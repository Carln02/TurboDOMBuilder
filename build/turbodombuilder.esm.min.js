import{__esDecorate as e,__runInitializers as t}from"tslib";import{AbstractType as s,Map as i,Array as n,YMapEvent as a,YArrayEvent as r}from"yjs";export{AbstractType as YAbstractType,Array as YArray,YArrayEvent,Doc as YDoc,YEvent,Map as YMap,YMapEvent,Text as YText}from"yjs";function o(e){return null==e&&null!=e}function l(e){return void 0===e}function c(e,t){return"string"==typeof e&&"string"==typeof t?e.localeCompare(t):"number"==typeof e&&"number"==typeof t?e-t:0}function h(e,t){let s=e;for(;s&&s!==Object.prototype;){const e=Object.getOwnPropertyDescriptor(s,t);if(e)return e;s=Object.getPrototypeOf(s)}}function u(e,t){let s=e;for(;s&&s!==Object.prototype;){if(Object.prototype.hasOwnProperty.call(s,t))return!0;s=Object.getPrototypeOf(s)}return!1}function d(e,t){let s=Object.getPrototypeOf(e);for(;s&&s!==Object.prototype;){if(Object.getOwnPropertyDescriptor(s,t))return s;s=Object.getPrototypeOf(s)}}function f(e,t,s){let i=Object.getPrototypeOf(e);for(;i&&i!==Object.prototype;){const e=Object.getOwnPropertyDescriptor(i,t),n=e?.value??e?.get??e?.set;if("function"==typeof n&&n!==s)return n;i=Object.getPrototypeOf(i)}}function p(e,t){let s=Object.getPrototypeOf(e);for(s&&(s=Object.getPrototypeOf(s));s&&s!==Object.prototype;){const e=Object.getOwnPropertyDescriptor(s,t);if(e)return e;s=Object.getPrototypeOf(s)}}const m=new class{constructorMap=new WeakMap;constructorData(e){let t=this.constructorMap.get(e);return t||(t={installed:new Map},this.constructorMap.set(e,t)),t}};function g(e){return function(t,s){e||(e={});const{kind:i,name:n,static:a}=s,r=n,o=Symbol(`__auto_${r}`);s.addInitializer(function(){const s=a?this:d(this,r),n=p(this,r);let c,u;const f=function(){return c&&e?.returnDefinedGetterValue?c.call(this):e.override&&n?.get?n.get.call(this):this[o]},g=function(t){e.override&&n?.set&&n.set.call(this,t),this[o]=t};let y=!1;const b=function(){let t=f.call(this);return y||(y=!0,!e.returnDefinedGetterValue&&l(t)&&(e.defaultValue?t=e.defaultValue:e.defaultValueCallback&&(t=e.defaultValueCallback.call(this)),(e.setIfUndefined||e.defaultValue||e.defaultValueCallback)&&(k.call(this,t),t=f.call(this))),y=!1),t};let v=!1;const k=function(t){if(v)return g.call(this,t);v=!0,e.callBefore?.call(this,t);let s=e?.preprocessValue?e.preprocessValue.call(this,t):t;(e.cancelIfUnchanged??1)&&f.call(this)===s||(e.executeSetterBeforeStoring&&u&&u.call(this,s),g.call(this,s),!e.executeSetterBeforeStoring&&u&&u.call(this,s),e.callAfter?.call(this,s)),v=!1};if(l(f.call(this))){let s="field"===i?t:void 0;l(s)&&(e.initialValue?s=e.initialValue:e.initialValueCallback&&(s=e.initialValueCallback.call(this))),!l(s)&&e.preprocessValue&&(s=e.preprocessValue.call(this,s)),this[o]=s}if("field"===i||"accessor"===i){const e=t;e?.get&&(c=e.get),e?.set&&(u=e.set);const s=h(this,r)??{enumerable:!0};Object.defineProperty(this,r,{configurable:!0,enumerable:s.enumerable??!0,get:()=>b.call(this),set:e=>k.call(this,e)})}else if("getter"===i||"setter"===i){const e=m.constructorData(s).installed;if(e.get(r))return;e.set(r,!0);const t=h(s,r)??{enumerable:!0};"function"==typeof t.get&&(c=t.get),"function"==typeof t.set&&(u=t.set),Object.defineProperty(s,r,{configurable:!0,enumerable:t.enumerable??!0,get:function(){return b.call(this)},set:function(e){k.call(this,e)}})}})}}class y{element;#e(){return new Proxy(this,{get(e,t,s){if(t in e)return Reflect.get(e,t,s);const i=e.element?.[t];return"function"==typeof i?i.bind(e.element):i},set:(e,t,s,i)=>t in e?Reflect.set(e,t,s,i):(e.element[t]=s,!0),has:(e,t)=>t in e||t in e.element,ownKeys:e=>Array.from([...Reflect.ownKeys(e),...Reflect.ownKeys(e.element)]),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e,t)||Object.getOwnPropertyDescriptor(e.element,t)||void 0})}constructor(){return this.#e()}}const b=new class{dataMap=new WeakMap;data(e){return e instanceof y&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}};const v=["interactors","tools","substrates","controllers","handlers"];const k=new class{operateOnClasses(e,t,s=()=>{}){if(!e||!t||!e.element)return e;try{"string"==typeof t&&(t=t.split(" ")),t.filter(e=>e.trim().length>0).forEach(e=>s(e))}catch(e){console.error(e)}return e}};const S="http://www.w3.org/2000/svg",E=new Set(["a","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tspan","use","view"]),w="http://www.w3.org/1998/Math/MathML",C=new Set(["annotation","annotation-xml","maction","math","merror","mfrac","mi","mmultiscripts","mn","mo","mover","mpadded","mphantom","mprescripts","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]);function O(e){return(t={})=>(t.tag=e,T({...t,tag:e}))}function T(e={}){let t;return t=e.namespace?"svg"==e.namespace?document.createElementNS(S,e.tag||"svg"):"mathML"==e.namespace?document.createElementNS(w,e.tag||"math"):document.createElementNS(e.namespace,e.tag||"div"):document.createElement(e.tag||"div"),e.shadowDOM&&t.attachShadow({mode:"open"}),Kt(t).setProperties(e),t}function P(e={}){let t;var s;return s=e.tag,t=E.has(s)||s?.startsWith("svg")?document.createElementNS(S,e.tag||"svg"):function(e){return C.has(e)||e?.startsWith("math")}(e.tag)?document.createElementNS(w,e.tag||"math"):document.createElement(e.tag||"div"),e.shadowDOM&&t.attachShadow({mode:"open"}),Kt(t).setProperties(e),t}function x(e={}){return T({...e,tag:"a"})}function D(e={}){return T({...e,tag:"canvas"})}function A(e={}){return T({...e,tag:"div"})}function M(e={}){return T({...e,tag:"form"})}function I(e={}){return T({...e,tag:"h1"})}function j(e={}){return T({...e,tag:"h2"})}function B(e={}){return T({...e,tag:"h3"})}function V(e={}){return T({...e,tag:"h4"})}function _(e={}){return T({...e,tag:"h5"})}function N(e={}){return T({...e,tag:"h6"})}function z(e={}){return T({...e,tag:"img"})}function K(e={}){return T({...e,tag:"input"})}function L(e={}){return T({...e,tag:"link"})}function F(e={}){return T({...e,tag:"p"})}function R(e={}){return T({...e,tag:"span"})}function W(e={}){return T({...e,tag:"style"})}function H(e={}){return T({...e,tag:"textarea"})}function U(e={}){return T({...e,tag:"video"})}function $(e,t=document.head){if(!e)return;const s=W({innerHTML:e});Kt(t).addChild(s)}class G{callbacks=new Map;model;constructor(e){e&&(this.model=e)}get defaultBlockKey(){return this.model?this.model.defaultBlockKey:"__defaultBlockKey__"}getBlock(e){return this.callbacks.get(e?.toString())}getOrGenerateBlock(e){return this.callbacks.has(e.toString())||this.callbacks.set(e.toString(),new Map),this.callbacks.get(e.toString())}getKey(e,t){const s=this.getBlock(t);return s?s.get(e):[]}getOrGenerateKey(e,t){const s=this.getOrGenerateBlock(t);return s.has(e)||s.set(e,[]),s.get(e)}addWithBlock(e,t,s){this.getOrGenerateKey(e,t).push(s)}add(e,t){this.addWithBlock(e,this.defaultBlockKey,t)}removeWithBlock(e,t,s){if(null==s)this.getBlock(t)?.delete(e);else{const i=this.getKey(e,t),n=i.indexOf(s);n>=0&&i.splice(n,1)}}remove(e,t){this.removeWithBlock(e,this.defaultBlockKey,t)}fireWithBlock(e,t,...s){this.callbacks.get(t.toString())?.get(e)?.forEach(e=>{e&&"function"==typeof e&&e(...s)})}fire(e,...t){this.fireWithBlock(e,this.defaultBlockKey,...t)}}class q{element;_view;_model;_emitter;_controllers=new Map;_handlers=new Map;_interactors=new Map;_tools=new Map;_substrates=new Map;constructor(e){e.element&&(this.element=e.element),e.emitter||(this.emitter=new G),this.generate(e)}get view(){return this._view}set view(e){this._view=this.generateInstance(e,{element:this.element}),this.linkPieces()}get model(){return this._model}set model(e){this.model?.keyChangedCallback.remove(this.emitterFireCallback),this._model=this.generateInstance(e),this._model.handlers=this._handlers,this._model.addHandler=e=>this.addHandler(e),this.linkPieces()}get emitter(){return this._emitter}set emitter(e){this._emitter=this.generateInstance(e),this.linkPieces()}get controllers(){return Array.from(this._controllers.values())||[]}set controllers(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addController(e)),this.linkPieces()}get handlers(){return Array.from(this._handlers.values())||[]}set handlers(e){this.generateInstances(e).forEach(e=>this.addHandler(e)),this.linkPieces()}get interactors(){return Array.from(this._interactors.values())||[]}set interactors(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addInteractor(e)),this.linkPieces()}get tools(){return Array.from(this._tools.values())||[]}set tools(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addTool(e)),this.linkPieces()}get substrates(){return Array.from(this._substrates.values())||[]}set substrates(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addSubstrate(e)),this.linkPieces()}get data(){return this.model?.data}set data(e){this.model&&(this.model.data=e)}get dataId(){return this.model?.dataId}set dataId(e){this.model&&(this.model.dataId=e)}get dataIndex(){return Number.parseInt(this.dataId)}set dataIndex(e){this.model&&(this.model.dataId=e.toString())}get dataSize(){return this.model?.getSize?.()}getController(e){return this._controllers.get(e)}addController(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Controller")),this._controllers.set(e.keyName,e),this.updateController(e)}getHandler(e){return this._handlers.get(e)}addHandler(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Handler")),this._handlers.set(e.keyName,e),this.updateHandler(e)}getInteractor(e){return this._interactors.get(e)}addInteractor(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Interactor")),this._interactors.set(e.keyName,e),this.updateInteractor(e)}getTool(e){return this._tools.get(e)}addTool(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Tool")),this._tools.set(e.keyName,e),this.updateTool(e)}getSubstrate(e){return this._substrates.get(e)}addSubstrate(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Substrate")),this._substrates.set(e.keyName,e),this.updateSubstrate(e)}generate(e={}){for(const t of Object.keys(e)){const s=e[t];void 0!==s&&"initialize"!==t&&"data"!==t&&(this[t]=s)}this._emitter||(this.emitter=new G),e.data&&this.model&&this.model.setBlock(e.data,void 0,void 0,!1),(void 0===e.initialize||e.initialize)&&this.initialize()}initialize(){this.view?.initialize(),this._controllers.forEach(e=>e.initialize()),this._interactors.forEach(e=>e.initialize()),this._tools.forEach(e=>e.initialize()),this._substrates.forEach(e=>e.initialize()),this.model?.initialize()}updateController(e){e.emitter=this.emitter,e.model=this.model,e.view=this.view}updateHandler(e){e.model=this.model}updateInteractor(e){e.model=this.model,e.view=this.view,e.emitter=this.emitter}updateTool(e){e.emitter=this.emitter,e.model=this.model,e.view=this.view}updateSubstrate(e){e.model=this.model,e.view=this.view,e.emitter=this.emitter}linkPieces(){this.model&&!this.model.keyChangedCallback.has(this.emitterFireCallback)&&this.model.keyChangedCallback.add(this.emitterFireCallback),this.emitter&&(this.emitter.model=this.model),this.view&&(this.view.emitter=this.emitter,this.view.model=this.model),this._controllers.forEach(e=>this.updateController(e)),this._handlers.forEach(e=>this.updateHandler(e)),this._interactors.forEach(e=>this.updateInteractor(e)),this._tools.forEach(e=>this.updateTool(e)),this._substrates.forEach(e=>this.updateSubstrate(e))}generateInstance(e,t,s=!0){if(e){if("function"==typeof e){return new e(s&&t&&"object"==typeof t?{...t}:t)}return e}}generateInstances(e,t,s=!0){if(!e)return[];"object"==typeof e&&Array.isArray(e)||(e=[e]);const i=[];return e.forEach(e=>{const n=this.generateInstance(e,t,s);n&&i.push(n)}),i}emitterFireCallback=(e,t,...s)=>this.emitter?.fireWithBlock(e,t,...s);extractClassEssenceName(e,t){let s=e.name,i=Object.getPrototypeOf(this.element);for(;i&&i.constructor!==Object;){const e=i.constructor.name.replaceAll("_","");if(s.startsWith(e)){s=s.slice(e.length);break}i=Object.getPrototypeOf(i)}return s.endsWith(t)&&(s=s.slice(0,-t.length)),s.charAt(0).toLowerCase()+s.slice(1)}}const Y=new class{constructorMap=new WeakMap;dataMap=new WeakMap;activeEffect=null;constructorData(e){let t=this.constructorMap.get(e);return t||(t={installed:new Map},this.constructorMap.set(e,t)),t}data(e){let t=this.dataMap.get(e);return t||(t={propertyKeyMap:new Map,blockKeyMap:new Map},this.dataMap.set(e,t)),t}track(e){this.activeEffect&&this.activeEffect.dependencies.add(e)}createSignalEntry(e,t,s,i,n,a){const r=new Set,o=this;a||(a={diffOnWrite:!0}),n||(n=e=>Reflect.set(t,s,e,t)),i||(i=t&&!l(s)?()=>Reflect.get(t,s):()=>e);const c={get:()=>(o.track(c),i()),set(r){if(!t||l(s)){const t=e;e=r,Object.is(t,r)||c.emit()}else if(a.diffOnWrite){const e=i();n(r);const t=i();Object.is(e,t)||c.emit()}else n(r),c.emit()},update(e){c.set(e(i()))},sub:e=>(r.add(e),()=>r.delete(e)),emit(){for(const e of Array.from(r))queueMicrotask(e)}};return t&&!l(s)&&(this.getReactivityData(t,s).signal=c),c}getReactivityData(e,t){const s=this.data(e).propertyKeyMap;return s.has(t)||s.set(t,{}),s.get(t)}getSignal(e,t){return this.getReactivityData(e,t).signal}setSignal(e,t,s){const i=this.getSignal(e,t);i?i.set(s):Reflect.set(e,t,s,e)}getEffect(e,t){return this.getReactivityData(e,t).effect}setEffect(e,t,s){this.getReactivityData(e,t).effect=s}markDirty(e,t){this.getSignal(e,t)?.emit()}schedule(e){e.scheduled||(e.scheduled=!0,queueMicrotask(()=>{e.scheduled=!1,e.run()}))}bindBlockKey(e,t,s,i){i=i??e?.defaultBlockKey??"__default__";const n=this.data(e).blockKeyMap;n.has(i)||n.set(i,new Map),n.get(i).set(s,t)}getKeyFromBlockKey(e,t,s){return s=s??e?.defaultBlockKey??"__default__",this.data(e).blockKeyMap.get(s)?.get(t)}},J=new class{utils;constructor(e){this.utils=e}createBoxFromEntry(e){return new Proxy({...e,toJSON:()=>e.get(),valueOf:()=>e.get(),[Symbol.toPrimitive]:t=>{const s=e.get();return"string"===t?String(s):"number"==typeof s?s:null!=s&&"function"==typeof s.valueOf?s.valueOf():s},get value(){return e.get()},set value(t){e.set(t)}},{get:(e,t,s)=>Reflect.get(e,t,s),set:(e,t,s,i)=>"value"===t?(e.value=s,!0):Reflect.set(e,t,s,i)})}signalDecorator(e,t,s,i,n=!1){const{kind:a,name:r,static:o,private:c}=t;if(c)throw new Error("@signal does not support private class elements.");const u=r,d=Symbol(`[[signal:${String(u)}]]`),f=Symbol(`[[signal:${String(u)}:shadow]]`),p=this.utils;t.addInitializer(function(){const t=o?this:this.constructor.prototype;let r,c;const m=function(){return s&&!this[f]?s.call(this):r&&!this[f]?r.call(this):this[d]},g=function(e){c||i?(i&&i.call(this,e),c&&c.call(this,e),r||s||(this[d]=e,this[f]=!0)):(this[d]=e,this[f]=!0)},y=(e,t=!0)=>{let i=p.getSignal(e,u);return i||("field"!==a||r||s||(e[d]=e[u]),i=p.createSignalEntry(void 0,e,u,()=>m.call(e),t=>g.call(e,t),{diffOnWrite:t}),"field"===a&&delete e[u],i)};if("field"===a||"accessor"===a){const t=e;t?.get&&(r=t.get),t?.set&&(c=t.set);const i=y(this,!r&&!s),n=h(this,u);Object.defineProperty(this,u,{configurable:n?.configurable??!0,enumerable:n?.enumerable??!0,get:()=>(p.track(i),m.call(this)),set:e=>i.set(e)})}else if("getter"===a||"setter"===a){const e=p.constructorData(t).installed;if(e.get(u))return;e.set(u,!0);const i=h(t,u)??{};"function"==typeof i.get&&(r=i.get),"function"==typeof i.set&&(c=i.set),Object.defineProperty(t,u,{configurable:i?.configurable??!0,enumerable:!!i?.enumerable,get:function(){const e=y(this,!r&&!s);return p.track(e),m.call(this)},set:function(e){y(this,!r&&!s).set(e)}})}if(n){l(s?.call(this)??r?.call(this))&&y(this,!r&&!s).set(void 0)}})}}(Y),X=new class{utils;constructor(e){this.utils=e}makeEffect(e){const t=this.utils;return{callback:e,dependencies:new Set,cleanups:[],scheduled:!1,run(){for(const e of this.cleanups)e();this.cleanups=[],this.dependencies=new Set,t.activeEffect=this;try{this.callback()}finally{t.activeEffect=null}for(const e of this.dependencies){const s=e.sub(()=>t.schedule(this));this.cleanups.push(s)}},dispose(){for(const e of this.cleanups)e();this.cleanups=[],this.dependencies.clear()}}}}(Y);function Q(...e){return 2===e.length&&e[1]&&"object"==typeof e[1]&&"kind"in e[1]&&"name"in e[1]&&"static"in e[1]&&"private"in e[1]?J.signalDecorator(e[0],e[1]):"function"==typeof e[0]&&"function"==typeof e[1]?J.createBoxFromEntry(Y.createSignalEntry(void 0,e[2],e[3],e[0],e[1])):J.createBoxFromEntry(Y.createSignalEntry(e[0],e[1],e[2]))}function Z(e,t){return function(s,i){const n=e??String(i.name);return i.addInitializer(function(){l(t)&&"defaultBlockKey"in this&&(t=this.defaultBlockKey),Y.bindBlockKey(this,i.name,n,t)}),J.signalDecorator(s,i,function(){return this.getData?.(n,t)},function(e){this.setData?.(n,e,t)})}}function ee(e,t){return function(s,i){const n=e??String(i.name);return i.addInitializer(function(){l(e)&&"defaultBlockKey"in this&&(e=this.defaultBlockKey)}),J.signalDecorator(s,i,function(){return this.getBlock?.(n)},function(e){this.setBlock?.(e,t,n)},!0)}}function te(e,t){return function(s,i){const n=e??String(i.name);return i.addInitializer(function(){l(e)&&"defaultBlockKey"in this&&(e=this.defaultBlockKey)}),J.signalDecorator(s,i,function(){return this.getBlockData?.(n)},function(e){this.setBlock?.(e,t,n)},!0)}}function se(e){return function(t,s){const i=e??String(s.name);return s.addInitializer(function(){l(e)&&"defaultBlockKey"in this&&(e=this.defaultBlockKey)}),J.signalDecorator(t,s,function(){return this.getBlockId?.(i)},function(e){this.setBlockId?.(e,i)},!0)}}function ie(...e){const t=e[0],s=e[1];if(s&&"object"==typeof s&&"kind"in s&&"name"in s&&"static"in s&&"private"in s){const{kind:e,name:i,static:n}=s,a=String(i);if("method"!==e&&"getter"!==e&&("field"!==e||"function"!=typeof t))throw new Error("@effect can only decorate zero-arg instance methods or getters.");if(n)throw new Error("@effect does not support static methods/getters.");s.addInitializer?.(function(){const e=this,s=function(){t?.call(this)},i=X.makeEffect(()=>s.call(e));Y.setEffect(e,a,i)})}else if("function"==typeof t){const e=X.makeEffect(t);return e.run(),()=>e.dispose()}}function ne(e,t){return Y.getSignal(e,t)}function ae(e,t,s){return Y.setSignal(e,t,s)}function re(e,t,s){let i;return l(s)||(i=Y.getKeyFromBlockKey(e,t,s)),l(i)&&(i=t),Y.markDirty(e,i)}function oe(e){for(const[,t]of Y.data(e).propertyKeyMap)t.effect?.run()}function le(e,t){const s=Y.getReactivityData(e,t);s.effect?.dispose(),s.effect=void 0}function ce(e){for(const[,t]of Y.data(e).propertyKeyMap)t.effect?.dispose(),t.effect=void 0}class he{_weakRefs;constructor(){this._weakRefs=new Set}add(e){return this.has(e)||this._weakRefs.add(new WeakRef(e)),this}has(e){for(const t of this._weakRefs)if(t.deref()===e)return!0;return!1}delete(e){for(const t of this._weakRefs)if(t.deref()===e)return this._weakRefs.delete(t),!0;return!1}cleanup(){for(const e of this._weakRefs)void 0===e.deref()&&this._weakRefs.delete(e)}toArray(){const e=[];for(const t of this._weakRefs){const s=t.deref();void 0!==s?e.push(s):this._weakRefs.delete(t)}return e}get size(){return this.cleanup(),this.toArray().length}clear(){this._weakRefs.clear()}}class ue{callbacks=new Set;add(e){this.callbacks.add(e)}remove(e){return this.callbacks.delete(e)}has(e){return this.callbacks.has(e)}fire(...e){let t;for(const s of this.callbacks)try{const i=s(...e);l(i)||(t=i)}catch(e){console.error("Error invoking callback:",e)}return t}clear(){this.callbacks.clear()}}class de extends ue{onAdded=new ue;add(e){super.add(e),this.onAdded.fire(e)}}class fe{_isInitialized=!1;onAdded=new de;onUpdated=new de;onDeleted=new de;onInitialize=new de;onDestroy=new de;instances=new Map;constructor(e={}){const t=this;e.onAdded&&this.onAdded.add((t,s,i,n)=>e.onAdded(t,s,i,n)),this.onUpdated.add((t,s,i,n,a)=>{if(e.onUpdated)e.onUpdated(t,s,i,n,a);else{if("object"!=typeof s)return;"model"in s&&s.model instanceof ge?s.model.setBlock(t,i):("data"in s&&(s.data=t),"dataId"in s&&(s.dataId=i.toString()))}}),this.onDeleted.add((t,s,i,n,a)=>{e.onDeleted?e.onDeleted(t,s,i,n,a):this.removeInstance(s)}),e.onInitialize&&this.onInitialize.add(()=>e.onInitialize(t)),e.onDestroy&&this.onDestroy.add(()=>e.onDestroy(t)),e.initialize&&this.initialize()}getInstance(e,t=this.defaultBlockKey){return this.instances.get(t)?.get(e)}getBlockInstancesAndKeys(e=this.defaultBlockKey){const t=this.instances.get(e);return t?Array.from(t.entries()):[]}getBlockInstances(e=this.defaultBlockKey){return this.getBlockInstancesAndKeys(e).sort((e,t)=>c(e[0],t[0])).map(e=>e[1])}getAllInstances(){return Array.from(this.instances.keys()).sort(c).flatMap(e=>this.getBlockInstances(e))}getInstanceKey(e){for(const[t,s]of this.instances.entries())for(const[i,n]of s.entries())if(n===e)return{blockKey:t,key:i}}getInstanceAt(e){const t=this.scopeKey(e);if(!l(t.blockKey)&&!l(t.key))return this.getInstance(t.key,t.blockKey)}getInstanceFlatKey(e){const t=this.getInstanceKey(e);if(t)return this.flattenKey(t.key,t.blockKey)}setInstance(e,t,s=this.defaultBlockKey){let i=this.instances.get(s);i||(this.instances.set(s,new Map),i=this.instances.get(s)),i?.set(t,e)}removeInstanceByKey(e,t=!0,s=this.defaultBlockKey){const i=this.instances.get(s);if(!i)return;const n=i.get(e);i.delete(e),n&&t&&n&&"object"==typeof n&&"remove"in n&&"function"==typeof n.remove&&n?.remove()}removeInstance(e,t=!0){const s=this.getInstanceKey(e);s&&this.removeInstanceByKey(s.key,t,s.blockKey??this.defaultBlockKey)}get isInitialized(){return this._isInitialized}initialize(){this.isInitialized||(this.onInitialize.fire(this),this._isInitialized=!0)}clear(){this.getAllInstances().forEach(e=>this.removeInstance(e)),this.instances.clear(),this._isInitialized=!1}destroy(){this.clear(),this.onDestroy.fire(this)}keyChanged(e,t,s=!1,i=this.defaultBlockKey){const n=this.getInstance(e,i);if(n)return void(s?this.onDeleted.fire(t,n,e,this,i):this.onUpdated.fire(t,n,e,this,i));if(s)return;const a=this.onAdded.fire(t,e,this,i);a&&(this.setInstance(a,e,i),this.onUpdated.fire(t,a,e,this,i))}flattenKey(e,t=this.defaultBlockKey){if("number"==typeof t){let s=0;for(const e of Array.from(this.instances.keys()).sort(c)){if(e===t)break;s+=this.getBlockInstancesAndKeys(e).length}return s+Number(e)}return t.toString()+"|"+e.toString()}scopeKey(e){if("string"==typeof e){const t=e.toString().split("|");return t.length<2?{}:{blockKey:t[0],key:t[1]}}const t=Array.from(this.instances.keys()).sort(c);if("number"==typeof e){if(e<0)return{blockKey:t[0]??0,key:0};let s=e;for(const e of t){const t=this.getBlockInstancesAndKeys(e).length;if(s<t)return{blockKey:e,key:s};s-=t}}const s=t[t.length-1];return{blockKey:s,key:this.getBlockInstancesAndKeys(s).length}}get defaultBlockKey(){const e=Array.from(this.instances.keys())?.[0];return l(e)?"__default__":e}}class pe extends fe{keyChanged(e,t,s=!1){super.keyChanged(e,t,s,this.defaultBlockKey)}getInstanceKey(e){return super.getInstanceKey(e)?.key}setInstance(e,t){super.setInstance(e,t)}}let me=(()=>{let s,i=[],n=[];return class{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[g({defaultValue:!0})],e(this,null,s,{kind:"accessor",name:"enabledCallbacks",static:!1,private:!1,access:{has:e=>"enabledCallbacks"in e,get:e=>e.enabledCallbacks,set:(e,t)=>{e.enabledCallbacks=t}},metadata:t},i,n),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}_data;id;get data(){return this._data}set data(e){this.clear(!1),this._data=e,e&&this.initialize()}#t=t(this,i,void 0);get enabledCallbacks(){return this.#t}set enabledCallbacks(e){this.#t=e}isInitialized=(t(this,n),!1);host;signals=new Map;changeObservers=new he;onKeyChanged=new de;observerConstructor=pe;constructor(e={}){this.id=e.id,this._data=e.data,e.initialize&&this.initialize()}get(e){return this.data instanceof Map?this.data.get(e):this.data?.[e]}set(e,t){if(!this.data)return;const s=this.get(e);Object.is(s,t)||(this.data instanceof Map?this.data.set(e,t):this.data[e]=t,this.keyChanged(e,t))}add(e,t){if(!this.data||!Array.isArray(this.data))return this.set(t,e);let s=t;return l(s)||"number"!=typeof s||s>this.data.length?(s=this.data.length,this.data.push(e)):(s<0&&(s=0),this.data.splice(s,0,e)),s}has(e){return this.data instanceof Map?this.data.has(e):void 0!==this.data?.[e]}delete(e){this.data&&this.has(e)&&(this.data instanceof Map?this.data.delete(e):delete this.data[e],this.keyChanged(e,void 0,!0))}get keys(){return this.data&&"object"==typeof this.data?this.data instanceof Map?Array.from(this.data.keys()):[...Object.keys(this.data),...Object.getOwnPropertySymbols(this.data)]:[]}get values(){return this.keys.map(e=>this.get(e))}get size(){return this.keys.length}initialize(){if(this.data&&!this.isInitialized){this.isInitialized=!0;for(const e of this.keys)this.keyChanged(e)}}clear(e=!0){e&&(this._data=void 0),this.changeObservers?.toArray().forEach(e=>e.clear()),this.isInitialized=!1}toJSON(){if(this.data instanceof Map)return Object.fromEntries(this.data);if(this.data&&"object"==typeof this.data){const e={};for(const t of this.keys)e[t]=this.get(t);return e}return{}}link(e){this.host=e}unlink(){this.host=void 0}makeSignal(e){if(this.signals.has(e))return this.signals.get(e);const t=Q(()=>this.get(e),t=>this.set(e,t),this,e);return this.signals.set(e,t),t}getSignal(e){return this.signals.get(e)}makeAllSignals(){this.keys.forEach(e=>this.makeSignal(e))}generateObserver(e={}){const t=new(e.customConstructor??this.observerConstructor??pe)({...e,onDestroy:e=>this.changeObservers?.delete(e),onInitialize:e=>{if(this.isInitialized)for(const t of this.keys)e.keyChanged(t,this.get(t))}});return this.changeObservers?.add(t),t}keyChanged(e,t=this.get(e),s=!1){this.signals.get(e)?.emit(),this.host?.onDirty?.(e,this),s&&this.signals.delete(e),this.enabledCallbacks&&(this.onKeyChanged.fire(e,t),this.host?.onChange?.(e,t,this),this.changeObservers?.toArray().forEach(i=>i.keyChanged(e,t,s)))}}})(),ge=(()=>{let s,i=[];return class{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[g()],e(this,null,s,{kind:"setter",name:"enabledCallbacks",static:!1,private:!1,access:{has:e=>"enabledCallbacks"in e,set:(e,t)=>{e.enabledCallbacks=t}},metadata:t},null,i),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}isDataBlocksArray=(t(this,i),!1);dataBlocks;changeObservers=new he;static dataBlockConstructor=me;observerConstructor=fe;onSetBlock=new de;handlers;keyChangedCallback;onDirty(e,t){re(this,e,this.getBlockKey(t))}onChange(e,t,s){this.fireBlockCallback(e,this.getBlockKey(s),t)}constructor(e,t){this.keyChangedCallback=new de,"array"===t?(this.isDataBlocksArray=!0,this.dataBlocks=[]):(this.isDataBlocksArray=!1,this.dataBlocks=new Map),this.enabledCallbacks=!0,e&&this.setBlock(e,void 0,this.defaultBlockKey,!1),this.setup()}setup(){}get block(){return this.getBlock()}set block(e){this.setBlock(e)}get data(){return this.getBlockData()}set data(e){this.setBlock(e)}get dataId(){return this.getBlockId()}set dataId(e){this.setBlockId(e)}set enabledCallbacks(e){this.getAllBlocks().forEach(t=>t.enabledCallbacks=e)}getBlock(e=this.defaultBlockKey){if(this.isValidBlockKey(e)){if(!this.isDataBlocksArray)return this.dataBlocks.get(e.toString());{const t=Number(e);if(Number.isInteger(t)&&t>=0&&t<this.dataBlocks.length)return this.dataBlocks[t]}}}createBlock(e,t,s=!0){const i=e instanceof me?e:new(this.constructor.dataBlockConstructor??me)({id:t,data:e});return i.link(this),s&&i.initialize(),i}setBlock(e,t,s=this.defaultBlockKey,i=!0){if(!this.isValidBlockKey(s))return;const n=this.getBlock(s);if(n&&!(e instanceof me))return n.clear(),n.data=e,l(t)||(n.id=t),void this.onSetBlock.fire(s);n?.clear(),n?.unlink();const a=this.createBlock(e,t,!1);if(this.isDataBlocksArray){const e=Number(s);Number.isInteger(e)&&e>=0&&(this.dataBlocks[e]=a)}else this.dataBlocks.set(s.toString(),a);i&&this.initialize(s),this.onSetBlock.fire(s)}hasBlock(e){if(this.isDataBlocksArray){const t=Number(e);return Number.isInteger(t)&&t>=0&&t<this.dataBlocks.length}return this.dataBlocks.has(e.toString())}deleteBlock(e){const t=this.getBlock(e);if(t)if(t.clear(),t.unlink(),this.isDataBlocksArray){const t=Number(e);Number.isInteger(t)&&t>=0&&t<this.dataBlocks.length&&this.dataBlocks.splice(t,1)}else this.dataBlocks.delete(e.toString())}addBlock(e,t,s,i=!0){if(!this.isDataBlocksArray)return this.setBlock(e,t,s,i);const n=this.createBlock(e,t,!1);let a=Number(s);return(!Number.isInteger(a)||a<0)&&(a=this.dataBlocks.length),this.dataBlocks.splice(a,0,n),i&&this.initialize(a),a}getData(e,t=this.defaultBlockKey){return this.getBlock(t)?.get(e)}getDataAt(e){const t=this.scopeKey(e);if(!l(t.key)&&!l(t.blockKey))return this.getData(t.key,t.blockKey)}setData(e,t,s=this.defaultBlockKey){return this.getBlock(s)?.set(e,t)}setDataAt(e,t){const s=this.scopeKey(e);if(!l(s.key)&&!l(s.blockKey))return this.setData(s.key,t,s.blockKey)}addData(e,t,s=this.defaultBlockKey){return this.getBlock(s)?.add(e,t)}addDataAt(e,t){const s=this.scopeKey(t);if(!l(s.key)&&!l(s.blockKey))return this.addData(e,s.key,s.blockKey)}hasData(e,t=this.defaultBlockKey){return this.getBlock(t)?.has(e)}hasDataAt(e){const t=this.scopeKey(e);return!l(t.key)&&!l(t.blockKey)&&this.hasData(t.key,t.blockKey)}deleteData(e,t=this.defaultBlockKey){return this.getBlock(t)?.delete(e)}deleteDataAt(e){const t=this.scopeKey(e);return!l(t.key)&&!l(t.blockKey)&&this.deleteData(t.key,t.blockKey)}getSize(e=this.defaultBlockKey){return this.getBlock(e)?.size??0}toJSON(e=this.defaultBlockKey){return this.getBlock(e)?.toJSON()}getBlockData(e=this.defaultBlockKey){return this.getBlock(e)?.data}getBlockId(e=this.defaultBlockKey){return this.getBlock(e)?.id}setBlockId(e,t=this.defaultBlockKey){if(!e)return;const s=this.getBlock(t);s&&(s.id=e)}fireCallback(e,...t){this.keyChangedCallback.fire(e,this.defaultBlockKey,...t)}fireBlockCallback(e,t=this.defaultBlockKey,...s){this.isValidBlockKey(t)||(t=this.getAllBlockKeys()[0]),this.keyChangedCallback.fire(e,t,...s);const i=this.getBlock(t)?.get(e);this.changeObservers.toArray().forEach(s=>s.keyChanged(e,i,!1,t))}initialize(e=this.defaultBlockKey){this.getBlock(e)?.initialize()}clear(e=!0,t=this.defaultBlockKey){this.getBlock(t)?.clear(e)}get defaultBlockKey(){return this.isDataBlocksArray?0:"__turbo_default_block_key__"}get defaultComputationBlockKey(){return(this.isDataBlocksArray?this.dataBlocks.length:this.dataBlocks.size)>1?null:this.defaultBlockKey}isValidBlockKey(e){return null!=e&&("string"==typeof e&&0!==e.length||"number"==typeof e)}getAllBlockKeys(){return this.isDataBlocksArray?this.dataBlocks.map((e,t)=>t):Array.from(this.dataBlocks.keys())}getAllBlockIds(){return this.getAllBlocks().map(e=>e.id)}getAllBlocks(e=this.defaultComputationBlockKey){const t=[];if(null!==e){const s=this.getBlock(e);s&&t.push(s)}else for(const e of this.getAllBlockKeys()){const s=this.getBlock(e);s&&t.push(s)}return t}getBlockKey(e){for(const t of this.getAllBlockKeys())if(this.getBlock(t)===e)return t}getAllKeys(e=this.defaultComputationBlockKey){return this.getAllBlocks(e).flatMap(e=>e.keys)}getAllValues(e=this.defaultComputationBlockKey){return this.getAllBlocks(e).flatMap(e=>e.values)}getHandler(e){return this.handlers?.get(e)}addHandler(e){e.keyName&&this.handlers?.set(e.keyName,e)}generateObserver(e={}){const t=new(e.customConstructor??this.observerConstructor??fe)({...e,onDestroy:()=>this.changeObservers.delete(t),onInitialize:()=>{for(const e of this.getAllBlockKeys())for(const s of this.getAllKeys(e))t.keyChanged(s,this.getData(s,e),!1,e)}});return this.changeObservers.add(t),t}flattenKey(e,t=this.defaultBlockKey){if(Array.isArray(this.dataBlocks)){let s=0;for(const e of this.getAllBlockKeys().sort(c)){if(e===t)break;s+=this.getSize(e)}return s+Number(e)}return t.toString()+"|"+e.toString()}scopeKey(e){if("string"==typeof e){const t=e.toString().split("|");return t.length<2?{}:{blockKey:t[0],key:t[1]}}const t=this.getAllBlockKeys().sort(c);if("number"==typeof e){if(e<0)return{blockKey:0,key:0};let s=e;for(const e of t){const t=this.getSize(e);if(s<t)return{blockKey:e,key:s};s-=t}}const s=t[t.length-1];return{blockKey:s,key:this.getSize(s)}}}})();const ye={keyPressed:"turbo-key-pressed",keyReleased:"turbo-key-released"},be={keyPressed:"keydown",keyReleased:"keyup"},ve={click:"turbo-click",clickStart:"turbo-click-start",clickEnd:"turbo-click-end",longPress:"turbo-long-press"},ke={click:"click",clickStart:"mousedown",clickEnd:"mouseup",longPress:ve.longPress},Se={move:"turbo-move"},Ee={move:"mousemove"},we={drag:"turbo-drag",dragStart:"turbo-drag-start",dragEnd:"turbo-drag-end"},Ce={drag:we.drag,dragStart:we.dragStart,dragEnd:we.dragEnd},Oe={trackpadScroll:"turbo-trackpad-scroll",trackpadPinch:"turbo-trackpad-pinch",mouseWheel:"turbo-mouse-wheel"},Te={trackpadScroll:"wheel",trackpadPinch:"wheel",mouseWheel:"wheel"},Pe={...ve,...ye,...Se,...we,...Oe,selectInput:"turbo-select-input"},xe={...be,...ke,...Ee,...Ce,...Te,wheel:"wheel",scroll:"scroll",input:"input",change:"change",focus:"focus",focusIn:"focusin",focusOut:"focusout",blur:"blur",resize:"resize",compositionStart:"compositionstart",compositionEnd:"compositionend"};function De(e){if(null!=e)switch(typeof e){case"string":return e;case"number":case"boolean":case"bigint":case"symbol":case"function":return e.toString();case"object":if(Array.isArray(e))return JSON.stringify(e.map(e=>De(e)));if(e instanceof Date)return e.toISOString();if(e instanceof Element)return"[DOM ELEMENT]";try{return JSON.stringify(e)}catch{return"[object Object]"}default:return String(e)}}function Ae(e){if(!l(e)){switch(e){case"null":return null;case"true":return!0;case"false":return!1}if(!isNaN(Number(e)))return Number(e);if(/^\d+n$/.test(e))return BigInt(e.slice(0,-1));if(e.startsWith("function")||e.startsWith("("))try{const t=new Function(`return (${e})`)();if("function"==typeof t)return t}catch{}try{const t=JSON.parse(e);if("object"==typeof t&&null!=t)return t}catch{}return e}}function Me(e){if(!e||0==e.length)return"";const t=e.match(/\.\S{1,4}$/);return t?t[0]:""}function Ie(e){if(e&&0!=e.length)return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function je(e){if(e&&0!=e.length)return e.replace(/-([a-z])/g,e=>e[1].toUpperCase())}const Be=["mousedown","mouseup","mousemove","click","dblclick","contextmenu","dragstart","selectstart","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","wheel"],Ve=["wheel","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointercancel"];var _e,Ne,ze;function Ke(e,t,s){const i=Symbol(`__${t.toLowerCase()}_${String(e.name)}`),n=function(e,t,s){return e??(String(s.name).endsWith(t)?String(s.name).slice(0,-t.length):String(s.name))}(s,t,e);e.addInitializer(function(){Object.defineProperty(this,e.name,{configurable:!0,enumerable:!1,get:function(){if(this[i])return this[i];let e,s;switch(t){case"Controller":s="getController";break;case"Handler":s="getHandler";break;case"Interactor":s="getInteractor";break;case"Tool":s="getTool";break;case"Substrate":s="getSubstrate"}if(s){if(this.mvc&&this.mvc instanceof q?e=this.mvc[s](n):this[s]&&"function"==typeof this[s]&&(e=this[s](n)),!e)throw new Error(`${t} "${n}" not found on ${this?.constructor?.name}.`);return this[i]=e,e}},set:function(e){this[i]=e}})})}function Le(e){return function(t,s){Ke(s,"Controller",e)}}function Fe(e){return function(t,s){Ke(s,"Handler",e)}}function Re(e){return function(t,s){Ke(s,"Interactor",e)}}function We(e){return function(t,s){Ke(s,"Tool",e)}}function He(e){return function(t,s){Ke(s,"Substrate",e)}}!function(e){e[e.none=0]="none",e[e.click=1]="click",e[e.longPress=2]="longPress",e[e.drag=3]="drag"}(_e||(_e={})),function(e){e[e.none=0]="none",e[e.left=1]="left",e[e.right=2]="right",e[e.middle=3]="middle",e[e.other=4]="other",e[e.key=5]="key"}(Ne||(Ne={})),function(e){e[e.unknown=0]="unknown",e[e.mouse=1]="mouse",e[e.trackpad=2]="trackpad",e[e.touch=3]="touch"}(ze||(ze={}));class Ue extends Map{enforceImmutability=!0;set(e,t){return super.set(e,this.enforceImmutability?this.copy(t):t)}get(e){const t=super.get(e);return this.enforceImmutability?this.copy(t):t}get first(){if(0==this.size)return null;const e=this.values().next().value;return this.enforceImmutability?this.copy(e):e}get last(){if(0==this.size)return null;const e=this.valuesArray()[this.size-1];return this.enforceImmutability?this.copy(e):e}keysArray(){return Array.from(this.keys())}valuesArray(){return Array.from(this.values())}copy(e){if(e&&"object"==typeof e){if(e instanceof Array)return e.map(e=>this.copy(e));if(e.constructor&&e.constructor!=Object){if("function"==typeof e.clone)return e.clone();if("function"==typeof e.copy)return e.copy()}return{...e}}return e}mapKeys(e){const t=new Ue;for(let[s,i]of this)t.set(e(s,i),i);return t}mapValues(e){const t=new Ue;for(let[s,i]of this)t.set(s,e(s,i));return t}filter(e){const t=new Ue;for(let[s,i]of this)e(s,i)&&t.set(s,i);return t}merge(e){for(let[t,s]of e)this.set(t,s);return this}}let $e=(()=>{let s,i,n=ge,a=[],r=[],o=[];return class extends n{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;s=[Fe()],i=[g({callBefore:function(e){e==ze.trackpad&&(this.wasRecentlyTrackpad=!0)}})],e(this,null,i,{kind:"setter",name:"inputDevice",static:!1,private:!1,access:{has:e=>"inputDevice"in e,set:(e,t)=>{e.inputDevice=t}},metadata:t},null,a),e(null,null,s,{kind:"field",name:"utils",static:!1,private:!1,access:{has:e=>"utils"in e,get:e=>e.utils,set:(e,t)=>{e.utils=t}},metadata:t},r,o),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}utils=(t(this,a),t(this,r,void 0));state=(t(this,o),{});lockState={};onInputDeviceChange=new de;onToolChange=new de;currentKeys=[];currentAction=_e.none;currentClick=Ne.none;wasRecentlyTrackpad=!1;moveThreshold;longPressDuration;authorizeEventScaling;scaleEventPosition;activePointers=new Set;origins=new Ue;previousPositions=new Ue;positions;lastTargetOrigin;timerMap=new Ue;tools=new Map;mappedKeysToTool=new Map;currentTools=new Map;set inputDevice(e){this.onInputDeviceChange.fire(e)}}})();var Ge;!function(e){e.target="target",e.position="position"}(Ge||(Ge={}));let qe=(()=>{let s,i,n=Event,a=[];return class extends n{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;s=[Ft()],i=[Ft()],e(this,null,s,{kind:"method",name:"closest",static:!1,private:!1,access:{has:e=>"closest"in e,get:e=>e.closest},metadata:t},null,a),e(this,null,i,{kind:"getter",name:"scaledPosition",static:!1,private:!1,access:{has:e=>"scaledPosition"in e,get:e=>e.scaledPosition},metadata:t},null,a),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}eventManager=t(this,a);toolName;eventName;clickMode;keys;position;authorizeScaling;scalePosition;constructor(e){super(e.eventName,{bubbles:!0,cancelable:!0,...e.eventInitDict}),this.eventManager=e.eventManager??ct.instance,this.authorizeScaling=e.authorizeScaling??!0,this.scalePosition=e.scalePosition??(e=>e),this.clickMode=e.clickMode??ct.instance.currentClick,this.keys=e.keys??ct.instance.currentKeys,this.eventName=e.eventName,this.position=e.position,this.toolName=e.toolName}get tool(){return this.toolName&&this.eventManager instanceof ct?this.eventManager.getToolByName(this.toolName):null}closest(e,t=!0,s=Ge.target){const i=s==Ge.target?[this.target]:document.elementsFromPoint(this.position.x,this.position.y),n=t instanceof Element?t:null,a=!0===t||null!==n;for(let t of i){for(;t&&(!(t instanceof e)||a&&!this.isPositionInsideElement(this.position,n??t));)t=t.parentElement;if(t)return t}return null}isPositionInsideElement(e,t){const s=t.getBoundingClientRect();return e.x>=s.left&&e.x<=s.right&&e.y>=s.top&&e.y<=s.bottom}get target(){return super.target||document}get scaledPosition(){return this.scalingAuthorized?this.scalePosition(this.position):this.position}get scalingAuthorized(){return"function"==typeof this.authorizeScaling?this.authorizeScaling():this.authorizeScaling}scalePositionsMap(e){return e.mapValues((e,t)=>this.scalePosition(t))}}})();class Ye extends qe{keyPressed;keyReleased;constructor(e){super({...e,position:null}),this.keyPressed=e.keyPressed,this.keyReleased=e.keyReleased}}class Je{keyName;element;view;model;emitter;constructor(e){this.element=e.element,e.model&&(this.model=e.model),e.emitter&&(this.emitter=e.emitter),e.view&&(this.view=e.view),this.setup()}setup(){}initialize(){this.setupChangedCallbacks()}setupChangedCallbacks(){oe(this)}}class Xe extends Je{keyName="key";keyDown=e=>this.keyDownFn(e);keyDownFn(e){this.element.enabled&&(this.model.currentKeys.includes(e.key)||(this.model.currentKeys.push(e.key),this.emitter.fire("dispatchEvent",document,Ye,{eventName:ye.keyPressed,keyPressed:e.key})))}keyUp=e=>this.keyUpFn(e);keyUpFn(e){this.element.enabled&&this.model.currentKeys.includes(e.key)&&(this.model.currentKeys.splice(this.model.currentKeys.indexOf(e.key),1),this.emitter.fire("dispatchEvent",document,Ye,{eventName:ye.keyReleased,keyReleased:e.key}))}}class Qe extends qe{delta;constructor(e){super({...e,position:null}),this.delta=e.delta}}class Ze{x;y;constructor(e=0,t=("number"==typeof e?e:0)){"number"==typeof e?(this.x=e,this.y=t):"clientX"in e?(this.x=e.clientX,this.y=e.clientY):"x"in e?(this.x=e.x,this.y=e.y):(this.x=e[0],this.y=e[1])}static dist(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static midPoint(...e){if(0==e.length)return null;const t=e.reduce((e,t)=>e+t.x,0)/e.length,s=e.reduce((e,t)=>e+t.y,0)/e.length;return new Ze(t,s)}static max(...e){if(0==e.length)return null;const t=e.reduce((e,t)=>Math.max(e,t.x),-1/0),s=e.reduce((e,t)=>Math.max(e,t.y),-1/0);return new Ze(t,s)}static min(...e){if(0==e.length)return null;const t=e.reduce((e,t)=>Math.min(e,t.x),1/0),s=e.reduce((e,t)=>Math.min(e,t.y),1/0);return new Ze(t,s)}get object(){return{x:this.x,y:this.y}}equals(e,t=0){return"number"==typeof e?this.x==e&&this.y==t:this.x==e.x&&this.y==e.y}boundX(e,t){return this.x<e?e:this.x>t?t:this.x}boundY(e,t){return this.y<e?e:this.y>t?t:this.y}bound(e,t,s=e,i=t){return new Ze(this.boundX(e,t),this.boundY(s,i))}add(e,t){return"number"==typeof e?new Ze(this.x+e,this.y+(t||0==t?t:e)):new Ze(this.x+e.x,this.y+e.y)}sub(e,t){return"number"==typeof e?new Ze(this.x-e,this.y-(t||0==t?t:e)):new Ze(this.x-e.x,this.y-e.y)}mul(e,t){return"number"==typeof e?new Ze(this.x*e,this.y*(t||0==t?t:e)):new Ze(this.x*e.x,this.y*e.y)}div(e,t){return"number"==typeof e?new Ze(this.x/e,this.y/(t||0==t?t:e)):new Ze(this.x/e.x,this.y/e.y)}mod(e,t){const s="number"==typeof e?{x:e,y:t||0==t?t:e}:{x:e.x,y:e.y},i=this.object;for(;i.x<0;)i.x+=s.x;for(;i.x>=s.x;)i.x-=s.x;for(;i.y<0;)i.y+=s.y;for(;i.y>=s.y;)i.y-=s.y;return new Ze(i)}get abs(){return new Ze(Math.abs(this.x),Math.abs(this.y))}get max(){return Math.max(this.x,this.y)}get min(){return Math.min(this.x,this.y)}get length2(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length2)}dot(e){return this.x*e.x+this.y*e.y}copy(){return new Ze(this.x,this.y)}arr(){return[this.x,this.y]}}class et extends Je{keyName="wheel";wheel=e=>{if(!this.element.enabled)return;let t;this.element.preventDefaultWheel&&e.preventDefault(),(Math.abs(e.deltaY)<=40||0!=e.deltaX)&&(this.model.inputDevice=ze.trackpad),this.model.wasRecentlyTrackpad||(this.model.inputDevice=ze.mouse),this.model.utils.clearTimer("recentlyTrackpadTimer"),this.model.utils.setTimer("recentlyTrackpadTimer",()=>{this.model.inputDevice==ze.trackpad&&(this.model.wasRecentlyTrackpad=!1)},800),t=this.model.inputDevice==ze.trackpad&&e.ctrlKey?Pe.trackpadPinch:this.model.inputDevice==ze.trackpad?Pe.trackpadScroll:Pe.mouseWheel,this.emitter.fire("dispatchEvent",document,Qe,{delta:new Ze(e.deltaX,e.deltaY),eventName:t})}}let tt=(()=>{let s,i,n,a,r,o,l,c=qe,h=[];return class extends c{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;s=[Ft()],i=[Ft()],n=[Ft()],a=[Ft()],r=[Ft()],o=[Ft()],l=[Ft()],e(this,null,s,{kind:"getter",name:"scaledOrigins",static:!1,private:!1,access:{has:e=>"scaledOrigins"in e,get:e=>e.scaledOrigins},metadata:t},null,h),e(this,null,i,{kind:"getter",name:"scaledPreviousPositions",static:!1,private:!1,access:{has:e=>"scaledPreviousPositions"in e,get:e=>e.scaledPreviousPositions},metadata:t},null,h),e(this,null,n,{kind:"getter",name:"scaledPositions",static:!1,private:!1,access:{has:e=>"scaledPositions"in e,get:e=>e.scaledPositions},metadata:t},null,h),e(this,null,a,{kind:"getter",name:"deltaPositions",static:!1,private:!1,access:{has:e=>"deltaPositions"in e,get:e=>e.deltaPositions},metadata:t},null,h),e(this,null,r,{kind:"getter",name:"deltaPosition",static:!1,private:!1,access:{has:e=>"deltaPosition"in e,get:e=>e.deltaPosition},metadata:t},null,h),e(this,null,o,{kind:"getter",name:"scaledDeltaPositions",static:!1,private:!1,access:{has:e=>"scaledDeltaPositions"in e,get:e=>e.scaledDeltaPositions},metadata:t},null,h),e(this,null,l,{kind:"getter",name:"scaledDeltaPosition",static:!1,private:!1,access:{has:e=>"scaledDeltaPosition"in e,get:e=>e.scaledDeltaPosition},metadata:t},null,h),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}origins=t(this,h);previousPositions;positions;constructor(e){super({...e,position:e.positions.first}),this.origins=e.origins,this.previousPositions=e.previousPositions,this.positions=e.positions}get scaledOrigins(){return this.scalingAuthorized?this.scalePositionsMap(this.origins):this.origins}get scaledPreviousPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.previousPositions):this.previousPositions}get scaledPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.positions):this.positions}get deltaPositions(){return this.positions.mapValues((e,t)=>{const s=this.previousPositions.get(e);if(s)return t.sub(s)})}get deltaPosition(){return Ze.midPoint(...this.deltaPositions.valuesArray())}get scaledDeltaPositions(){return this.scaledPositions.mapValues((e,t)=>{const s=this.scaledPreviousPositions.get(e);if(s)return t.sub(s)})}get scaledDeltaPosition(){return Ze.midPoint(...this.scaledDeltaPositions.valuesArray())}}})();class st extends Je{keyName="pointer";pointerDown=e=>this.pointerDownFn(e);pointerMove=e=>this.pointerMoveFn(e);pointerUp=e=>this.pointerUpFn(e);pointerCancel=e=>this.pointerCancelFn(e);lostPointerCapture=e=>this.lostPointerCaptureFn(e);pointerDownFn(e){if(e.composedPath().includes(this.model.lockState.lockOrigin)||(document.activeElement?.blur?.(),this.element.unlock()),!this.element.enabled)return;const t="touch"===e.pointerType;this.element.preventDefaultMouse&&!t&&e.preventDefault(),this.element.preventDefaultTouch&&t&&e.preventDefault(),t?this.model.inputDevice=ze.touch:this.model.inputDevice!==ze.unknown&&this.model.inputDevice!==ze.touch||(this.model.inputDevice=ze.mouse);const s=e.pointerId,i=new Ze(e.clientX,e.clientY);this.model.origins.set(s,i),this.model.previousPositions.set(s,i);const n=document.elementFromPoint(i.x,i.y);n&&n.setPointerCapture?.(e.pointerId),this.model.activePointers.add(s),this.model.utils.setClickMode(t?this.model.activePointers.size:e.button,t),this.element.clickEventEnabled&&(this.fireClick(this.model.origins.first,Pe.clickStart),this.model.currentAction=_e.click,this.model.utils.setTimer(Pe.longPress,()=>{this.model.currentAction===_e.click&&(this.model.currentAction=_e.longPress,this.fireClick(this.model.origins.first,Pe.longPress))},this.model.longPressDuration))}pointerMoveFn(e){if(!this.element.enabled)return;if(!this.element.moveEventsEnabled&&!this.element.dragEventEnabled)return;const t="touch"===e.pointerType;if(this.element.preventDefaultMouse&&!t&&e.preventDefault(),this.element.preventDefaultTouch&&t&&e.preventDefault(),this.model.positions=new Ue,this.model.positions.set(e.pointerId,new Ze(e.clientX,e.clientY)),this.model.currentAction!==_e.drag&&(this.model.lastTargetOrigin=null),this.element.moveEventsEnabled&&this.fireDrag(this.model.positions,Pe.move),this.model.currentAction!==_e.none&&this.element.dragEventEnabled){if(this.model.currentAction!==_e.drag){if(!Array.from(this.model.origins.entries()).some(([t,s])=>{const i=t===e.pointerId?this.model.positions.get(t):this.model.previousPositions.get(t);return i&&Ze.dist(i,s)>this.model.moveThreshold}))return;Rt(this),this.fireDrag(this.model.origins,Pe.dragStart),this.model.currentAction=_e.drag}this.fireDrag(this.model.positions)}this.model.previousPositions.set(e.pointerId,this.model.positions.get(e.pointerId))}pointerUpFn(e){if(!this.element.enabled)return;const t="touch"===e.pointerType;this.element.preventDefaultMouse&&!t&&e.preventDefault(),this.element.preventDefaultTouch&&t&&e.preventDefault(),this.model.utils.clearTimer(Pe.longPress),this.model.positions=new Ue,this.model.positions.set(e.pointerId,new Ze(e.clientX,e.clientY)),this.model.currentAction===_e.drag&&this.element.dragEventEnabled&&this.fireDrag(this.model.positions,Pe.dragEnd),this.element.clickEventEnabled&&(this.model.currentAction===_e.click&&this.fireClick(this.model.positions.first,Pe.click),this.fireClick(this.model.origins.first,Pe.clickEnd)),this.model.origins.delete(e.pointerId),this.model.previousPositions.delete(e.pointerId),this.model.activePointers.delete(e.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=_e.none,this.model.currentClick=Ne.none)}pointerCancelFn(e){this.model.utils.clearTimer(Pe.longPress),this.model.origins.delete(e.pointerId),this.model.previousPositions.delete(e.pointerId),this.model.activePointers.delete(e.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=_e.none,this.model.currentClick=Ne.none)}lostPointerCaptureFn(e){}fireClick(e,t=Pe.click){if(!e)return;const s=document.elementFromPoint(e.x,e.y)||document;this.emitter.fire("dispatchEvent",s,qe,{position:e,eventName:t})}fireDrag(e,t=Pe.drag){e&&this.emitter.fire("dispatchEvent",this.getFireOrigin(e),tt,{positions:e,previousPositions:this.model.previousPositions,origins:this.model.origins,eventName:t})}getFireOrigin(e,t=!1){if(!this.model.lastTargetOrigin||t){const t=this.model.origins.first?this.model.origins.first:e.first;this.model.lastTargetOrigin=document.elementFromPoint(t.x,t.y)}return this.model.lastTargetOrigin}}class it extends Je{keyName="dispatch";boundHooks=new Map;setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("dispatchEvent",this.dispatchEvent)}dispatchEvent=(e,t,s)=>{e&&(s.keys=this.model.currentKeys,s.toolName=this.element.getCurrentToolName(this.model.currentClick),s.clickMode=this.model.currentClick,s.eventManager=this.element,s.eventInitDict={bubbles:!0,cancelable:!0,composed:!0},s.authorizeScaling=this.element.authorizeEventScaling,s.scalePosition=this.element.scaleEventPosition,s.eventName===ye.keyPressed?this.element.setToolByKey(s.keyPressed):s.eventName===ye.keyReleased&&this.element.setTool(void 0,Ne.key,{select:!1}),e.dispatchEvent(new t(s)))};getToolHandlingCallback(e,t){const s=this.element.getCurrentToolName(this.model.currentClick),i=t.composedPath?.()||[];for(let n=i.length-1;n>=0;n--)if(i[n]instanceof Node&&Kt(i[n]).executeAction(e,s,t,{capture:!0},this.element)){t.stopPropagation();break}for(let n=0;n<i.length;n++)if(i[n]instanceof Node&&Kt(i[n]).executeAction(e,s,t,void 0,this.element)){t.stopPropagation();break}}setupCustomDispatcher(e){if(this.boundHooks.has(e))return;const t=t=>this.getToolHandlingCallback(e,t);this.boundHooks.set(e,t),document.addEventListener(e,t,{capture:!0})}removeCustomDispatcher(e){const t=this.boundHooks.get(e);t&&(document.removeEventListener(e,t,{capture:!0}),this.boundHooks.delete(e))}}class nt{keyName;model;constructor(e){this.model&&(this.model=e),this.setup()}setup(){}}class at extends nt{keyName="utils";setClickMode(e,t=!1){switch(t&&e--,e){case-1:return void(this.model.currentClick=Ne.none);case 0:return void(this.model.currentClick=Ne.left);case 1:return void(this.model.currentClick=Ne.middle);case 2:return void(this.model.currentClick=Ne.right);default:return void(this.model.currentClick=Ne.other)}}applyEventNames(e){for(const t in e)xe[t]=e[t]}setTimer(e,t,s){this.clearTimer(e),this.model.timerMap.set(e,setTimeout(()=>{t(),this.clearTimer(e)},s))}clearTimer(e){const t=this.model.timerMap.get(e);t&&(clearTimeout(t),this.model.timerMap.delete(e))}selectTool(e,t){"selected"in e&&"boolean"==typeof e.selected&&(e.selected=t)}activateTool(e,t,s){s?Kt(e).onToolActivate(t).fire():Kt(e).onToolDeactivate(t).fire()}}function rt(e){const t=e.prototype;Object.defineProperty(t,"view",{get(){return this.mvc?.view},set(e){if(!this.mvc)throw new Error("view: missing this.mvc");this.mvc.view=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"model",{get(){return this.mvc?.model},set(e){if(!this.mvc)throw new Error("model: missing this.mvc");this.mvc.model=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"data",{get(){return this.mvc?.data},set(e){if(!this.mvc)throw new Error("data: missing this.mvc");this.mvc.data=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"dataId",{get(){return this.mvc?.dataId},set(e){if(!this.mvc)throw new Error("dataId: missing this.mvc");this.mvc.dataId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"dataIndex",{get(){return this.mvc?.dataIndex},set(e){if(!this.mvc)throw new Error("dataIndex: missing this.mvc");this.mvc.dataIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"dataSize",{get(){return this.mvc?.dataSize},enumerable:!0,configurable:!0})}function ot(e){const t=e.prototype,s=Symbol("__selected__"),i=Symbol("__selectedClass__"),n=Symbol("__initialized__");Object.defineProperty(t,"selected",{get(){return!!this[s]},set(e){const t=this instanceof Element?this:this.element instanceof Element?this.element:void 0;if(!t)return void(this[s]=e);const n=this[i],a=this.getPropertiesValue?.(null,"defaultSelectedClass","selected")??"selected";this[s]=e,this[i]=a,n&&n!==a&&Kt(t).toggleClass(n,!1),Kt(t).toggleClass(a,!!e)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"getPropertiesValue",{value:function(e,t,s){if(null!=e)return e;let i=this.constructor;for(;i;){const e=i.config?.[t];if(null!=e)return e;i=Object.getPrototypeOf(i)}return s},configurable:!0,enumerable:!1}),Object.defineProperty(t,"destroy",{value:function(){},configurable:!0,enumerable:!1}),Object.defineProperty(t,"initialized",{get:function(){return this[n]??!1},configurable:!0,enumerable:!1}),Object.defineProperty(t,"initialize",{value:function(){this[n]||(this.setupUIElements?.(),this.setupUILayout?.(),this.setupUIListeners?.(),this.setupChangedCallbacks?.(),this.mvc&&this.mvc instanceof q&&this.mvc.initialize(),oe(this),this[n]=!0)},configurable:!0,enumerable:!1})}class lt{static config={};static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}mvc;constructor(e={}){this.mvc=new q({...e,element:this})}}ot(lt),rt(lt);let ct=(()=>{let s,i,n,a,r,o,c,h,u,d,f,p=lt,m=[],y=[],b=[],v=[],k=[],S=[],E=[],w=[],C=[];return class O extends p{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;s=[Le()],i=[Le()],n=[Le()],a=[Le()],r=[g()],o=[g()],c=[g()],h=[g()],u=[g()],d=[g()],f=[g()],e(this,null,r,{kind:"setter",name:"keyEventsEnabled",static:!1,private:!1,access:{has:e=>"keyEventsEnabled"in e,set:(e,t)=>{e.keyEventsEnabled=t}},metadata:t},null,m),e(this,null,o,{kind:"setter",name:"wheelEventsEnabled",static:!1,private:!1,access:{has:e=>"wheelEventsEnabled"in e,set:(e,t)=>{e.wheelEventsEnabled=t}},metadata:t},null,m),e(this,null,c,{kind:"setter",name:"moveEventsEnabled",static:!1,private:!1,access:{has:e=>"moveEventsEnabled"in e,set:(e,t)=>{e.moveEventsEnabled=t}},metadata:t},null,m),e(this,null,h,{kind:"setter",name:"mouseEventsEnabled",static:!1,private:!1,access:{has:e=>"mouseEventsEnabled"in e,set:(e,t)=>{e.mouseEventsEnabled=t}},metadata:t},null,m),e(this,null,u,{kind:"setter",name:"touchEventsEnabled",static:!1,private:!1,access:{has:e=>"touchEventsEnabled"in e,set:(e,t)=>{e.touchEventsEnabled=t}},metadata:t},null,m),e(this,null,d,{kind:"setter",name:"clickEventEnabled",static:!1,private:!1,access:{has:e=>"clickEventEnabled"in e,set:(e,t)=>{e.clickEventEnabled=t}},metadata:t},null,m),e(this,null,f,{kind:"setter",name:"dragEventEnabled",static:!1,private:!1,access:{has:e=>"dragEventEnabled"in e,set:(e,t)=>{e.dragEventEnabled=t}},metadata:t},null,m),e(null,null,s,{kind:"field",name:"keyController",static:!1,private:!1,access:{has:e=>"keyController"in e,get:e=>e.keyController,set:(e,t)=>{e.keyController=t}},metadata:t},y,b),e(null,null,i,{kind:"field",name:"wheelController",static:!1,private:!1,access:{has:e=>"wheelController"in e,get:e=>e.wheelController,set:(e,t)=>{e.wheelController=t}},metadata:t},v,k),e(null,null,n,{kind:"field",name:"pointerController",static:!1,private:!1,access:{has:e=>"pointerController"in e,get:e=>e.pointerController,set:(e,t)=>{e.pointerController=t}},metadata:t},S,E),e(null,null,a,{kind:"field",name:"dispatchController",static:!1,private:!1,access:{has:e=>"dispatchController"in e,get:e=>e.dispatchController,set:(e,t)=>{e.dispatchController=t}},metadata:t},w,C),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static managers=[];static get instance(){return O.managers.length>0?O.managers[0]:new O}static get allManagers(){return[...this.managers]}static set allManagers(e){this.managers=e}keyController=(t(this,m),t(this,y,void 0));wheelController=(t(this,b),t(this,v,void 0));pointerController=(t(this,k),t(this,S,void 0));dispatchController=(t(this,E),t(this,w,void 0));constructor(e={}){super(),t(this,C),this.mvc.generate({model:$e,controllers:[Xe,et,st,it],handlers:[at]}),O.managers.push(this),this.model.authorizeEventScaling=e.authorizeEventScaling,this.model.scaleEventPosition=e.scaleEventPosition,this.model.state.enabled=e.enabled??!0,this.model.state.preventDefaultMouse=e.preventDefaultMouse??!0,this.model.state.preventDefaultTouch=e.preventDefaultTouch??!0,this.model.state.preventDefaultWheel=e.preventDefaultWheel??!0,this.unlock(),this.model.moveThreshold=e.moveThreshold||10,this.model.longPressDuration=e.longPressDuration||500,e.disableKeyEvents||(this.keyEventsEnabled=!0),e.disableWheelEvents||(this.wheelEventsEnabled=!0),e.disableMouseEvents||(this.mouseEventsEnabled=!0),e.disableTouchEvents||(this.touchEventsEnabled=!0),e.disableDragEvents||(this.dragEventEnabled=!0),e.disableClickEvents||(this.clickEventEnabled=!0),e.disableMoveEvent||(this.moveEventsEnabled=!0),document.addEventListener("pointerdown",this.pointerController.pointerDown,{passive:!1}),document.addEventListener("pointermove",this.pointerController.pointerMove,{passive:!1}),document.addEventListener("pointerup",this.pointerController.pointerUp,{passive:!1}),document.addEventListener("pointercancel",this.pointerController.pointerCancel,{passive:!1}),this.dispatchController.setupCustomDispatcher("pointerdown")}get inputDevice(){return this.model.inputDevice}get onInputDeviceChange(){return this.model.onInputDeviceChange}get currentClick(){return this.model.currentClick}get currentKeys(){return this.model.currentKeys}get onToolChange(){return this.model.onToolChange}get authorizeEventScaling(){return this.model.authorizeEventScaling}set authorizeEventScaling(e){this.model.authorizeEventScaling=e}get scaleEventPosition(){return this.model.scaleEventPosition}set scaleEventPosition(e){this.model.scaleEventPosition=e}get moveThreshold(){return this.model.moveThreshold}set moveThreshold(e){this.model.moveThreshold=e}get longPressDuration(){return this.model.longPressDuration}set longPressDuration(e){this.model.longPressDuration=e}set keyEventsEnabled(e){e?(document.addEventListener("keydown",this.keyController.keyDown),document.addEventListener("keyup",this.keyController.keyUp)):(document.removeEventListener("keydown",this.keyController.keyDown),document.removeEventListener("keyup",this.keyController.keyUp)),this.applyAndHookEvents(ye,be,e)}set wheelEventsEnabled(e){e?document.body.addEventListener("wheel",this.wheelController.wheel,{passive:!1}):document.body.removeEventListener("wheel",this.wheelController.wheel),this.applyAndHookEvents(Oe,Te,e)}set moveEventsEnabled(e){this.applyAndHookEvents(Se,Ee,e)}set mouseEventsEnabled(e){}set touchEventsEnabled(e){}set clickEventEnabled(e){this.applyAndHookEvents(ve,ke,e)}set dragEventEnabled(e){this.applyAndHookEvents(we,Ce,e)}lock(e,t){this.unlock(),this.model.lockState.lockOrigin=e;for(const e in t)this.model.lockState[e]=t[e]}unlock(){const e=this.model.state,t=this.model.lockState;t.enabled=e.enabled,t.preventDefaultMouse=e.preventDefaultMouse,t.preventDefaultTouch=e.preventDefaultTouch,t.preventDefaultWheel=e.preventDefaultWheel,t.lockOrigin=document.body}get enabled(){return this.model.state.enabled&&this.model.lockState.enabled}set enabled(e){this.model.state.enabled=e}get preventDefaultWheel(){return this.model.state.preventDefaultWheel&&this.model.lockState.preventDefaultWheel}set preventDefaultWheel(e){this.model.state.preventDefaultWheel=e}get preventDefaultMouse(){return this.model.state.preventDefaultMouse&&this.model.lockState.preventDefaultMouse}set preventDefaultMouse(e){this.model.state.preventDefaultMouse=e}get preventDefaultTouch(){return this.model.state.preventDefaultTouch&&this.model.lockState.preventDefaultTouch}set preventDefaultTouch(e){this.model.state.preventDefaultTouch=e}get toolsArray(){const e=[];for(const t of this.model.tools.values())e.push(...t.toArray());return e}getCurrentTool(e=this.model.currentClick){return this.model.currentTools.get(e)}getCurrentTools(e=this.model.currentClick){return this.getToolsByName(this.getCurrentToolName(e))}getCurrentToolName(e=this.model.currentClick){return this.getToolName(this.getCurrentTool(e))}getToolName(e){for(const[t,s]of this.model.tools.entries())if(s.has(e))return t}getSimilarTools(e){for(const[t,s]of this.model.tools.entries())if(s.has(e))return s.toArray();return[]}getToolsByName(e){return this.model.tools.get(e)?.toArray()||[]}getToolByName(e,t){const s=this.getToolsByName(e);return t?s?.find(t):s?.[0]}getToolsByKey(e){const t=this.model.mappedKeysToTool.get(e);return t?this.getToolsByName(t):[]}getToolByKey(e,t){const s=this.getToolsByKey(e);return t?s?.find(t):s?.[0]}addTool(e,t,s){this.model.tools.has(e)||this.model.tools.set(e,new he);const i=this.model.tools.get(e);i.has(t)||i.add(t),s&&this.model.mappedKeysToTool.set(s,e)}setTool(e,t,s={}){if(!l(e)&&!Kt(e).isTool(this))return;null==s.select&&(s.select=!0),null==s.activate&&(s.activate=!0),null==s.setAsNoAction&&(s.setAsNoAction=t==Ne.left);const i=this.model.currentTools.get(t);if(i){if(i===e)return;this.getSimilarTools(i).forEach(e=>{s.select&&this.model.utils.selectTool(e,!1),s.activate&&this.model.utils.activateTool(e,this.getToolName(i),!1)})}this.model.currentTools.set(t,e),s.setAsNoAction&&this.model.currentTools.set(Ne.none,e),this.getSimilarTools(e).forEach(t=>{s.activate&&this.model.utils.activateTool(t,this.getToolName(e),!0),s.select&&this.model.utils.selectTool(t,!0)}),this.onToolChange.fire(i,e,t)}setToolByKey(e){const t=this.model.mappedKeysToTool.get(e);return!!t&&(this.setTool(this.getToolByName(t),Ne.key,{select:!1}),!0)}setupCustomDispatcher(e){return this.dispatchController.setupCustomDispatcher(e)}applyAndHookEvents(e,t,s){this.model.utils.applyEventNames(s?e:t);for(const t in e)s?this.dispatchController.setupCustomDispatcher(t):this.dispatchController.removeCustomDispatcher(t)}destroy(){return this.keyEventsEnabled=!1,this.wheelEventsEnabled=!1,this.mouseEventsEnabled=!1,this.touchEventsEnabled=!1,this.dragEventEnabled=!1,this.clickEventEnabled=!1,this.onToolChange.clear(),this}}})();const ht=new class{dataMap=new WeakMap;data(e){return e instanceof y&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}getBoundListenersSet(e){let t=this.data(e).boundListeners;return t||(t=new Set,this.data(e).boundListeners=t),t}getPreventDefaultListeners(e){let t=this.data(e).preventDefaultListeners;return t||(t={},this.data(e).preventDefaultListeners=t),t}bypassManager(e,t,s){e instanceof y&&(e=e.element),e&&("boolean"==typeof s?t.lock(e,{enabled:s,preventDefaultWheel:s,preventDefaultMouse:s,preventDefaultTouch:s}):t.lock(e,{enabled:s.enabled??!1,preventDefaultWheel:s.preventDefaultWheel??!1,preventDefaultMouse:s.preventDefaultMouse??!1,preventDefaultTouch:s.preventDefaultTouch??!1}))}getBoundListeners(e,t,s,i,n=ct.instance){return e instanceof y&&(e=e.element),e?(i||(i={}),[...this.getBoundListenersSet(e)].filter(e=>e.type===t&&e.manager===n&&e.toolName===s).filter(e=>{if(!i)return!0;for(const[t,s]of Object.entries(i))if(e.options?.[t]!==s)return!1;return!0})):[]}};const ut=new class{dataMap=new WeakMap;data(e){return e instanceof y&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}setStyle(e,t,s,i=!1,n=!0){if(i)return void(e.element.style[t]=s.toString());let a=this.data(e.element).pendingStyles;a&&"object"==typeof a||(a={},this.data(e.element).pendingStyles=a),a[t]=s,n&&this.applyStyles(e)}applyStyles(e){const t=this.data(e.element).pendingStyles;t&&"object"==typeof t&&requestAnimationFrame(()=>{for(const s in t)"cssText"==s?e.element.style.cssText+=";"+t.cssText:e.element.style[s]=t[s];this.data(e.element).pendingStyles={}})}};const dt=new class{elements=new WeakMap;tools=new WeakMap;getOrCreate(e,t,s){let i=e.get(t);return i||(i=s(),e.set(t,i)),i}getElementData(e,t){e instanceof y&&(e=e.element);const s=this.getOrCreate(this.elements,e,()=>new WeakMap);return this.getOrCreate(s,t,()=>({tools:new Set,ignoreAllTools:!1,ignoredTools:new Map,activationDelegates:new Map,deactivationDelegates:new Map}))}getToolsData(e,t){const s=this.getOrCreate(this.tools,e,()=>new Map);return this.getOrCreate(s,t,()=>({behaviors:new Map}))}getActivationDelegate(e,t,s){const i=this.getElementData(e,s).activationDelegates;return i.get(t)||i.set(t,new de),i.get(t)}getDeactivationDelegate(e,t,s){const i=this.getElementData(e,s).deactivationDelegates;return i.get(t)||i.set(t,new de),i.get(t)}saveTool(e,t,s){e instanceof y&&(e=e.element),e&&this.getElementData(e,s).tools.add(t)}getToolNames(e,t){return e instanceof y&&(e=e.element),e?[...this.getElementData(e,t).tools]:[]}setEmbeddedToolTarget(e,t,s){t instanceof y&&(t=t.element),t&&(e instanceof y&&(e=e.element),e&&(this.getElementData(e,s).embeddedTarget=t))}getEmbeddedToolTarget(e,t){if(e instanceof y&&(e=e.element),e)return this.getElementData(e,t).embeddedTarget}addToolBehavior(e,t,s,i){const n=this.getToolsData(i,e).behaviors;this.getOrCreate(n,t,()=>new Set).add(s)}getToolBehaviors(e,t,s){const i=this.getToolsData(s,e).behaviors;return[...this.getOrCreate(i,t,()=>new Set)]}removeToolBehaviors(e,t,s){const i=this.getToolsData(s,e).behaviors;this.getOrCreate(i,t,()=>new Set).clear()}clearToolBehaviors(e){this.getOrCreate(this.tools,e,()=>new Map).clear()}ignoreTool(e,t,s,i,n){const a=this.getElementData(e,n).ignoredTools;if(s){const e=a.get(t);if(!i)return void(e instanceof Set&&e.delete(s));e instanceof Set||a.set(t,new Set),a.get(t).add(s)}else i?a.set(t,"all"):a.delete(t)}isToolIgnored(e,t,s,i){const n=this.getElementData(e,i).ignoredTools?.get(t);return!!n&&("all"===n||!s||n.has(s))}};const ft=new class{dataMap=new WeakMap;data(e){return e instanceof y&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{substrates:new Map,onChange:new de}),this.dataMap.get(e)):{}}createSubstrate(e,t){const s={objects:e instanceof Element?e.children:e.childNodes,temporaryMetadata:new WeakMap,persistentMetadata:new WeakMap,onActivate:new de,onDeactivate:new de,solvers:new Set};return this.data(e).substrates.set(t,s),s}setCurrent(e,t){return!!this.getSubstrates(e).includes(t)&&(this.data(e).current=t,!0)}getSubstrateData(e,t){return this.data(e).substrates.get(t)}getSubstrates(e){return[...this.data(e).substrates.keys()]}getPersistentMetadata(e,t,s){const i=this.getSubstrateData(e,t);if(!i||!i.persistentMetadata)return{};let n=i.persistentMetadata.get(s);return n||(n={},i.persistentMetadata.set(s,n)),n}setPersistentMetadata(e,t,s,i){const n=this.getSubstrateData(e,t);n&&n.persistentMetadata&&n.persistentMetadata.set(s,i)}getTemporaryMetadata(e,t,s){const i=this.getSubstrateData(e,t);if(!i||!i.temporaryMetadata)return;let n=i.temporaryMetadata.get(s);return n||(n={},i.temporaryMetadata.set(s,n)),n}setTemporaryMetadata(e,t,s,i){const n=this.getSubstrateData(e,t);n&&n.temporaryMetadata&&n.temporaryMetadata.set(s,i)}};const pt=new WeakMap;function mt(e){if(pt.has(e))return pt.get(e);let t,s,i=!1;const n=function(...n){if(i)return t;if(s)return s;try{const a=e.apply(this,n);return a instanceof Promise?(s=a.then(e=>(t=e,i=!0,s=null,e)).catch(e=>{throw s=null,e}),s):(t=a,i=!0,a)}catch(e){throw e}};return pt.set(e,n),n}function gt(e,t){if("method"!==t.kind)throw new Error(`@callOnce can only be used on methods (got: ${t.kind}).`);const s=String(t.name),i=Symbol(`__callOnce__${s}`);return function(...t){if(!this[i])return this[i]=!0,e.apply(this,t);console.warn(`Function ${s} has already been called once on this instance and will not be called again.`)}}function yt(e,t,s=0){return e<s&&(e=s),e>t&&(e=t),e}function bt(e,t=0){for(;e<0;)e+=t;for(;e>=t;)e-=t;return e}let vt=(()=>{let s,i,n,a,r,c,h,u,d,f,p=[],m=[],y=[];return class b{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[g({defaultValueCallback:function(){return this.getAllStates()}})],i=[g({defaultValueCallback:()=>({global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0}),preprocessValue:function(e){return"boolean"==typeof e?{...this.enabled,global:e}:e}})],n=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.properties,e)}})],a=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.styles,e)}})],r=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.classes,e)}})],c=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.replaceWith,e)}})],h=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.transitionProperties,e)}})],u=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.transitionDuration,e)}})],d=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.transitionTimingFunction,e)}})],f=[g({setIfUndefined:!0,preprocessValue:function(e){return this.normalizePropertyConfig(this.transitionDelay,e)}})],e(this,null,i,{kind:"getter",name:"enabled",static:!1,private:!1,access:{has:e=>"enabled"in e,get:e=>e.enabled},metadata:t},null,p),e(this,null,n,{kind:"setter",name:"properties",static:!1,private:!1,access:{has:e=>"properties"in e,set:(e,t)=>{e.properties=t}},metadata:t},null,p),e(this,null,a,{kind:"setter",name:"styles",static:!1,private:!1,access:{has:e=>"styles"in e,set:(e,t)=>{e.styles=t}},metadata:t},null,p),e(this,null,r,{kind:"setter",name:"classes",static:!1,private:!1,access:{has:e=>"classes"in e,set:(e,t)=>{e.classes=t}},metadata:t},null,p),e(this,null,c,{kind:"setter",name:"replaceWith",static:!1,private:!1,access:{has:e=>"replaceWith"in e,set:(e,t)=>{e.replaceWith=t}},metadata:t},null,p),e(this,null,h,{kind:"setter",name:"transitionProperties",static:!1,private:!1,access:{has:e=>"transitionProperties"in e,set:(e,t)=>{e.transitionProperties=t}},metadata:t},null,p),e(this,null,u,{kind:"setter",name:"transitionDuration",static:!1,private:!1,access:{has:e=>"transitionDuration"in e,set:(e,t)=>{e.transitionDuration=t}},metadata:t},null,p),e(this,null,d,{kind:"setter",name:"transitionTimingFunction",static:!1,private:!1,access:{has:e=>"transitionTimingFunction"in e,set:(e,t)=>{e.transitionTimingFunction=t}},metadata:t},null,p),e(this,null,f,{kind:"setter",name:"transitionDelay",static:!1,private:!1,access:{has:e=>"transitionDelay"in e,set:(e,t)=>{e.transitionDelay=t}},metadata:t},null,p),e(null,null,s,{kind:"field",name:"states",static:!1,private:!1,access:{has:e=>"states"in e,get:e=>e.states,set:(e,t)=>{e.states=t}},metadata:t},m,y),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static fields=["properties","classes","styles","replaceWith","transitionProperties","transitionDuration","transitionTimingFunction","transitionDelay"];timeRegex=(t(this,p),/^(\d+(?:\.\d+)?)(ms|s)?$/i);attachedObjects=[];states=t(this,m,void 0);get enabled(){}set enabled(e){const t=e;l(t.global)?(l(t.properties)||this.refreshProperties(),l(t.styles)||this.refreshStyles(),l(t.classes)||this.refreshClasses(),l(t.replaceWith)||this.refreshReplaceWith(),l(t.transition)||this.refreshTransition()):this.refreshResolvedValues()}set properties(e){}get properties(){}set styles(e){}get styles(){}set classes(e){}get classes(){}set replaceWith(e){}get replaceWith(){}set transitionProperties(e){}get transitionProperties(){}set transitionDuration(e){}get transitionDuration(){}set transitionTimingFunction(e){}get transitionTimingFunction(){}set transitionDelay(e){}get transitionDelay(){}constructor(e){t(this,y),e.states&&(this.states=e.states),Object.entries(e).forEach(([e,t])=>{"attachedObjects"!==e&&"states"!==e&&(this[e]=t)}),e.transition||e.transitionProperties||e.transitionDuration||e.transitionTimingFunction||e.transitionDelay||(this.enabled.transition=!1),e.attachedObjects&&this.attachAll(...e.attachedObjects)}attach(e,t,s){const i=this.getData(e);return i&&t&&(i.onSwitch=t),i||this.attachObject(e,s,t),this}attachAll(...e){return e.forEach(e=>{this.getData(e)||this.attachObject(e)}),this}attachAllAt(e,...t){return t.forEach((t,s)=>{this.getData(t)||this.attachObject(t,e+s)}),this}detach(...e){return e.forEach(e=>{const t=this.getData(e);t&&this.detachObject(t)}),this}attachObject(e,t,s){(null==t||isNaN(t))&&(t=this.attachedObjects.length),t<0&&(t=0);const i=this.generateNewData(e,s);return this.attachedObjects.splice(t,0,i),_t(e).attachReifect(this),i.lastState=this.stateOf(e),this.applyResolvedValues(i,!1,!0),i}detachObject(e){if(!this.attachedObjects.includes(e))return;const t=e.object.deref();this.attachedObjects.splice(this.attachedObjects.indexOf(e),1),t&&_t(t).detachReifect(this)}getData(e){if(e)for(const t of this.attachedObjects){const s=this.getObject(t);if(s&&s==e)return t}}getObject(e){if(e)return e.object.deref()}stateOf(e){if(!e)return;const t=this.getData(e);if(t){if(t.lastState)return t.lastState;if(!(e instanceof HTMLElement))return this.states[0];t.resolvedValues||this.processRawProperties(t);for(const s of this.states){if(!t.resolvedValues?.styles?.[s])continue;let i=!0;for(const[n,a]of Object.entries(t.resolvedValues.styles[s]))if(e.style[n]!=a){i=!1;break}if(i)return t.lastState=s,s}return this.states[0]}}getAllStates(){const e=new Set;for(const t of b.fields){const s=this[t];if(s&&"object"==typeof s)for(const t of Object.keys(s))e.add(t)}return Array.from(e)}parseState(e){if("boolean"!=typeof e)return this.states.includes(e)?e:this.states[0];for(const t of e?["true","on","in","enabled","shown"]:["false","off","out","disabled","hidden"])if(this.states.includes(t))return t;return this.states[0]}enable(e,t){const s=this.getData(t);if(!s)return this.enabled=e;"boolean"==typeof e?s.enabled.global=e:"object"==typeof e&&Object.entries(e).forEach(([e,t])=>s.enabled[e]=t)}getObjectEnabledState(e){return this.getData(e)?.enabled}set transition(e){if(!e)return;const t="string"==typeof e?this.processTransitionString(e):this.processTransitionObject(e);Object.entries(t).forEach(([e,t])=>this[e]=t)}processTransitionObject(e){const t={};for(const[s,i]of Object.entries(e))this.states.includes(s)&&"string"==typeof i&&Object.entries(this.processTransitionString(i)).forEach(([e,i])=>{t[e]||(t[e]={}),t[e][s]=i});return t}processTransitionString(e){const t=e.trim().replace(/,/g," ").split(/\s+/).filter(e=>e.length>0),s={transitionProperties:[]};let i=0;for(;i<t.length&&!this.timeRegex.test(t[i]);)s.transitionProperties.push(t[i]),i++;if(i<t.length){const e=this.parseTime(t[i]);isNaN(e)||(s.transitionDuration=e),i++}if(i<t.length&&(s.transitionTimingFunction=t[i],i++),i<t.length){const e=this.parseTime(t[i]);isNaN(e)||(s.transitionDelay=e),i++}return s}getTransitionString(e,t=e.lastState){if(!e.resolvedValues)return"";const s=this.cleanTransitionProperties(e.resolvedValues.transitionProperties[t]),i=e.resolvedValues.transitionDuration[t]??0,n=e.resolvedValues.transitionTimingFunction[t]??"linear",a=e.resolvedValues.transitionDelay[t]??0;return s.map(e=>`${e} ${i}s ${n} ${a}s`).join(", ")}initialize(e,t,s){this.enabled&&(e=this.parseState(e),s=this.initializeOptions(s,t),this.getEnabledObjectsData(t,s).forEach(t=>{!s.recomputeProperties&&t.resolvedValues||this.processRawProperties(t,s.propertiesOverride),t.lastState=e,this.applyResolvedValues(t,!0,s?.applyStylesInstantly),t.onSwitch&&t.onSwitch(e,t.objectIndex,t.totalObjectCount,this.getObject(t))}))}apply(e,t,s){this.enabled&&(e=this.parseState(e),s=this.initializeOptions(s,t),this.getEnabledObjectsData(t,s).forEach(t=>{!s.recomputeProperties&&t.resolvedValues||this.processRawProperties(t,s.propertiesOverride),t.lastState=e,this.applyResolvedValues(t,!1,s?.applyStylesInstantly),t.onSwitch&&t.onSwitch(e,t.objectIndex,t.totalObjectCount,this.getObject(t))}))}toggle(e,t){if(!this.enabled)return;e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[];const s=this.getData(e[0])?.lastState,i=bt(s?this.states.indexOf(s)+1:0,this.states.length);this.apply(this.states[i],e,t)}reloadFor(e){if(!this.enabled.global)return this;const t=this.getData(e);return t&&t.enabled&&t.enabled.global?(this.applyResolvedValues(t),this):this}reloadTransitionFor(e){if(!this.enabled.global||!this.enabled.transition)return this;const t=this.getData(e);return t&&t.enabled&&t.enabled.global&&t.enabled.transition?(this.applyTransition(t,t.lastState),this):this}getEnabledObjectsData(e,t){if(!this.enabled)return console.warn("The reifier object you are trying to access is disabled."),[];e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[],(t=this.initializeOptions(t,e)).attachObjects&&e.forEach(e=>this.attach(e)),t.executeForAll&&(e=[],this.attachedObjects.forEach(t=>{const s=t.object.deref();s&&e.push(s)}));const s=[];return e.forEach(e=>{const i=this.getData(e)||this.generateNewData(e);this.filterEnabledObjects(i)&&((t.recomputeIndices||null==i.objectIndex)&&(i.objectIndex=s.length),s.push(i))}),s.forEach(e=>{(t.recomputeIndices||null==e.totalObjectCount)&&(e.totalObjectCount=s.length)}),s}applyResolvedValues(e,t=!1,s=!1){this.applyStyles(e,e.lastState,s),t||(this.attachedObjects.includes(e)?_t(e.object.deref()).reloadTransitions():this.applyTransition(e,e.lastState)),this.applyReplaceWith(e,e.lastState),this.applyProperties(e,e.lastState),this.applyClasses(e,e.lastState)}refreshResolvedValues(){this.refreshProperties(),this.refreshStyles(),this.refreshClasses(),this.refreshReplaceWith(),this.refreshTransition()}applyProperties(e,t=e.lastState){if(!this.enabled||!this.enabled.properties)return;if(!e.enabled.global||!e.enabled.properties)return;const s=e.resolvedValues?.properties?.[t];if(!s)return;const i=e.object.deref();if(i)for(const[e,t]of Object.entries(s))if(e&&null!=t)try{i[e]=t}catch(s){console.error(`Unable to set property ${e} to ${t}: ${s.message}`)}}refreshProperties(){this.enabled&&this.enabled.properties&&this.attachedObjects.forEach(e=>this.applyProperties(e))}applyReplaceWith(e,t=e.lastState){if(!this.enabled||!this.enabled.replaceWith)return;if(!e.enabled.global||!e.enabled.replaceWith)return;const s=e.resolvedValues?.replaceWith?.[t];if(s)try{const t=e.object.deref();t&&t instanceof Node&&s instanceof Node&&t.parentNode?.replaceChild(s,t),e.object=new WeakRef(s)}catch(e){console.error(`Unable to replace object: ${e.message}`)}}refreshReplaceWith(){this.enabled&&this.enabled.replaceWith&&this.attachedObjects.forEach(e=>this.applyReplaceWith(e))}applyClasses(e,t=e.lastState){if(!this.enabled||!this.enabled.classes)return;if(!e.enabled.global||!e.enabled.classes)return;const s=e.resolvedValues?.classes;if(!s)return;const i=e.object.deref();if(i&&i instanceof Element)for(const[e,n]of Object.entries(s))_t(i).toggleClass(n,t==e)}refreshClasses(){this.enabled&&this.enabled.classes&&this.attachedObjects.forEach(e=>this.applyClasses(e))}applyStyles(e,t=e.lastState,s=!1){if(!this.enabled||!this.enabled.styles)return;if(!e.enabled.global||!e.enabled.styles)return;if(!e.resolvedValues?.styles)return;const i=e.object.deref();i&&i instanceof Element&&_t(i).setStyles(e.resolvedValues.styles[t],s)}refreshStyles(){this.enabled&&this.enabled.styles&&this.attachedObjects.forEach(e=>this.applyStyles(e))}applyTransition(e,t=e.lastState){if(!this.enabled||!this.enabled.transition)return;if(!e.enabled.global||!e.enabled.transition)return;const s=e.object.deref();s&&s instanceof Element&&e.resolvedValues&&_t(s).appendStyle("transition",this.getTransitionString(e,t),", ",!0)}refreshTransition(){for(const e of this.attachedObjects)_t(e.object?.deref()).reloadTransitions()}filterEnabledObjects(e){return!(!e.enabled||!e.enabled.global)||(console.warn("The reified properties instance you are trying to set on an object is disabled for this particular object."),!1)}processRawProperties(e,t){if(e.resolvedValues||(e.resolvedValues={}),o(t))return;const s=e.object.deref();if(!s)return;const i=e.objectIndex??0,n=e.totalObjectCount??1;for(const a of b.fields){const r=this.normalizePropertyConfig(this[a],t?.[a]);e.resolvedValues[a]||(e.resolvedValues[a]={});for(const t of this.states)e.resolvedValues[a][t]=r[t]?.(i,n,s)}}generateNewData(e,t){return{object:new WeakRef(e),enabled:{global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0},lastState:this.stateOf(e),onSwitch:t}}initializeOptions(e,t){return t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[],(e=e||{}).attachObjects=e.attachObjects??!0,e.executeForAll=e.executeForAll??0===t.length,e.recomputeIndices=e.recomputeIndices??0!==t.length,e.recomputeProperties=e.recomputeProperties??0!==t.length,e}clone(){return new b({states:this.states,properties:this.properties,classes:this.classes,styles:this.styles,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay})}normalizePropertyConfig(e,t){const s=e?{...e}:{};if(l(t))return s;const i="object"==typeof t&&null!==t&&!Array.isArray(t),n=i?Reflect.ownKeys(t):[],a=i&&n.length>0&&n.every(e=>this.states.includes(e));if(i&&0===n.length)return s;if("function"==typeof t)this.states.forEach(e=>{s[e]=(s,i,n)=>t(e,s,i,n)});else if(a)this.states.forEach(e=>{const i=t[e];l(i)||(s[e]="function"==typeof i?i:()=>i)});else{const e=()=>t;this.states.forEach(t=>s[t]=e)}return s}cleanTransitionProperties(e){if(!e)return["all"];if(Array.isArray(e))return e.length?e:["all"];const t=e.split(/\s+/).map(e=>e.trim()).filter(Boolean);return t.length?t:["all"]}parseTime(e){const t=e.match(this.timeRegex);if(!t)return NaN;const s=parseFloat(t[1]);return"ms"===(t[2]?.toLowerCase()??"s")?s/1e3:s}}})();function kt(e){return new vt(e)}class St extends vt{constructor(e){e.states=["default"],super(e)}get properties(){return super.properties?.default}set properties(e){super.properties=e}get styles(){return super.styles?.default}set styles(e){super.styles=e}get classes(){return super.classes?.default}set classes(e){super.classes=e}get replaceWith(){return super.replaceWith?.default}set replaceWith(e){super.replaceWith=e}get transitionProperties(){return super.transitionProperties?.default}set transitionProperties(e){super.transitionProperties=e}get transitionDuration(){return super.transitionDuration?.default}set transitionDuration(e){super.transitionDuration=e}get transitionTimingFunction(){return super.transitionTimingFunction?.default}set transitionTimingFunction(e){super.transitionTimingFunction=e}get transitionDelay(){return super.transitionDelay?.default}set transitionDelay(e){super.transitionDelay=e}initialize(e,t){super.initialize("default",e,t)}apply(e,t){super.apply("default",e,t)}}function Et(e){return new St(e)}var wt,Ct,Ot,Tt,Pt,xt,Dt,At,Mt,It;!function(e){e.vertical="vertical",e.horizontal="horizontal"}(wt||(wt={})),function(e){e.left="left",e.right="right"}(Ct||(Ct={})),function(e){e.top="top",e.bottom="bottom"}(Ot||(Ot={})),function(e){e.top="top",e.bottom="bottom",e.left="left",e.right="right"}(Tt||(Tt={})),function(e){e.in="in",e.out="out"}(Pt||(Pt={})),function(e){e.on="on",e.off="off"}(xt||(xt={})),function(e){e.open="open",e.closed="closed"}(Dt||(Dt={})),function(e){e.visible="visible",e.hidden="hidden"}(At||(At={})),function(e){e.public="public",e.protected="protected",e.private="private"}(Mt||(Mt={})),function(e){e.min="min",e.max="max"}(It||(It={}));const jt=new class{dataMap=new WeakMap;data(e){if(e instanceof y&&(e=e.element),this.dataMap.has(e))return this.dataMap.get(e);const t={reifects:new he,enabled:{},onTransitionStart:new de,onTransitionEnd:new de};return e&&this.dataMap.set(e,t),t}attachReifect(e,t){const s=this.data(e).reifects;s.has(t)||s.add(t)}detachReifect(e,t){const s=this.data(e).reifects;s.has(t)&&s.delete(t)}},Bt=new vt({states:[At.visible,At.hidden],styles:e=>`visibility: ${e}`});const Vt=new WeakMap;function _t(e){let t;if(Lt(),e||(e="div"),"string"==typeof e)t=T({tag:e});else if("object"==typeof e){if(e instanceof y)return e;t=e instanceof Node?e:e.element&&"object"==typeof e.element?e.element:e}const s=Vt.get(t);if(s)return s;const i=new y;return i.element=t,Vt.set(t,i),i}function Nt(e){return _t(e)}function zt(e){return _t(e)}function Kt(e){return _t(e)}const Lt=mt(function(e={}){e.excludeHierarchyFunctions||(Object.defineProperty(y.prototype,"childHandler",{set:function(e){e instanceof y&&(e=e.element),b.data(this).childHandler=e},get:function(){return b.data(this).childHandler||(this.element instanceof Element&&this.element.shadowRoot?this.element.shadowRoot:this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"childNodesArray",{get:function(){return this.element&&Array.from(this.childHandler?.childNodes)||[]},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"childrenArray",{get:function(){return this.childNodesArray.filter(e=>1===e.nodeType)},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"siblingNodes",{get:function(){const e=this.element?.parentNode;return e&&Kt(e).childNodesArray||[]},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"siblings",{get:function(){const e=this.element?.parentElement;return e&&Kt(e).childrenArray||[]},configurable:!1,enumerable:!0}),y.prototype.bringToFront=function(){const e=this.element?.parentNode;return e?(Kt(e).addChild(this.element),this):this},y.prototype.sendToBack=function(){const e=this.element?.parentNode;return e?(Kt(e).addChild(this.element,0),this):this},y.prototype.remove=function(){return this.element?.parentNode?.removeChild(this.element),this},y.prototype.addChild=function(e,t,s=this.childrenArray){if(!this.element||!e)return this;if(void 0!==t&&(t<0||t>s.length)&&(t=void 0),null!=t)this.addChildBefore(e,s[t]);else try{Array.isArray(e)||(e=[e]),e.forEach(e=>{e&&(e instanceof y&&(e=e.element),this.childHandler.appendChild(e))})}catch(e){console.error(e)}return this},y.prototype.remChild=function(e){if(!this.element||!e)return this;try{Array.isArray(e)||(e=[e]),e.forEach(e=>{e&&(e instanceof y&&(e=e.element),this.childHandler.removeChild(e))})}catch(e){console.error(e)}return this},y.prototype.addChildBefore=function(e,t){if(!this.element||!e)return this;if(!t)return this.addChild(e);try{Array.isArray(e)||(e=[e]),e.forEach(e=>{e&&(e instanceof y&&(e=e.element),this.childHandler.insertBefore(e,t))})}catch(e){console.error(e)}return this},y.prototype.removeChildAt=function(e,t=1,s=this.childrenArray){if(!this.element||void 0===e||e<0)return this;if(e>=s.length)return this;try{for(let i=e+t-1;i>=e;i--)i>=s.length||this.removeChild(s[i])}catch(e){console.error(e)}return this},y.prototype.removeAllChildren=function(e=this.childrenArray){if(!this.element)return this;try{for(let t=0;t<e.length;t++)this.removeChild(e[t])}catch(e){console.error(e)}return this},y.prototype.childAt=function(e,t=this.childrenArray){if(!this.element||void 0===e)return null;for(e>=t.length&&(e=t.length-1);e<0;)e+=t.length;return t[e]},y.prototype.indexOfChild=function(e,t=this.childrenArray){return this.element&&e?(t instanceof Array||(t=Array.from(t)),t.indexOf(e)):-1},y.prototype.hasChild=function(e){if(!this.element||!e)return!1;const t=Array.from(this.element?.childNodes);if(e instanceof Node)return t.includes(e);for(const s of e)if(!t.includes(s))return!1;return!0},y.prototype.closest=function(e){if(!(this.element&&e&&this.element instanceof Element))return null;if("string"==typeof e)return this.element.closest(e);if("function"==typeof e){let t=this.element;for(;t&&!(t instanceof e);)t=t.parentElement;return t||null}return null},y.prototype.findInParents=function(e){if(!e||!this.element)return!1;e instanceof Node&&(e=[e]);let t=this.element,s=0;for(;t&&s<e.length;)e.includes(t)&&s++,t=t.parentNode;return s===e.length},y.prototype.findInSubTree=function(e){if(!e||!this.element)return!1;e instanceof Node&&(e=[e]);let t=0;const s=i=>{e.includes(i)&&t++,t>=e.length||i.childNodes.forEach(e=>s(e))};return s(this.element),t>=e.length},y.prototype.indexInParent=function(e=this.siblings){return e&&this.element?e.indexOf(this.element):-1},y.prototype.addToParent=function(e,t,s){return this.element&&e?(Kt(e).addChild(this.element,t,s),this):this}),e.excludeMiscFunctions||(y.prototype.execute=function(e){return e(this),this},y.prototype.applyDefaults=function(e,t={}){if(!this.element||"object"!=typeof this.element)return this;const{mergeProperties:s=v,removeDuplicates:i=!0}=t;for(const[t,n]of Object.entries(e)){const e=s?.includes(t);if(e){const e=Array.isArray(n)?n:[n];let s=(l(this.element[t])?[]:Array.isArray(this.element[t])?this.element[t].slice():[this.element[t]]).concat(e);i&&(s=Array.from(new Set(s))),this.element[t]=s}else l(this.element[t])&&(this.element[t]=n)}return this}),e.excludeClassFunctions||(y.prototype.addClass=function(e){return this.element instanceof Element?k.operateOnClasses(this,e,e=>this.element.classList.add(e)):this},y.prototype.removeClass=function(e){return this.element instanceof Element?k.operateOnClasses(this,e,e=>this.element.classList.remove(e)):this},y.prototype.toggleClass=function(e,t){return this.element instanceof Element?k.operateOnClasses(this,e,e=>this.element.classList.toggle(e,t)):this},y.prototype.hasClass=function(e){if(!(e&&this.element instanceof Element))return!1;if("string"==typeof e)return this.element.classList.contains(e);for(let t of e)if(!this.element.classList.contains(t))return!1;return!0}),e.excludeElementFunctions||(y.prototype.setProperties=function(e={},t=!1){if(!this)return this;if(e.out&&("string"==typeof e.out?this.__outName=e.out:Object.assign(e.out,this)),!this.element.shadowRoot){let t=!!e.shadowDOM;if("getPropertiesValue"in this.element&&"function"==typeof this.element.getPropertiesValue&&(t=this.element.getPropertiesValue(e.shadowDOM,"shadowDOM")),t)try{this.element.attachShadow({mode:"open"})}catch{}}const s=this.element?.mvc instanceof q?this.element.mvc:"model"in this.element&&"view"in this.element?this.element:void 0;for(const i of Object.keys(e)){const n=e[i];if(void 0!==n)switch(i){case"tag":case"namespace":case"shadowDOM":break;case"text":this.element instanceof HTMLElement&&(this.element.innerText=n);break;case"style":if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))break;this.setStyles(n,!0);break;case"stylesheet":$(n,this.closestRoot);break;case"id":this.element.id=n;break;case"classes":this.addClass(n);break;case"listeners":Object.entries(n).forEach(([e,t])=>this.on(e,t));break;case"onClick":this.on(xe.click,n);break;case"onDrag":this.on(xe.drag,n);break;case"children":this.addChild(n);break;case"parent":Kt(n).addChild(this.element);break;case"data":case"dataId":case"initialize":if(s)break;case"model":case"view":case"emitter":case"controllers":case"handlers":case"interactors":case"tools":case"substrates":if(t)break;if(s){try{s[i]=n,"model"===i&&e.data&&s.model instanceof ge&&s.model.setBlock(e.data,e.dataId,void 0,!1)}catch{}break}default:if(t)break;try{this.element[i]=n}catch(e){try{this.setAttribute(i,De(n))}catch(e){console.error(e)}}}}return(void 0===e.initialize||e.initialize)&&(this.element&&"initialize"in this.element&&"function"==typeof this.element.initialize?this.element.initialize():s&&"initialize"in s&&"function"==typeof s.initialize&&s.initialize()),this},y.prototype.setMvc=function(e){if(this.element)return"mvc"in this.element&&this.element.mvc instanceof q?(this.element.mvc.generate(e),this.element.mvc):new q({...e,element:this.element})},y.prototype.destroy=function(){return this.removeAllListeners(),this.remove(),this.element&&"destroy"in this.element&&"function"==typeof this.element.destroy&&this.element.destroy(),this},y.prototype.setAttribute=function(e,t){return this.element instanceof Element&&this.element.setAttribute(e,t?.toString()||"true"),this},y.prototype.removeAttribute=function(e){return this.element instanceof Element&&this.element.removeAttribute(e),this},y.prototype.blur=function(){return this.element instanceof HTMLElement&&this.element.blur(),this},y.prototype.focus=function(){return this.element instanceof HTMLElement&&this.element.focus(),this}),e.excludeEventFunctions||(Object.defineProperty(y.prototype,"boundListeners",{get:function(){return ht.getBoundListenersSet(this)},configurable:!0,enumerable:!0}),Object.defineProperty(y.prototype,"bypassManagerOn",{get:function(){return ht.data(this).bypassCallback},set:function(e){ht.data(this).bypassCallback=e},configurable:!0,enumerable:!0}),y.prototype.onTool=function(e,t,s,i,n=ct.instance){return this.hasToolListener(e,t,s,n)||(n.setupCustomDispatcher?.(e),ht.getBoundListenersSet(this).add({target:this,type:e,toolName:t,listener:s,bundledListener:e=>s(e,this),options:i,manager:n})),this},y.prototype.on=function(e,t,s,i=ct.instance){return this.onTool(e,void 0,t,s,i)},y.prototype.executeAction=function(e,t,s,i,n=ct.instance){if(!e)return!1;i||(i={});const a=t??n.getCurrentToolName();this.bypassManagerOn&&ht.bypassManager(this,n,this.bypassManagerOn(s));const r=new Set,o=(t,a)=>{const o=t instanceof y?t:Kt(t),l=ht.getBoundListenersSet(t),c=[...ht.getBoundListeners(t,e,a,i,n)];if(0===c.length)return!1;let h=!1;for(const e of c)if(!r.has(e))try{e.listener(s,o)&&(h=!0)}finally{r.add(e),e.options?.once&&l.delete(e)}return h};if(a&&o(this,a))return!0;if(!i.capture&&a&&!this.isToolIgnored(a,e,n)&&this.applyTool(a,e,s,n))return!0;const l=this.getEmbeddedToolTarget(n),c=this.getToolNames(n);if(l&&c.length>0){let t=!1;for(const e of c)o(l,e)&&(t=!0);if(t)return!0;const a=Kt(l);if(!i.capture)for(const i of c)!a.isToolIgnored(i,e,n)&&Kt(l).applyTool(i,e,s,n)&&(t=!0);if(t)return!0}return o(this,void 0)},y.prototype.hasListener=function(e,t,s=ct.instance){return this.hasToolListener(e,void 0,t,s)},y.prototype.hasToolListener=function(e,t,s,i=ct.instance){return ht.getBoundListeners(this,e,t,void 0,i).filter(e=>e.listener===s).length>0},y.prototype.hasListenersByType=function(e,t,s=ct.instance){return ht.getBoundListeners(this,e,t,void 0,s).length>0},y.prototype.removeListener=function(e,t,s=ct.instance){return this.removeToolListener(e,void 0,t,s)},y.prototype.removeToolListener=function(e,t,s,i=ct.instance){const n=ht.getBoundListenersSet(this);return ht.getBoundListeners(this,e,t,void 0,i).filter(e=>e.listener===s).forEach(e=>{e.target.removeEventListener(e.type,e.bundledListener,e.options),n.delete(e)}),this},y.prototype.removeListenersByType=function(e,t,s=ct.instance){const i=ht.getBoundListenersSet(this);return ht.getBoundListeners(this,e,t,void 0,s).forEach(e=>{e.target.removeEventListener(e.type,e.bundledListener,e.options),i.delete(e)}),this},y.prototype.removeAllListeners=function(e=ct.instance){const t=this.boundListeners;return[...t].filter(t=>t.manager===e).forEach(e=>{e.target.removeEventListener(e.type,e.bundledListener,e.options),t.delete(e)}),this},y.prototype.preventDefault=function(e){e||(e={});const t=e.manager??ct.instance,s=e.types??Be,i=e.phase??"capture",n=e.stop??!1;ht.data(this.element).preventDefaultOn=e.preventDefaultOn??ht.data(this.element).preventDefaultOn??(()=>!0);const a=ht.getPreventDefaultListeners(this);if(e.clearPreviousListeners)for(const[e,t]of Object.entries(a))this.removeListener(e,t),delete a[e];const r=new Set(Ve);for(const e of new Set(s)){const s=t=>!!ht.data(this.element).preventDefaultOn(e,t)&&(t.preventDefault?.(),"immediate"===n?t.stopImmediatePropagation?.():"stop"===n&&t.stopPropagation?.(),!0);a[e]=s;const o={};"capture"===i&&(o.capture=!0),r.has(e)&&(o.passive=!1),this.on(e,s,o,t)}return this}),e.excludeStyleFunctions||(Object.defineProperty(y.prototype,"closestRoot",{get:function(){let e=this.element;for(;e;){if(e instanceof Element&&e.shadowRoot)return e.shadowRoot;e=e.parentElement}return document.head},configurable:!1,enumerable:!0}),y.prototype.setStyle=function(e,t,s=!1){return e&&null!=t&&(this.element instanceof HTMLElement||this.element instanceof SVGElement)?(ut.setStyle(this,e,t,s),this):this},y.prototype.appendStyle=function(e,t,s=", ",i=!1){if(!e||null==t)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;const n=this.element.style[e]||"";return s=n.length>0?s:"",ut.setStyle(this,e,n+s+t,i),this},y.prototype.setStyles=function(e,t=!1){if(!e||"number"==typeof e)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;let s={};return"object"==typeof e?s=e:"string"==typeof e&&e.split(";").forEach(e=>{const[t,i]=e.split(":").map(e=>e.trim());t&&i&&(s[t]=i)}),Object.entries(s).forEach(([e,s])=>ut.setStyle(this,e,s,t,!1)),t||ut.applyStyles(this),this}),e.excludeToolFunctions||(y.prototype.makeTool=function(e,t){return e?(t||(t={}),t.manager||(t.manager=ct.instance),t.manager.addTool(e,this.element,t.key),t.customActivation&&"function"==typeof t.customActivation?t.customActivation(this,t.manager):(t.activationEvent??=xe.click,t.clickMode??=Ne.left,this.on(t.activationEvent,()=>(t.manager.setTool(this.element,t.clickMode),!0),void 0,t.manager)),dt.saveTool(this,e,t.manager),t.onActivate&&dt.getActivationDelegate(this,e,t.manager).add(t.onActivate),t.onDeactivate&&dt.getDeactivationDelegate(this,e,t.manager).add(t.onDeactivate),this):this},y.prototype.isTool=function(e=ct.instance){return dt.getToolNames(this.element,e).length>0},y.prototype.getToolNames=function(e=ct.instance){return dt.getToolNames(this.element,e)},y.prototype.getToolName=function(e=ct.instance){const t=dt.getToolNames(this.element,e);if(t.length>0)return t[0]},y.prototype.onToolActivate=function(e,t=ct.instance){return e||(e=this.getToolName(t)),dt.getActivationDelegate(this,e,t)},y.prototype.onToolDeactivate=function(e,t=ct.instance){return e||(e=this.getToolName(t)),dt.getDeactivationDelegate(this,e,t)},y.prototype.addToolBehavior=function(e,t,s=this.getToolName(),i=ct.instance){return e&&s&&(i.setupCustomDispatcher?.(e),dt.addToolBehavior(s,e,t,i)),this},y.prototype.hasToolBehavior=function(e,t=this.getToolName(),s=ct.instance){return!(!e||!t)&&dt.getToolBehaviors(t,e,s).length>0},y.prototype.removeToolBehaviors=function(e,t=this.getToolName(),s=ct.instance){return e&&t&&dt.removeToolBehaviors(t,e,s),this},y.prototype.clearToolBehaviors=function(e=ct.instance){return dt.clearToolBehaviors(e),this},y.prototype.embedTool=function(e,t=ct.instance){return this.isTool(t)&&dt.setEmbeddedToolTarget(this.element,e,t),this},y.prototype.isEmbeddedTool=function(e=ct.instance){return!!dt.getEmbeddedToolTarget(this.element,e)},y.prototype.getEmbeddedToolTarget=function(e=ct.instance){return dt.getEmbeddedToolTarget(this.element,e)},y.prototype.applyTool=function(e,t,s,i=ct.instance){let n=!1;const a=dt.getToolBehaviors(e,t,i),r={};return r.embeddedTarget=dt.getEmbeddedToolTarget(this.element,i),r.isEmbedded=!!r.embeddedTarget,a.forEach(e=>{e(s,this.element,r)&&(n=!0)}),n},y.prototype.ignoreTool=function(e,t,s=!0,i=ct.instance){return dt.ignoreTool(this.element,e,t,s,i),this},y.prototype.ignoreAllTools=function(e=!0,t=ct.instance){return dt.getElementData(this.element,t).ignoreAllTools=e,this},y.prototype.isToolIgnored=function(e,t,s=ct.instance){return!!dt.getElementData(this.element,s).ignoreAllTools||dt.isToolIgnored(this.element,e,t,s)}),e.excludeSubstrateFunctions||(y.prototype.makeSubstrate=function(e,t){return ft.createSubstrate(this,e),t?.onActivate&&this.onSubstrateActivate(e).add(t.onActivate),t?.onDeactivate&&this.onSubstrateDeactivate(e).add(t.onDeactivate),this.currentSubstrate||(this.currentSubstrate=e),this},Object.defineProperty(y.prototype,"substrates",{get:function(){return ft.getSubstrates(this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"currentSubstrate",{get:function(){return ft.data(this).current},set:function(e){if(!e)return;const t=this.currentSubstrate;ft.setCurrent(this,e)&&this.onSubstrateChange.fire(t,e)},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"onSubstrateChange",{get:function(){return ft.data(this).onChange},configurable:!1,enumerable:!0}),y.prototype.onSubstrateActivate=function(e=this.currentSubstrate){return ft.getSubstrateData(this,e)?.onActivate??new de},y.prototype.onSubstrateDeactivate=function(e=this.currentSubstrate){return ft.getSubstrateData(this,e)?.onDeactivate??new de},y.prototype.getSubstrateObjectList=function(e=this.currentSubstrate){const t=new Set;return e?(Array.from(ft.getSubstrateData(this,e).objects).forEach(s=>{ft.getPersistentMetadata(this,e,s).ignored||t.add(s)}),t):t},y.prototype.setSubstrateObjectList=function(e,t=this.currentSubstrate){return e&&t?(ft.getSubstrateData(this,t).objects=e,this):this},y.prototype.addObjectToSubstrate=function(e,t=this.currentSubstrate){if(!e||!t)return this;ft.getPersistentMetadata(this,t,e).ignored=!1;const s=ft.getSubstrateData(this,t).objects;if(s instanceof HTMLCollection||s instanceof NodeList)return this;try{s.has(e)||s.add(e)}catch{}return this},y.prototype.removeObjectFromSubstrate=function(e,t=this.currentSubstrate){if(!e||!t)return this;ft.getPersistentMetadata(this,t,e).ignored=!0;const s=ft.getSubstrateData(this,t).objects;return s instanceof Set&&s.delete(e),this},y.prototype.hasObjectInSubstrate=function(e,t=this.currentSubstrate){if(!e||!t)return!1;const s=this.getSubstrateObjectList(t);for(const t of s)if(t===e)return!0;return!1},y.prototype.wasObjectProcessedBySubstrate=function(e,t=this.currentSubstrate){return!(!e||!t||!ft.getTemporaryMetadata(this,t,e)?.processed)},y.prototype.addSolver=function(e,t=this.currentSubstrate){return ft.getSubstrateData(this,t).solvers?.add(e),this},y.prototype.removeSolver=function(e,t=this.currentSubstrate){return ft.getSubstrateData(this,t).solvers?.delete(e),this},y.prototype.clearSolvers=function(e=this.currentSubstrate){return ft.getSubstrateData(this,e).solvers?.clear(),this},y.prototype.resolveSubstrate=function(e={},t=this.currentSubstrate){if(e||(e={}),e.substrate=e.substrate??t,!e.substrate)return this;e.manager||(e.manager=ct.instance),e.eventOptions||(e.eventOptions={});const s=ft.getSubstrateData(this,e.substrate);return s?(s.solvers?.forEach(t=>{let i;s.temporaryMetadata=new WeakMap,e.eventTarget&&(s.temporaryMetadata.set(e.eventTarget,{processed:!0,isMainTarget:!0}),t({...e,target:e.eventTarget}));do{i=Array.from(this.getSubstrateObjectList(e.substrate)).find(e=>!s.temporaryMetadata.get(e)?.processed),i&&(s.temporaryMetadata.set(i,{processed:!0}),t({...e,target:i}))}while(i)}),this):this}),e.excludeReifectFunctions||(Object.defineProperty(y.prototype,"reifects",{get:function(){return this.element?new Set(jt.data(this.element).reifects?.toArray()):new Set},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"onTransitionStart",{get:function(){return jt.data(this.element).onTransitionStart},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"onTransitionEnd",{get:function(){return jt.data(this.element).onTransitionEnd},configurable:!1,enumerable:!0}),Object.defineProperty(y.prototype,"showTransition",{get:function(){if(!this.element)return;const e=jt.data(this.element);return e.showTransition||(e.showTransition=Bt),e.showTransition},set:function(e){this.element&&(jt.data(this.element).showTransition=e)},configurable:!0,enumerable:!0}),Object.defineProperty(y.prototype,"isShown",{get:function(){if(!this.element)return;const e=this.showTransition.stateOf(this.element);return e==At.visible||e!=At.hidden&&"none"!=this.element.style.display&&"hidden"!=this.element.style.visibility&&"0"!=this.element.style.opacity},configurable:!1,enumerable:!0}),y.prototype.show=function(e,t={}){return this.element?(t.executeForAll||(t.executeForAll=!1),this.showTransition.apply(e?At.visible:At.hidden,this.element,t),this):this},y.prototype.attachReifect=function(...e){return this.element&&"object"==typeof this.element?(e.forEach(e=>{this.reifects.has(e)||(jt.attachReifect(this.element,e),e.attach(this.element))}),this):this},y.prototype.detachReifect=function(...e){return this.element&&"object"==typeof this.element?(e.forEach(e=>{this.reifects.has(e)&&(jt.detachReifect(this.element,e),e.detach(this.element))}),this):this},y.prototype.initializeReifect=function(e,t,s){return this.element?(e instanceof St?e.initialize(this.element,s):e.initialize(this.element,t,s),this):this},y.prototype.applyReifect=function(e,t,s){return this.element?(e instanceof St?e.apply(this.element,s):e.apply(this.element,t,s),this):this},y.prototype.toggleReifect=function(e,t){return this.element?(e instanceof St||e.toggle(this.element,t),this):this},y.prototype.reloadReifects=function(){return this.element?(this.setStyle("transition","",!0),this.reifects.forEach(e=>e.reloadFor(this.element)),this):this},y.prototype.reloadTransitions=function(){return this.element?(this.setStyle("transition","",!0),this.reifects.forEach(e=>e.reloadTransitionFor(this.element)),this):this},y.prototype.reifectEnabledState=function(e){return this.element?e?e.getObjectEnabledState(this.element):jt.data(this.element).enabled:{}},y.prototype.enableReifect=function(e,t){if(!this.element)return this;if(t)return t.enable(e,this.element),this;const s=jt.data(this.element).enabled;return"boolean"==typeof e?s.global=e:"object"==typeof e&&Object.entries(e).forEach(([e,t])=>s[e]=t),this})});function Ft(e={}){return function(t,s){const{kind:i,name:n,static:a}=s,r=n,o=function(e){return Symbol(`__cache__${e}`)}(r),l=Symbol(`__cache__setup__${r}`),c=[],u=function(e=!0){if(!e)return;const t=this[o];if(t){t instanceof Map?t.clear():delete this[o];for(const e of c)clearTimeout(e);c.length=0}},d=function(){this[l]||(this[l]=!0,function(e,t,s,i,n,a,r){if(a.onEvent){const t="function"==typeof e?.addEventListener?e:document,s=Array.isArray(a.onEvent)?a.onEvent:String(a.onEvent).split(/\s+/).filter(Boolean);for(const e of s)Kt(t).on(e,()=>r())}if(a.onFieldChange){const t=Array.isArray(a.onFieldChange)?a.onFieldChange:[a.onFieldChange];for(const s of t){const t="string"==typeof s?s:s.name;if(!t)continue;const i=h(e,t),n=e[t];if("function"==typeof n){const s=n;Object.defineProperty(e,t,{configurable:!0,enumerable:i?.enumerable??!0,writable:!0,value:function(...e){return r(),s.apply(this,e)}})}else{const s=()=>i?.get?i.get.call(e):n,a=s=>{i?.set?i.set.call(e,s):Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:s})};Object.defineProperty(e,t,{configurable:!0,enumerable:i?.enumerable??!0,get:()=>s(),set(e){r(),a(e)}})}}}if(a.onCallback){const t=setInterval(()=>{const t=a.onCallback.call(e);t instanceof Promise?t.then(e=>r(Boolean(e))):r(Boolean(t))},a.onCallbackFrequency??50);"function"==typeof e?.addEventListener&&e.addEventListener("destroy",()=>clearInterval(t),{once:!0})}}(this,0,0,0,0,e,u.bind(this)))};if("method"===i){const i=t;return s.addInitializer(function(){this[o]||(this[o]=new Map)}),function(...t){d.call(this);const s=this[o]??(this[o]=new Map),n=function(e){return e&&0!==e.length?JSON.stringify(e.map(e=>{if("function"==typeof e)return`function:${e.name}`;if(e&&"object"==typeof e)try{return JSON.stringify(Object.entries(e).sort())}catch{return"[[unserializable-object]]"}return void 0===e?"undefined":e})):"__no_args__"}(t);if(s.has(n))return s.get(n);const a=i.apply(this,t);if(s.set(n,a),e.timeout){const t=setTimeout(()=>s.delete(n),e.timeout);c.push(t)}if(e.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:e=>setTimeout(e,0))(()=>u.call(this))}return a}}if("getter"===i){const s=t;return function(){if(d.call(this),void 0===this[o]){if(this[o]=s.call(this),e.timeout){const t=setTimeout(()=>u.call(this),e.timeout);c.push(t)}if(e.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:e=>setTimeout(e,0))(()=>u.call(this))}}return this[o]}}if("accessor"===i){const s=t;return{get(){if(d.call(this),void 0===this[o]){const t=s.get?s.get.call(this):void 0;if(this[o]=t,e.timeout){const t=setTimeout(()=>u.call(this),e.timeout);c.push(t)}if(e.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:e=>setTimeout(e,0))(()=>u.call(this))}}return this[o]},set(e){u.call(this),s.set&&s.set.call(this,e)},init:e=>e}}}}function Rt(e){for(const t of Object.getOwnPropertySymbols(e))String(t).startsWith("Symbol(__cache__")&&delete e[t]}function Wt(e,t){const s="function"==typeof t?t.name:t,i=Object.getOwnPropertySymbols(e).find(e=>String(e)===`Symbol(__cache__${s})`);i&&delete e[i]}const Ht=new class{prototypeMap=new WeakMap;dataMap=new WeakMap;data(e){return e instanceof y&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}prototype(e){return e?(this.prototypeMap.has(e)||this.prototypeMap.set(e,{}),this.prototypeMap.get(e)):{}}fieldSetInPrototype(e,t){for(;e&&e!==HTMLElement.prototype;){if(this.prototype(e)[t])return!0;e=Object.getPrototypeOf(e)}return!1}skipAttributeChangedCallback(e){return this.fieldSetInPrototype(e,"setupAttributeChangedCallback")}skipConnectedCallback(e){return this.fieldSetInPrototype(e,"setupConnectedCallback")}getNamesOfPrototypeChain(e){const t=[];for(;e&&e!==HTMLElement.prototype;){const s=this.prototype(e).name;s&&t.push(s),e=Object.getPrototypeOf(e)}return t}};function Ut(e,t={injectAttributeBridge:!0}){return function(s,i){const n=e??Ie(i.name),a=s.prototype;if(n&&(Ht.prototype(a).name=n),Object.defineProperty(s,"observedAttributes",{configurable:!0,enumerable:!1,get:function(){const e=new Set;let t=this;for(;t&&t!==Function.prototype;){const s=t[Symbol.metadata]?.observedAttributes;if(s)for(const t of s)e.add(t);t=Object.getPrototypeOf(t)}return Array.from(e)}}),!1!==t.injectAttributeBridge&&!Ht.skipAttributeChangedCallback(a)){Ht.prototype(a).setupAttributeChangedCallback=!0;const e=function(t,s,i){if(f(this,"attributeChangedCallback",e)?.call(this,t,s,i),i===s)return;if(Ht.data(this).attributeBridgePass)return;const n=je(t);if(n in this)try{Ht.data(this).attributeBridgePass=!0,this[n]=null===i?void 0:Ae(i)}finally{Ht.data(this).attributeBridgePass=!1}};Object.defineProperty(a,"attributeChangedCallback",{configurable:!0,enumerable:!1,writable:!0,value:e})}if(!Ht.skipConnectedCallback(a)){Ht.prototype(a).setupConnectedCallback=!0;const e=function(){if(f(this,"connectedCallback",e)?.call(this),this instanceof HTMLElement){for(const e of this.constructor.observedAttributes??[]){const t=this[je(e)];if(void 0===t)continue;const s=De(t);this.getAttribute(e)!==s&&this.setAttribute(e,s)}Ht.getNamesOfPrototypeChain(Object.getPrototypeOf(this)).forEach(e=>this.classList?.add(e))}};Object.defineProperty(a,"connectedCallback",{configurable:!0,enumerable:!1,writable:!0,value:e})}return i.addInitializer(function(){n&&!customElements.get(n)&&customElements.define(n,s)}),s}}function $t(e,t=!0){return function(s,i){if(!e)return s;const{kind:n,name:a}=i,r=String(a),o=e.split(".").filter(Boolean),l=function(e){if(!e)return;let t=e;for(const e of o)if(t=t[e],!t)return;return t};if("method"===n)return function(...e){const t=l(this),s=t?.[r];if("function"==typeof s)return s.apply(t,e)};i.addInitializer(function(){const e=function(){return l(this)?.[r]},s=function(e){const t=l(this);t&&(t[r]=e)};if("field"===n||"accessor"===n){const i=h(this,r);Object.defineProperty(this,r,{configurable:!0,enumerable:i?.enumerable??!0,get:()=>e.call(this),set:e=>{t&&s.call(this,e)}})}})}}"metadata"in Symbol||Object.defineProperty(Symbol,"metadata",{value:Symbol.for("Symbol.metadata"),writable:!1,enumerable:!1,configurable:!0});const Gt=new class{constructorMap=new WeakMap;constructorData(e){let t=this.constructorMap.get(e);return t||(t={installed:new Map},this.constructorMap.set(e,t)),t}};function qt(e,t){const{kind:s,name:i,static:n}=t,a=String(i),r=Ie(a),o=Symbol(`__observed_${a}`);if(t.metadata){const e=t.metadata.observedAttributes;Object.prototype.hasOwnProperty.call(t.metadata,"observedAttributes")?e||(t.metadata.observedAttributes=new Set):t.metadata.observedAttributes=new Set(e),t.metadata.observedAttributes.add(r)}t.addInitializer(function(){const t=n?this:d(this,a);let l,c;if("field"===s||"accessor"===s)try{this[o]=this[i]}catch{}const u=function(){return l?l.call(this):this[o]},f=function(e){this[a]!==e&&(c?c.call(this,e):this[o]=e,this.setAttribute?.(r,De(this[a])))};if("field"===s||"accessor"===s){const t=e;t?.get&&(l=t.get),t?.set&&(c=t.set);const s=h(this,a);s?.get&&(l=s.get),s?.set&&(c=s.set),Object.defineProperty(this,a,{configurable:!0,enumerable:s?.enumerable??!0,get:()=>u.call(this),set:e=>f.call(this,e)})}else if("getter"===s||"setter"===s){const e=Gt.constructorData(t).installed;if(e.get(a))return;e.set(a,!0);const s=h(t,a)??{};"function"==typeof s.get&&(l=s.get),"function"==typeof s.set&&(c=s.set),Object.defineProperty(t,a,{configurable:!0,enumerable:!!s?.enumerable,get:function(){return u.call(this)},set:function(e){f.call(this,e)}})}})}function Yt(e,t){const{name:s}=t;return t.addInitializer(function(){this.solverKeys?.push(s)}),e}function Jt(e){const t=T(e);return Kt(t).setStyles({display:"flex",flexDirection:"column"},!0),t}function Xt(e){const t=Jt(e);return Kt(t).setStyles({justifyContent:"center",alignItems:"center"},!0),t}function Qt(e){const t=T(e);return Kt(t).setStyles({display:"flex",flexDirection:"row"},!0),t}function Zt(e){const t=Qt(e);return Kt(t).setStyles({justifyContent:"center",alignItems:"center"},!0),t}function es(e){const t=T(e);return Kt(t).setStyle("flexGrow",1,!0),t}class ts{element;model;emitter;constructor(e){this.element=e.element,e.model&&(this.model=e.model),e.emitter&&(this.emitter=e.emitter),this.setup()}setup(){}initialize(){this.setupUIElements(),this.setupUILayout(),this.setupUIListeners(),this.setupChangedCallbacks()}setupChangedCallbacks(){oe(this)}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}class ss extends Je{#s;get target(){return this.#s}set target(e){this.#s=e}toolName;manager;options;constructor(e){super(e),this.manager=e.manager??this.manager??ct.instance,this.toolName=e.toolName??this.toolName??void 0,this.options=e.listenerOptions??{};const t=this.element;this.target=e.target??this.target??t instanceof Node?t:t?.element instanceof Node?t.element:void 0,this.setup()}initialize(){super.initialize();const e=this.target??this;for(const[t,s]of Object.entries(xe)){const i=this[t];if("function"!=typeof i)continue;const n=this.options?.[t];this.toolName?Kt(e).onTool(s,this.toolName,e=>i.call(this,e),n,this.manager):Kt(e).on(s,e=>i.call(this,e),n,this.manager)}}}class is extends Je{substrateName;solverKeys=[];get objectList(){return Kt(this).getSubstrateObjectList(this.substrateName)}set objectList(e){Kt(this).setSubstrateObjectList(e,this.substrateName)}constructor(e){super(e),this.substrateName=e.substrateName??this.substrateName??void 0,e.onActivate&&(this.onActivate=e.onActivate),e.onDeactivate&&(this.onDeactivate=e.onDeactivate),this.setup()}initialize(){super.initialize(),this.substrateName&&(Kt(this).makeSubstrate(this.substrateName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0}),this.solverKeys.forEach(e=>{Kt(this).addSolver(t=>this[e]?.(t))}))}addObject(e){Kt(this).addObjectToSubstrate(e,this.substrateName)}removeObject(e){Kt(this).removeObjectFromSubstrate(e,this.substrateName)}hasObject(e){return Kt(this).hasObjectInSubstrate(e,this.substrateName)}isProcessed(e){return Kt(this).wasObjectProcessedBySubstrate(e,this.substrateName)}addSolver(e){Kt(this).addSolver(e,this.substrateName)}removeSolver(e){Kt(this).removeSolver(e,this.substrateName)}clearSolvers(){Kt(this).clearSolvers(this.substrateName)}resolve(e={}){Kt(this).resolveSubstrate({...e,substrate:this.substrateName})}}class ns extends Je{toolName;embeddedTarget;manager;activationEvent=xe.click;clickMode=Ne.left;key;constructor(e){super(e),this.toolName=e.toolName??this.toolName??void 0,e.embeddedTarget&&(this.embeddedTarget=e.embeddedTarget),e.onActivate&&(this.onActivate=e.onActivate),e.onDeactivate&&(this.onDeactivate=e.onDeactivate),e.activationEvent&&(this.activationEvent=e.activationEvent),e.clickMode&&(this.clickMode=e.clickMode),e.customActivation&&(this.customActivation=e.customActivation),e.key&&(this.key=e.key),this.manager=e.manager??this.manager??ct.instance,this.setup()}initialize(){if(super.initialize(),this.toolName){Kt(this).makeTool(this.toolName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0,activationEvent:this.activationEvent,clickMode:this.clickMode,customActivation:"function"==typeof this.customActivation?this.customActivation.bind(this):void 0,key:this.key,manager:this.manager}),this.embeddedTarget&&Kt(this).embedTool(this.embeddedTarget,this.manager);for(const[e,t]of Object.entries(xe)){const s=this[e];"function"==typeof s&&Kt(this).addToolBehavior(t,(e,t)=>s.call(this,e,t),this.toolName,this.manager)}}}}function as(e,t){void 0===t&&(t={});var s=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===s&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}function rs(e){const t=e.prototype,s=Symbol("__unset_default_classes__");Object.defineProperty(t,"unsetDefaultClasses",{get:function(){return this[s]??!1},set:function(e){this[s]=e;const t=this.constructor?.config?.defaultClasses;t&&Kt(this).toggleClass(t,e)},enumerable:!0,configurable:!0})}as("turbo-button{align-items:center;background-color:#dadada;border:1px solid #000;border-radius:.4em;color:#000;display:inline-flex;flex-direction:row;gap:.4em;padding:.5em .7em;text-decoration:none}turbo-button>h4{flex-grow:1}");class os extends HTMLElement{static config={shadowDOM:!1,defaultSelectedClass:"selected"};mvc=new q({element:this});onAttach=new de;onDetach=new de;onAdopt=new de;static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}connectedCallback(){this.onAttach.fire()}disconnectedCallback(){this.onDetach.fire()}adoptedCallback(){this.onAdopt.fire()}}function ls(...e){if(e.length<2)return!0;for(let t=0;t<e.length-1;t++)if(e[t]!=e[t+1])return!1;return!0}function cs(e,...t){if(t.length<1)return!0;for(const s of t)if(e==s)return!0;return!1}function hs(e,...t){if(t.length<1)return!0;for(const s of t){let t=!1;for(const i of e)s==i&&(t=!0);if(!t)return!1}return!0}function us(e){let t=document.createElement("div");return t.innerHTML=e,t.children[0]}function ds(e,t){return new Proxy(e,{get:(e,s,i)=>s in e?Reflect.get(e,s,i):s in t?Reflect.get(t,s,i):void 0,set:(e,s,i,n)=>s in e?Reflect.set(e,s,i,n):Reflect.set(t,s,i,n)})}function fs(e,t=!0){return new Promise((s,i)=>{e&&0!==e.length?fetch(e).then(e=>{if(!e.ok)throw new Error("Network response was not ok while loading your SVG");return e.text()}).then(e=>{const t=us(e);if(!t)throw new Error("Error parsing SVG text");s(t)}).catch(e=>{t||i(e),console.error("Error fetching SVG:",e),i(e)}):i(new Error("Invalid path"))})}ot(os),rt(os),rs(os);let ps=(()=>{let s,i,n,a,r,o,c,h=[Ut("turbo-icon")],u=[],d=os,f=[],p=[],m=[],y=[],b=[];return class extends d{static{i=this}static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(d[Symbol.metadata]??null):void 0;n=[qt,g({initialValueCallback:function(){return this.getPropertiesValue(this.type,"defaultType","svg")},preprocessValue:function(e){return e&&0!=e.length?("."==e[0]&&(e=e.substring(1)),e):this.type},callAfter:function(){this.generateIcon()}})],a=[qt,g({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultDirectory","")},preprocessValue:function(e){return l(e)?this.directory:(e.length>0&&!e.endsWith("/")&&(e+="/"),e)},callAfter:function(){this.generateIcon()}})],r=[qt,g()],o=[qt,g()],c=[Ft()],e(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:e=>"icon"in e,set:(e,t)=>{e.icon=t}},metadata:t},null,f),e(this,null,o,{kind:"setter",name:"iconColor",static:!1,private:!1,access:{has:e=>"iconColor"in e,set:(e,t)=>{e.iconColor=t}},metadata:t},null,f),e(this,null,c,{kind:"method",name:"loadSvg",static:!1,private:!1,access:{has:e=>"loadSvg"in e,get:e=>e.loadSvg},metadata:t},null,f),e(null,null,n,{kind:"field",name:"type",static:!1,private:!1,access:{has:e=>"type"in e,get:e=>e.type,set:(e,t)=>{e.type=t}},metadata:t},p,m),e(null,null,a,{kind:"field",name:"directory",static:!1,private:!1,access:{has:e=>"directory"in e,get:e=>e.directory,set:(e,t)=>{e.directory=t}},metadata:t},y,b),e(null,s={value:i},h,{kind:"class",name:i.name,metadata:t},null,u),i=s.value,t&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static config={...os.config,defaultType:"svg",customLoaders:{}};static imageTypes=["png","jpg","jpeg","gif","webp","PNG","JPG","JPEG","GIF","WEBP"];_element=t(this,f);_loadToken=0;onLoaded;type=t(this,p,void 0);directory=(t(this,m),t(this,y,void 0));get path(){let e=Me(this.icon);const t=this.icon?.replace(e,"");return 0===e.length&&this.type?.length>0&&(e="."+this.type),this.directory+t+e}set icon(e){const t=Me(e).substring(1);t&&(this.type=t),this.generateIcon()}set iconColor(e){this.updateColor(e)}set element(e){this._element=e}get element(){return this._element}loadSvg(e){return fs(e)}loadImg(e){return z({src:e,alt:this.icon})}updateColor(e=this.iconColor){e&&this.element instanceof SVGElement&&(this.element.style.fill=e)}generateIcon(){const e=this.path,t=Me(e)?.substring(1);if(this.element instanceof HTMLImageElement&&cs(t,...this.constructor.imageTypes))return this.element.src=this.path,void(this.element.alt=this.icon);if(this.clear(),!this.icon||0===this.icon.length)return;const s=++this._loadToken,i=this.getLoader(t)(e);i instanceof Element?this.setupLoadedElement(i):i.then(e=>{s===this._loadToken&&this.setupLoadedElement(e)}).catch(e=>console.error(`Failed to load icon: ${e}`))}getLoader(e){if(!e)return;const t=this.constructor.config.customLoaders[e];if(t)return t;if(cs(e,"svg","SVG"))return this.loadSvg.bind(this);if(cs(e,...this.constructor.imageTypes))return this.loadImg.bind(this);throw new Error(`Unsupported icon type: ${e}`)}setupLoadedElement(e){!this.element&&e&&(e.parentElement&&(e=e.cloneNode(!0)),Kt(this).addChild(e),this.updateColor(),this.onLoaded?.(e),this.element=e)}clear(){Kt(this.element).destroy(),this.element=null}constructor(){super(...arguments),t(this,b)}static{t(i,u)}},i})();function ms(e){return e.tag||(e.tag="turbo-icon"),T({...e})}let gs=(()=>{let s,i,n,a,r,o,l,c,h,u,d=[Ut("turbo-rich-element")],f=[],p=os,m=[],y=[],b=[];return class extends p{static{i=this}static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;n=[g({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultElementTag","h4")}})],a=[g({executeSetterBeforeStoring:!0})],r=[g({preprocessValue:function(e){if("string"==typeof e){if(this.leftIcon)return this.leftIcon.icon=e,this.leftIcon;e=ms({icon:e})}return Kt(this).remChild(this.leftIcon),this.addAtPosition(e,"leftIcon"),e}})],o=[g({preprocessValue:function(e){if("string"==typeof e){if(this.prefixEntry)return this.prefixEntry.textContent=e,this.prefixEntry;e=T({text:e})}return Kt(this).remChild(this.prefixEntry),this.addAtPosition(e,"prefixEntry"),e}})],l=[g({preprocessValue:function(e){if("string"==typeof e){if(this.element&&"textContent"in this.element)return this.element.textContent=e,this.element;e=T({tag:this.elementTag,text:e})}else"object"!=typeof e||e instanceof Element||(e.tag||(e.tag=this.elementTag),e=T(e));return Kt(this).remChild(this.element),this.addAtPosition(e,"element"),e}})],c=[g({preprocessValue:function(e){if("string"==typeof e){if(this.suffixEntry)return this.suffixEntry.textContent=e,this.suffixEntry;e=T({text:e})}return Kt(this).remChild(this.suffixEntry),this.addAtPosition(e,"suffixEntry"),e}})],h=[g({preprocessValue:function(e){if("string"==typeof e){if(this.rightIcon)return this.rightIcon.icon=e,this.rightIcon;e=ms({icon:e})}return Kt(this).remChild(this.rightIcon),this.addAtPosition(e,"rightIcon"),e}})],u=[g({executeSetterBeforeStoring:!0})],e(this,null,a,{kind:"setter",name:"leftCustomElements",static:!1,private:!1,access:{has:e=>"leftCustomElements"in e,set:(e,t)=>{e.leftCustomElements=t}},metadata:t},null,m),e(this,null,r,{kind:"setter",name:"leftIcon",static:!1,private:!1,access:{has:e=>"leftIcon"in e,set:(e,t)=>{e.leftIcon=t}},metadata:t},null,m),e(this,null,o,{kind:"setter",name:"prefixEntry",static:!1,private:!1,access:{has:e=>"prefixEntry"in e,set:(e,t)=>{e.prefixEntry=t}},metadata:t},null,m),e(this,null,l,{kind:"setter",name:"element",static:!1,private:!1,access:{has:e=>"element"in e,set:(e,t)=>{e.element=t}},metadata:t},null,m),e(this,null,c,{kind:"setter",name:"suffixEntry",static:!1,private:!1,access:{has:e=>"suffixEntry"in e,set:(e,t)=>{e.suffixEntry=t}},metadata:t},null,m),e(this,null,h,{kind:"setter",name:"rightIcon",static:!1,private:!1,access:{has:e=>"rightIcon"in e,set:(e,t)=>{e.rightIcon=t}},metadata:t},null,m),e(this,null,u,{kind:"setter",name:"rightCustomElements",static:!1,private:!1,access:{has:e=>"rightCustomElements"in e,set:(e,t)=>{e.rightCustomElements=t}},metadata:t},null,m),e(null,null,n,{kind:"field",name:"elementTag",static:!1,private:!1,access:{has:e=>"elementTag"in e,get:e=>e.elementTag,set:(e,t)=>{e.elementTag=t}},metadata:t},y,b),e(null,s={value:i},d,{kind:"class",name:i.name,metadata:t},null,f),i=s.value,t&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static config={...os.config,defaultElementTag:"h4"};childrenOrder=(t(this,m),["leftCustomElements","leftIcon","prefixEntry","element","suffixEntry","rightIcon","rightCustomElements"]);addAtPosition(e,t){if(!e||!t)return;let s=0;for(let e=0;e<this.childrenOrder.length;e++){const i=this.childrenOrder[e];if(i===t)break;const n=this[i];n&&n instanceof Element?s++:n&&Array.isArray(n)&&(s+=n.length)}Kt(this).addChild(e,s)}elementTag=t(this,y,void 0);set leftCustomElements(e){Kt(this).remChild(this.leftCustomElements),this.addAtPosition(e,"leftCustomElements")}set leftIcon(e){}get leftIcon(){}set prefixEntry(e){}get prefixEntry(){}set element(e){}get element(){}get text(){const e=this.element;return e?e.textContent:""}set text(e){e||(e=""),this.element=e}set suffixEntry(e){}get suffixEntry(){}set rightIcon(e){}get rightIcon(){}set rightCustomElements(e){Kt(this).remChild(this.rightCustomElements),this.addAtPosition(e,"rightCustomElements")}constructor(){super(...arguments),t(this,b)}static{t(i,f)}},i})();function ys(e){return e.text&&!e.element&&(e.element=e.text),!e.elementTag||"object"!=typeof e.element||e.element instanceof Element||(e.element.tag=e.elementTag),e.tag||(e.tag="turbo-rich-element"),T({...e,text:void 0})}let bs=(()=>{let s,i,n=[Ut("turbo-button")],a=[],r=gs;return class extends r{static{i=this}static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e(null,s={value:i},n,{kind:"class",name:i.name,metadata:t},null,a),i=s.value,t&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static config={...gs.config,defaultElementTag:"h4"};static{t(i,a)}},i})();function vs(e){return e.tag||(e.tag="turbo-button"),ys({...e})}let ks=(()=>{let s,i,n,a,r,o=[Ut("turbo-icon-switch")],l=[],c=ps,h=[];return class extends c{static{i=this}static{const u="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;n=[g({preprocessValue:function(e){return e instanceof vt?e:new vt(e||{})}})],a=[g()],r=[g()],e(this,null,n,{kind:"setter",name:"switchReifect",static:!1,private:!1,access:{has:e=>"switchReifect"in e,set:(e,t)=>{e.switchReifect=t}},metadata:u},null,h),e(this,null,a,{kind:"setter",name:"defaultState",static:!1,private:!1,access:{has:e=>"defaultState"in e,set:(e,t)=>{e.defaultState=t}},metadata:u},null,h),e(this,null,r,{kind:"setter",name:"appendStateToIconName",static:!1,private:!1,access:{has:e=>"appendStateToIconName"in e,set:(e,t)=>{e.appendStateToIconName=t}},metadata:u},null,h),e(null,s={value:i},o,{kind:"class",name:i.name,metadata:u},null,l),i=s.value,u&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),t(i,l)}config=(t(this,h),{...ps.config});get switchReifect(){}set switchReifect(e){this.switchReifect.attach(this),this.defaultState&&this.switchReifect.apply(this.defaultState,this)}set defaultState(e){this.switchReifect?.apply(e,this)}set appendStateToIconName(e){if(e){const e=this.switchReifect.properties;this.switchReifect.states.forEach(t=>{e[t]={...e[t],icon:this.icon+"-"+t.toString()}}),this.switchReifect.properties=e}}initialize(){super.initialize(),this.defaultState&&this.switchReifect?.apply(this.defaultState,this)}},i})();function Ss(e){return e.tag||(e.tag="turbo-icon-switch"),ms({...e})}let Es=(()=>{let s,i,n,a,r=[Ut("turbo-icon-toggle")],o=[],l=ps,c=[];return class extends l{static{i=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;n=[g({initialValue:!1})],a=[g({initialValue:!1})],e(this,null,n,{kind:"setter",name:"toggled",static:!1,private:!1,access:{has:e=>"toggled"in e,set:(e,t)=>{e.toggled=t}},metadata:h},null,c),e(this,null,a,{kind:"setter",name:"toggleOnClick",static:!1,private:!1,access:{has:e=>"toggleOnClick"in e,set:(e,t)=>{e.toggleOnClick=t}},metadata:h},null,c),e(null,s={value:i},r,{kind:"class",name:i.name,metadata:h},null,o),i=s.value,h&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),t(i,o)}config=(t(this,c),{...ps.config});stopPropagationOnClick=!0;onToggle;clickListener=()=>(this.toggle(),this.stopPropagationOnClick);set toggled(e){this.onToggle&&this.onToggle(e,this)}set toggleOnClick(e){e?Kt(this).on(xe.click,this.clickListener):Kt(this).removeListener(xe.click,this.clickListener)}toggle(){this.toggled=!this.toggled}},i})();function ws(e){return e.tag||(e.tag="turbo-icon-toggle"),ms({...e})}function Cs(e=8){const t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map(e=>e.toString(36).padStart(2,"0")).join("").slice(0,e)}function Os(e,t){if("number"!=typeof e||"number"!=typeof t)return 0;const s=Math.min(e,t),i=Math.max(e,t);return Math.random()*(i-s)+s}function Ts(e=[50,70],t=[70,85]){return"number"!=typeof e&&e.length>=2&&(e=Os(e[0],e[1])),"number"!=typeof t&&t.length>=2&&(t=Os(t[0],t[1])),"hsl("+360*Math.random()+" "+e+" "+t+")"}function Ps(e=12){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let i=0;i<e;i++)s+=t.charAt(Math.floor(62*Math.random()));return s}class xs extends ss{keyName="__input__interactor__";_composing=!1;_resizeQueued=!1;options={compositionStart:{capture:!0},compositionEnd:{capture:!0},input:{capture:!0}};get inputElement(){return this.element.element}initialize(){super.initialize(),Kt(this.target).bypassManagerOn=()=>!0}setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("valueSet",()=>this.handleInput())}click(){return this.element.locked||this.inputElement?.focus(),!1}focusIn(e){if(e.target===this.inputElement){if(!this.element.locked)return this.element.selectTextOnFocus&&requestAnimationFrame(()=>{try{this.inputElement.select?.()}catch{}}),this.element.onFocus.fire(),!0;this.inputElement.blur()}}focusOut(e){e.target===this.inputElement&&(this.element.value=this.element.element?.value,this.element.onBlur.fire())}compositionStart(e){e.target===this.inputElement&&(this._composing=!0)}compositionEnd(e){if(e.target===this.inputElement)return this._composing=!1,this.handleInput(),!0}input(e){if(e.target===this.inputElement)return this.handleInput(),!0}handleInput(){this._composing||this.inputElement&&(this.element.dynamicVerticalResize&&this.inputElement instanceof HTMLTextAreaElement&&(this._resizeQueued||(this._resizeQueued=!0,queueMicrotask(()=>{this._resizeQueued=!1,Kt(this.inputElement).setStyle("height","auto",!0).setStyle("height",this.inputElement.scrollHeight+"px",!0)}))),this.emitter.fire("processValue"))}}let Ds=(()=>{let s,i,n,a=[Ut("turbo-input")],r=[],o=gs,l=[];return class extends o{static{i=this}static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(o[Symbol.metadata]??null):void 0;n=[g()],e(this,null,n,{kind:"setter",name:"label",static:!1,private:!1,access:{has:e=>"label"in e,set:(e,t)=>{e.label=t}},metadata:t},null,l),e(null,s={value:i},a,{kind:"class",name:i.name,metadata:t},null,r),i=s.value,t&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static config={...gs.config,defaultElementTag:"input"};labelElement=t(this,l);_content;get content(){return this._content}set content(e){this._content=e}defaultId="turbo-input-"+Cs();locked=!1;selectTextOnFocus=!1;dynamicVerticalResize=!1;inputRegexCheck;blurRegexCheck;lastValidForInput="";lastValidForBlur="";onFocus=new de;onBlur=new de;onInput=new de;set label(e){e&&0!==e.length?(this.labelElement||(this.labelElement=T({tag:"label",htmlFor:this.element?.id??this.defaultId}),Kt(this).childHandler=this,Kt(this).addChild(this.labelElement,0),this.content&&(Kt(this).childHandler=this.content)),this.labelElement.textContent=e):this.labelElement&&this.labelElement.remove()}set element(e){e instanceof Node||"object"!=typeof e||(e.name||(e.name=Cs()),"input"!==this.elementTag||e.type||(e.type="text")),super.element=e,this.element&&(this.element.id?this.labelElement&&(this.labelElement.htmlFor=this.element.id):this.element.id=this.defaultId)}get element(){return super.element}initialize(){super.initialize(),this.mvc.generate({interactors:[xs]}),this.mvc.getInteractor("__input__interactor__").target=this.content}setupUIElements(){super.setupUIElements(),this.content=A()}setupUILayout(){super.setupUILayout(),Kt(this.content).addChild(Kt(this).childrenArray),Kt(this).addChild([this.labelElement,this.content]),Kt(this).childHandler=this.content}setupChangedCallbacks(){super.setupChangedCallbacks(),this.mvc.emitter.add("processValue",()=>this.processInputValue())}get value(){const e=this.element?.value;try{const t=parseFloat(e);if(!isNaN(t))return t}catch{}return e}set value(e){if(!(this.element instanceof HTMLInputElement||this.element instanceof HTMLTextAreaElement))return;let t=e.toString();if(this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(t)||(t=this.lastValidForBlur)}this.element.value=t,this.mvc.emitter.fire("valueSet")}processInputValue(e=this.element.value){if(this.inputRegexCheck){const t=new RegExp(this.inputRegexCheck);if(!t.test(e)){const s=this.sanitizeByRegex(e,this.inputRegexCheck);e=t.test(s)?s:this.lastValidForInput}}if(this.lastValidForInput=e.toString(),this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(e.toString())&&(this.lastValidForBlur=e)}else this.lastValidForBlur=e;this.element.value=e,this.onInput.fire()}sanitizeByRegex(e,t){const s="string"==typeof t?t:t.source,i="string"==typeof t?"":t.flags.replace("g",""),n=new RegExp(s,i);let a="";for(const t of e){const e=a+t;n.lastIndex=0,n.test(e)&&(a=e)}return a}static{t(i,r)}},i})();function As(e){return e.element=e.input,e.elementTag=e.inputTag,e.elementTag||(e.elementTag="input"),e.element||(e.element={}),e.tag||(e.tag="turbo-input"),ys({...e,input:void 0,inputTag:void 0})}let Ms=(()=>{let s,i,n=[Ut("turbo-numerical-input")],a=[],r=Ds;return class extends r{static{i=this}static{const o="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;e(null,s={value:i},n,{kind:"class",name:i.name,metadata:o},null,a),i=s.value,o&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),t(i,a)}multiplier=1;decimalPlaces;min;max;get value(){return Number.parseFloat(this.element.value)/this.multiplier}set value(e){e&&""!=e||(e=0),"string"==typeof e&&(e=Number.parseFloat(e)),e*=this.multiplier,null!=this.min&&e<this.min&&(e=this.min),null!=this.max&&e>this.max&&(e=this.max),null!=this.decimalPlaces&&(e=Math.round(e*Math.pow(10,this.decimalPlaces))/Math.pow(10,this.decimalPlaces)),super.value=e}},i})();function Is(e){return e.inputRegexCheck||(e.inputRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?\.?$|^-$|^$/),e.blurRegexCheck||(e.blurRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?(?<=\d)$/),e.tag||(e.tag="turbo-numerical-input"),As({...e})}class js extends qe{toggledEntry;values;constructor(e){super(e),this.toggledEntry=e.toggledEntry,this.values=e.values}}class Bs{static config={};static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}}ot(Bs);let Vs=(()=>{let s,i,n,a,r,c,h,u=Bs,d=[],f=[],p=[],m=[],y=[],b=[],v=[],k=[],S=[],E=[],w=[];return class extends u{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(u[Symbol.metadata]??null):void 0;s=[g()],i=[g({defaultValue:e=>e instanceof gs?e.text:e instanceof HTMLElement?e.textContent:e instanceof Element?e.innerHTML:void 0})],n=[g({defaultValue:()=>""})],a=[g({defaultValue:e=>ys({text:De(e)})})],r=[g({defaultValue:!1})],c=[g({defaultValueCallback:function(){return!this.multiSelection}})],h=[g({callBefore:function(){this.selectedEntries?.forEach(e=>_t(e).removeClass(this.selectedEntryClasses))},callAfter:function(){this.selectedEntries?.forEach(e=>_t(e).addClass(this.selectedEntryClasses))},initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectedEntryClasses")}})],e(this,null,s,{kind:"setter",name:"parent",static:!1,private:!1,access:{has:e=>"parent"in e,set:(e,t)=>{e.parent=t}},metadata:t},null,d),e(this,null,r,{kind:"setter",name:"multiSelection",static:!1,private:!1,access:{has:e=>"multiSelection"in e,set:(e,t)=>{e.multiSelection=t}},metadata:t},null,d),e(null,null,i,{kind:"field",name:"getValue",static:!1,private:!1,access:{has:e=>"getValue"in e,get:e=>e.getValue,set:(e,t)=>{e.getValue=t}},metadata:t},f,p),e(null,null,n,{kind:"field",name:"getSecondaryValue",static:!1,private:!1,access:{has:e=>"getSecondaryValue"in e,get:e=>e.getSecondaryValue,set:(e,t)=>{e.getSecondaryValue=t}},metadata:t},m,y),e(null,null,a,{kind:"field",name:"createEntry",static:!1,private:!1,access:{has:e=>"createEntry"in e,get:e=>e.createEntry,set:(e,t)=>{e.createEntry=t}},metadata:t},b,v),e(null,null,c,{kind:"field",name:"forceSelection",static:!1,private:!1,access:{has:e=>"forceSelection"in e,get:e=>e.forceSelection,set:(e,t)=>{e.forceSelection=t}},metadata:t},k,S),e(null,null,h,{kind:"field",name:"selectedEntryClasses",static:!1,private:!1,access:{has:e=>"selectedEntryClasses"in e,get:e=>e.selectedEntryClasses,set:(e,t)=>{e.selectedEntryClasses=t}},metadata:t},E,w),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static config={defaultSelectedEntryClasses:"selected"};_inputField=t(this,d);_entries=[];_entriesData=new WeakMap;parentObserver;onSelectDelegate=new de;onEnabledDelegate=new de;onEntryAdded=new de;onEntryRemoved=new de;onEntryClicked=new de;get entries(){return this._entries}set entries(e){this.enableObserver(!1),console.log(e);const t=this.selectedValues;this.clear(!1),this._entries=(Array.isArray(e)?e:Array.from(e)).filter(e=>e!==this.inputField),e instanceof HTMLCollection&&e.item(0)&&(this.parent=e.item(0).parentElement);const s=this.entries;for(let e=0;e<s.length;e++)this.onEntryAdded.fire(s[e],e);this.deselectAll();for(let e=0;e<s.length;e++)t.includes(this.getValue(s[e]))&&this.select(s[e]);0===this.selectedEntries.length&&this.initializeSelection(),this.refreshInputField(),this.enableObserver(!0)}get values(){return this.entries.map(e=>this.getValue(e))}set values(e){const t=[];e.forEach(e=>{const s=this.createEntry(e);s instanceof Node&&this.parent&&Kt(this.parent).addChild(s),t.push(s)}),this.entries=t}get selectedEntries(){return this.entries.filter(e=>this.getEntryData(e).selected)}set selectedEntries(e){this.deselectAll(),e&&e.forEach(e=>this.select(e))}set parent(e){e instanceof Element&&(Kt(e).addChild(this.entries.filter(e=>e instanceof Node)),this.inputField&&e.appendChild(this.inputField),this.setupParentObserver())}getValue=t(this,f,void 0);getSecondaryValue=(t(this,p),t(this,m,void 0));createEntry=(t(this,y),t(this,b,void 0));get inputName(){return this.inputField?.name}set inputName(e){this._inputField||(this._inputField=K({value:this.stringSelectedValue,type:"hidden",parent:this.parent??document.body})),this.inputField.name=e}get inputField(){return this._inputField}set multiSelection(e){this.forceSelection=!e}forceSelection=(t(this,v),t(this,k,void 0));set onSelect(e){e&&this.onSelectDelegate.add(e)}set onEnabled(e){e&&this.onEnabledDelegate.add(e)}selectedEntryClasses=(t(this,S),t(this,E,void 0));constructor(e={}){super(),t(this,w);const s=e.selectedValues||[];e.selectedValues=void 0,this.onEntryClicked.add(e=>this.select(e,!this.isSelected(e))),this.onEntryAdded.add(e=>{this.initializeSelection(),_t(e).on(xe.click,t=>(this.onEntryClicked.fire(e,t),!0))}),e.onEnabled||(e.onEnabled=(e,t)=>{t instanceof HTMLElement&&_t(t).setStyle("visibility",e?"":"hidden")});for(const t of Object.keys(e))try{this[t]instanceof de?this[t].add(e[t]):this[t]=e[t]}catch{}this.forceSelection||this.deselectAll(),this.entries.forEach(e=>{s.includes(this.getValue(e))&&this.select(e)})}getEntryData(e){if(!e)return{};let t=this._entriesData.get(e);return t||(t={selected:!1,enabled:!0},this._entriesData.set(e,t)),t}clearEntryData(e){this._entriesData.delete(e);const t=this.entries.indexOf(e);t>=0&&this.entries.splice(t,1)}addEntry(e,t=this.entries.length){(void 0===t||"number"!=typeof t||t>this.entries.length)&&(t=this.entries.length),t<0&&(t=0),this.enableObserver(!1),this.onEntryAdded.fire(e,t),Array.isArray(this.entries)&&!this.entries.includes(e)&&this.entries.splice(t,0,e),e instanceof Node&&!e.parentElement&&this.parent&&Kt(this.parent).addChild(e,t),this.enableObserver(!0),requestAnimationFrame(()=>this.select(this.selectedEntry))}getEntryFromSecondaryValue(e){return this.entries.find(t=>this.getSecondaryValue(t)===e)}isSelected(e){return this.selectedEntries.includes(e)}getEntry(e){let t;try{const s=this.find(e);if(s)t=s;else{const s=this.entries.find(t=>t===e);s&&(t=s)}}catch{}return t}select(e,t=!0){if(o(e)||l(e))return this;let s;try{const t=this.getEntry(e);if(t)s=t;else{const t=this.entries.find(t=>t===e);t&&(s=t)}}catch{}if(!s)return this;const i=this.isSelected(s);return t===i||!t&&i&&this.selectedEntries.length<=1&&this.forceSelection||(this.multiSelection||this.deselectAll(),this.getEntryData(s).selected=t,s instanceof HTMLElement&&Kt(s).toggleClass(this.selectedEntryClasses,t),this.initializeSelection(),this.refreshInputField(),this.onSelectDelegate.fire(t,s,this.getIndex(s)),(this.parent??document).dispatchEvent(new js({toggledEntry:s,values:this.selectedValues}))),this}selectByIndex(e,t=yt){return e=t(e,this.entries.length-1,0),this.select(this.entries[e])}getIndex(e){return this.entries.indexOf(e)}deselectAll(){this.selectedEntries.forEach(e=>{e instanceof HTMLElement&&Kt(e).toggleClass(this.selectedEntryClasses,!1),this.getEntryData(e).selected=!1}),this.refreshInputField()}reset(){this.deselectAll()}get enabledEntries(){return this.entries.filter(e=>this.getEntryData(e).enabled)}get enabledValues(){return this.enabledEntries.map(e=>this.getValue(e))}get enabledSecondaryValues(){return this.enabledEntries.map(e=>this.getSecondaryValue(e))}find(e){return this.entries.find(t=>this.getValue(t)===e)}findBySecondaryValue(e){return this.entries.find(t=>this.getSecondaryValue(t)===e)}findAll(...e){return this.entries.filter(t=>e.includes(this.getValue(t)))}findAllBySecondaryValue(...e){return this.entries.filter(t=>e.includes(this.getSecondaryValue(t)))}enable(e,...t){t&&0!==t.length||(t=this.entries),t.forEach(t=>{const s=this.getEntry(t);s&&(this.getEntryData(s).enabled=e,this.onEnabledDelegate.fire(e,s,this.getIndex(s)))})}get selectedEntry(){return this.selectedEntries[0]}get selectedValues(){return this.selectedEntries.map(e=>this.getValue(e))}get selectedValue(){const e=this.selectedEntry;if(e)return this.getValue(e)}get selectedSecondaryValues(){return this.selectedEntries.map(e=>this.getSecondaryValue(e))}get selectedSecondaryValue(){const e=this.selectedEntry;if(e)return this.getSecondaryValue(e)}get stringSelectedValue(){return this.selectedEntries.map(e=>De(this.getValue(e))).join(", ")}clear(e=!0){e&&this.enableObserver(!1);for(let e=this.entries.length-1;e>=0;e--){const t=this.entries[e];this.onEntryRemoved.fire(t),this.parent&&t instanceof HTMLElement&&t.remove()}this._entries=[],this.refreshInputField(),e&&this.enableObserver(!0)}refreshInputField(){this.inputField&&(this.inputField.value=this.stringSelectedValue)}destroy(){return this.enableObserver(!1),this.parentObserver=null,this}enableObserver(e){if(!e)return this.parentObserver?.disconnect();this.parent instanceof Element&&this.parentObserver&&this.parentObserver.observe(this.parent,{childList:!0})}initializeSelection(){if(this.forceSelection&&this.enabledEntries.length&&0===this.selectedEntries.length){const e=this.enabledEntries[0];e&&this.select(e)}}setupParentObserver(){this.enableObserver(!1),this.parentObserver=new MutationObserver(e=>{for(const t of e){for(const e of t.addedNodes){if(!(e instanceof Element)||e.parentElement!==this.parent)continue;if(e===this.inputField)continue;const t=e,s=Array.from(this.parent.children).filter(e=>e!==this.inputField).filter(e=>this.entries.includes(e)||e===t),i=s.indexOf(t);if(!(i<0)){if(0===i)this.entries.splice(i,0,t);else{const e=this.entries.indexOf(s[i-1]);this.entries.splice(e+1,0,t)}this.getEntryData(t),this.onEntryAdded.fire(t,this.getIndex(t))}}for(const e of t.removedNodes)e instanceof Element&&e!==this.inputField&&queueMicrotask(()=>{if(e.isConnected)return;const t=this.getEntryData(e);if(t.selected&&this.forceSelection&&this.enabledEntries.length){const e=this.enabledEntries[0];e&&this.select(e)}t.selected=!1,this.onEntryRemoved.fire(e),this.clearEntryData(e)})}}),this.enableObserver(!0)}}})();as(".turbo-drawer{align-items:center;direction:ltr;display:inline-flex}.turbo-drawer-panel-container{align-items:center;display:flex;overflow:hidden;position:relative}.turbo-drawer-thumb{display:inline-block;position:relative}.top-drawer .turbo-drawer-panel-container,.turbo-drawer.top-drawer{flex-direction:column}.bottom-drawer .turbo-drawer-panel-container,.turbo-drawer.bottom-drawer{flex-direction:column-reverse}.left-drawer .turbo-drawer-panel-container,.turbo-drawer.left-drawer{flex-direction:row}.right-drawer .turbo-drawer-panel-container,.turbo-drawer.right-drawer{flex-direction:row-reverse}");let _s=(()=>{let s,i,n,a,r,o,l,c,h,u,d,f,p,m=[Ut("turbo-drawer")],y=[],b=os,v=[],k=[],S=[];return class extends b{static{i=this}static{const E="function"==typeof Symbol&&Symbol.metadata?Object.create(b[Symbol.metadata]??null):void 0;n=[g({setIfUndefined:!0,callBefore:function(){this.thumb&&_t(this).remChild(this.thumb)},preprocessValue:e=>e instanceof HTMLElement?e:A(e)})],a=[g({setIfUndefined:!0,callBefore:function(){this.panel&&_t(this).remChild(this.panel)},preprocessValue:e=>e instanceof HTMLElement?e:A(e)})],r=[g({callBefore:function(){this.icon?.parentElement===this.thumb&&this.thumb.removeChild(this.icon)},preprocessValue:function(e){return e instanceof Element?e:("string"!=typeof e||this.attachSideToIconName||this.rotateIconBasedOnSide||(this.attachSideToIconName=!0),Ss("object"==typeof e?e:{icon:e,switchReifect:{states:Object.values(Tt)},defaultState:this.open?this.getOppositeSide():this.side,appendStateToIconName:this.attachSideToIconName}))}})],o=[g({defaultValue:!1})],l=[g({defaultValue:!1})],c=[g({defaultValue:!1})],h=[g({defaultValue:Tt.bottom,cancelIfUnchanged:!1})],u=[g({defaultValue:{open:0,closed:0},preprocessValue:e=>"number"==typeof e?{open:e,closed:e}:{open:e?.open||0,closed:e?.closed||0}})],d=[g({defaultValue:!1})],f=[g()],p=[g({defaultValueCallback:function(){return new St({transitionProperties:["transform",this.isVertical?"height":"width"],transitionDuration:.2,transitionTimingFunction:"ease-out"})},callAfter:function(){this.transition.attachAll(this,this.panelContainer)}})],e(this,null,n,{kind:"setter",name:"thumb",static:!1,private:!1,access:{has:e=>"thumb"in e,set:(e,t)=>{e.thumb=t}},metadata:E},null,v),e(this,null,a,{kind:"setter",name:"panel",static:!1,private:!1,access:{has:e=>"panel"in e,set:(e,t)=>{e.panel=t}},metadata:E},null,v),e(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:e=>"icon"in e,set:(e,t)=>{e.icon=t}},metadata:E},null,v),e(this,null,o,{kind:"setter",name:"hideOverflow",static:!1,private:!1,access:{has:e=>"hideOverflow"in e,set:(e,t)=>{e.hideOverflow=t}},metadata:E},null,v),e(this,null,l,{kind:"setter",name:"attachSideToIconName",static:!1,private:!1,access:{has:e=>"attachSideToIconName"in e,set:(e,t)=>{e.attachSideToIconName=t}},metadata:E},null,v),e(this,null,c,{kind:"setter",name:"rotateIconBasedOnSide",static:!1,private:!1,access:{has:e=>"rotateIconBasedOnSide"in e,set:(e,t)=>{e.rotateIconBasedOnSide=t}},metadata:E},null,v),e(this,null,h,{kind:"setter",name:"side",static:!1,private:!1,access:{has:e=>"side"in e,set:(e,t)=>{e.side=t}},metadata:E},null,v),e(this,null,u,{kind:"setter",name:"offset",static:!1,private:!1,access:{has:e=>"offset"in e,set:(e,t)=>{e.offset=t}},metadata:E},null,v),e(this,null,d,{kind:"setter",name:"open",static:!1,private:!1,access:{has:e=>"open"in e,set:(e,t)=>{e.open=t}},metadata:E},null,v),e(this,null,f,{kind:"setter",name:"translation",static:!1,private:!1,access:{has:e=>"translation"in e,set:(e,t)=>{e.translation=t}},metadata:E},null,v),e(null,null,p,{kind:"field",name:"transition",static:!1,private:!1,access:{has:e=>"transition"in e,get:e=>e.transition,set:(e,t)=>{e.transition=t}},metadata:E},k,S),e(null,s={value:i},m,{kind:"class",name:i.name,metadata:E},null,y),i=s.value,E&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:E}),t(i,y)}_panelContainer=t(this,v);get panelContainer(){return this._panelContainer}dragging=!1;resizeObserver;set thumb(e){_t(e).addClass("turbo-drawer-thumb"),this.initialized&&this.setupUILayout()}get thumb(){}set panel(e){_t(e).addClass("turbo-drawer-panel"),this.initialized&&this.setupUILayout()}get panel(){}set icon(e){this.initialized&&this.setupUILayout()}get icon(){}set hideOverflow(e){_t(this.panelContainer).setStyle("overflow",e?"hidden":"")}set attachSideToIconName(e){this.icon instanceof ks&&(this.icon.appendStateToIconName=e),e&&(this.rotateIconBasedOnSide=!1)}set rotateIconBasedOnSide(e){e&&(this.attachSideToIconName=!1),this.icon instanceof ks&&(this.icon.switchReifect.styles={top:"transform: rotate(180deg)",bottom:"transform: rotate(0deg)",left:"transform: rotate(90deg)",right:"transform: rotate(270deg)"})}set side(e){_t(this).toggleClass("top-drawer",e==Tt.top).toggleClass("bottom-drawer",e==Tt.bottom).toggleClass("left-drawer",e==Tt.left).toggleClass("right-drawer",e==Tt.right),this.refresh()}set offset(e){}get offset(){}get isVertical(){return this.side==Tt.top||this.side==Tt.bottom}set open(e){e?this.resizeObserver?.observe(this.panel,{box:"border-box"}):this.resizeObserver?.unobserve(this.panel),this.refresh()}set translation(e){switch(this.side){case Tt.top:case Tt.bottom:this.hideOverflow?_t(this.panelContainer).setStyle("height",e+"px"):_t(this).setStyle("transform",`translateY(${-e}px)`);break;case Tt.left:case Tt.right:this.hideOverflow?_t(this.panelContainer).setStyle("width",e+"px"):_t(this).setStyle("transform",`translateX(${-e}px)`)}}transition=t(this,k,void 0);get translation(){}initialize(){super.initialize(),_t(this).show(!1),this.enableTransition(!1),this.setupResizeObserver(),this.open=!1,requestAnimationFrame(()=>{_t(this).show(!0),this.enableTransition(!0)})}setupUIElements(){super.setupUIElements(),this._panelContainer=A({classes:"turbo-drawer-panel-container"})}setupUILayout(){super.setupUILayout(),_t(this).childHandler=this,_t(this.panel).addChild(_t(this).childrenArray.filter(e=>e!==this.panelContainer)),_t(this).addChild([this.thumb,this.panelContainer]),_t(this.panelContainer).addChild(this.panel),_t(this.thumb).addChild(this.icon),_t(this).childHandler=this.panel}setupUIListeners(){_t(this.thumb).on(xe.click,e=>(this.open=!this.open,!0)).on(Pe.dragStart,e=>(this.dragging=!0,this.enableTransition(!1),!0)).on(Pe.drag,e=>{if(this.dragging)return this.translation+=this.isVertical?e.scaledDeltaPosition.y:e.scaledDeltaPosition.x,!0}).on(Pe.dragEnd,e=>{if(!this.dragging)return;this.dragging=!1;const t=e.positions.first.sub(e.origins.first);switch(this.side){case Tt.top:this.open&&t.y>100?this.open=!1:!this.open&&t.y<-100&&(this.open=!0);break;case Tt.bottom:this.open&&t.y<-100?this.open=!1:!this.open&&t.y>100&&(this.open=!0);break;case Tt.left:this.open&&t.x>100?this.open=!1:!this.open&&t.x<-100&&(this.open=!0);break;case Tt.right:this.open&&t.x<-100?this.open=!1:!this.open&&t.x>100&&(this.open=!0)}return this.enableTransition(!0),this.refresh(),!0})}getOppositeSide(e=this.side){switch(e){case Tt.top:return Tt.bottom;case Tt.bottom:return Tt.top;case Tt.left:return Tt.right;case Tt.right:return Tt.left}}getAdjacentSide(e=this.side){switch(e){case Tt.top:return Tt.right;case Tt.bottom:return Tt.left;case Tt.left:return Tt.top;case Tt.right:return Tt.bottom}}refresh(){this.hideOverflow&&_t(this.panel).setStyle("position","absolute",!0),this.icon instanceof ks&&this.icon.switchReifect.apply(this.open?this.getOppositeSide():this.side),requestAnimationFrame(()=>{this.translation=(this.open?this.offset.open:this.offset.closed)+(this.open?this.isVertical?this.panel.offsetHeight:this.panel.offsetWidth:0),this.hideOverflow&&_t(this.panel).setStyle("position","relative",!0)})}enableTransition(e){this.transition.enabled=e,this.transition.apply()}setupResizeObserver(){let e=0,t=!0;_t(this).on("transitionstart",()=>e++).on("transitionend",()=>{e--,t=!1}),_t(this.panelContainer).on("transitionstart",()=>e++).on("transitionend",()=>e--),this.resizeObserver=new ResizeObserver(s=>{if(!this.open||this.dragging||e>0||t)return;const i=(Array.isArray(s[0].borderBoxSize)?s[0].borderBoxSize[0]:s[0].borderBoxSize)[this.isVertical?"blockSize":"inlineSize"];this.translation=(this.open?this.offset.open:this.offset.closed)+i})}constructor(){super(...arguments),t(this,S)}},i})();function Ns(e){return e.tag||(e.tag="turbo-drawer"),T({...e,text:void 0})}var zs;!function(e){e.invert="invert",e.offset="offset",e.none="none"}(zs||(zs={}));as("#turbo-popup-parent-element{display:block;left:0;position:fixed;top:0;z-index:1000}.turbo-popup{display:block;inset:auto;overflow:auto;position:fixed}");let Ks=(()=>{let s,i,n,a,r,o,l,c,h,u,d,f,p,m,y=[Ut("turbo-popup")],b=[],v=os,k=[],S=[],E=[],w=[],C=[];var O=class extends v{static{i=this}static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(v[Symbol.metadata]??null):void 0;n=[g({defaultValue:A({parent:document.body,id:"turbo-popup-parent-element"})})],a=[g({defaultValue:document.body})],r=[g({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupAnchor",{x:50,y:0})},preprocessValue:e=>new Ze(e).bound(0,100)})],o=[g({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultAnchorPosition",{x:50,y:100})},preprocessValue:e=>new Ze(e).bound(0,100)})],l=[g({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultViewportMargin",0)},preprocessValue:e=>new Ze(e)})],c=[g({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultOffsetFromAnchor",0)},preprocessValue:e=>new Ze(e)})],h=[g({preprocessValue:e=>"object"!=typeof e?{x:e,y:e}:e,initialValueCallback:function(){return{x:Math.abs(this.anchorPosition.x-50)>25?zs.invert:zs.offset,y:Math.abs(this.anchorPosition.y-50)>25?zs.invert:zs.offset}}})],u=[Ft({clearOnNextFrame:!0})],d=[Ft({clearOnNextFrame:!0})],f=[Ft({clearOnNextFrame:!0})],p=[Ft({clearOnNextFrame:!0})],m=[Ft({clearOnNextFrame:!0})],e(this,null,r,{kind:"setter",name:"popupPosition",static:!1,private:!1,access:{has:e=>"popupPosition"in e,set:(e,t)=>{e.popupPosition=t}},metadata:t},null,k),e(this,null,o,{kind:"setter",name:"anchorPosition",static:!1,private:!1,access:{has:e=>"anchorPosition"in e,set:(e,t)=>{e.anchorPosition=t}},metadata:t},null,k),e(this,null,l,{kind:"setter",name:"viewportMargin",static:!1,private:!1,access:{has:e=>"viewportMargin"in e,set:(e,t)=>{e.viewportMargin=t}},metadata:t},null,k),e(this,null,c,{kind:"setter",name:"offsetFromAnchor",static:!1,private:!1,access:{has:e=>"offsetFromAnchor"in e,set:(e,t)=>{e.offsetFromAnchor=t}},metadata:t},null,k),e(this,null,h,{kind:"setter",name:"fallbackModes",static:!1,private:!1,access:{has:e=>"fallbackModes"in e,set:(e,t)=>{e.fallbackModes=t}},metadata:t},null,k),e(this,null,u,{kind:"getter",name:"rect",static:!1,private:!1,access:{has:e=>"rect"in e,get:e=>e.rect},metadata:t},null,k),e(this,null,d,{kind:"getter",name:"anchorRect",static:!1,private:!1,access:{has:e=>"anchorRect"in e,get:e=>e.anchorRect},metadata:t},null,k),e(this,null,f,{kind:"getter",name:"computedStyle",static:!1,private:!1,access:{has:e=>"computedStyle"in e,get:e=>e.computedStyle},metadata:t},null,k),e(this,null,p,{kind:"getter",name:"anchorComputedStyle",static:!1,private:!1,access:{has:e=>"anchorComputedStyle"in e,get:e=>e.anchorComputedStyle},metadata:t},null,k),e(this,null,m,{kind:"getter",name:"computedMargins",static:!1,private:!1,access:{has:e=>"computedMargins"in e,get:e=>e.computedMargins},metadata:t},null,k),e(null,null,n,{kind:"field",name:"parentElement",static:!0,private:!1,access:{has:e=>"parentElement"in e,get:e=>e.parentElement,set:(e,t)=>{e.parentElement=t}},metadata:t},S,E),e(null,null,a,{kind:"field",name:"anchor",static:!1,private:!1,access:{has:e=>"anchor"in e,get:e=>e.anchor,set:(e,t)=>{e.anchor=t}},metadata:t},w,C),e(null,s={value:i},y,{kind:"class",name:i.name,metadata:t},null,b),O=i=s.value,t&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static config={...os.config,defaultPopupPosition:{x:0,y:-100},defaultAnchorPosition:{x:0,y:100},defaultViewportMargin:4,defaultOffsetFromAnchor:{x:0,y:4}};static parentElement=t(i,S,void 0);anchor=(t(this,k),t(this,w,void 0));set popupPosition(e){}get popupPosition(){}set anchorPosition(e){}get anchorPosition(){}set viewportMargin(e){}get viewportMargin(){}set offsetFromAnchor(e){}get offsetFromAnchor(){}set fallbackModes(e){}get fallbackModes(){}get rect(){return this.getBoundingClientRect()}get anchorRect(){return this.anchor.getBoundingClientRect()}get computedStyle(){return window.getComputedStyle(this)}get anchorComputedStyle(){return window.getComputedStyle(this.anchor)}get computedMargins(){return{x:parseFloat(this.computedStyle.marginLeft)+parseFloat(this.computedStyle.marginRight),y:parseFloat(this.computedStyle.marginTop)+parseFloat(this.computedStyle.marginBottom)}}initialize(){super.initialize(),this.show(!1),this.parentElement||_t(this).addToParent(O.parentElement)}setupUIListeners(){super.setupUIListeners(),document.addEventListener(xe.scroll,()=>this.show(!1),{capture:!0,passive:!0}),window.addEventListener(xe.resize,()=>{_t(this).isShown&&this.recomputePosition()},{passive:!0}),_t(document.body).on(xe.click,e=>{if(!_t(this).isShown)return;const t=e.target;this.contains(t)||this.anchor instanceof Node&&this.anchor.contains(t)||this.show(!1)},{capture:!0})}recomputePosition(){if(!this.anchor)return;_t(this).setStyles({maxHeight:"",maxWidth:""},!0);const e=this.computeAxis(wt.horizontal),t=this.computeAxis(wt.vertical);_t(this).setStyles({left:`${e}px`,top:`${t}px`});const s=Math.max(0,Math.min(window.innerWidth-2*this.viewportMargin.x,window.innerWidth-2*this.viewportMargin.x-this.computedMargins.x)),i=Math.max(0,Math.min(window.innerHeight-2*this.viewportMargin.y,window.innerHeight-2*this.viewportMargin.y-this.computedMargins.y));_t(this).setStyle("maxWidth",`${s}px`),_t(this).setStyle("maxHeight",`${i}px`)}computeAxis(e){const t=e===wt.horizontal?"x":"y",s=e===wt.horizontal?"width":"height",i=e===wt.horizontal?window.innerWidth:window.innerHeight,n=this.anchorRect[e===wt.horizontal?"left":"top"],a=this.rect[s]+this.computedMargins[t],r=this.viewportMargin[t],o=i-this.viewportMargin[t]-a,l=n+this.anchorRect[s]*this.anchorPosition[t]/100-a*this.popupPosition[t]/100+this.offsetFromAnchor[t],c=l>=r&&l<=o;if(c||this.fallbackModes[t]===zs.offset)return Math.min(Math.max(l,r),o);const h=n+this.anchorRect[s]*(1-this.anchorPosition[t]/100)-a*(1-this.popupPosition[t]/100)-this.offsetFromAnchor[t];let u;if(h>=r&&h<=o)u=h;else if(c)u=l;else{const e=Math.abs(l-Math.min(Math.max(l,r),o))<=Math.abs(h-Math.min(Math.max(h,r),o))?l:h;u=Math.min(Math.max(e,r),o)}return u}show(e){return e?(this.style.visibility="hidden",this.style.display="",this.recomputePosition(),this.style.visibility="",_t(this).show(!0)):_t(this).setStyles({maxHeight:"",maxWidth:""},!0).show(!1),this}constructor(){super(...arguments),t(this,C)}static{t(i,E),t(i,b)}};return O=i})();function Ls(e={}){return T({...e,text:void 0,tag:"turbo-popup"})}let Fs=(()=>{let o,c=me,h=[];return class extends c{static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;o=[g({override:!0})],e(this,null,o,{kind:"setter",name:"enabledCallbacks",static:!1,private:!1,access:{has:e=>"enabledCallbacks"in e,set:(e,t)=>{e.enabledCallbacks=t}},metadata:t},null,h),t&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}observer=(t(this,h),(e,t)=>this.observeChanges(e,t));set enabledCallbacks(e){this.data&&this.data instanceof s&&(e?this.data.observe(this.observer):this.data.unobserve(this.observer))}get(e){if(this.data&&"object"==typeof this.data)return this.data instanceof i?this.data.get(e.toString()):this.data instanceof n?this.data.get(yt(Number(e),this.data.length)):super.get(e)}set(e,t){if(this.data&&"object"==typeof this.data)if(this.data instanceof i)this.data.set(e.toString(),t);else if(this.data instanceof n){const s=yt(Number(e),this.data.length+1);s<this.data.length&&this.data.delete(s,1),this.data.insert(s,[t])}else super.set(e,t)}add(e,t){if(this.data instanceof n){let s=t;return l(s)||"number"!=typeof s||s>this.data.length?(s=this.data.length,this.data.push([e])):(s<0&&(s=0),this.data.insert(s,[e])),s}return this.data instanceof s?this.set(t,e):super.add(e,t)}has(e){return!(!this.data||"object"!=typeof this.data)&&(this.data instanceof i?this.data.has(e.toString()):this.data instanceof n?"number"==typeof e&&e>=0&&e<this.size:super.has(e))}delete(e){this.data&&"object"==typeof this.data&&(this.data instanceof i?this.data.delete(e.toString()):this.data instanceof n&&"number"==typeof e&&e>=0&&e<this.size?this.data.delete(e,1):super.delete(e))}get keys(){if(this.data instanceof i)return Array.from(this.data.keys());if(this.data instanceof n){const e=[];for(let t=0;t<this.data.length;t++)e.push(t);return e}return super.keys}get size(){return this.data instanceof i?this.data.size:this.data instanceof n?this.data.length:0}initialize(){super.initialize(),this.enabledCallbacks&&this.data instanceof s&&this.data?.observe(this.observer)}clear(e=!0){e&&this.data instanceof s&&this.data?.unobserve(this.observer),super.clear(e)}observeChanges(e,t){if(e instanceof a)e.keysChanged.forEach(t=>{const s=e.changes.keys.get(t);s&&("delete"===s.action?this.keyChanged(t,void 0,!0):this.keyChanged(t))});else if(e instanceof r){let t=0;for(const s of e.delta)if(void 0!==s.retain)t+=s.retain;else if(s.insert){const e=(Array.isArray(s.insert)?s.insert:[s.insert]).length;this.shiftIndices(t,e);for(let s=0;s<e;s++)this.keyChanged(t+s);t+=e}else if(s.delete){const e=s.delete;for(let s=0;s<e;s++)this.keyChanged(t+s,void 0,!0);this.shiftIndices(t+e,-e)}}}shiftIndices(e,t){this.changeObservers?.toArray().forEach(s=>{const i=[];for(const[t,n]of s.getBlockInstancesAndKeys()){const s=Number(t);s>=e&&i.push([s,n])}i.sort((e,t)=>e[0]-t[0]);for(const[e]of i)s.removeInstanceByKey(e,!1);for(const[e,n]of i){const i=e+t;"object"==typeof n&&"dataId"in n&&(n.dataId=i),s.setInstance(n,e+t)}})}}})();as("turbo-dropdown{display:inline-block;position:relative}turbo-dropdown>.turbo-popup{background-color:#fff;border:.1em solid #5e5e5e;border-radius:.4em;display:flex;flex-direction:column;overflow:hidden}turbo-dropdown>.turbo-popup>turbo-select-entry{padding:.5em}turbo-dropdown>.turbo-popup>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}turbo-dropdown>turbo-select-entry{padding:.5em .7em;width:100%}turbo-dropdown>turbo-select-entry:hover{background-color:#d7d7d7}turbo-dropdown>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}");let Rs=(()=>{let s,i,n,a,r,o,l,c,h,u,d,f,p,m,y,b=[Ut("turbo-dropdown")],v=[],k=os,S=[],E=[],w=[],C=[],O=[],T=[],P=[],x=[],D=[],A=[],M=[],I=[],j=[],B=[],V=[],_=[],N=[],z=[],K=[],L=[],F=[],R=[],W=[];return class extends k{static{i=this}static{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(k[Symbol.metadata]??null):void 0;n=[g({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorTag")}})],a=[g({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorClasses")},callBefore:function(){_t(this.selector).removeClass(this.selectorClasses)},callAfter:function(){_t(this.selector).addClass(this.selectorClasses)}})],r=[g({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupClasses")},callBefore:function(){_t(this.popup).removeClass(this.popupClasses)},callAfter:function(){_t(this.popup).addClass(this.popupClasses)}})],o=[$t("select")],l=[$t("select")],c=[$t("select",!1)],h=[$t("select",!1)],u=[$t("select",!1)],d=[$t("select",!1)],f=[$t("select",!1)],p=[$t("select",!1)],m=[g({setIfUndefined:!0,preprocessValue:function(e){if(e instanceof HTMLElement)return e;const t="string"==typeof e?e:De(this.select.getValue(this.entries[0]));if(!(this.selector instanceof bs))return vs({text:t,elementTag:this.selectorTag});this.selector.text=t}})],y=[g({defaultValueCallback:()=>Ls()})],e(this,null,c,{kind:"accessor",name:"selectedEntry",static:!1,private:!1,access:{has:e=>"selectedEntry"in e,get:e=>e.selectedEntry,set:(e,t)=>{e.selectedEntry=t}},metadata:t},I,j),e(this,null,h,{kind:"accessor",name:"selectedValue",static:!1,private:!1,access:{has:e=>"selectedValue"in e,get:e=>e.selectedValue,set:(e,t)=>{e.selectedValue=t}},metadata:t},B,V),e(this,null,u,{kind:"accessor",name:"selectedValues",static:!1,private:!1,access:{has:e=>"selectedValues"in e,get:e=>e.selectedValues,set:(e,t)=>{e.selectedValues=t}},metadata:t},_,N),e(this,null,d,{kind:"accessor",name:"selectedSecondaryValues",static:!1,private:!1,access:{has:e=>"selectedSecondaryValues"in e,get:e=>e.selectedSecondaryValues,set:(e,t)=>{e.selectedSecondaryValues=t}},metadata:t},z,K),e(this,null,f,{kind:"accessor",name:"selectedSecondaryValue",static:!1,private:!1,access:{has:e=>"selectedSecondaryValue"in e,get:e=>e.selectedSecondaryValue,set:(e,t)=>{e.selectedSecondaryValue=t}},metadata:t},L,F),e(this,null,p,{kind:"accessor",name:"stringSelectedValue",static:!1,private:!1,access:{has:e=>"stringSelectedValue"in e,get:e=>e.stringSelectedValue,set:(e,t)=>{e.stringSelectedValue=t}},metadata:t},R,W),e(this,null,m,{kind:"setter",name:"selector",static:!1,private:!1,access:{has:e=>"selector"in e,set:(e,t)=>{e.selector=t}},metadata:t},null,S),e(this,null,y,{kind:"setter",name:"popup",static:!1,private:!1,access:{has:e=>"popup"in e,set:(e,t)=>{e.popup=t}},metadata:t},null,S),e(null,null,n,{kind:"field",name:"selectorTag",static:!1,private:!1,access:{has:e=>"selectorTag"in e,get:e=>e.selectorTag,set:(e,t)=>{e.selectorTag=t}},metadata:t},E,w),e(null,null,a,{kind:"field",name:"selectorClasses",static:!1,private:!1,access:{has:e=>"selectorClasses"in e,get:e=>e.selectorClasses,set:(e,t)=>{e.selectorClasses=t}},metadata:t},C,O),e(null,null,r,{kind:"field",name:"popupClasses",static:!1,private:!1,access:{has:e=>"popupClasses"in e,get:e=>e.popupClasses,set:(e,t)=>{e.popupClasses=t}},metadata:t},T,P),e(null,null,o,{kind:"field",name:"entries",static:!1,private:!1,access:{has:e=>"entries"in e,get:e=>e.entries,set:(e,t)=>{e.entries=t}},metadata:t},x,D),e(null,null,l,{kind:"field",name:"values",static:!1,private:!1,access:{has:e=>"values"in e,get:e=>e.values,set:(e,t)=>{e.values=t}},metadata:t},A,M),e(null,s={value:i},b,{kind:"class",name:i.name,metadata:t},null,v),i=s.value,t&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})}static config={...os.config,defaultSelectorTag:"h4"};select=(t(this,S),new Vs({onEntryClicked:()=>this.openPopup(!1)}));popupOpen=!1;selectorTag=t(this,E,void 0);selectorClasses=(t(this,w),t(this,C,void 0));popupClasses=(t(this,O),t(this,T,void 0));entries=(t(this,P),t(this,x,void 0));values=(t(this,D),t(this,A,void 0));#i=(t(this,M),t(this,I,void 0));get selectedEntry(){return this.#i}set selectedEntry(e){this.#i=e}#n=(t(this,j),t(this,B,void 0));get selectedValue(){return this.#n}set selectedValue(e){this.#n=e}#a=(t(this,V),t(this,_,void 0));get selectedValues(){return this.#a}set selectedValues(e){this.#a=e}#r=(t(this,N),t(this,z,void 0));get selectedSecondaryValues(){return this.#r}set selectedSecondaryValues(e){this.#r=e}#o=(t(this,K),t(this,L,void 0));get selectedSecondaryValue(){return this.#o}set selectedSecondaryValue(e){this.#o=e}#l=(t(this,F),t(this,R,void 0));get stringSelectedValue(){return this.#l}set stringSelectedValue(e){this.#l=e}set selector(e){e instanceof HTMLElement&&(_t(e).addClass(this.selectorClasses).on(xe.click,e=>(this.openPopup(!this.popupOpen),!0)),this.popup instanceof Ks&&(this.popup.anchor=e),_t(this).addChild(e),e instanceof bs&&(this.select.onSelect=()=>e.text=this.stringSelectedValue))}get selector(){}set popup(e){e instanceof Ks&&(e.anchor=this.selector),_t(e).addClass(this.popupClasses),this.select.parent=e}initialize(){super.initialize(),this.selector,_t(document.body).on(xe.click,()=>e=>{this.popupOpen&&!this.contains(e.target)&&this.openPopup(!1)},{capture:!0})}openPopup(e){this.popupOpen!=e&&(this.popupOpen=e,"show"in this.popup&&"function"==typeof this.popup.show?this.popup.show(e):_t(this.popup).show(e))}constructor(){super(...arguments),t(this,W)}static{t(i,v)}},i})();function Ws(e={}){return e.tag||(e.tag="turbo-dropdown"),T({...e,text:void 0})}let Hs=(()=>{let s,i,n,a,r=[Ut("turbo-marking-menu")],o=[],l=os,c=[],h=[],u=[],d=[];return class extends l{static{i=this}static{const f="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;n=[g({initialValue:0,preprocessValue:e=>e-Math.PI/2})],a=[g({initialValue:2*Math.PI,preprocessValue:e=>e-Math.PI/2})],e(null,null,n,{kind:"field",name:"startAngle",static:!1,private:!1,access:{has:e=>"startAngle"in e,get:e=>e.startAngle,set:(e,t)=>{e.startAngle=t}},metadata:f},c,h),e(null,null,a,{kind:"field",name:"endAngle",static:!1,private:!1,access:{has:e=>"endAngle"in e,get:e=>e.endAngle,set:(e,t)=>{e.endAngle=t}},metadata:f},u,d),e(null,s={value:i},r,{kind:"class",name:i.name,metadata:f},null,o),i=s.value,f&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f}),t(i,o)}transition;currentOrigin;minDragDistance=20;semiMajor=50;semiMinor=45;startAngle=t(this,c,void 0);endAngle=(t(this,h),t(this,u,void 0));constructor(){super(...arguments),t(this,d)}},i})();function Us(e,t,s,i,n,a=!0){if(a){const i=Math.max(t,s),n=Math.min(t,s);e>i&&(e=i),e<n&&(e=n)}return i+(e-t)*(n-i)/(s-t)}let $s=(()=>{let s,i,n,a,r,o,l,c,h,u,d,f,p=[Ut("turbo-select-wheel")],m=[],y=os,b=[],v=[],k=[],S=[],E=[],w=[],C=[],O=[],T=[],P=[],x=[];return class extends y{static{i=this}static{const D="function"==typeof Symbol&&Symbol.metadata?Object.create(y[Symbol.metadata]??null):void 0;n=[$t("selector")],a=[$t("selector")],r=[$t("selector",!1)],o=[$t("selector",!1)],l=[g({defaultValue:{max:1,min:0},preprocessValue:e=>({max:yt(e?.max,1),min:yt(e?.min,1)})})],c=[g({preprocessValue:e=>"object"==typeof e?e:{max:e??100,min:-(e??100)}})],h=[g({preprocessValue:function(e){return e instanceof St?e:(e||(e={}),e.transitionProperties||(e.transitionProperties="opacity transform"),null==e.transitionDuration&&(e.transitionDuration=.2),e.transitionTimingFunction||(e.transitionTimingFunction="ease-in-out"),new St(e))}})],u=[g({defaultValue:!1})],d=[g({cancelIfUnchanged:!1})],f=[g()],e(this,null,n,{kind:"accessor",name:"entries",static:!1,private:!1,access:{has:e=>"entries"in e,get:e=>e.entries,set:(e,t)=>{e.entries=t}},metadata:D},v,k),e(this,null,a,{kind:"accessor",name:"values",static:!1,private:!1,access:{has:e=>"values"in e,get:e=>e.values,set:(e,t)=>{e.values=t}},metadata:D},S,E),e(this,null,r,{kind:"accessor",name:"selectedEntry",static:!1,private:!1,access:{has:e=>"selectedEntry"in e,get:e=>e.selectedEntry,set:(e,t)=>{e.selectedEntry=t}},metadata:D},w,C),e(this,null,o,{kind:"accessor",name:"selectedValue",static:!1,private:!1,access:{has:e=>"selectedValue"in e,get:e=>e.selectedValue,set:(e,t)=>{e.selectedValue=t}},metadata:D},O,T),e(this,null,c,{kind:"setter",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,set:(e,t)=>{e.size=t}},metadata:D},null,b),e(this,null,h,{kind:"getter",name:"reifect",static:!1,private:!1,access:{has:e=>"reifect"in e,get:e=>e.reifect},metadata:D},null,b),e(this,null,u,{kind:"setter",name:"alwaysOpen",static:!1,private:!1,access:{has:e=>"alwaysOpen"in e,set:(e,t)=>{e.alwaysOpen=t}},metadata:D},null,b),e(this,null,d,{kind:"setter",name:"index",static:!1,private:!1,access:{has:e=>"index"in e,set:(e,t)=>{e.index=t}},metadata:D},null,b),e(this,null,f,{kind:"setter",name:"open",static:!1,private:!1,access:{has:e=>"open"in e,set:(e,t)=>{e.open=t}},metadata:D},null,b),e(null,null,l,{kind:"field",name:"opacity",static:!1,private:!1,access:{has:e=>"opacity"in e,get:e=>e.opacity,set:(e,t)=>{e.opacity=t}},metadata:D},P,x),e(null,s={value:i},p,{kind:"class",name:i.name,metadata:D},null,m),i=s.value,D&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:D}),t(i,m)}selector=t(this,b);#c=t(this,v,void 0);get entries(){return this.#c}set entries(e){this.#c=e}#h=(t(this,k),t(this,S,void 0));get values(){return this.#h}set values(e){this.#h=e}#i=(t(this,E),t(this,w,void 0));get selectedEntry(){return this.#i}set selectedEntry(e){this.#i=e}#n=(t(this,C),t(this,O,void 0));get selectedValue(){return this.#n}set selectedValue(e){this.#n=e}_currentPosition=(t(this,T),0);sizePerEntry=[];positionPerEntry=[];totalSize=0;dragLimitOffset=30;openTimeout=3e3;direction=wt.horizontal;scale={max:1,min:.5};generateCustomStyling;dragging;openTimer;initialize(){this.selector=new Vs,this.selector.multiSelection=!1,this.selector.forceSelection=!0,this.selector.onSelectDelegate.add(e=>{e&&(this.open=!0,this.alwaysOpen||this.setOpenTimer())}),this.selector.onEntryRemoved.add(e=>this.reifect?.detach(e)),this.selector.onEntryAdded.add(e=>{let t;e instanceof Element&&e.parentElement&&(this.reifect?.attach(e),this.reloadEntrySizes()),_t(e).setStyles({position:"absolute"}).on(xe.dragStart,e=>{e.stopImmediatePropagation(),this.clearOpenTimer(),this.open=!0,this.dragging=!0,this.reifect.enabled.transition=!1,this.reloadEntrySizes()}).on("pointerover",()=>{clearTimeout(t),t=setTimeout(()=>this.open=!0,1e3)}).on("pointerout",()=>{t&&clearTimeout(t),t=null}),this.refresh()}),super.initialize(),this.refresh(),_t(this).setStyles({display:"block",position:"relative"})}opacity=t(this,P,void 0);set size(e){}get size(){}get reifect(){}set reifect(e){this.reifect.attachAll(...this.entries)}closeOnClick=(t(this,x),()=>this.open=!1);set alwaysOpen(e){e?_t(document.body).removeListener(xe.click,this.closeOnClick):_t(document.body).on(xe.click,this.closeOnClick),this.open=e}get isVertical(){return this.direction==wt.vertical}set index(e){this.selector.selectByIndex(this.trimmedIndex)}get trimmedIndex(){return yt(Math.round(this.index),this.entries.length-1)}get flooredTrimmedIndex(){return yt(Math.floor(this.index),this.entries.length-1)}set open(e){_t(this).setStyle("overflow",e?"visible":"hidden")}get currentPosition(){return this._currentPosition}set currentPosition(e){const t=-this.dragLimitOffset-this.sizePerEntry[0]/2,s=this.totalSize+this.dragLimitOffset-this.sizePerEntry[this.sizePerEntry.length-1]/2;e<t&&(e=t),e>s&&(e=s),this._currentPosition=e;const i=this.reifect.getEnabledObjectsData();0!==i.length&&i.forEach((t,s)=>this.computeAndApplyStyling(t.object.deref(),this.positionPerEntry[s]-e))}setupUIListeners(){super.setupUIListeners(),_t(document.body).on(xe.drag,e=>{this.dragging&&(e.stopImmediatePropagation(),this.currentPosition+=this.computeDragValue(e.scaledDeltaPosition))}).on(xe.dragEnd,e=>{this.dragging&&(e.stopImmediatePropagation(),this.dragging=!1,this.recomputeIndex(),this.alwaysOpen||this.setOpenTimer())})}computeDragValue(e){return-e[this.isVertical?"y":"x"]}reloadEntrySizes(){if(!this.reifect)return;this.sizePerEntry.length=0,this.positionPerEntry.length=0,this.totalSize=0,this.reifect.getEnabledObjectsData().forEach(e=>{const t=e.object.deref(),s=t?t[this.isVertical?"offsetHeight":"offsetWidth"]:0;this.sizePerEntry.push(s),this.positionPerEntry.push(this.totalSize),this.totalSize+=s});const e=Math.floor(this.index),t=this.index-Math.floor(this.index);this.currentPosition=0,this.index<0?this.currentPosition=-Math.abs(this.index)*this.sizePerEntry[0]:this.index>=this.sizePerEntry.length?this.currentPosition=(this.index-this.sizePerEntry.length+1)*this.sizePerEntry[this.sizePerEntry.length-1]:this.currentPosition=this.positionPerEntry[e]+this.sizePerEntry[e]*t}recomputeIndex(){let e=0;for(;e<this.positionPerEntry.length-1&&this.positionPerEntry[e+1]<this.currentPosition;)e++;this.currentPosition-this.positionPerEntry[e]>this.sizePerEntry[e+1]/2&&e++,this.index=e}computeAndApplyStyling(e,t,s=this.size){let i,n;const a=t>0?s.max:s.min;i=Us(t,0,a,this.opacity.max,this.opacity.min),n=Us(t,0,a,this.scale.max,this.scale.min);let r={left:"50%",top:"50%",opacity:i,transform:`translate3d(\n            calc(${this.isVertical?0:t}px - 50%),\n            calc(${this.isVertical?t:0}px - 50%),\n            0) scale3d(${n}, ${n}, 1)`};this.generateCustomStyling&&(r=this.generateCustomStyling({element:e,translationValue:t,opacityValue:i,scaleValue:n,size:s,defaultComputedStyles:r})),Kt(e).setStyles(r)}select(e,t=!0){if(null==e)return this;const s=this.selector.getIndex(this.selectedEntry);s!=this.index&&(this.index=s),this.reifect&&(this.reifect.enabled.transition=!0,this.reloadEntrySizes());const i=getComputedStyle(this.selectedEntry);return Kt(this).setStyles({minWidth:i.width,minHeight:i.height},!0),this}clear(){this.reifect.detach(...this.entries),this.selector.clear()}refresh(){this.selectedEntry?this.select(this.selectedEntry):this.reset()}reset(){this.select(this.entries[0])}clearOpenTimer(){this.openTimer&&clearTimeout(this.openTimer)}setOpenTimer(){this.clearOpenTimer(),"number"!=typeof this.openTimeout||this.openTimeout<0||(this.openTimer=setTimeout(()=>this.open=!1,this.openTimeout))}},i})();function Gs(e){return _t(e).applyDefaults({tag:"turbo-select-wheel"}),T({...e})}class qs{static config={shadowDOM:!1,defaultSelectedClass:"selected"};static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}element;mvc=new q({element:this});constructor(e={}){this.element=P(e)}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}async function Ys(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(s)).map(e=>e.toString(16).padStart(2,"0")).join("")}async function Js(e,t=12){const s=Math.ceil(6*t/8),i=new TextEncoder,n=await crypto.subtle.digest("SHA-256",i.encode(e)),a=new Uint8Array(n).slice(0,s);return("function"==typeof btoa?btoa(String.fromCharCode(...a)):Buffer.from(a).toString("base64")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"").slice(0,t)}function Xs(e){const t=new i;for(const[s,i]of Object.entries(e))t.set(s,i);return t}function Qs(e){const t=new n;return t.push(e),t}async function Zs(e,t,s){const i=async()=>await Js(t?.doc?.clientID?.toString(32)+Cs());if(!s)for(s=await i();void 0!==t?.get(s);)s=await i();return t.set(s,e),s}function ei(e,t,s){return null==s||s>t.length?(s=t.length,t.push([e])):(s<0&&(s=0),t.insert(s,[e])),s}function ti(e,t){for(const[s,i]of t.toArray())if(e==i)return t.delete(s),!0;return!1}function si(e,t,...s){if(!e)return;const n=new Set(s);e.observeDeep(e=>{for(const s of e){const e=s.target,o=e._item?.parent,l=e._item?.parentSub;for(const c of n)if(s instanceof a&&s.changes.keys.has(c)||s instanceof r&&o instanceof i&&l===c||s.path?.some(e=>e===c))return void t(c,s,e)}})}function ii(e,t,...s){if(!e)return;const n=new Set(s);e.observeDeep(e=>{const s=new Set;for(const o of e){const e=o.target,l=e._item?.parent,c=e._item?.parentSub;for(const e of n)(o instanceof a&&o.changes.keys.has(e)||o instanceof r&&l instanceof i&&c===e||o.path?.some(t=>t===e))&&s.add(e);if(s.size===n.size)return void t(o,e)}})}function ni(e){return e instanceof qe?e.scaledPosition:e instanceof PointerEvent?new Ze(e.clientX,e.clientY):void 0}function ai(e){if(!e)return NaN;const t=parseInt(e.substring(1),16);return.2126*((t>>16&255)/255)+.7152*((t>>8&255)/255)+.0722*((255&t)/255)}function ri(e,t){if(!e||!t)return NaN;const s=ai(e),i=ai(t);return(Math.max(s,i)+.1)/(Math.min(s,i)+.1)}function oi(e,t="#000000",s="#FFFFFF"){return ri(e,s)>ri(t,e)?s:t}function li(e,...t){let s="";return e.forEach((e,i)=>{s+=e+(t[i]||"")}),s}ot(qs),rt(qs),rs(qs);const ci={900:{Black:"normal",BlackItalic:"italic"},800:{ExtraBold:"normal",ExtraBoldItalic:"italic"},700:{Bold:"normal",BoldItalic:"italic"},600:{SemiBold:"normal",SemiBoldItalic:"italic"},500:{Medium:"normal",MediumItalic:"italic"},400:{Regular:"normal",Italic:"italic"},300:{Light:"normal",LightItalic:"italic"},200:{ExtraLight:"normal",ExtraLightItalic:"italic"},100:{Thin:"normal",ThinItalic:"italic"}};function hi(e,t,s,i,n){return li`
        @font-face {
            font-family: "${e}";
            src: url("${t}") format("${s}"), 
            url("${t}") format("woff"),
            url("${t}") format("truetype");
            font-weight: ${"string"==typeof i?'"'+i+'"':i};
            font-style: "${n}";
        }`}function ui(e){e.name&&e.pathOrDirectory||console.error("Please specify font name and path/directory");const t=0==Me(e.pathOrDirectory).length;e.stylesPerWeights||(e.stylesPerWeights=t?ci:{normal:"normal"}),e.format||(e.format="woff2"),e.extension||(e.extension=".ttf"),"."!=e.extension[0]&&(e.extension="."+e.extension),$(Object.entries(e.stylesPerWeights).map(([t,s])=>{const i=Number.parseInt(t),n=i||t;return"string"==typeof s?hi(e.name,e.pathOrDirectory,e.format,n,s):Object.entries(s).map(([t,s])=>hi(e.name,`${e.pathOrDirectory}/${e.name}-${t}${e.extension}`,e.format,n,s)).join("\n")}).join("\n"))}export{Kt as $,Mt as AccessLevel,_e as ActionMode,v as ApplyDefaultsMergeProperties,Be as BasicInputEvents,Ne as ClickMode,Ge as ClosestOrigin,pe as DataBlockObserver,ke as DefaultClickEventName,Ce as DefaultDragEventName,xe as DefaultEventName,be as DefaultKeyEventName,Ee as DefaultMoveEventName,Te as DefaultWheelEventName,de as Delegate,wt as Direction,Pt as InOut,ze as InputDevice,w as MathMLNamespace,C as MathMLTags,q as Mvc,Ve as NonPassiveEvents,xt as OnOff,Dt as Open,Ze as Point,zs as PopupFallbackMode,It as Range,St as Reifect,At as Shown,Tt as Side,Ct as SideH,Ot as SideV,vt as StatefulReifect,S as SvgNamespace,E as SvgTags,Bs as TurboBaseElement,bs as TurboButton,ve as TurboClickEventName,Je as TurboController,me as TurboDataBlock,tt as TurboDragEvent,we as TurboDragEventName,_s as TurboDrawer,Rs as TurboDropdown,os as TurboElement,G as TurboEmitter,qe as TurboEvent,ct as TurboEventManager,Pe as TurboEventName,nt as TurboHandler,lt as TurboHeadlessElement,ps as TurboIcon,ks as TurboIconSwitch,Es as TurboIconToggle,Ds as TurboInput,ss as TurboInteractor,Ye as TurboKeyEvent,ye as TurboKeyEventName,Ue as TurboMap,Hs as TurboMarkingMenu,ge as TurboModel,Se as TurboMoveEventName,Ms as TurboNumericalInput,fe as TurboObserver,Ks as TurboPopup,qs as TurboProxiedElement,gs as TurboRichElement,Vs as TurboSelect,js as TurboSelectInputEvent,$s as TurboSelectWheel,y as TurboSelector,is as TurboSubstrate,ns as TurboTool,ts as TurboView,he as TurboWeakSet,Qe as TurboWheelEvent,Oe as TurboWheelEventName,Fs as TurboYBlock,x as a,ei as addInYArray,Zs as addInYMap,c as alphabeticalSorting,ls as areEqual,g as auto,oi as bestOverlayColor,P as blindElement,te as blockDataSignal,se as blockIdSignal,ee as blockSignal,vs as button,Ft as cache,mt as callOnce,gt as callOncePerInstance,Ie as camelToKebabCase,D as canvas,Rt as clearCache,Wt as clearCacheEntry,ri as contrast,Le as controller,ds as createProxy,Qs as createYArray,Xs as createYMap,li as css,ii as deepObserveAll,si as deepObserveAny,Ut as define,le as disposeEffect,ce as disposeEffects,A as div,Ns as drawer,Ws as dropdown,hs as eachEqualToAny,ie as effect,T as element,cs as equalToAny,$t as expose,fs as fetchSvg,Jt as flexCol,Xt as flexColCenter,Qt as flexRow,Zt as flexRowCenter,M as form,O as generateTagFunction,ni as getEventPosition,Me as getFileExtension,h as getFirstDescriptorInChain,d as getFirstPrototypeInChainWith,ne as getSignal,p as getSuperDescriptor,f as getSuperMethod,I as h1,j as h2,B as h3,V as h4,_ as h5,N as h6,Fe as handler,u as hasPropertyInChain,Js as hashBySize,Ys as hashString,ms as icon,Ss as iconSwitch,ws as iconToggle,z as img,oe as initializeEffects,K as input,Re as interactor,o as isNull,l as isUndefined,je as kebabToCamelCase,Us as linearInterpolation,L as link,ui as loadLocalFont,ai as luminance,re as markDirty,bt as mod,Z as modelSignal,Is as numericalInput,qt as observe,F as p,Ae as parse,Ls as popup,Ts as randomColor,Os as randomFromRange,Cs as randomId,Ps as randomString,Et as reifect,ti as removeFromYArray,ys as richElement,Gs as selectWheel,ae as setSignal,Q as signal,Yt as solver,es as spacer,R as span,kt as statefulReifier,De as stringify,W as style,$ as stylesheet,He as substrate,zt as t,us as textToElement,H as textarea,We as tool,yt as trim,Nt as tu,_t as turbo,As as turboInput,Lt as turbofy,U as video};
