import{__esDecorate as t,__runInitializers as e}from"tslib";import{AbstractType as s,Map as i,Array as n,YMapEvent as a,YArrayEvent as r}from"yjs";export{AbstractType as YAbstractType,Array as YArray,YArrayEvent,Doc as YDoc,YEvent,Map as YMap,YMapEvent,Text as YText}from"yjs";function o(t,e){let s=t;for(;s&&s!==HTMLElement.prototype;){const t=Object.getOwnPropertyDescriptor(s,e);if(t)return t;s=Object.getPrototypeOf(s)}}function l(t,e){let s=t;for(;s&&s!==HTMLElement.prototype;){if(Object.prototype.hasOwnProperty.call(s,e))return!0;s=Object.getPrototypeOf(s)}return!1}function c(t,e){let s=Object.getPrototypeOf(t);for(;s&&s!==HTMLElement.prototype;){if(Object.getOwnPropertyDescriptor(s,e))return s;s=Object.getPrototypeOf(s)}}function h(t,e,s){let i=Object.getPrototypeOf(t);for(;i&&i!==HTMLElement.prototype;){const t=Object.getOwnPropertyDescriptor(i,e),n=t?.value??t?.get??t?.set;if("function"==typeof n&&n!==s)return n;i=Object.getPrototypeOf(i)}}function u(t){return null==t&&null!=t}function d(t){return void 0===t}const p=new class{constructorMap=new WeakMap;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}};function f(t){return function(e,s){t||(t={});const{kind:i,name:n,static:a}=s,r=n,l=Symbol(`__auto_${r}`);s.addInitializer(function(){const s=a?this:c(this,r);let n,h;const u=function(e){t.callBefore?.call(this,e);let s=t?.preprocessValue?t.preprocessValue.call(this,e):e;(t.cancelIfUnchanged??1)&&this[l]===s||(t.executeSetterBeforeStoring&&h&&h.call(this,s),this[l]=s,!t.executeSetterBeforeStoring&&h&&h.call(this,s),t.callAfter?.call(this,s))};let f=!1;const m=function(){return n&&t?.returnDefinedGetterValue?n.call(this):this[l]},g=function(){let e=m.call(this);if(!f&&!t.returnDefinedGetterValue&&d(e)){if(f=!0,t.defaultValue)e=t.defaultValue;else if(t.defaultValueCallback)e=t.defaultValueCallback.call(this);else if(!t.setIfUndefined)return e;u.call(this,e),e=m.call(this),f=!1}return e};if(d(this[l])){let s="field"===i?e:void 0;d(s)&&(t.initialValue?s=t.initialValue:t.initialValueCallback&&(s=t.initialValueCallback.call(this))),!d(s)&&t.preprocessValue&&(s=t.preprocessValue.call(this,s)),this[l]=s}if("field"===i||"accessor"===i){const t=e;t?.get&&(n=t.get),t?.set&&(h=t.set);const s=o(this,r);Object.defineProperty(this,r,{configurable:!0,enumerable:s?.enumerable??!0,get:()=>g.call(this),set:t=>u.call(this,t)})}else if("getter"===i||"setter"===i){const t=p.constructorData(s).installed;if(t.get(r))return;t.set(r,!0);const e=o(s,r)??{};"function"==typeof e.get&&(n=e.get),"function"==typeof e.set&&(h=e.set),Object.defineProperty(s,r,{configurable:!0,enumerable:!!e?.enumerable,get:function(){return g.call(this)},set:function(t){u.call(this,t)}})}})}}class m{element;#t(){return new Proxy(this,{get(t,e,s){if(e in t)return Reflect.get(t,e,s);const i=t.element?.[e];return"function"==typeof i?i.bind(t.element):i},set:(t,e,s,i)=>e in t?Reflect.set(t,e,s,i):(t.element[e]=s,!0),has:(t,e)=>e in t||e in t.element,ownKeys:t=>Array.from([...Reflect.ownKeys(t),...Reflect.ownKeys(t.element)]),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t,e)||Object.getOwnPropertyDescriptor(t.element,e)||void 0})}constructor(){return this.#t()}}const g=new class{dataMap=new WeakMap;data(t){return t instanceof m&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}};function b(){Object.defineProperty(m.prototype,"childHandler",{set:function(t){t instanceof m&&(t=t.element),g.data(this).childHandler=t},get:function(){const t=g.data(this).childHandler;return t||(this.element instanceof Element&&this.element.shadowRoot?this.element.shadowRoot:this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(m.prototype,"childNodesArray",{get:function(){return this.element&&Array.from(this.childHandler?.childNodes)||[]},configurable:!1,enumerable:!0}),Object.defineProperty(m.prototype,"childrenArray",{get:function(){return this.childNodesArray.filter(t=>1===t.nodeType)},configurable:!1,enumerable:!0}),Object.defineProperty(m.prototype,"siblingNodes",{get:function(){const t=this.element?.parentNode;return t&&He(t).childNodesArray||[]},configurable:!1,enumerable:!0}),Object.defineProperty(m.prototype,"siblings",{get:function(){const t=this.element?.parentElement;return t&&He(t).childrenArray||[]},configurable:!1,enumerable:!0}),m.prototype.bringToFront=function(){const t=this.element?.parentNode;return t?(He(t).addChild(this.element),this):this},m.prototype.sendToBack=function(){const t=this.element?.parentNode;return t?(He(t).addChild(this.element,0),this):this},m.prototype.remove=function(){return this.element?.parentNode?.removeChild(this.element),this},m.prototype.addChild=function(t,e,s=this.childrenArray){if(!this.element||!t)return this;if(void 0!==e&&(e<0||e>s.length)&&(e=void 0),null!=e)this.addChildBefore(t,s[e]);else try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof m&&(t=t.element),this.childHandler.appendChild(t))})}catch(t){console.error(t)}return this},m.prototype.remChild=function(t){if(!this.element||!t)return this;try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof m&&(t=t.element),this.childHandler.removeChild(t))})}catch(t){console.error(t)}return this},m.prototype.addChildBefore=function(t,e){if(!this.element||!t)return this;if(!e)return this.addChild(t);try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof m&&(t=t.element),this.childHandler.insertBefore(t,e))})}catch(t){console.error(t)}return this},m.prototype.removeChildAt=function(t,e=1,s=this.childrenArray){if(!this.element||void 0===t||t<0)return this;if(t>=s.length)return this;try{for(let i=t+e-1;i>=t;i--)i>=s.length||this.removeChild(s[i])}catch(t){console.error(t)}return this},m.prototype.removeAllChildren=function(t=this.childrenArray){if(!this.element)return this;try{for(let e=0;e<t.length;e++)this.removeChild(t[e])}catch(t){console.error(t)}return this},m.prototype.childAt=function(t,e=this.childrenArray){if(!this.element||void 0===t)return null;for(t>=e.length&&(t=e.length-1);t<0;)t+=e.length;return e[t]},m.prototype.indexOfChild=function(t,e=this.childrenArray){return this.element&&t?(e instanceof Array||(e=Array.from(e)),e.indexOf(t)):-1},m.prototype.hasChild=function(t){if(!this.element||!t)return!1;const e=Array.from(this.element?.childNodes);if(t instanceof Node)return e.includes(t);for(const s of t)if(!e.includes(s))return!1;return!0},m.prototype.closest=function(t){if(!(this.element&&t&&this.element instanceof Element))return null;if("string"==typeof t)return this.element.closest(t);if("function"==typeof t){let e=this.element;for(;e&&!(e instanceof t);)e=e.parentElement;return e||null}return null},m.prototype.findInParents=function(t){if(!t||!this.element)return!1;t instanceof Node&&(t=[t]);let e=this.element,s=0;for(;e&&s<t.length;)t.includes(e)&&s++,e=e.parentNode;return s===t.length},m.prototype.findInSubTree=function(t){if(!t||!this.element)return!1;t instanceof Node&&(t=[t]);let e=0;const s=i=>{t.includes(i)&&e++,e>=t.length||i.childNodes.forEach(t=>s(t))};return s(this.element),e>=t.length},m.prototype.indexInParent=function(t=this.siblings){return t&&this.element?t.indexOf(this.element):-1},m.prototype.addToParent=function(t,e,s){return this.element&&t?(He(t).addChild(this.element,e,s),this):this}}const y=["interactors","tools","substrates","controllers","handlers"];function v(){m.prototype.execute=function(t){return t(this),this},m.prototype.applyDefaults=function(t,e={}){if(!this.element||"object"!=typeof this.element)return this;const{mergeProperties:s=y,removeDuplicates:i=!0}=e;for(const[e,n]of Object.entries(t)){const t=s?.includes(e);if(t){const t=Array.isArray(n)?n:[n];let s=(d(this.element[e])?[]:Array.isArray(this.element[e])?this.element[e].slice():[this.element[e]]).concat(t);i&&(s=Array.from(new Set(s))),this.element[e]=s}else d(this.element[e])&&(this.element[e]=n)}return this}}const k=new class{operateOnClasses(t,e,s=()=>{}){if(!t||!e||!t.element)return t;try{"string"==typeof e&&(e=e.split(" ")),e.filter(t=>t.trim().length>0).forEach(t=>s(t))}catch(t){console.error(t)}return t}};function E(){m.prototype.addClass=function(t){return this.element instanceof Element?k.operateOnClasses(this,t,t=>this.element.classList.add(t)):this},m.prototype.removeClass=function(t){return this.element instanceof Element?k.operateOnClasses(this,t,t=>this.element.classList.remove(t)):this},m.prototype.toggleClass=function(t,e){return this.element instanceof Element?k.operateOnClasses(this,t,t=>this.element.classList.toggle(t,e)):this},m.prototype.hasClass=function(t){if(!(t&&this.element instanceof Element))return!1;if("string"==typeof t)return this.element.classList.contains(t);for(let e of t)if(!this.element.classList.contains(e))return!1;return!0}}const S="http://www.w3.org/2000/svg",w="http://www.w3.org/1998/Math/MathML",C=new Set(["a","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tspan","use","view"]),T=new Set(["annotation","annotation-xml","maction","math","merror","mfrac","mi","mmultiscripts","mn","mo","mover","mpadded","mphantom","mprescripts","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]);function O(t){return C.has(t)||t?.startsWith("svg")}function P(t){return T.has(t)||t?.startsWith("math")}function D(t={}){let e;return e=t.namespace?"svg"==t.namespace?document.createElementNS(S,t.tag||"svg"):"mathML"==t.namespace?document.createElementNS(w,t.tag||"math"):document.createElementNS(t.namespace,t.tag||"div"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),He(e).setProperties(t),e}function x(t={}){let e;return e=O(t.tag)?document.createElementNS(S,t.tag||"svg"):P(t.tag)?document.createElementNS(w,t.tag||"math"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),He(e).setProperties(t),e}function A(t){return(e={})=>(e.tag=t,D({...e,tag:t}))}function M(t={}){return D({...t,tag:"a"})}function j(t={}){return D({...t,tag:"canvas"})}function I(t={}){return D({...t,tag:"div"})}function B(t={}){return D({...t,tag:"form"})}function N(t={}){return D({...t,tag:"h1"})}function V(t={}){return D({...t,tag:"h2"})}function _(t={}){return D({...t,tag:"h3"})}function F(t={}){return D({...t,tag:"h4"})}function L(t={}){return D({...t,tag:"h5"})}function z(t={}){return D({...t,tag:"h6"})}function R(t={}){return D({...t,tag:"img"})}function W(t={}){return D({...t,tag:"input"})}function K(t={}){return D({...t,tag:"link"})}function H(t={}){return D({...t,tag:"p"})}function U(t={}){return D({...t,tag:"span"})}function $(t={}){return D({...t,tag:"style"})}function G(t={}){return D({...t,tag:"textarea"})}function q(t={}){return D({...t,tag:"video"})}function Y(t,e=document.head){if(!t)return;const s=$({innerHTML:t});He(e).addChild(s)}class X{callbacks=new Map;model;constructor(t){t&&(this.model=t)}get defaultBlockKey(){return this.model?this.model.defaultBlockKey:"__defaultBlockKey__"}getBlock(t){return this.callbacks.get(t?.toString())}getOrGenerateBlock(t){return this.callbacks.has(t.toString())||this.callbacks.set(t.toString(),new Map),this.callbacks.get(t.toString())}getKey(t,e){const s=this.getBlock(e);return s?s.get(t):[]}getOrGenerateKey(t,e){const s=this.getOrGenerateBlock(e);return s.has(t)||s.set(t,[]),s.get(t)}addWithBlock(t,e,s){this.getOrGenerateKey(t,e).push(s)}add(t,e){this.addWithBlock(t,this.defaultBlockKey,e)}removeWithBlock(t,e,s){if(null==s)this.getBlock(e)?.delete(t);else{const i=this.getKey(t,e),n=i.indexOf(s);n>=0&&i.splice(n,1)}}remove(t,e){this.removeWithBlock(t,this.defaultBlockKey,e)}fireWithBlock(t,e,...s){this.callbacks.get(e.toString())?.get(t)?.forEach(t=>{t&&"function"==typeof t&&t(...s)})}fire(t,...e){this.fireWithBlock(t,this.defaultBlockKey,...e)}}class J{element;_view;_model;_emitter;_controllers=new Map;_handlers=new Map;_interactors=new Map;_tools=new Map;_substrates=new Map;constructor(t){t.element&&(this.element=t.element),t.emitter||(this.emitter=new X),this.generate(t)}get view(){return this._view}set view(t){this._view=this.generateInstance(t,{element:this.element}),this.linkPieces()}get model(){return this._model}set model(t){this.model?.keyChangedCallback.remove(this.emitterFireCallback),this._model=this.generateInstance(t),this._model.handlers=this._handlers,this._model.addHandler=t=>this.addHandler(t),this.linkPieces()}get emitter(){return this._emitter}set emitter(t){this._emitter=this.generateInstance(t),this.linkPieces()}get controllers(){return Array.from(this._controllers.values())||[]}set controllers(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addController(t)),this.linkPieces()}get handlers(){return Array.from(this._handlers.values())||[]}set handlers(t){this.generateInstances(t).forEach(t=>this.addHandler(t)),this.linkPieces()}get interactors(){return Array.from(this._interactors.values())||[]}set interactors(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addInteractor(t)),this.linkPieces()}get tools(){return Array.from(this._tools.values())||[]}set tools(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addTool(t)),this.linkPieces()}get substrates(){return Array.from(this._substrates.values())||[]}set substrates(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addSubstrate(t)),this.linkPieces()}get data(){return this.model?.data}set data(t){this.model&&(this.model.data=t)}get dataId(){return this.model?.dataId}set dataId(t){this.model&&(this.model.dataId=t)}get dataIndex(){return Number.parseInt(this.dataId)}set dataIndex(t){this.model&&(this.model.dataId=t.toString())}get dataSize(){return this.model?.getSize?.()}getController(t){return this._controllers.get(t)}addController(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Controller")),this._controllers.set(t.keyName,t),this.updateController(t)}getHandler(t){return this._handlers.get(t)}addHandler(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Handler")),this._handlers.set(t.keyName,t),this.updateHandler(t)}getInteractor(t){return this._interactors.get(t)}addInteractor(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Interactor")),this._interactors.set(t.keyName,t),this.updateInteractor(t)}getTool(t){return this._tools.get(t)}addTool(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Tool")),this._tools.set(t.keyName,t),this.updateTool(t)}getSubstrate(t){return this._substrates.get(t)}addSubstrate(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Substrate")),this._substrates.set(t.keyName,t),this.updateSubstrate(t)}generate(t={}){for(const e of Object.keys(t)){const s=t[e];void 0!==s&&"initialize"!==e&&"data"!==e&&(this[e]=s)}this._emitter||(this.emitter=new X),t.data&&this.model&&this.model.setBlock(t.data,void 0,void 0,!1),(void 0===t.initialize||t.initialize)&&this.initialize()}initialize(){this.view?.initialize(),this._controllers.forEach(t=>t.initialize()),this._interactors.forEach(t=>t.initialize()),this._tools.forEach(t=>t.initialize()),this._substrates.forEach(t=>t.initialize()),this.model?.initialize()}updateController(t){t.emitter=this.emitter,t.model=this.model,t.view=this.view}updateHandler(t){t.model=this.model}updateInteractor(t){t.model=this.model,t.view=this.view,t.emitter=this.emitter}updateTool(t){t.emitter=this.emitter,t.model=this.model,t.view=this.view}updateSubstrate(t){t.model=this.model,t.view=this.view,t.emitter=this.emitter}linkPieces(){this.model&&!this.model.keyChangedCallback.has(this.emitterFireCallback)&&this.model.keyChangedCallback.add(this.emitterFireCallback),this.emitter&&(this.emitter.model=this.model),this.view&&(this.view.emitter=this.emitter,this.view.model=this.model),this._controllers.forEach(t=>this.updateController(t)),this._handlers.forEach(t=>this.updateHandler(t)),this._interactors.forEach(t=>this.updateInteractor(t)),this._tools.forEach(t=>this.updateTool(t)),this._substrates.forEach(t=>this.updateSubstrate(t))}generateInstance(t,e,s=!0){if(t){if("function"==typeof t){return new t(s&&e&&"object"==typeof e?{...e}:e)}return t}}generateInstances(t,e,s=!0){if(!t)return[];"object"==typeof t&&Array.isArray(t)||(t=[t]);const i=[];return t.forEach(t=>{const n=this.generateInstance(t,e,s);n&&i.push(n)}),i}emitterFireCallback=(t,e,...s)=>this.emitter?.fireWithBlock(t,e,...s);extractClassEssenceName(t,e){let s=t.name,i=Object.getPrototypeOf(this.element);for(;i&&i.constructor!==Object;){const t=i.constructor.name.replaceAll("_","");if(s.startsWith(t)){s=s.slice(t.length);break}i=Object.getPrototypeOf(i)}return s.endsWith(e)&&(s=s.slice(0,-e.length)),s.charAt(0).toLowerCase()+s.slice(1)}}class Q{callbacks=new Set;add(t){this.callbacks.add(t)}remove(t){return this.callbacks.delete(t)}has(t){return this.callbacks.has(t)}fire(...t){let e;for(const s of this.callbacks)try{const i=s(...t);d(i)||(e=i)}catch(t){console.error("Error invoking callback:",t)}return e}clear(){this.callbacks.clear()}}class Z extends Q{onAdded=new Q;add(t){super.add(t),this.onAdded.fire(t)}}const tt=new class{constructorMap=new WeakMap;dataMap=new WeakMap;activeEffect=null;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}data(t){let e=this.dataMap.get(t);return e||(e=new Map,this.dataMap.set(t,e)),e}track(t){this.activeEffect&&this.activeEffect.dependencies.add(t)}createSignalEntry(t,e,s,i,n){const a=new Set,r=this,o=void 0!==e||void 0!==s;let l=t;n||(n={diffOnWrite:!0});const c={get:()=>(r.track(c),o?s():l),set(a){if(o)if(i&&!n.diffOnWrite)i(a),c.emit();else if(i){const t=s();i(a);const e=s();Object.is(t,e)||c.emit()}else Reflect.set(t,e,a,t);else{const t=l;l=a,Object.is(t,a)||c.emit()}},update(t){c.set(t(o?s():l))},sub:t=>(a.add(t),()=>a.delete(t)),emit(){for(const t of Array.from(a))queueMicrotask(t)}};return c}getReactivityData(t,e){const s=this.data(t);return s.has(e)||s.set(e,{}),s.get(e)}getSignal(t,e){return this.getReactivityData(t,e).signal}setSignal(t,e,s){const i=this.getSignal(t,e);i?i.set(s):Reflect.set(t,e,s,t)}getEffect(t,e){return this.getReactivityData(t,e).effect}setEffect(t,e,s){this.getReactivityData(t,e).effect=s}markDirty(t,e){this.getSignal(t,e)?.emit()}schedule(t){t.scheduled||(t.scheduled=!0,queueMicrotask(()=>{t.scheduled=!1,t.run()}))}},et=new class{utils;constructor(t){this.utils=t}createBoxFromEntry(t){return new Proxy({...t,toJSON:()=>t.get(),valueOf:()=>t.get(),[Symbol.toPrimitive]:e=>{const s=t.get();return"string"===e?String(s):"number"==typeof s?s:null!=s&&"function"==typeof s.valueOf?s.valueOf():s},get value(){return t.get()},set value(e){t.set(e)}},{get:(t,e,s)=>Reflect.get(t,e,s),set:(t,e,s,i)=>"value"===e?(t.value=s,!0):Reflect.set(t,e,s,i)})}signalDecorator(t,e,s,i){const{kind:n,name:a,static:r,private:l}=e;if(l)throw new Error("@signal does not support private class elements.");const c=a,h=Symbol(`[[signal:${String(c)}]]`),u=Symbol(`[[signal:${String(c)}:shadow]]`),d=this.utils;e.addInitializer(function(){const e=r?this:this.constructor.prototype;let a,l;const p=function(){return s&&!this[u]?s.call(this):a&&!this[u]?a.call(this):this[h]},f=function(t){l||i?(i&&i.call(this,t),l&&l.call(this,t),a||s||(this[h]=t,this[u]=!0)):(this[h]=t,this[u]=!0)},m=(t,e=!0)=>{let i=d.getSignal(t,c);return i||("field"!==n||a||s||(t[h]=t[c]),i=d.createSignalEntry(t,c,()=>p.call(t),e=>f.call(t,e),{diffOnWrite:e}),d.getReactivityData(t,c).signal=i,"field"===n&&delete t[c],i)};if("field"===n||"accessor"===n){const e=t;e?.get&&(a=e.get),e?.set&&(l=e.set);const i=m(this,!a&&!s),n=o(this,c);Object.defineProperty(this,c,{configurable:n?.configurable??!0,enumerable:n?.enumerable??!0,get:()=>(d.track(i),p.call(this)),set:t=>i.set(t)})}else if("getter"===n||"setter"===n){const t=d.constructorData(e).installed;if(t.get(c))return;t.set(c,!0);const i=o(e,c)??{};"function"==typeof i.get&&(a=i.get),"function"==typeof i.set&&(l=i.set),Object.defineProperty(e,c,{configurable:i?.configurable??!0,enumerable:!!i?.enumerable,get:function(){const t=m(this,!a&&!s);return d.track(t),p.call(this)},set:function(t){m(this,!a&&!s).set(t)}})}})}}(tt),st=new class{utils;constructor(t){this.utils=t}makeEffect(t){const e=this.utils;return{callback:t,dependencies:new Set,cleanups:[],scheduled:!1,run(){for(const t of this.cleanups)t();this.cleanups=[],this.dependencies=new Set,e.activeEffect=this;try{this.callback()}finally{e.activeEffect=null}for(const t of this.dependencies){const s=t.sub(()=>e.schedule(this));this.cleanups.push(s)}},dispose(){for(const t of this.cleanups)t();this.cleanups=[],this.dependencies.clear()}}}}(tt);function it(...t){if(t[1]&&"object"==typeof t[1]&&"kind"in t[1]&&"name"in t[1]&&"static"in t[1]&&"private"in t[1])return et.signalDecorator(t[0],t[1]);const e=t[0];return et.createBoxFromEntry(tt.createSignalEntry(e))}function nt(t,e){return function(s,i){const n=t??String(i.name);return et.signalDecorator(s,i,function(){return this.getData?.(n,e)},function(t){this.setData?.(n,t,e)})}}function at(...t){const e=t[0],s=t[1];if(s&&"object"==typeof s&&"kind"in s&&"name"in s&&"static"in s&&"private"in s){const{kind:t,name:i,static:n}=s,a=String(i);if("method"!==t&&"getter"!==t&&("field"!==t||"function"!=typeof e))throw new Error("@effect can only decorate zero-arg instance methods or getters.");if(n)throw new Error("@effect does not support static methods/getters.");s.addInitializer?.(function(){const t=this,s=function(){e?.call(this)},i=st.makeEffect(()=>s.call(t));tt.setEffect(t,a,i)})}else if("function"==typeof e){const t=st.makeEffect(e);return t.run(),()=>t.dispose()}}function rt(t,e){return tt.getSignal(t,e)}function ot(t,e,s){return tt.setSignal(t,e,s)}function lt(t,e){return tt.markDirty(t,e)}function ct(t){for(const[,e]of tt.data(t))e.effect?.run()}function ht(t,e){const s=tt.getReactivityData(t,e);s.effect?.dispose(),s.effect=void 0}function ut(t){for(const[,e]of tt.data(t))e.effect?.dispose(),e.effect=void 0}let dt=(()=>{let s,i=[],n=[];return class{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[f()],t(this,null,s,{kind:"accessor",name:"enabledCallbacks",static:!1,private:!1,access:{has:t=>"enabledCallbacks"in t,get:t=>t.enabledCallbacks,set:(t,e)=>{t.enabledCallbacks=e}},metadata:e},i,n),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}isInitialized=new Map;isDataBlocksArray=!1;dataBlocks;handlers;keyChangedCallback;constructor(t,s){e(this,n),this.keyChangedCallback=new Z,"array"===s?(this.isDataBlocksArray=!0,this.dataBlocks=[]):(this.isDataBlocksArray=!1,this.dataBlocks=new Map),this.enabledCallbacks=!0,this.setBlock(t,void 0,this.defaultBlockKey,!1)}get data(){return this.getBlockData()}set data(t){this.setBlock(t)}get dataId(){return this.getBlockId()}set dataId(t){this.setBlockId(t)}#e=e(this,i,void 0);get enabledCallbacks(){return this.#e}set enabledCallbacks(t){this.#e=t}getData(t,e=this.defaultBlockKey){return this.isValidBlockKey(e)?this.getBlockData(e)?.[t]:null}setData(t,e,s=this.defaultBlockKey){if(!this.isValidBlockKey(s))return;const i=this.getBlockData(s);i&&(i[t]=e),this.enabledCallbacks&&this.fireKeyChangedCallback(t,s)}getSize(t=this.defaultBlockKey){return this.getAllKeys(t)?.length??0}getBlock(t=this.defaultBlockKey){if(!this.isValidBlockKey(t))return null;if(this.isDataBlocksArray){const e=Number(t);return Number.isInteger(e)&&e>=0?this.dataBlocks[e]??null:null}return this.dataBlocks.get(t.toString())??null}createBlock(t,e,s=this.defaultBlockKey){return{id:e??null,data:t}}setBlock(t,e,s=this.defaultBlockKey,i=!0){if(!this.isValidBlockKey(s)||null==t)return;const n=this.createBlock(t,e,s);if(this.isDataBlocksArray){const t=Number(s);Number.isInteger(t)&&t>=0&&(this.dataBlocks[t]=n)}else this.dataBlocks.set(s.toString(),n);i?this.initialize(s):this.isInitialized.set(s,!1)}hasBlock(t){if(this.isDataBlocksArray){const e=Number(t);return Number.isInteger(e)&&e>=0&&e<this.dataBlocks.length}return this.dataBlocks.has(t.toString())}addBlock(t,e,s,i=!0){if(!t)return;if(!this.isDataBlocksArray)return this.setBlock(t,e,s,i);const n=this.createBlock(t,e,s);let a=Number(s);(!Number.isInteger(a)||a<0)&&(a=this.dataBlocks.length),this.dataBlocks.splice(a,0,n),i&&this.initialize(a)}getBlockData(t=this.defaultBlockKey){const e=this.getBlock(t);return e?e.data:null}getBlockId(t=this.defaultBlockKey){const e=this.getBlock(t);return e?e.id:null}setBlockId(t,e=this.defaultBlockKey){if(!t)return;const s=this.getBlock(e);s&&(s.id=t)}fireKeyChangedCallback(t,e=this.defaultBlockKey,s=!1){this.isValidBlockKey(e)||(e=this.getAllBlockKeys()[0]),lt(this,t),this.keyChangedCallback.fire(t,e,s?void 0:this.getData(t,e))}fireCallback(t,...e){this.keyChangedCallback.fire(t,this.defaultBlockKey,...e)}fireBlockCallback(t,e=this.defaultBlockKey,...s){this.isValidBlockKey(e)||(e=this.getAllBlockKeys()[0]),this.keyChangedCallback.fire(t,e,...s)}initialize(t=this.defaultBlockKey){const e=this.getAllKeys(t);e&&this.enabledCallbacks&&(e.forEach(e=>this.fireKeyChangedCallback(e,t)),this.isInitialized.set(t,!0))}clear(t=this.defaultBlockKey){}get defaultBlockKey(){return this.isDataBlocksArray?0:"__turbo_default_block_key__"}get defaultComputationBlockKey(){return(this.isDataBlocksArray?this.dataBlocks.length:this.dataBlocks.size)>1?null:this.defaultBlockKey}isValidBlockKey(t){return null!=t&&("string"==typeof t&&0!==t.length||"number"==typeof t)}getAllBlockKeys(){return this.isDataBlocksArray?this.dataBlocks.map((t,e)=>e):Array.from(this.dataBlocks.keys())}getAllIds(){return this.isDataBlocksArray?this.dataBlocks.map(t=>t.id):Array.from(this.dataBlocks.values()).map(t=>t.id)}getAllBlocks(t=this.defaultComputationBlockKey){const e=[];if(null!==t){const s=this.getBlock(t);s&&e.push(s)}else for(const t of this.getAllBlockKeys()){const s=this.getBlock(t);s&&e.push(s)}return e}getAllKeys(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap(t=>Object.keys(t.data))}getAllData(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap(t=>Object.values(t.data))}getHandler(t){return this.handlers.get(t)}addHandler(t){t.keyName&&this.handlers.set(t.keyName,t)}}})();const pt={keyPressed:"turbo-key-pressed",keyReleased:"turbo-key-released"},ft={keyPressed:"keydown",keyReleased:"keyup"},mt={click:"turbo-click",clickStart:"turbo-click-start",clickEnd:"turbo-click-end",longPress:"turbo-long-press"},gt={click:"click",clickStart:"mousedown",clickEnd:"mouseup",longPress:mt.longPress},bt={move:"turbo-move"},yt={move:"mousemove"},vt={drag:"turbo-drag",dragStart:"turbo-drag-start",dragEnd:"turbo-drag-end"},kt={drag:vt.drag,dragStart:vt.dragStart,dragEnd:vt.dragEnd},Et={trackpadScroll:"turbo-trackpad-scroll",trackpadPinch:"turbo-trackpad-pinch",mouseWheel:"turbo-mouse-wheel"},St={trackpadScroll:"wheel",trackpadPinch:"wheel",mouseWheel:"wheel"},wt={...mt,...pt,...bt,...vt,...Et,selectInput:"turbo-select-input"},Ct={...ft,...gt,...yt,...kt,...St,wheel:"wheel",scroll:"scroll",input:"input",change:"change",focus:"focus",focusIn:"focusin",focusOut:"focusout",blur:"blur",resize:"resize",compositionStart:"compositionstart",compositionEnd:"compositionend"};function Tt(t){if(null!=t)switch(typeof t){case"string":return t;case"number":case"boolean":case"bigint":case"symbol":case"function":return t.toString();case"object":if(Array.isArray(t))return JSON.stringify(t);if(t instanceof Date)return t.toISOString();try{return JSON.stringify(t)}catch{return"[object Object]"}default:return String(t)}}function Ot(t){if(!d(t)){switch(t){case"null":return null;case"true":return!0;case"false":return!1}if(!isNaN(Number(t)))return Number(t);if(/^\d+n$/.test(t))return BigInt(t.slice(0,-1));if(t.startsWith("function")||t.startsWith("("))try{const e=new Function(`return (${t})`)();if("function"==typeof e)return e}catch{}try{const e=JSON.parse(t);if("object"==typeof e&&null!=e)return e}catch{}return t}}function Pt(t){if(!t||0==t.length)return"";const e=t.match(/\.\S{1,4}$/);return e?e[0]:""}function Dt(t){if(t&&0!=t.length)return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function xt(t){if(t&&0!=t.length)return t.replace(/-([a-z])/g,t=>t[1].toUpperCase())}function At(){m.prototype.setProperties=function(t={},e=!1){if(!this)return this;if(t.out&&("string"==typeof t.out?this.__outName=t.out:Object.assign(t.out,this)),!this.element.shadowRoot){let e=!!t.shadowDOM;if("getPropertiesValue"in this.element&&"function"==typeof this.element.getPropertiesValue&&(e=this.element.getPropertiesValue(t.shadowDOM,"shadowDOM")),e)try{this.element.attachShadow({mode:"open"})}catch{}}const s=this.element?.mvc instanceof J?this.element.mvc:"model"in this.element&&"view"in this.element?this.element:void 0;for(const i of Object.keys(t)){const n=t[i];if(void 0!==n)switch(i){case"tag":case"namespace":case"shadowDOM":break;case"text":this.element instanceof HTMLElement&&(this.element.innerText=n);break;case"style":if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))break;this.setStyles(n,!0);break;case"stylesheet":Y(n,this.closestRoot);break;case"id":this.element.id=n;break;case"classes":this.addClass(n);break;case"listeners":Object.entries(n).forEach(([t,e])=>this.on(t,e));break;case"onClick":this.on(Ct.click,n);break;case"onDrag":this.on(Ct.drag,n);break;case"children":this.addChild(n);break;case"parent":He(n).addChild(this.element);break;case"data":case"initialize":if(s)break;case"model":case"view":case"emitter":case"controllers":case"handlers":case"interactors":case"tools":case"substrates":if(e)break;if(s){try{s[i]=n,"model"===i&&t.data&&s.model instanceof dt&&s.model.setBlock(t.data,void 0,void 0,!1)}catch{}break}default:if(e)break;try{this.element[i]=n}catch(t){try{this.setAttribute(i,Tt(n))}catch(t){console.error(t)}}}}return(void 0===t.initialize||t.initialize)&&(this.element&&"initialize"in this.element&&"function"==typeof this.element.initialize?this.element.initialize():s&&"initialize"in s&&"function"==typeof s.initialize&&s.initialize()),this},m.prototype.setMvc=function(t){if(this.element)return"mvc"in this.element&&this.element.mvc instanceof J?(this.element.mvc.generate(t),this.element.mvc):new J({...t,element:this.element})},m.prototype.destroy=function(){return this.removeAllListeners(),this.remove(),this.element&&"destroy"in this.element&&"function"==typeof this.element.destroy&&this.element.destroy(),this},m.prototype.setAttribute=function(t,e){return this.element instanceof Element&&this.element.setAttribute(t,e?.toString()||"true"),this},m.prototype.removeAttribute=function(t){return this.element instanceof Element&&this.element.removeAttribute(t),this},m.prototype.blur=function(){return this.element instanceof HTMLElement&&this.element.blur(),this},m.prototype.focus=function(){return this.element instanceof HTMLElement&&this.element.focus(),this}}const Mt=["mousedown","mouseup","mousemove","click","dblclick","contextmenu","dragstart","selectstart","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","wheel"],jt=["wheel","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointercancel"];var It,Bt,Nt;!function(t){t[t.none=0]="none",t[t.click=1]="click",t[t.longPress=2]="longPress",t[t.drag=3]="drag"}(It||(It={})),function(t){t[t.none=0]="none",t[t.left=1]="left",t[t.right=2]="right",t[t.middle=3]="middle",t[t.other=4]="other",t[t.key=5]="key"}(Bt||(Bt={})),function(t){t[t.unknown=0]="unknown",t[t.mouse=1]="mouse",t[t.trackpad=2]="trackpad",t[t.touch=3]="touch"}(Nt||(Nt={}));class Vt extends Map{enforceImmutability=!0;set(t,e){return super.set(t,this.enforceImmutability?this.copy(e):e)}get(t){const e=super.get(t);return this.enforceImmutability?this.copy(e):e}get first(){if(0==this.size)return null;const t=this.values().next().value;return this.enforceImmutability?this.copy(t):t}get last(){if(0==this.size)return null;const t=this.valuesArray()[this.size-1];return this.enforceImmutability?this.copy(t):t}keysArray(){return Array.from(this.keys())}valuesArray(){return Array.from(this.values())}copy(t){if(t&&"object"==typeof t){if(t instanceof Array)return t.map(t=>this.copy(t));if(t.constructor&&t.constructor!=Object){if("function"==typeof t.clone)return t.clone();if("function"==typeof t.copy)return t.copy()}return{...t}}return t}mapKeys(t){const e=new Vt;for(let[s,i]of this)e.set(t(s,i),i);return e}mapValues(t){const e=new Vt;for(let[s,i]of this)e.set(s,t(s,i));return e}filter(t){const e=new Vt;for(let[s,i]of this)t(s,i)&&e.set(s,i);return e}merge(t){for(let[e,s]of t)this.set(e,s);return this}}function _t(t,e,s){const i=Symbol(`__${e.toLowerCase()}_${String(t.name)}`),n=function(t,e,s){return t??(String(s.name).endsWith(e)?String(s.name).slice(0,-e.length):String(s.name))}(s,e,t);t.addInitializer(function(){Object.defineProperty(this,t.name,{configurable:!0,enumerable:!1,get:function(){if(this[i])return this[i];let t,s;switch(e){case"Controller":s="getController";break;case"Handler":s="getHandler";break;case"Interactor":s="getInteractor";break;case"Tool":s="getTool";break;case"Substrate":s="getSubstrate"}if(s){if(this.mvc&&this.mvc instanceof J?t=this.mvc[s](n):this[s]&&"function"==typeof this[s]&&(t=this[s](n)),!t)throw new Error(`${e} "${n}" not found on ${this?.constructor?.name}.`);return this[i]=t,t}},set:function(t){this[i]=t}})})}function Ft(t){return function(e,s){_t(s,"Controller",t)}}function Lt(t){return function(e,s){_t(s,"Handler",t)}}function zt(t){return function(e,s){_t(s,"Interactor",t)}}function Rt(t){return function(e,s){_t(s,"Tool",t)}}function Wt(t){return function(e,s){_t(s,"Substrate",t)}}let Kt=(()=>{let s,i,n=dt,a=[],r=[],o=[];return class extends n{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;s=[Lt()],i=[f({callBefore:function(t){t==Nt.trackpad&&(this.wasRecentlyTrackpad=!0)}})],t(this,null,i,{kind:"setter",name:"inputDevice",static:!1,private:!1,access:{has:t=>"inputDevice"in t,set:(t,e)=>{t.inputDevice=e}},metadata:e},null,a),t(null,null,s,{kind:"field",name:"utils",static:!1,private:!1,access:{has:t=>"utils"in t,get:t=>t.utils,set:(t,e)=>{t.utils=e}},metadata:e},r,o),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}utils=(e(this,a),e(this,r,void 0));state=(e(this,o),{});lockState={};onInputDeviceChange=new Z;onToolChange=new Z;currentKeys=[];currentAction=It.none;currentClick=Bt.none;wasRecentlyTrackpad=!1;moveThreshold;longPressDuration;authorizeEventScaling;scaleEventPosition;activePointers=new Set;origins=new Vt;previousPositions=new Vt;positions;lastTargetOrigin;timerMap=new Vt;tools=new Map;mappedKeysToTool=new Map;currentTools=new Map;set inputDevice(t){this.onInputDeviceChange.fire(t)}}})();var Ht;!function(t){t.target="target",t.position="position"}(Ht||(Ht={}));let Ut=(()=>{let s,i,n=Event,a=[];return class extends n{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;s=[$e()],i=[$e()],t(this,null,s,{kind:"method",name:"closest",static:!1,private:!1,access:{has:t=>"closest"in t,get:t=>t.closest},metadata:e},null,a),t(this,null,i,{kind:"getter",name:"scaledPosition",static:!1,private:!1,access:{has:t=>"scaledPosition"in t,get:t=>t.scaledPosition},metadata:e},null,a),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}eventManager=e(this,a);toolName;eventName;clickMode;keys;position;authorizeScaling;scalePosition;constructor(t){super(t.eventName,{bubbles:!0,cancelable:!0,...t.eventInitDict}),this.eventManager=t.eventManager??oe.instance,this.authorizeScaling=t.authorizeScaling??!0,this.scalePosition=t.scalePosition??(t=>t),this.clickMode=t.clickMode??oe.instance.currentClick,this.keys=t.keys??oe.instance.currentKeys,this.eventName=t.eventName,this.position=t.position,this.toolName=t.toolName}get tool(){return this.toolName&&this.eventManager instanceof oe?this.eventManager.getToolByName(this.toolName):null}closest(t,e=!0,s=Ht.target){const i=s==Ht.target?[this.target]:document.elementsFromPoint(this.position.x,this.position.y),n=e instanceof Element?e:null,a=!0===e||null!==n;for(let e of i){for(;e&&(!(e instanceof t)||a&&!this.isPositionInsideElement(this.position,n??e));)e=e.parentElement;if(e)return e}return null}isPositionInsideElement(t,e){const s=e.getBoundingClientRect();return t.x>=s.left&&t.x<=s.right&&t.y>=s.top&&t.y<=s.bottom}get target(){return super.target||document}get scaledPosition(){return this.scalingAuthorized?this.scalePosition(this.position):this.position}get scalingAuthorized(){return"function"==typeof this.authorizeScaling?this.authorizeScaling():this.authorizeScaling}scalePositionsMap(t){return t.mapValues((t,e)=>this.scalePosition(e))}}})();class $t extends Ut{keyPressed;keyReleased;constructor(t){super({...t,position:null}),this.keyPressed=t.keyPressed,this.keyReleased=t.keyReleased}}class Gt{keyName;element;view;model;emitter;constructor(t){this.element=t.element,t.model&&(this.model=t.model),t.emitter&&(this.emitter=t.emitter),t.view&&(this.view=t.view)}initialize(){this.setupChangedCallbacks()}setupChangedCallbacks(){ct(this)}}class qt extends Gt{keyName="key";keyDown=t=>this.keyDownFn(t);keyDownFn(t){this.element.enabled&&(this.model.currentKeys.includes(t.key)||(this.model.currentKeys.push(t.key),this.emitter.fire("dispatchEvent",document,$t,{eventName:pt.keyPressed,keyPressed:t.key})))}keyUp=t=>this.keyUpFn(t);keyUpFn(t){this.element.enabled&&this.model.currentKeys.includes(t.key)&&(this.model.currentKeys.splice(this.model.currentKeys.indexOf(t.key),1),this.emitter.fire("dispatchEvent",document,$t,{eventName:pt.keyReleased,keyReleased:t.key}))}}class Yt extends Ut{delta;constructor(t){super({...t,position:null}),this.delta=t.delta}}class Xt{x;y;constructor(t=0,e=("number"==typeof t?t:0)){"number"==typeof t?(this.x=t,this.y=e):"clientX"in t?(this.x=t.clientX,this.y=t.clientY):"x"in t?(this.x=t.x,this.y=t.y):(this.x=t[0],this.y=t[1])}static dist(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static midPoint(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>t+e.x,0)/t.length,s=t.reduce((t,e)=>t+e.y,0)/t.length;return new Xt(e,s)}static max(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>Math.max(t,e.x),-1/0),s=t.reduce((t,e)=>Math.max(t,e.y),-1/0);return new Xt(e,s)}static min(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>Math.min(t,e.x),1/0),s=t.reduce((t,e)=>Math.min(t,e.y),1/0);return new Xt(e,s)}get object(){return{x:this.x,y:this.y}}equals(t,e=0){return"number"==typeof t?this.x==t&&this.y==e:this.x==t.x&&this.y==t.y}boundX(t,e){return this.x<t?t:this.x>e?e:this.x}boundY(t,e){return this.y<t?t:this.y>e?e:this.y}bound(t,e,s=t,i=e){return new Xt(this.boundX(t,e),this.boundY(s,i))}add(t,e){return"number"==typeof t?new Xt(this.x+t,this.y+(e||0==e?e:t)):new Xt(this.x+t.x,this.y+t.y)}sub(t,e){return"number"==typeof t?new Xt(this.x-t,this.y-(e||0==e?e:t)):new Xt(this.x-t.x,this.y-t.y)}mul(t,e){return"number"==typeof t?new Xt(this.x*t,this.y*(e||0==e?e:t)):new Xt(this.x*t.x,this.y*t.y)}div(t,e){return"number"==typeof t?new Xt(this.x/t,this.y/(e||0==e?e:t)):new Xt(this.x/t.x,this.y/t.y)}mod(t,e){const s="number"==typeof t?{x:t,y:e||0==e?e:t}:{x:t.x,y:t.y},i=this.object;for(;i.x<0;)i.x+=s.x;for(;i.x>=s.x;)i.x-=s.x;for(;i.y<0;)i.y+=s.y;for(;i.y>=s.y;)i.y-=s.y;return new Xt(i)}get abs(){return new Xt(Math.abs(this.x),Math.abs(this.y))}get max(){return Math.max(this.x,this.y)}get min(){return Math.min(this.x,this.y)}get length2(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length2)}dot(t){return this.x*t.x+this.y*t.y}copy(){return new Xt(this.x,this.y)}arr(){return[this.x,this.y]}}class Jt extends Gt{keyName="wheel";wheel=t=>{if(!this.element.enabled)return;let e;this.element.preventDefaultWheel&&t.preventDefault(),(Math.abs(t.deltaY)<=40||0!=t.deltaX)&&(this.model.inputDevice=Nt.trackpad),this.model.wasRecentlyTrackpad||(this.model.inputDevice=Nt.mouse),this.model.utils.clearTimer("recentlyTrackpadTimer"),this.model.utils.setTimer("recentlyTrackpadTimer",()=>{this.model.inputDevice==Nt.trackpad&&(this.model.wasRecentlyTrackpad=!1)},800),e=this.model.inputDevice==Nt.trackpad&&t.ctrlKey?wt.trackpadPinch:this.model.inputDevice==Nt.trackpad?wt.trackpadScroll:wt.mouseWheel,this.emitter.fire("dispatchEvent",document,Yt,{delta:new Xt(t.deltaX,t.deltaY),eventName:e})}}let Qt=(()=>{let s,i,n,a,r,o,l,c=Ut,h=[];return class extends c{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;s=[$e()],i=[$e()],n=[$e()],a=[$e()],r=[$e()],o=[$e()],l=[$e()],t(this,null,s,{kind:"getter",name:"scaledOrigins",static:!1,private:!1,access:{has:t=>"scaledOrigins"in t,get:t=>t.scaledOrigins},metadata:e},null,h),t(this,null,i,{kind:"getter",name:"scaledPreviousPositions",static:!1,private:!1,access:{has:t=>"scaledPreviousPositions"in t,get:t=>t.scaledPreviousPositions},metadata:e},null,h),t(this,null,n,{kind:"getter",name:"scaledPositions",static:!1,private:!1,access:{has:t=>"scaledPositions"in t,get:t=>t.scaledPositions},metadata:e},null,h),t(this,null,a,{kind:"getter",name:"deltaPositions",static:!1,private:!1,access:{has:t=>"deltaPositions"in t,get:t=>t.deltaPositions},metadata:e},null,h),t(this,null,r,{kind:"getter",name:"deltaPosition",static:!1,private:!1,access:{has:t=>"deltaPosition"in t,get:t=>t.deltaPosition},metadata:e},null,h),t(this,null,o,{kind:"getter",name:"scaledDeltaPositions",static:!1,private:!1,access:{has:t=>"scaledDeltaPositions"in t,get:t=>t.scaledDeltaPositions},metadata:e},null,h),t(this,null,l,{kind:"getter",name:"scaledDeltaPosition",static:!1,private:!1,access:{has:t=>"scaledDeltaPosition"in t,get:t=>t.scaledDeltaPosition},metadata:e},null,h),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}origins=e(this,h);previousPositions;positions;constructor(t){super({...t,position:t.positions.first}),this.origins=t.origins,this.previousPositions=t.previousPositions,this.positions=t.positions}get scaledOrigins(){return this.scalingAuthorized?this.scalePositionsMap(this.origins):this.origins}get scaledPreviousPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.previousPositions):this.previousPositions}get scaledPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.positions):this.positions}get deltaPositions(){return this.positions.mapValues((t,e)=>{const s=this.previousPositions.get(t);if(s)return e.sub(s)})}get deltaPosition(){return Xt.midPoint(...this.deltaPositions.valuesArray())}get scaledDeltaPositions(){return this.scaledPositions.mapValues((t,e)=>{const s=this.scaledPreviousPositions.get(t);if(s)return e.sub(s)})}get scaledDeltaPosition(){return Xt.midPoint(...this.scaledDeltaPositions.valuesArray())}}})();class Zt extends Gt{keyName="pointer";pointerDown=t=>this.pointerDownFn(t);pointerMove=t=>this.pointerMoveFn(t);pointerUp=t=>this.pointerUpFn(t);pointerCancel=t=>this.pointerCancelFn(t);lostPointerCapture=t=>this.lostPointerCaptureFn(t);pointerDownFn(t){if(t.composedPath().includes(this.model.lockState.lockOrigin)||(document.activeElement?.blur?.(),this.element.unlock()),!this.element.enabled)return;const e="touch"===t.pointerType;this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),e?this.model.inputDevice=Nt.touch:this.model.inputDevice!==Nt.unknown&&this.model.inputDevice!==Nt.touch||(this.model.inputDevice=Nt.mouse);const s=t.pointerId,i=new Xt(t.clientX,t.clientY);this.model.origins.set(s,i),this.model.previousPositions.set(s,i);const n=document.elementFromPoint(i.x,i.y);n&&n.setPointerCapture?.(t.pointerId),this.model.activePointers.add(s),this.model.utils.setClickMode(e?this.model.activePointers.size:t.button,e),this.element.clickEventEnabled&&(this.fireClick(this.model.origins.first,wt.clickStart),this.model.currentAction=It.click,this.model.utils.setTimer(wt.longPress,()=>{this.model.currentAction===It.click&&(this.model.currentAction=It.longPress,this.fireClick(this.model.origins.first,wt.longPress))},this.model.longPressDuration))}pointerMoveFn(t){if(!this.element.enabled)return;if(!this.element.moveEventsEnabled&&!this.element.dragEventEnabled)return;const e="touch"===t.pointerType;if(this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),this.model.positions=new Vt,this.model.positions.set(t.pointerId,new Xt(t.clientX,t.clientY)),this.model.currentAction!==It.drag&&(this.model.lastTargetOrigin=null),this.element.moveEventsEnabled&&this.fireDrag(this.model.positions,wt.move),this.model.currentAction!==It.none&&this.element.dragEventEnabled){if(this.model.currentAction!==It.drag){if(!Array.from(this.model.origins.entries()).some(([e,s])=>{const i=e===t.pointerId?this.model.positions.get(e):this.model.previousPositions.get(e);return i&&Xt.dist(i,s)>this.model.moveThreshold}))return;Ge(this),this.fireDrag(this.model.origins,wt.dragStart),this.model.currentAction=It.drag}this.fireDrag(this.model.positions)}this.model.previousPositions.set(t.pointerId,this.model.positions.get(t.pointerId))}pointerUpFn(t){if(!this.element.enabled)return;const e="touch"===t.pointerType;this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),this.model.utils.clearTimer(wt.longPress),this.model.positions=new Vt,this.model.positions.set(t.pointerId,new Xt(t.clientX,t.clientY)),this.model.currentAction===It.drag&&this.element.dragEventEnabled&&this.fireDrag(this.model.positions,wt.dragEnd),this.element.clickEventEnabled&&(this.model.currentAction===It.click&&this.fireClick(this.model.positions.first,wt.click),this.fireClick(this.model.origins.first,wt.clickEnd)),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=It.none,this.model.currentClick=Bt.none)}pointerCancelFn(t){this.model.utils.clearTimer(wt.longPress),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=It.none,this.model.currentClick=Bt.none)}lostPointerCaptureFn(t){}fireClick(t,e=wt.click){if(!t)return;const s=document.elementFromPoint(t.x,t.y)||document;this.emitter.fire("dispatchEvent",s,Ut,{position:t,eventName:e})}fireDrag(t,e=wt.drag){t&&this.emitter.fire("dispatchEvent",this.getFireOrigin(t),Qt,{positions:t,previousPositions:this.model.previousPositions,origins:this.model.origins,eventName:e})}getFireOrigin(t,e=!1){if(!this.model.lastTargetOrigin||e){const e=this.model.origins.first?this.model.origins.first:t.first;this.model.lastTargetOrigin=document.elementFromPoint(e.x,e.y)}return this.model.lastTargetOrigin}}class te{_weakRefs;constructor(){this._weakRefs=new Set}add(t){return this.has(t)||this._weakRefs.add(new WeakRef(t)),this}has(t){for(const e of this._weakRefs)if(e.deref()===t)return!0;return!1}delete(t){for(const e of this._weakRefs)if(e.deref()===t)return this._weakRefs.delete(e),!0;return!1}cleanup(){for(const t of this._weakRefs)void 0===t.deref()&&this._weakRefs.delete(t)}toArray(){const t=[];for(const e of this._weakRefs){const s=e.deref();void 0!==s?t.push(s):this._weakRefs.delete(e)}return t}get size(){return this.cleanup(),this.toArray().length}clear(){this._weakRefs.clear()}}class ee extends Gt{keyName="dispatch";boundHooks=new Map;setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("dispatchEvent",this.dispatchEvent)}dispatchEvent=(t,e,s)=>{t&&(s.keys=this.model.currentKeys,s.toolName=this.element.getCurrentToolName(this.model.currentClick),s.clickMode=this.model.currentClick,s.eventManager=this.element,s.eventInitDict={bubbles:!0,cancelable:!0,composed:!0},s.authorizeScaling=this.element.authorizeEventScaling,s.scalePosition=this.element.scaleEventPosition,s.eventName===pt.keyPressed?this.element.setToolByKey(s.keyPressed):s.eventName===pt.keyReleased&&this.element.setTool(void 0,Bt.key,{select:!1}),t.dispatchEvent(new e(s)))};getToolHandlingCallback(t,e){const s=this.element.getCurrentToolName(this.model.currentClick),i=e.composedPath?.()||[];for(let n=i.length-1;n>=0;n--)if(i[n]instanceof Node&&He(i[n]).executeAction(t,s,e,{capture:!0},this.element)){e.stopPropagation();break}for(let n=0;n<i.length;n++)if(i[n]instanceof Node&&He(i[n]).executeAction(t,s,e,void 0,this.element)){e.stopPropagation();break}}setupCustomDispatcher(t){if(this.boundHooks.has(t))return;const e=e=>this.getToolHandlingCallback(t,e);this.boundHooks.set(t,e),document.addEventListener(t,e,{capture:!0})}removeCustomDispatcher(t){const e=this.boundHooks.get(t);e&&(document.removeEventListener(t,e,{capture:!0}),this.boundHooks.delete(t))}}class se{keyName;model;constructor(t){this.model&&(this.model=t)}}class ie extends se{keyName="utils";setClickMode(t,e=!1){switch(e&&t--,t){case-1:return void(this.model.currentClick=Bt.none);case 0:return void(this.model.currentClick=Bt.left);case 1:return void(this.model.currentClick=Bt.middle);case 2:return void(this.model.currentClick=Bt.right);default:return void(this.model.currentClick=Bt.other)}}applyEventNames(t){for(const e in t)Ct[e]=t[e]}setTimer(t,e,s){this.clearTimer(t),this.model.timerMap.set(t,setTimeout(()=>{e(),this.clearTimer(t)},s))}clearTimer(t){const e=this.model.timerMap.get(t);e&&(clearTimeout(e),this.model.timerMap.delete(t))}selectTool(t,e){"selected"in t&&"boolean"==typeof t.selected&&(t.selected=e)}activateTool(t,e,s){s?He(t).onToolActivate(e).fire():He(t).onToolDeactivate(e).fire()}}function ne(t){const e=t.prototype;Object.defineProperty(e,"view",{get(){return this.mvc?.view},set(t){if(!this.mvc)throw new Error("view: missing this.mvc");this.mvc.view=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"model",{get(){return this.mvc?.model},set(t){if(!this.mvc)throw new Error("model: missing this.mvc");this.mvc.model=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"data",{get(){return this.mvc?.data},set(t){if(!this.mvc)throw new Error("data: missing this.mvc");this.mvc.data=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataId",{get(){return this.mvc?.dataId},set(t){if(!this.mvc)throw new Error("dataId: missing this.mvc");this.mvc.dataId=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataIndex",{get(){return this.mvc?.dataIndex},set(t){if(!this.mvc)throw new Error("dataIndex: missing this.mvc");this.mvc.dataIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataSize",{get(){return this.mvc?.dataSize},enumerable:!0,configurable:!0})}function ae(t){const e=t.prototype,s=Symbol("__selected__"),i=Symbol("__selectedClass__"),n=Symbol("__initialized__");Object.defineProperty(e,"selected",{get(){return!!this[s]},set(t){const e=this instanceof Element?this:this.element instanceof Element?this.element:void 0;if(!e)return void(this[s]=t);const n=this[i],a=this.getPropertiesValue?.(null,"defaultSelectedClass","selected")??"selected";this[s]=t,this[i]=a,n&&n!==a&&He(e).toggleClass(n,!1),He(e).toggleClass(a,!!t)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"getPropertiesValue",{value:function(t,e,s){if(null!=t)return t;let i=this.constructor;for(;i;){const t=i.config?.[e];if(null!=t)return t;i=Object.getPrototypeOf(i)}return s},configurable:!0,enumerable:!1}),Object.defineProperty(e,"destroy",{value:function(){},configurable:!0,enumerable:!1}),Object.defineProperty(e,"initialized",{get:function(){return this[n]??!1},configurable:!0,enumerable:!1}),Object.defineProperty(e,"initialize",{value:function(){this[n]||(this.setupUIElements?.(),this.setupUILayout?.(),this.setupUIListeners?.(),this.setupChangedCallbacks?.(),this.mvc&&this.mvc instanceof J&&this.mvc.initialize(),ct(this),this[n]=!0)},configurable:!0,enumerable:!1})}class re{static config={};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}mvc;constructor(t={}){this.mvc=new J({...t,element:this})}}ae(re),ne(re);let oe=(()=>{let s,i,n,a,r,o,l,c,h,u,p,m=re,g=[],b=[],y=[],v=[],k=[],E=[],S=[],w=[],C=[];return class T extends m{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(m[Symbol.metadata]??null):void 0;s=[Ft()],i=[Ft()],n=[Ft()],a=[Ft()],r=[f()],o=[f()],l=[f()],c=[f()],h=[f()],u=[f()],p=[f()],t(this,null,r,{kind:"setter",name:"keyEventsEnabled",static:!1,private:!1,access:{has:t=>"keyEventsEnabled"in t,set:(t,e)=>{t.keyEventsEnabled=e}},metadata:e},null,g),t(this,null,o,{kind:"setter",name:"wheelEventsEnabled",static:!1,private:!1,access:{has:t=>"wheelEventsEnabled"in t,set:(t,e)=>{t.wheelEventsEnabled=e}},metadata:e},null,g),t(this,null,l,{kind:"setter",name:"moveEventsEnabled",static:!1,private:!1,access:{has:t=>"moveEventsEnabled"in t,set:(t,e)=>{t.moveEventsEnabled=e}},metadata:e},null,g),t(this,null,c,{kind:"setter",name:"mouseEventsEnabled",static:!1,private:!1,access:{has:t=>"mouseEventsEnabled"in t,set:(t,e)=>{t.mouseEventsEnabled=e}},metadata:e},null,g),t(this,null,h,{kind:"setter",name:"touchEventsEnabled",static:!1,private:!1,access:{has:t=>"touchEventsEnabled"in t,set:(t,e)=>{t.touchEventsEnabled=e}},metadata:e},null,g),t(this,null,u,{kind:"setter",name:"clickEventEnabled",static:!1,private:!1,access:{has:t=>"clickEventEnabled"in t,set:(t,e)=>{t.clickEventEnabled=e}},metadata:e},null,g),t(this,null,p,{kind:"setter",name:"dragEventEnabled",static:!1,private:!1,access:{has:t=>"dragEventEnabled"in t,set:(t,e)=>{t.dragEventEnabled=e}},metadata:e},null,g),t(null,null,s,{kind:"field",name:"keyController",static:!1,private:!1,access:{has:t=>"keyController"in t,get:t=>t.keyController,set:(t,e)=>{t.keyController=e}},metadata:e},b,y),t(null,null,i,{kind:"field",name:"wheelController",static:!1,private:!1,access:{has:t=>"wheelController"in t,get:t=>t.wheelController,set:(t,e)=>{t.wheelController=e}},metadata:e},v,k),t(null,null,n,{kind:"field",name:"pointerController",static:!1,private:!1,access:{has:t=>"pointerController"in t,get:t=>t.pointerController,set:(t,e)=>{t.pointerController=e}},metadata:e},E,S),t(null,null,a,{kind:"field",name:"dispatchController",static:!1,private:!1,access:{has:t=>"dispatchController"in t,get:t=>t.dispatchController,set:(t,e)=>{t.dispatchController=e}},metadata:e},w,C),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static managers=[];static get instance(){return T.managers.length>0?T.managers[0]:new T}static get allManagers(){return[...this.managers]}static set allManagers(t){this.managers=t}keyController=(e(this,g),e(this,b,void 0));wheelController=(e(this,y),e(this,v,void 0));pointerController=(e(this,k),e(this,E,void 0));dispatchController=(e(this,S),e(this,w,void 0));constructor(t={}){super(),e(this,C),this.mvc.generate({model:Kt,controllers:[qt,Jt,Zt,ee],handlers:[ie]}),T.managers.push(this),this.model.authorizeEventScaling=t.authorizeEventScaling,this.model.scaleEventPosition=t.scaleEventPosition,this.model.state.enabled=t.enabled??!0,this.model.state.preventDefaultMouse=t.preventDefaultMouse??!0,this.model.state.preventDefaultTouch=t.preventDefaultTouch??!0,this.model.state.preventDefaultWheel=t.preventDefaultWheel??!0,this.unlock(),this.model.moveThreshold=t.moveThreshold||10,this.model.longPressDuration=t.longPressDuration||500,t.disableKeyEvents||(this.keyEventsEnabled=!0),t.disableWheelEvents||(this.wheelEventsEnabled=!0),t.disableMouseEvents||(this.mouseEventsEnabled=!0),t.disableTouchEvents||(this.touchEventsEnabled=!0),t.disableDragEvents||(this.dragEventEnabled=!0),t.disableClickEvents||(this.clickEventEnabled=!0),t.disableMoveEvent||(this.moveEventsEnabled=!0),document.addEventListener("pointerdown",this.pointerController.pointerDown,{passive:!1}),document.addEventListener("pointermove",this.pointerController.pointerMove,{passive:!1}),document.addEventListener("pointerup",this.pointerController.pointerUp,{passive:!1}),document.addEventListener("pointercancel",this.pointerController.pointerCancel,{passive:!1}),this.dispatchController.setupCustomDispatcher("pointerdown")}get inputDevice(){return this.model.inputDevice}get onInputDeviceChange(){return this.model.onInputDeviceChange}get currentClick(){return this.model.currentClick}get currentKeys(){return this.model.currentKeys}get onToolChange(){return this.model.onToolChange}get authorizeEventScaling(){return this.model.authorizeEventScaling}set authorizeEventScaling(t){this.model.authorizeEventScaling=t}get scaleEventPosition(){return this.model.scaleEventPosition}set scaleEventPosition(t){this.model.scaleEventPosition=t}get moveThreshold(){return this.model.moveThreshold}set moveThreshold(t){this.model.moveThreshold=t}get longPressDuration(){return this.model.longPressDuration}set longPressDuration(t){this.model.longPressDuration=t}set keyEventsEnabled(t){t?(document.addEventListener("keydown",this.keyController.keyDown),document.addEventListener("keyup",this.keyController.keyUp)):(document.removeEventListener("keydown",this.keyController.keyDown),document.removeEventListener("keyup",this.keyController.keyUp)),this.applyAndHookEvents(pt,ft,t)}set wheelEventsEnabled(t){t?document.body.addEventListener("wheel",this.wheelController.wheel,{passive:!1}):document.body.removeEventListener("wheel",this.wheelController.wheel),this.applyAndHookEvents(Et,St,t)}set moveEventsEnabled(t){this.applyAndHookEvents(bt,yt,t)}set mouseEventsEnabled(t){}set touchEventsEnabled(t){}set clickEventEnabled(t){this.applyAndHookEvents(mt,gt,t)}set dragEventEnabled(t){this.applyAndHookEvents(vt,kt,t)}lock(t,e){this.unlock(),this.model.lockState.lockOrigin=t;for(const t in e)this.model.lockState[t]=e[t]}unlock(){const t=this.model.state,e=this.model.lockState;e.enabled=t.enabled,e.preventDefaultMouse=t.preventDefaultMouse,e.preventDefaultTouch=t.preventDefaultTouch,e.preventDefaultWheel=t.preventDefaultWheel,e.lockOrigin=document.body}get enabled(){return this.model.state.enabled&&this.model.lockState.enabled}set enabled(t){this.model.state.enabled=t}get preventDefaultWheel(){return this.model.state.preventDefaultWheel&&this.model.lockState.preventDefaultWheel}set preventDefaultWheel(t){this.model.state.preventDefaultWheel=t}get preventDefaultMouse(){return this.model.state.preventDefaultMouse&&this.model.lockState.preventDefaultMouse}set preventDefaultMouse(t){this.model.state.preventDefaultMouse=t}get preventDefaultTouch(){return this.model.state.preventDefaultTouch&&this.model.lockState.preventDefaultTouch}set preventDefaultTouch(t){this.model.state.preventDefaultTouch=t}get toolsArray(){const t=[];for(const e of this.model.tools.values())t.push(...e.toArray());return t}getCurrentTool(t=this.model.currentClick){return this.model.currentTools.get(t)}getCurrentTools(t=this.model.currentClick){return this.getToolsByName(this.getCurrentToolName(t))}getCurrentToolName(t=this.model.currentClick){return this.getToolName(this.getCurrentTool(t))}getToolName(t){for(const[e,s]of this.model.tools.entries())if(s.has(t))return e}getSimilarTools(t){for(const[e,s]of this.model.tools.entries())if(s.has(t))return s.toArray();return[]}getToolsByName(t){return this.model.tools.get(t)?.toArray()||[]}getToolByName(t,e){const s=this.getToolsByName(t);return e?s?.find(e):s?.[0]}getToolsByKey(t){const e=this.model.mappedKeysToTool.get(t);return e?this.getToolsByName(e):[]}getToolByKey(t,e){const s=this.getToolsByKey(t);return e?s?.find(e):s?.[0]}addTool(t,e,s){this.model.tools.has(t)||this.model.tools.set(t,new te);const i=this.model.tools.get(t);i.has(e)||i.add(e),s&&this.model.mappedKeysToTool.set(s,t)}setTool(t,e,s={}){if(!d(t)&&!He(t).isTool(this))return;null==s.select&&(s.select=!0),null==s.activate&&(s.activate=!0),null==s.setAsNoAction&&(s.setAsNoAction=e==Bt.left);const i=this.model.currentTools.get(e);if(i){if(i===t)return;this.getSimilarTools(i).forEach(t=>{s.select&&this.model.utils.selectTool(t,!1),s.activate&&this.model.utils.activateTool(t,this.getToolName(i),!1)})}this.model.currentTools.set(e,t),s.setAsNoAction&&this.model.currentTools.set(Bt.none,t),this.getSimilarTools(t).forEach(e=>{s.activate&&this.model.utils.activateTool(e,this.getToolName(t),!0),s.select&&this.model.utils.selectTool(e,!0)}),this.onToolChange.fire(i,t,e)}setToolByKey(t){const e=this.model.mappedKeysToTool.get(t);return!!e&&(this.setTool(this.getToolByName(e),Bt.key,{select:!1}),!0)}setupCustomDispatcher(t){return this.dispatchController.setupCustomDispatcher(t)}applyAndHookEvents(t,e,s){this.model.utils.applyEventNames(s?t:e);for(const e in t)s?this.dispatchController.setupCustomDispatcher(e):this.dispatchController.removeCustomDispatcher(e)}destroy(){return this.keyEventsEnabled=!1,this.wheelEventsEnabled=!1,this.mouseEventsEnabled=!1,this.touchEventsEnabled=!1,this.dragEventEnabled=!1,this.clickEventEnabled=!1,this.onToolChange.clear(),this}}})();const le=new class{dataMap=new WeakMap;data(t){return t instanceof m&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}getBoundListenersSet(t){let e=this.data(t).boundListeners;return e||(e=new Set,this.data(t).boundListeners=e),e}getPreventDefaultListeners(t){let e=this.data(t).preventDefaultListeners;return e||(e={},this.data(t).preventDefaultListeners=e),e}bypassManager(t,e,s){t instanceof m&&(t=t.element),t&&("boolean"==typeof s?e.lock(t,{enabled:s,preventDefaultWheel:s,preventDefaultMouse:s,preventDefaultTouch:s}):e.lock(t,{enabled:s.enabled??!1,preventDefaultWheel:s.preventDefaultWheel??!1,preventDefaultMouse:s.preventDefaultMouse??!1,preventDefaultTouch:s.preventDefaultTouch??!1}))}getBoundListeners(t,e,s,i,n=oe.instance){return t instanceof m&&(t=t.element),t?(i||(i={}),[...this.getBoundListenersSet(t)].filter(t=>t.type===e&&t.manager===n&&t.toolName===s).filter(t=>{if(!i)return!0;for(const[e,s]of Object.entries(i))if(t.options?.[e]!==s)return!1;return!0})):[]}};function ce(){Object.defineProperty(m.prototype,"boundListeners",{get:function(){return le.getBoundListenersSet(this)},configurable:!0,enumerable:!0}),Object.defineProperty(m.prototype,"bypassManagerOn",{get:function(){return le.data(this).bypassCallback},set:function(t){le.data(this).bypassCallback=t},configurable:!0,enumerable:!0}),m.prototype.onTool=function(t,e,s,i,n=oe.instance){if(this.hasToolListener(t,e,s,n))return this;return n.setupCustomDispatcher?.(t),le.getBoundListenersSet(this).add({target:this,type:t,toolName:e,listener:s,bundledListener:t=>s(t,this),options:i,manager:n}),this},m.prototype.on=function(t,e,s,i=oe.instance){return this.onTool(t,void 0,e,s,i)},m.prototype.executeAction=function(t,e,s,i,n=oe.instance){if(!t)return!1;i||(i={});const a=e??n.getCurrentToolName();this.bypassManagerOn&&le.bypassManager(this,n,this.bypassManagerOn(s));const r=new Set,o=(e,a)=>{const o=e instanceof m?e:He(e),l=le.getBoundListenersSet(e),c=[...le.getBoundListeners(e,t,a,i,n)];if(0===c.length)return!1;let h=!1;for(const t of c)if(!r.has(t))try{t.listener(s,o)&&(h=!0)}finally{r.add(t),t.options?.once&&l.delete(t)}return h};if(a&&o(this,a))return!0;if(!i.capture&&a&&!this.isToolIgnored(a,t,n)&&this.applyTool(a,t,s,n))return!0;const l=this.getEmbeddedToolTarget(n),c=this.getToolNames(n);if(l&&c.length>0){let e=!1;for(const t of c)o(l,t)&&(e=!0);if(e)return!0;const a=He(l);if(!i.capture)for(const i of c)!a.isToolIgnored(i,t,n)&&He(l).applyTool(i,t,s,n)&&(e=!0);if(e)return!0}return o(this,void 0)},m.prototype.hasListener=function(t,e,s=oe.instance){return this.hasToolListener(t,void 0,e,s)},m.prototype.hasToolListener=function(t,e,s,i=oe.instance){return le.getBoundListeners(this,t,e,void 0,i).filter(t=>t.listener===s).length>0},m.prototype.hasListenersByType=function(t,e,s=oe.instance){return le.getBoundListeners(this,t,e,void 0,s).length>0},m.prototype.removeListener=function(t,e,s=oe.instance){return this.removeToolListener(t,void 0,e,s)},m.prototype.removeToolListener=function(t,e,s,i=oe.instance){const n=le.getBoundListenersSet(this);return le.getBoundListeners(this,t,e,void 0,i).filter(t=>t.listener===s).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),n.delete(t)}),this},m.prototype.removeListenersByType=function(t,e,s=oe.instance){const i=le.getBoundListenersSet(this);return le.getBoundListeners(this,t,e,void 0,s).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),i.delete(t)}),this},m.prototype.removeAllListeners=function(t=oe.instance){const e=this.boundListeners;return[...e].filter(e=>e.manager===t).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),e.delete(t)}),this},m.prototype.preventDefault=function(t){t||(t={});const e=t.manager??oe.instance,s=t.types??Mt,i=t.phase??"capture",n=t.stop??!1;le.data(this.element).preventDefaultOn=t.preventDefaultOn??le.data(this.element).preventDefaultOn??(()=>!0);const a=le.getPreventDefaultListeners(this);if(t.clearPreviousListeners)for(const[t,e]of Object.entries(a))this.removeListener(t,e),delete a[t];const r=new Set(jt);for(const t of new Set(s)){const s=e=>!!le.data(this.element).preventDefaultOn(t,e)&&(e.preventDefault?.(),"immediate"===n?e.stopImmediatePropagation?.():"stop"===n&&e.stopPropagation?.(),!0);a[t]=s;const o={};"capture"===i&&(o.capture=!0),r.has(t)&&(o.passive=!1),this.on(t,s,o,e)}return this}}const he=new class{dataMap=new WeakMap;data(t){return t instanceof m&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}setStyle(t,e,s,i=!1,n=!0){if(i)return void(t.element.style[e]=s.toString());let a=this.data(t.element).pendingStyles;a&&"object"==typeof a||(a={},this.data(t.element).pendingStyles=a),a[e]=s,n&&this.applyStyles(t)}applyStyles(t){const e=this.data(t.element).pendingStyles;e&&"object"==typeof e&&requestAnimationFrame(()=>{for(const s in e)"cssText"==s?t.element.style.cssText+=";"+e.cssText:t.element.style[s]=e[s];this.data(t.element).pendingStyles={}})}};function ue(){Object.defineProperty(m.prototype,"closestRoot",{get:function(){let t=this.element;for(;t;){if(t instanceof Element&&t.shadowRoot)return t.shadowRoot;t=t.parentElement}return document.head},configurable:!1,enumerable:!0}),m.prototype.setStyle=function(t,e,s=!1){return t&&null!=e&&(this.element instanceof HTMLElement||this.element instanceof SVGElement)?(he.setStyle(this,t,e,s),this):this},m.prototype.appendStyle=function(t,e,s=", ",i=!1){if(!t||null==e)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;const n=this.element.style[t]||"";return s=n.length>0?s:"",he.setStyle(this,t,n+s+e,i),this},m.prototype.setStyles=function(t,e=!1){if(!t||"number"==typeof t)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;let s={};return"object"==typeof t?s=t:"string"==typeof t&&t.split(";").forEach(t=>{const[e,i]=t.split(":").map(t=>t.trim());e&&i&&(s[e]=i)}),Object.entries(s).forEach(([t,s])=>he.setStyle(this,t,s,e,!1)),e||he.applyStyles(this),this}}const de=new class{elements=new WeakMap;tools=new WeakMap;getOrCreate(t,e,s){let i=t.get(e);return i||(i=s(),t.set(e,i)),i}getElementData(t,e){t instanceof m&&(t=t.element);const s=this.getOrCreate(this.elements,t,()=>new WeakMap);return this.getOrCreate(s,e,()=>({tools:new Set,ignoreAllTools:!1,ignoredTools:new Map,activationDelegates:new Map,deactivationDelegates:new Map}))}getToolsData(t,e){const s=this.getOrCreate(this.tools,t,()=>new Map);return this.getOrCreate(s,e,()=>({behaviors:new Map}))}getActivationDelegate(t,e,s){const i=this.getElementData(t,s).activationDelegates;return i.get(e)||i.set(e,new Z),i.get(e)}getDeactivationDelegate(t,e,s){const i=this.getElementData(t,s).deactivationDelegates;return i.get(e)||i.set(e,new Z),i.get(e)}saveTool(t,e,s){t instanceof m&&(t=t.element),t&&this.getElementData(t,s).tools.add(e)}getToolNames(t,e){return t instanceof m&&(t=t.element),t?[...this.getElementData(t,e).tools]:[]}setEmbeddedToolTarget(t,e,s){e instanceof m&&(e=e.element),e&&(t instanceof m&&(t=t.element),t&&(this.getElementData(t,s).embeddedTarget=e))}getEmbeddedToolTarget(t,e){if(t instanceof m&&(t=t.element),t)return this.getElementData(t,e).embeddedTarget}addToolBehavior(t,e,s,i){const n=this.getToolsData(i,t).behaviors;this.getOrCreate(n,e,()=>new Set).add(s)}getToolBehaviors(t,e,s){const i=this.getToolsData(s,t).behaviors;return[...this.getOrCreate(i,e,()=>new Set)]}removeToolBehaviors(t,e,s){const i=this.getToolsData(s,t).behaviors;this.getOrCreate(i,e,()=>new Set).clear()}clearToolBehaviors(t){this.getOrCreate(this.tools,t,()=>new Map).clear()}ignoreTool(t,e,s,i,n){const a=this.getElementData(t,n).ignoredTools;if(s){const t=a.get(e);if(!i)return void(t instanceof Set&&t.delete(s));t instanceof Set||a.set(e,new Set),a.get(e).add(s)}else i?a.set(e,"all"):a.delete(e)}isToolIgnored(t,e,s,i){const n=this.getElementData(t,i).ignoredTools?.get(e);return!!n&&("all"===n||!s||n.has(s))}};function pe(){m.prototype.makeTool=function(t,e){return t?(e||(e={}),e.manager||(e.manager=oe.instance),e.manager.addTool(t,this.element,e.key),e.customActivation&&"function"==typeof e.customActivation?e.customActivation(this,e.manager):(e.activationEvent??=Ct.click,e.clickMode??=Bt.left,this.on(e.activationEvent,()=>(e.manager.setTool(this.element,e.clickMode),!0),void 0,e.manager)),de.saveTool(this,t,e.manager),e.onActivate&&de.getActivationDelegate(this,t,e.manager).add(e.onActivate),e.onDeactivate&&de.getDeactivationDelegate(this,t,e.manager).add(e.onDeactivate),this):this},m.prototype.isTool=function(t=oe.instance){return de.getToolNames(this.element,t).length>0},m.prototype.getToolNames=function(t=oe.instance){return de.getToolNames(this.element,t)},m.prototype.getToolName=function(t=oe.instance){const e=de.getToolNames(this.element,t);if(e.length>0)return e[0]},m.prototype.onToolActivate=function(t,e=oe.instance){return t||(t=this.getToolName(e)),de.getActivationDelegate(this,t,e)},m.prototype.onToolDeactivate=function(t,e=oe.instance){return t||(t=this.getToolName(e)),de.getDeactivationDelegate(this,t,e)},m.prototype.addToolBehavior=function(t,e,s=this.getToolName(),i=oe.instance){return t&&s&&(i.setupCustomDispatcher?.(t),de.addToolBehavior(s,t,e,i)),this},m.prototype.hasToolBehavior=function(t,e=this.getToolName(),s=oe.instance){return!(!t||!e)&&de.getToolBehaviors(e,t,s).length>0},m.prototype.removeToolBehaviors=function(t,e=this.getToolName(),s=oe.instance){return t&&e&&de.removeToolBehaviors(e,t,s),this},m.prototype.clearToolBehaviors=function(t=oe.instance){return de.clearToolBehaviors(t),this},m.prototype.embedTool=function(t,e=oe.instance){return this.isTool(e)&&de.setEmbeddedToolTarget(this.element,t,e),this},m.prototype.isEmbeddedTool=function(t=oe.instance){return!!de.getEmbeddedToolTarget(this.element,t)},m.prototype.getEmbeddedToolTarget=function(t=oe.instance){return de.getEmbeddedToolTarget(this.element,t)},m.prototype.applyTool=function(t,e,s,i=oe.instance){let n=!1;const a=de.getToolBehaviors(t,e,i),r={};return r.embeddedTarget=de.getEmbeddedToolTarget(this.element,i),r.isEmbedded=!!r.embeddedTarget,a.forEach(t=>{t(s,this.element,r)&&(n=!0)}),n},m.prototype.ignoreTool=function(t,e,s=!0,i=oe.instance){return de.ignoreTool(this.element,t,e,s,i),this},m.prototype.ignoreAllTools=function(t=!0,e=oe.instance){return de.getElementData(this.element,e).ignoreAllTools=t,this},m.prototype.isToolIgnored=function(t,e,s=oe.instance){return!!de.getElementData(this.element,s).ignoreAllTools||de.isToolIgnored(this.element,t,e,s)}}const fe=new class{dataMap=new WeakMap;data(t){return t instanceof m&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{substrates:new Map,onChange:new Z}),this.dataMap.get(t)):{}}createSubstrate(t,e){const s={objects:t instanceof Element?t.children:t.childNodes,temporaryMetadata:new WeakMap,persistentMetadata:new WeakMap,onActivate:new Z,onDeactivate:new Z,solvers:new Set};return this.data(t).substrates.set(e,s),s}setCurrent(t,e){return!!this.getSubstrates(t).includes(e)&&(this.data(t).current=e,!0)}getSubstrateData(t,e){return this.data(t).substrates.get(e)}getSubstrates(t){return[...this.data(t).substrates.keys()]}getPersistentMetadata(t,e,s){const i=this.getSubstrateData(t,e);if(!i||!i.persistentMetadata)return{};let n=i.persistentMetadata.get(s);return n||(n={},i.persistentMetadata.set(s,n)),n}setPersistentMetadata(t,e,s,i){const n=this.getSubstrateData(t,e);n&&n.persistentMetadata&&n.persistentMetadata.set(s,i)}getTemporaryMetadata(t,e,s){const i=this.getSubstrateData(t,e);if(!i||!i.temporaryMetadata)return;let n=i.temporaryMetadata.get(s);return n||(n={},i.temporaryMetadata.set(s,n)),n}setTemporaryMetadata(t,e,s,i){const n=this.getSubstrateData(t,e);n&&n.temporaryMetadata&&n.temporaryMetadata.set(s,i)}};function me(){m.prototype.makeSubstrate=function(t,e){return fe.createSubstrate(this,t),e?.onActivate&&this.onSubstrateActivate(t).add(e.onActivate),e?.onDeactivate&&this.onSubstrateDeactivate(t).add(e.onDeactivate),this.currentSubstrate||(this.currentSubstrate=t),this},Object.defineProperty(m.prototype,"substrates",{get:function(){return fe.getSubstrates(this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(m.prototype,"currentSubstrate",{get:function(){return fe.data(this).current},set:function(t){if(!t)return;const e=this.currentSubstrate;fe.setCurrent(this,t)&&this.onSubstrateChange.fire(e,t)},configurable:!1,enumerable:!0}),Object.defineProperty(m.prototype,"onSubstrateChange",{get:function(){return fe.data(this).onChange},configurable:!1,enumerable:!0}),m.prototype.onSubstrateActivate=function(t=this.currentSubstrate){return fe.getSubstrateData(this,t)?.onActivate??new Z},m.prototype.onSubstrateDeactivate=function(t=this.currentSubstrate){return fe.getSubstrateData(this,t)?.onDeactivate??new Z},m.prototype.getSubstrateObjectList=function(t=this.currentSubstrate){const e=new Set;return t?(Array.from(fe.getSubstrateData(this,t).objects).forEach(s=>{fe.getPersistentMetadata(this,t,s).ignored||e.add(s)}),e):e},m.prototype.setSubstrateObjectList=function(t,e=this.currentSubstrate){return t&&e?(fe.getSubstrateData(this,e).objects=t,this):this},m.prototype.addObjectToSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return this;fe.getPersistentMetadata(this,e,t).ignored=!1;const s=fe.getSubstrateData(this,e).objects;if(s instanceof HTMLCollection||s instanceof NodeList)return this;try{s.has(t)||s.add(t)}catch{}return this},m.prototype.removeObjectFromSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return this;fe.getPersistentMetadata(this,e,t).ignored=!0;const s=fe.getSubstrateData(this,e).objects;return s instanceof Set&&s.delete(t),this},m.prototype.hasObjectInSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return!1;const s=this.getSubstrateObjectList(e);for(const e of s)if(e===t)return!0;return!1},m.prototype.wasObjectProcessedBySubstrate=function(t,e=this.currentSubstrate){return!(!t||!e)&&!!fe.getTemporaryMetadata(this,e,t)?.processed},m.prototype.addSolver=function(t,e=this.currentSubstrate){return fe.getSubstrateData(this,e).solvers?.add(t),this},m.prototype.removeSolver=function(t,e=this.currentSubstrate){return fe.getSubstrateData(this,e).solvers?.delete(t),this},m.prototype.clearSolvers=function(t=this.currentSubstrate){return fe.getSubstrateData(this,t).solvers?.clear(),this},m.prototype.resolveSubstrate=function(t={},e=this.currentSubstrate){if(t||(t={}),t.substrate=t.substrate??e,!t.substrate)return this;t.manager||(t.manager=oe.instance),t.eventOptions||(t.eventOptions={});const s=fe.getSubstrateData(this,t.substrate);return s?(s.solvers?.forEach(e=>{let i;s.temporaryMetadata=new WeakMap,t.eventTarget&&(s.temporaryMetadata.set(t.eventTarget,{processed:!0,isMainTarget:!0}),e({...t,target:t.eventTarget}));do{i=Array.from(this.getSubstrateObjectList(t.substrate)).find(t=>!s.temporaryMetadata.get(t)?.processed),i&&(s.temporaryMetadata.set(i,{processed:!0}),e({...t,target:i}))}while(i)}),this):this}}const ge=new WeakMap;function be(t){if(ge.has(t))return ge.get(t);let e,s,i=!1;const n=function(...n){if(i)return e;if(s)return s;try{const a=t.apply(this,n);return a instanceof Promise?(s=a.then(t=>(e=t,i=!0,s=null,t)).catch(t=>{throw s=null,t}),s):(e=a,i=!0,a)}catch(t){throw t}};return ge.set(t,n),n}function ye(t,e){if("method"!==e.kind)throw new Error(`@callOnce can only be used on methods (got: ${e.kind}).`);const s=String(e.name),i=Symbol(`__callOnce__${s}`);return function(...e){if(!this[i])return this[i]=!0,t.apply(this,e);console.warn(`Function ${s} has already been called once on this instance and will not be called again.`)}}function ve(...t){if(t.length<2)return!0;for(let e=0;e<t.length-1;e++)if(t[e]!=t[e+1])return!1;return!0}function ke(t,...e){if(e.length<1)return!0;for(const s of e)if(t==s)return!0;return!1}function Ee(t,...e){if(e.length<1)return!0;for(const s of e){let e=!1;for(const i of t)s==i&&(e=!0);if(!e)return!1}return!0}function Se(t,e,s=0){return t<s&&(t=s),t>e&&(t=e),t}function we(t,e=0){for(;t<0;)t+=e;for(;t>=e;)t-=e;return t}let Ce=(()=>{let s,i,n,a,r,o,l,c,h,d,p,m,g,b,y,v=[];return class k{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[f()],i=[f()],n=[f()],a=[f()],r=[f()],o=[f()],l=[f()],c=[f()],h=[f()],d=[f()],p=[f()],m=[f()],g=[f()],b=[f()],y=[f()],t(this,null,s,{kind:"setter",name:"enabled",static:!1,private:!1,access:{has:t=>"enabled"in t,set:(t,e)=>{t.enabled=e}},metadata:e},null,v),t(this,null,i,{kind:"setter",name:"propertiesEnabled",static:!1,private:!1,access:{has:t=>"propertiesEnabled"in t,set:(t,e)=>{t.propertiesEnabled=e}},metadata:e},null,v),t(this,null,n,{kind:"setter",name:"stylesEnabled",static:!1,private:!1,access:{has:t=>"stylesEnabled"in t,set:(t,e)=>{t.stylesEnabled=e}},metadata:e},null,v),t(this,null,a,{kind:"setter",name:"classesEnabled",static:!1,private:!1,access:{has:t=>"classesEnabled"in t,set:(t,e)=>{t.classesEnabled=e}},metadata:e},null,v),t(this,null,r,{kind:"setter",name:"replaceWithEnabled",static:!1,private:!1,access:{has:t=>"replaceWithEnabled"in t,set:(t,e)=>{t.replaceWithEnabled=e}},metadata:e},null,v),t(this,null,o,{kind:"setter",name:"transitionEnabled",static:!1,private:!1,access:{has:t=>"transitionEnabled"in t,set:(t,e)=>{t.transitionEnabled=e}},metadata:e},null,v),t(this,null,l,{kind:"setter",name:"properties",static:!1,private:!1,access:{has:t=>"properties"in t,set:(t,e)=>{t.properties=e}},metadata:e},null,v),t(this,null,c,{kind:"setter",name:"styles",static:!1,private:!1,access:{has:t=>"styles"in t,set:(t,e)=>{t.styles=e}},metadata:e},null,v),t(this,null,h,{kind:"setter",name:"classes",static:!1,private:!1,access:{has:t=>"classes"in t,set:(t,e)=>{t.classes=e}},metadata:e},null,v),t(this,null,d,{kind:"setter",name:"replaceWith",static:!1,private:!1,access:{has:t=>"replaceWith"in t,set:(t,e)=>{t.replaceWith=e}},metadata:e},null,v),t(this,null,p,{kind:"setter",name:"transitionProperties",static:!1,private:!1,access:{has:t=>"transitionProperties"in t,set:(t,e)=>{t.transitionProperties=e}},metadata:e},null,v),t(this,null,m,{kind:"setter",name:"transitionDuration",static:!1,private:!1,access:{has:t=>"transitionDuration"in t,set:(t,e)=>{t.transitionDuration=e}},metadata:e},null,v),t(this,null,g,{kind:"setter",name:"transitionTimingFunction",static:!1,private:!1,access:{has:t=>"transitionTimingFunction"in t,set:(t,e)=>{t.transitionTimingFunction=e}},metadata:e},null,v),t(this,null,b,{kind:"setter",name:"transitionDelay",static:!1,private:!1,access:{has:t=>"transitionDelay"in t,set:(t,e)=>{t.transitionDelay=e}},metadata:e},null,v),t(this,null,y,{kind:"setter",name:"transition",static:!1,private:!1,access:{has:t=>"transition"in t,set:(t,e)=>{t.transition=e}},metadata:e},null,v),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}timeRegex=(e(this,v),/^(\d+(?:\.\d+)?)(ms|s)?$/i);attachedObjects=[];_states;values;constructor(t){this.enable({global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0}),this.properties=t.properties||{},this.classes=t.classes||{},this.styles=t.styles||{},this.replaceWith=t.replaceWith||{},this.transition=t.transition??"all 0s linear 0s",t.transitionProperties&&(this.transitionProperties=t.transitionProperties),void 0!==t.transitionDuration&&(this.transitionDuration=t.transitionDuration),t.transitionTimingFunction&&(this.transitionTimingFunction=t.transitionTimingFunction),void 0!==t.transitionDelay&&(this.transitionDelay=t.transitionDelay),t.transition||t.transitionProperties||t.transitionDuration||t.transitionTimingFunction||t.transitionDelay||(this.transitionEnabled=!1),t.states&&(this.states=t.states),t.attachedObjects&&this.attachAll(...t.attachedObjects)}attach(t,e,s){const i=this.getData(t);if(i&&e&&(i.onSwitch=e),!i)return this.attachObject(t,s,e),this}attachAll(...t){return t.forEach(t=>{this.getData(t)||this.attachObject(t)}),this}attachAllAt(t,...e){return e.forEach((e,s)=>{this.getData(e)||this.attachObject(e,t+s)}),this}detach(...t){return t.forEach(t=>{const e=this.getData(t);e&&this.detachObject(e)}),this}attachObject(t,e,s){(null==e||isNaN(e))&&(e=this.attachedObjects.length),e<0&&(e=0);const i=this.generateNewData(t,s);return this.attachedObjects.splice(e,0,i),He(t).reifects?.attach(this),i.lastState=this.stateOf(t),this.applyResolvedValues(i,!1,!0),i}detachObject(t){this.attachedObjects.splice(this.attachedObjects.indexOf(t),1)}getData(t){if(!t)return null;for(const e of this.attachedObjects){const s=this.getObject(e);if(s&&s==t)return e}return null}getObject(t){if(!t)return null;return t.object.deref()||null}get states(){return this._states}set states(t){this._states=t||this.getAllStates()}stateOf(t){if(!t)return;const e=this.getData(t);if(e){if(e.lastState)return e.lastState;if(!(t instanceof HTMLElement))return this.states[0];e.resolvedValues||this.processRawProperties(e);for(const s of this.states){if(!e.resolvedValues?.styles?.[s])continue;let i=!0;for(const[n,a]of Object.entries(e.resolvedValues.styles[s]))if(t.style[n]!=a){i=!1;break}if(i)return e.lastState=s,s}return this.states[0]}}getAllStates(){const t=[...this.states];for(const e of[this.properties,this.classes,this.styles,this.replaceWith])if("object"==typeof e)for(const s of Object.keys(e))t.includes(s)||t.push(s);return 0==t.length&&console.warn("No states found for this particular reifect:",this),t}parseState(t){if("boolean"!=typeof t)return this.states.includes(t)?t:this.states[0];for(const e of t?["true","on","in","enabled","shown"]:["false","off","out","disabled","hidden"])if(this.states.includes(e))return e;return this.states[0]}set enabled(t){this.refreshResolvedValues()}set propertiesEnabled(t){this.refreshProperties()}set stylesEnabled(t){this.refreshStyles()}set classesEnabled(t){this.refreshClasses()}set replaceWithEnabled(t){this.refreshReplaceWith()}set transitionEnabled(t){this.refreshTransition()}enable(t,e){if("boolean"==typeof t)this.enabled=t;else{if(!t)return;Object.entries(t).forEach(([t,e])=>{"global"==t?this.enabled=e:this[t+"Enabled"]=e})}}enableObject(t,e){const s=this.getData(t);if(s)if("boolean"==typeof e)s.enabled.global=e;else{if(!e)return;Object.entries(e).forEach(([t,e])=>s.enabled[t]=e)}}getObjectEnabledState(t){return this.getData(t)?.enabled}set properties(t){}set styles(t){}set classes(t){}set replaceWith(t){}set transitionProperties(t){}set transitionDuration(t){}set transitionTimingFunction(t){}set transitionDelay(t){}set transition(t){if(!t)return;const e="string"==typeof t?this.processTransitionString(t):this.processTransitionObject(t);void 0!==e.transitionProperties&&(this.transitionProperties=e.transitionProperties),void 0!==e.transitionDuration&&(this.transitionDuration=e.transitionDuration),void 0!==e.transitionDelay&&(this.transitionDelay=e.transitionDelay),void 0!==e.transitionTimingFunction&&(this.transitionTimingFunction=e.transitionTimingFunction)}processTransitionObject(t){const e={};for(const[s,i]of Object.entries(t)){if(!this.states.includes(s))continue;if("string"!=typeof i)continue;const t=this.processTransitionString(i);void 0!==t.transitionProperties&&(e.transitionProperties[s]=t.transitionProperties),void 0!==t.transitionDuration&&(e.transitionDuration[s]=t.transitionDuration),void 0!==t.transitionDelay&&(e.transitionDelay[s]=t.transitionDelay),void 0!==t.transitionTimingFunction&&(e.transitionTimingFunction[s]=t.transitionTimingFunction)}return e}processTransitionString(t){const e=t.trim().replace(/,/g," ").split(/\s+/).filter(t=>t.length>0),s={transitionProperties:[]};let i=0;for(;i<e.length&&!this.timeRegex.test(e[i]);)s.transitionProperties.push(e[i]),i++;if(i<e.length){const t=this.parseTime(e[i]);isNaN(t)||(s.transitionDuration=t),i++}if(i<e.length&&(s.transitionTimingFunction=e[i],i++),i<e.length){const t=this.parseTime(e[i]);isNaN(t)||(s.transitionDelay=t),i++}return s}getTransitionString(t,e=t.lastState){let s="";return t.resolvedValues.transitionProperties[e].forEach(i=>s+=", "+i+" "+(t.resolvedValues.transitionDuration[e]||0)+"s "+(t.resolvedValues.transitionTimingFunction[e]||"linear")+" "+(t.resolvedValues.transitionDelay[e]||0)+"s"),s.substring(2)}initialize(t,e,s){this.enabled&&(t=this.parseState(t),s=this.initializeOptions(s,e),this.getEnabledObjectsData(e,s).forEach(e=>{!s.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,s.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!0,s?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))}))}apply(t,e,s){this.enabled&&(t=this.parseState(t),s=this.initializeOptions(s,e),this.getEnabledObjectsData(e,s).forEach(e=>{!s.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,s.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!1,s?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))}))}toggle(t,e){if(!this.enabled)return;t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[];const s=this.getData(t[0])?.lastState,i=we(s?this.states.indexOf(s)+1:0,this.states.length);this.apply(this.states[i],t,e)}reloadFor(t){if(!this.enabled)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global?(this.applyResolvedValues(e),this):this}reloadTransitionFor(t){if(!this.enabled||!this.transitionEnabled)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global&&e.enabled.transition?(this.applyTransition(e,e.lastState),this):this}getEnabledObjectsData(t,e){if(!this.enabled)return console.warn("The reifier object you are trying to access is disabled."),[];t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[],(e=this.initializeOptions(e,t)).attachObjects&&t.forEach(t=>this.attach(t)),e.executeForAll&&(t=[],this.attachedObjects.forEach(e=>{const s=e.object.deref();s&&t.push(s)}));const s=[];return t.forEach(t=>{const i=this.getData(t)||this.generateNewData(t);this.filterEnabledObjects(i)&&((e.recomputeIndices||null==i.objectIndex)&&(i.objectIndex=s.length),s.push(i))}),s.forEach(t=>{(e.recomputeIndices||null==t.totalObjectCount)&&(t.totalObjectCount=s.length)}),s}applyResolvedValues(t,e=!1,s=!1){if(this.applyStyles(t,t.lastState,s),!e){const e=He(t.object.deref()).reifects;this.attachedObjects.includes(t)&&e?e.reloadTransitions():this.applyTransition(t,t.lastState)}this.applyReplaceWith(t,t.lastState),this.applyProperties(t,t.lastState),this.applyClasses(t,t.lastState)}refreshResolvedValues(){this.refreshProperties(),this.refreshStyles(),this.refreshClasses(),this.refreshReplaceWith(),this.refreshTransition()}applyProperties(t,e=t.lastState){if(!this.enabled||!this.propertiesEnabled)return;if(!t.enabled.global||!t.enabled.properties)return;const s=t.resolvedValues?.properties?.[e];if(!s)return;const i=t.object.deref();if(i)for(const[t,e]of Object.entries(s))if(t&&null!=e)try{i[t]=e}catch(s){console.error(`Unable to set property ${t} to ${e}: ${s.message}`)}}refreshProperties(){this.enabled&&this.propertiesEnabled&&this.attachedObjects.forEach(t=>this.applyProperties(t))}applyReplaceWith(t,e=t.lastState){if(!this.enabled||!this.replaceWithEnabled)return;if(!t.enabled.global||!t.enabled.replaceWith)return;const s=t.resolvedValues?.replaceWith?.[e];if(s)try{const e=t.object.deref();e&&e instanceof Node&&s instanceof Node&&e.parentNode?.replaceChild(s,e),t.object=new WeakRef(s)}catch(t){console.error(`Unable to replace object: ${t.message}`)}}refreshReplaceWith(){this.enabled&&this.replaceWithEnabled&&this.attachedObjects.forEach(t=>this.applyReplaceWith(t))}applyClasses(t,e=t.lastState){if(!this.enabled||!this.classesEnabled)return;if(!t.enabled.global||!t.enabled.classes)return;const s=t.resolvedValues?.classes;if(!s)return;const i=t.object.deref();if(i&&i instanceof Element)for(const[t,n]of Object.entries(s))He(i).toggleClass(n,e==t)}refreshClasses(){this.enabled&&this.classesEnabled&&this.attachedObjects.forEach(t=>this.applyClasses(t))}applyStyles(t,e=t.lastState,s=!1){if(!this.enabled||!this.stylesEnabled)return;if(!t.enabled.global||!t.enabled.styles)return;if(!t.resolvedValues?.styles)return;const i=t.object.deref();i&&i instanceof Element&&He(i).setStyles(t.resolvedValues.styles[e],s)}refreshStyles(){this.enabled&&this.stylesEnabled&&this.attachedObjects.forEach(t=>this.applyStyles(t))}applyTransition(t,e=t.lastState){if(!this.enabled||!this.transitionEnabled)return;if(!t.enabled.global||!t.enabled.transition)return;const s=t.object.deref();s&&s instanceof Element&&t.resolvedValues&&He(s).appendStyle("transition",this.getTransitionString(t,e),", ",!0)}refreshTransition(){for(const t of this.attachedObjects){const e=He(t.object?.deref()).reifects;e&&e.reloadTransitions()}}filterEnabledObjects(t){return!(!t.enabled||!t.enabled.global)||(console.warn("The reified properties instance you are trying to set on an object is disabled for this particular object."),!1)}processRawProperties(t,e){if(t.resolvedValues||(t.resolvedValues={properties:void 0,styles:void 0,classes:void 0,replaceWith:void 0,transitionProperties:void 0,transitionDuration:void 0,transitionTimingFunction:void 0,transitionDelay:void 0}),u(e))return;const s={properties:this.properties,styles:this.styles,classes:this.classes,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay,...e||{}};t.resolvedValues.properties={},this.states.forEach(e=>this.processRawPropertyForState(t,"properties",s.properties,e)),"transitionProperties"in s&&(t.resolvedValues.transitionProperties={},this.states.forEach(e=>this.processRawPropertyForState(t,"transitionProperties",s.transitionProperties,e)));for(const[e,i]of Object.entries(s))"transitionProperties"!=e&&"properties"!=e&&(t.resolvedValues[e]={},this.states.forEach(s=>this.processRawPropertyForState(t,e,i,s)))}generateNewData(t,e){return{object:new WeakRef(t),enabled:{global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0},lastState:this.stateOf(t),onSwitch:e}}initializeOptions(t,e){return e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[],(t=t||{}).attachObjects=t.attachObjects??!0,t.executeForAll=t.executeForAll??0===e.length,t.recomputeIndices=t.recomputeIndices??0!==e.length,t.recomputeProperties=t.recomputeProperties??0!==e.length,t}clone(){return new k({states:this.states,properties:this.properties,classes:this.classes,styles:this.styles,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay})}processRawPropertyForState(t,e,s,i){let n;const a=t.object.deref();if(a){if("function"==typeof s)n=s(i,t.objectIndex,t.totalObjectCount,a);else if("object"==typeof s&&Ee(this.states,...Object.keys(s))){const e=s[i];n="function"==typeof e?e(t.objectIndex,t.totalObjectCount,a):e}else n=s;if("properties"!=e&&"transitionProperties"!=e||"string"!=typeof n){if("styles"==e){if(null==t.resolvedValues.styles[i]&&(t.resolvedValues.styles[i]={}),"number"==typeof n)return void t.resolvedValues.transitionProperties[i].forEach(e=>t.resolvedValues.styles[i][e]=n);if("string"==typeof n){const e=n.split(";").map(t=>t.split(":").map(t=>t.trim()));if(1==e.length&&1==e[0].length)return void t.resolvedValues.transitionProperties[i].forEach(s=>t.resolvedValues.styles[i][s]=e[0][0])}}}else n=n.split(" ");t.resolvedValues[e][i]=n}}parseTime(t){const e=t.match(this.timeRegex);if(!e)return NaN;const s=parseFloat(e[1]);return"ms"===(e[2]?.toLowerCase()??"s")?s/1e3:s}}})();function Te(t){return new Ce(t)}var Oe,Pe,De,xe,Ae,Me,je,Ie,Be,Ne;!function(t){t.vertical="vertical",t.horizontal="horizontal"}(Oe||(Oe={})),function(t){t.left="left",t.right="right"}(Pe||(Pe={})),function(t){t.top="top",t.bottom="bottom"}(De||(De={})),function(t){t.top="top",t.bottom="bottom",t.left="left",t.right="right"}(xe||(xe={})),function(t){t.in="in",t.out="out"}(Ae||(Ae={})),function(t){t.on="on",t.off="off"}(Me||(Me={})),function(t){t.open="open",t.closed="closed"}(je||(je={})),function(t){t.visible="visible",t.hidden="hidden"}(Ie||(Ie={})),function(t){t.public="public",t.protected="protected",t.private="private"}(Be||(Be={})),function(t){t.min="min",t.max="max"}(Ne||(Ne={}));class Ve{attachedNode;reifects;_enabled;constructor(t){this.attachedNode=t,this.reifects=[],this._enabled={},this.enabled=!0}attach(...t){return t.forEach(t=>{this.reifects.some(e=>e.deref()==t)||(this.reifects.push(new WeakRef(t)),t.attach(this.attachedNode))}),this}detach(...t){return t.forEach(t=>{const e=this.reifects.find(e=>e.deref()==t);e&&(this.reifects.splice(this.reifects.indexOf(e),1),t.detach(this.attachedNode))}),this}initialize(t,e,s){return t.initialize(e,this.attachedNode,s),this}apply(t,e,s){return t.apply(e,this.attachedNode,s),this}toggle(t,e){return t.toggle(this.attachedNode,e),this}clear(){this.attachedNode instanceof Node&&He(this.attachedNode).setStyle("transition","",!0)}reload(){this.clear(),this.reifects.forEach(t=>t.deref()?.reloadFor(this.attachedNode))}reloadTransitions(){this.clear(),this.reifects.forEach(t=>t.deref()?.reloadTransitionFor(this.attachedNode))}get enabled(){return this._enabled}set enabled(t){if("boolean"==typeof t)this._enabled.global=t;else{if(!t)return;for(const[e,s]of Object.entries(t))this._enabled[e]=s}}getReifectEnabledState(t){return t.getObjectEnabledState(this.attachedNode)}enableReifect(t,e){t.enableObject(this.attachedNode,e)}}const _e=new class{dataMap=new WeakMap;data(t){return t instanceof m&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}},Fe=new Ce({states:[Ie.visible,Ie.hidden],styles:t=>`visibility: ${t}`});function Le(){Object.defineProperty(m.prototype,"reifects",{get:function(){if(!this.element)return;const t=_e.data(this.element);return t.reifects||(t.reifects=new Ve(this)),t.reifects},configurable:!1,enumerable:!0}),Object.defineProperty(m.prototype,"showTransition",{get:function(){if(!this.element)return;const t=_e.data(this.element);return t.showTransition||(t.showTransition=Fe),t.showTransition},set:function(t){this.element&&(_e.data(this.element).showTransition=t)},configurable:!0,enumerable:!0}),Object.defineProperty(m.prototype,"isShown",{get:function(){if(!this.element)return;const t=this.showTransition.stateOf(this);return t==Ie.visible||t!=Ie.hidden&&("none"!=this.element.style.display&&"hidden"!=this.element.style.visibility&&"0"!=this.element.style.opacity)},configurable:!1,enumerable:!0}),m.prototype.show=function(t,e={executeForAll:!1}){if(this.element)return this.showTransition.apply(t?Ie.visible:Ie.hidden,this.element,e),this}}const ze=new WeakMap;function Re(t){let e;if(Ue(),t||(t="div"),"string"==typeof t)e=D({tag:t});else if("object"==typeof t){if(t instanceof m)return t;e=t instanceof Node?t:t.element&&"object"==typeof t.element?t.element:t}const s=ze.get(e);if(s)return s;const i=new m;return i.element=e,ze.set(e,i),i}function We(t){return Re(t)}function Ke(t){return Re(t)}function He(t){return Re(t)}const Ue=be(function(t={}){t.excludeHierarchyFunctions||b(),t.excludeMiscFunctions||v(),t.excludeClassFunctions||E(),t.excludeElementFunctions||At(),t.excludeEventFunctions||ce(),t.excludeStyleFunctions||ue(),t.excludeToolFunctions||pe(),t.excludeSubstrateFunctions||me(),t.excludeReifectFunctions||Le()});function $e(t={}){return function(e,s){const{kind:i,name:n,static:a}=s,r=n,l=function(t){return Symbol(`__cache__${t}`)}(r),c=Symbol(`__cache__setup__${r}`),h=[],u=function(t=!0){if(!t)return;const e=this[l];if(e){e instanceof Map?e.clear():delete this[l];for(const t of h)clearTimeout(t);h.length=0}},d=function(){this[c]||(this[c]=!0,function(t,e,s,i,n,a,r){if(a.onEvent){const e="function"==typeof t?.addEventListener?t:document,s=Array.isArray(a.onEvent)?a.onEvent:String(a.onEvent).split(/\s+/).filter(Boolean);for(const t of s)He(e).on(t,()=>r())}if(a.onFieldChange){const e=Array.isArray(a.onFieldChange)?a.onFieldChange:[a.onFieldChange];for(const s of e){const e="string"==typeof s?s:s.name;if(!e)continue;const i=o(t,e),n=t[e];if("function"==typeof n){const s=n;Object.defineProperty(t,e,{configurable:!0,enumerable:i?.enumerable??!0,writable:!0,value:function(...t){return r(),s.apply(this,t)}})}else{const s=()=>i?.get?i.get.call(t):n,a=s=>{i?.set?i.set.call(t,s):Object.defineProperty(t,e,{configurable:!0,enumerable:!0,writable:!0,value:s})};Object.defineProperty(t,e,{configurable:!0,enumerable:i?.enumerable??!0,get:()=>s(),set(t){r(),a(t)}})}}}if(a.onCallback){const e=setInterval(()=>{const e=a.onCallback.call(t);e instanceof Promise?e.then(t=>r(Boolean(t))):r(Boolean(e))},a.onCallbackFrequency??50);"function"==typeof t?.addEventListener&&t.addEventListener("destroy",()=>clearInterval(e),{once:!0})}}(this,0,0,0,0,t,u.bind(this)))};if("method"===i){const i=e;return s.addInitializer(function(){this[l]||(this[l]=new Map)}),function(...e){d.call(this);const s=this[l]??(this[l]=new Map),n=function(t){return t&&0!==t.length?JSON.stringify(t.map(t=>{if("function"==typeof t)return`function:${t.name}`;if(t&&"object"==typeof t)try{return JSON.stringify(Object.entries(t).sort())}catch{return"[[unserializable-object]]"}return void 0===t?"undefined":t})):"__no_args__"}(e);if(s.has(n))return s.get(n);const a=i.apply(this,e);if(s.set(n,a),t.timeout){const e=setTimeout(()=>s.delete(n),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}return a}}if("getter"===i){const s=e;return function(){if(d.call(this),void 0===this[l]){if(this[l]=s.call(this),t.timeout){const e=setTimeout(()=>u.call(this),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}}return this[l]}}if("accessor"===i){const s=e;return{get(){if(d.call(this),void 0===this[l]){const e=s.get?s.get.call(this):void 0;if(this[l]=e,t.timeout){const e=setTimeout(()=>u.call(this),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}}return this[l]},set(t){u.call(this),s.set&&s.set.call(this,t)},init:t=>t}}}}function Ge(t){for(const e of Object.getOwnPropertySymbols(t))String(e).startsWith("Symbol(__cache__")&&delete t[e]}function qe(t,e){const s="function"==typeof e?e.name:e,i=Object.getOwnPropertySymbols(t).find(t=>String(t)===`Symbol(__cache__${s})`);i&&delete t[i]}const Ye=new class{prototypeMap=new WeakMap;dataMap=new WeakMap;data(t){return t instanceof m&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}prototype(t){return t?(this.prototypeMap.has(t)||this.prototypeMap.set(t,{}),this.prototypeMap.get(t)):{}}fieldSetInPrototype(t,e){for(;t&&t!==HTMLElement.prototype;){if(this.prototype(t)[e])return!0;t=Object.getPrototypeOf(t)}return!1}skipAttributeChangedCallback(t){return this.fieldSetInPrototype(t,"setupAttributeChangedCallback")}skipConnectedCallback(t){return this.fieldSetInPrototype(t,"setupConnectedCallback")}getNamesOfPrototypeChain(t){const e=[];for(;t&&t!==HTMLElement.prototype;){const s=this.prototype(t).name;s&&e.push(s),t=Object.getPrototypeOf(t)}return e}};function Xe(t,e={injectAttributeBridge:!0}){return function(s,i){const n=t??Dt(i.name),a=s.prototype;if(n&&(Ye.prototype(a).name=n),Object.defineProperty(s,"observedAttributes",{configurable:!0,enumerable:!1,get:function(){const t=new Set;let e=this;for(;e&&e!==Function.prototype;){const s=e[Symbol.metadata]?.observedAttributes;if(s)for(const e of s)t.add(e);e=Object.getPrototypeOf(e)}return Array.from(t)}}),!1!==e.injectAttributeBridge&&!Ye.skipAttributeChangedCallback(a)){Ye.prototype(a).setupAttributeChangedCallback=!0;const t=function(e,s,i){if(h(this,"attributeChangedCallback",t)?.call(this,e,s,i),i===s)return;if(Ye.data(this).attributeBridgePass)return;const n=xt(e);if(n in this)try{Ye.data(this).attributeBridgePass=!0,this[n]=null===i?void 0:Ot(i)}finally{Ye.data(this).attributeBridgePass=!1}};Object.defineProperty(a,"attributeChangedCallback",{configurable:!0,enumerable:!1,writable:!0,value:t})}if(!Ye.skipConnectedCallback(a)){Ye.prototype(a).setupConnectedCallback=!0;const t=function(){if(h(this,"connectedCallback",t)?.call(this),this instanceof HTMLElement){for(const t of this.constructor.observedAttributes??[]){const e=this[xt(t)];if(void 0===e)continue;const s=Tt(e);this.getAttribute(t)!==s&&this.setAttribute(t,s)}Ye.getNamesOfPrototypeChain(Object.getPrototypeOf(this)).forEach(t=>this.classList?.add(t))}};Object.defineProperty(a,"connectedCallback",{configurable:!0,enumerable:!1,writable:!0,value:t})}return i.addInitializer(function(){n&&!customElements.get(n)&&customElements.define(n,s)}),s}}function Je(t,e=!0){return function(s,i){if(!t)return s;const{kind:n,name:a}=i,r=String(a),l=t.split(".").filter(Boolean),c=function(t){if(!t)return;let e=t;for(const t of l)if(e=e[t],!e)return;return e};if("method"===n)return function(...t){const e=c(this),s=e?.[r];if("function"==typeof s)return s.apply(e,t)};i.addInitializer(function(){const t=function(){return c(this)?.[r]},s=function(t){const e=c(this);e&&(e[r]=t)};if("field"===n||"accessor"===n){const i=o(this,r);Object.defineProperty(this,r,{configurable:!0,enumerable:i?.enumerable??!0,get:()=>t.call(this),set:t=>{e&&s.call(this,t)}})}})}}"metadata"in Symbol||Object.defineProperty(Symbol,"metadata",{value:Symbol.for("Symbol.metadata"),writable:!1,enumerable:!1,configurable:!0});const Qe=new class{constructorMap=new WeakMap;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}};function Ze(t,e){const{kind:s,name:i,static:n}=e,a=String(i),r=Dt(a),l=Symbol(`__observed_${a}`);if(e.metadata){const t=e.metadata.observedAttributes;Object.prototype.hasOwnProperty.call(e.metadata,"observedAttributes")?t||(e.metadata.observedAttributes=new Set):e.metadata.observedAttributes=new Set(t),e.metadata.observedAttributes.add(r)}e.addInitializer(function(){const e=n?this:c(this,a);let h,u;if("field"===s||"accessor"===s)try{this[l]=this[i]}catch{}const d=function(){return h?h.call(this):this[l]},p=function(t){this[a]!==t&&(u?u.call(this,t):this[l]=t,this.setAttribute?.(r,Tt(this[a])))};if("field"===s||"accessor"===s){const e=t;e?.get&&(h=e.get),e?.set&&(u=e.set);const s=o(this,a);s?.get&&(h=s.get),s?.set&&(u=s.set),Object.defineProperty(this,a,{configurable:!0,enumerable:s?.enumerable??!0,get:()=>d.call(this),set:t=>p.call(this,t)})}else if("getter"===s||"setter"===s){const t=Qe.constructorData(e).installed;if(t.get(a))return;t.set(a,!0);const s=o(e,a)??{};"function"==typeof s.get&&(h=s.get),"function"==typeof s.set&&(u=s.set),Object.defineProperty(e,a,{configurable:!0,enumerable:!!s?.enumerable,get:function(){return d.call(this)},set:function(t){p.call(this,t)}})}})}function ts(t,e){const{name:s}=e;return e.addInitializer(function(){this.solverKeys?.push(s)}),t}function es(t){const e=D(t);return He(e).setStyles({display:"flex",flexDirection:"column"},!0),e}function ss(t){const e=es(t);return He(e).setStyles({justifyContent:"center",alignItems:"center"},!0),e}function is(t){const e=D(t);return He(e).setStyles({display:"flex",flexDirection:"row"},!0),e}function ns(t){const e=is(t);return He(e).setStyles({justifyContent:"center",alignItems:"center"},!0),e}function as(t){const e=D(t);return He(e).setStyle("flexGrow",1,!0),e}class rs{element;model;emitter;constructor(t){this.element=t.element,t.model&&(this.model=t.model),t.emitter&&(this.emitter=t.emitter)}initialize(){this.setupUIElements(),this.setupUILayout(),this.setupUIListeners(),this.setupChangedCallbacks()}setupChangedCallbacks(){ct(this)}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}class os extends Gt{#s;get target(){return this.#s}set target(t){this.#s=t}toolName;manager;options;constructor(t){super(t),this.manager=t.manager??this.manager??oe.instance,this.toolName=t.toolName??this.toolName??void 0,this.options=t.listenerOptions??{};const e=this.element;this.target=t.target??this.target??e instanceof Node?e:e?.element instanceof Node?e.element:void 0}initialize(){super.initialize();const t=this.target??this;for(const[e,s]of Object.entries(Ct)){const i=this[e];if("function"!=typeof i)continue;const n=this.options?.[e];this.toolName?He(t).onTool(s,this.toolName,t=>i.call(this,t),n,this.manager):He(t).on(s,t=>i.call(this,t),n,this.manager)}}}class ls extends Gt{substrateName;solverKeys=[];get objectList(){return He(this).getSubstrateObjectList(this.substrateName)}set objectList(t){He(this).setSubstrateObjectList(t,this.substrateName)}constructor(t){super(t),this.substrateName=t.substrateName??this.substrateName??void 0,t.onActivate&&(this.onActivate=t.onActivate),t.onDeactivate&&(this.onDeactivate=t.onDeactivate)}initialize(){super.initialize(),this.substrateName&&(He(this).makeSubstrate(this.substrateName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0}),this.solverKeys.forEach(t=>{He(this).addSolver(e=>this[t]?.(e))}))}addObject(t){He(this).addObjectToSubstrate(t,this.substrateName)}removeObject(t){He(this).removeObjectFromSubstrate(t,this.substrateName)}hasObject(t){return He(this).hasObjectInSubstrate(t,this.substrateName)}isProcessed(t){return He(this).wasObjectProcessedBySubstrate(t,this.substrateName)}addSolver(t){He(this).addSolver(t,this.substrateName)}removeSolver(t){He(this).removeSolver(t,this.substrateName)}clearSolvers(){He(this).clearSolvers(this.substrateName)}resolve(t={}){He(this).resolveSubstrate({...t,substrate:this.substrateName})}}class cs extends Gt{toolName;embeddedTarget;manager;activationEvent=Ct.click;clickMode=Bt.left;key;constructor(t){super(t),this.toolName=t.toolName??this.toolName??void 0,t.embeddedTarget&&(this.embeddedTarget=t.embeddedTarget),t.onActivate&&(this.onActivate=t.onActivate),t.onDeactivate&&(this.onDeactivate=t.onDeactivate),t.activationEvent&&(this.activationEvent=t.activationEvent),t.clickMode&&(this.clickMode=t.clickMode),t.customActivation&&(this.customActivation=t.customActivation),t.key&&(this.key=t.key),this.manager=t.manager??this.manager??oe.instance}initialize(){if(super.initialize(),this.toolName){He(this).makeTool(this.toolName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0,activationEvent:this.activationEvent,clickMode:this.clickMode,customActivation:"function"==typeof this.customActivation?this.customActivation.bind(this):void 0,key:this.key,manager:this.manager}),this.embeddedTarget&&He(this).embedTool(this.embeddedTarget,this.manager);for(const[t,e]of Object.entries(Ct)){const s=this[t];"function"==typeof s&&He(this).addToolBehavior(e,(t,e)=>s.call(this,t,e),this.toolName,this.manager)}}}}function hs(t,e){void 0===e&&(e={});var s=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===s&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}function us(t){let e=document.createElement("div");return e.innerHTML=t,e.children[0]}function ds(t,e){return new Proxy(t,{get:(t,s,i)=>s in t?Reflect.get(t,s,i):s in e?Reflect.get(e,s,i):void 0,set:(t,s,i,n)=>s in t?Reflect.set(t,s,i,n):Reflect.set(e,s,i,n)})}function ps(t,e=!0){return new Promise((s,i)=>{t&&0!==t.length?fetch(t).then(t=>{if(!t.ok)throw new Error("Network response was not ok while loading your SVG");return t.text()}).then(t=>{const e=us(t);if(!e)throw new Error("Error parsing SVG text");s(e)}).catch(t=>{e||i(t),console.error("Error fetching SVG:",t),i(t)}):i(new Error("Invalid path"))})}function fs(t){const e=t.prototype,s=Symbol("__unset_default_classes__");Object.defineProperty(e,"unsetDefaultClasses",{get:function(){return this[s]??!1},set:function(t){this[s]=t;const e=this.constructor?.config?.defaultClasses;e&&He(this).toggleClass(e,t)},enumerable:!0,configurable:!0})}hs("turbo-button{align-items:center;background-color:#dadada;border:1px solid #000;border-radius:.4em;color:#000;display:inline-flex;flex-direction:row;gap:.4em;padding:.5em .7em;text-decoration:none}turbo-button>h4{flex-grow:1}");class ms extends HTMLElement{static config={shadowDOM:!1,defaultSelectedClass:"selected"};mvc=new J({element:this});onAttach=new Z;onDetach=new Z;onAdopt=new Z;static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}connectedCallback(){this.onAttach.fire()}disconnectedCallback(){this.onDetach.fire()}adoptedCallback(){this.onAdopt.fire()}}ae(ms),ne(ms),fs(ms);let gs=(()=>{let s,i,n,a,r,o,l,c=[Xe("turbo-icon")],h=[],u=ms,p=[],m=[],g=[],b=[],y=[];return class extends u{static{i=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(u[Symbol.metadata]??null):void 0;n=[Ze,f({initialValueCallback:function(){return this.getPropertiesValue(this.type,"defaultType","svg")},preprocessValue:function(t){return t&&0!=t.length?("."==t[0]&&(t=t.substring(1)),t):this.type},callAfter:function(){this.generateIcon()}})],a=[Ze,f({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultDirectory","")},preprocessValue:function(t){return d(t)?this.directory:(t.length>0&&!t.endsWith("/")&&(t+="/"),t)},callAfter:function(){this.generateIcon()}})],r=[Ze,f()],o=[Ze,f()],l=[$e()],t(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:t=>"icon"in t,set:(t,e)=>{t.icon=e}},metadata:e},null,p),t(this,null,o,{kind:"setter",name:"iconColor",static:!1,private:!1,access:{has:t=>"iconColor"in t,set:(t,e)=>{t.iconColor=e}},metadata:e},null,p),t(this,null,l,{kind:"method",name:"loadSvg",static:!1,private:!1,access:{has:t=>"loadSvg"in t,get:t=>t.loadSvg},metadata:e},null,p),t(null,null,n,{kind:"field",name:"type",static:!1,private:!1,access:{has:t=>"type"in t,get:t=>t.type,set:(t,e)=>{t.type=e}},metadata:e},m,g),t(null,null,a,{kind:"field",name:"directory",static:!1,private:!1,access:{has:t=>"directory"in t,get:t=>t.directory,set:(t,e)=>{t.directory=e}},metadata:e},b,y),t(null,s={value:i},c,{kind:"class",name:i.name,metadata:e},null,h),i=s.value,e&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ms.config,defaultType:"svg",customLoaders:{}};static imageTypes=["png","jpg","jpeg","gif","webp","PNG","JPG","JPEG","GIF","WEBP"];_element=e(this,p);_loadToken=0;onLoaded;type=e(this,m,void 0);directory=(e(this,g),e(this,b,void 0));get path(){let t=Pt(this.icon);const e=this.icon?.replace(t,"");return 0===t.length&&this.type?.length>0&&(t="."+this.type),this.directory+e+t}set icon(t){const e=Pt(t).substring(1);e&&(this.type=e),this.generateIcon()}set iconColor(t){this.updateColor(t)}set element(t){this._element=t}get element(){return this._element}loadSvg(t){return ps(t)}loadImg(t){return R({src:t,alt:this.icon})}updateColor(t=this.iconColor){t&&this.element instanceof SVGElement&&(this.element.style.fill=t)}generateIcon(){const t=this.path,e=Pt(t)?.substring(1);if(this.element instanceof HTMLImageElement&&ke(e,...this.constructor.imageTypes))return this.element.src=this.path,void(this.element.alt=this.icon);if(this.clear(),!this.icon)return;const s=++this._loadToken,i=this.getLoader(e)(t);i instanceof Element?this.setupLoadedElement(i):i.then(t=>{s===this._loadToken&&this.setupLoadedElement(t)}).catch(t=>console.error(`Failed to load icon: ${t}`))}getLoader(t){if(!t)return;const e=this.constructor.config.customLoaders[t];if(e)return e;if(ke(t,"svg","SVG"))return this.loadSvg.bind(this);if(ke(t,...this.constructor.imageTypes))return this.loadImg.bind(this);throw new Error(`Unsupported icon type: ${t}`)}setupLoadedElement(t){!this.element&&t&&(t.parentElement&&(t=t.cloneNode(!0)),He(this).addChild(t),this.updateColor(),this.onLoaded?.(t),this.element=t)}clear(){He(this.element).destroy(),this.element=null}constructor(){super(...arguments),e(this,y)}static{e(i,h)}},i})();function bs(t){return t.tag||(t.tag="turbo-icon"),D({...t})}let ys=(()=>{let s,i,n,a,r,o,l,c,h,u,d=[Xe("turbo-rich-element")],p=[],m=ms,g=[],b=[],y=[];return class extends m{static{i=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(m[Symbol.metadata]??null):void 0;n=[f({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultElementTag","h4")}})],a=[f({executeSetterBeforeStoring:!0})],r=[f({preprocessValue:function(t){if("string"==typeof t){if(this.leftIcon)return this.leftIcon.icon=t,this.leftIcon;t=bs({icon:t})}return He(this).remChild(this.leftIcon),this.addAtPosition(t,"leftIcon"),t}})],o=[f({preprocessValue:function(t){if("string"==typeof t){if(this.prefixEntry)return this.prefixEntry.textContent=t,this.prefixEntry;t=D({text:t})}return He(this).remChild(this.prefixEntry),this.addAtPosition(t,"prefixEntry"),t}})],l=[f({preprocessValue:function(t){if("string"==typeof t){if(this.element&&"textContent"in this.element)return this.element.textContent=t,this.element;t=D({tag:this.elementTag,text:t})}else"object"!=typeof t||t instanceof Element||(t.tag||(t.tag=this.elementTag),t=D(t));return He(this).remChild(this.element),this.addAtPosition(t,"element"),t}})],c=[f({preprocessValue:function(t){if("string"==typeof t){if(this.suffixEntry)return this.suffixEntry.textContent=t,this.suffixEntry;t=D({text:t})}return He(this).remChild(this.suffixEntry),this.addAtPosition(t,"suffixEntry"),t}})],h=[f({preprocessValue:function(t){if("string"==typeof t){if(this.rightIcon)return this.rightIcon.icon=t,this.rightIcon;t=bs({icon:t})}return He(this).remChild(this.rightIcon),this.addAtPosition(t,"rightIcon"),t}})],u=[f({executeSetterBeforeStoring:!0})],t(this,null,a,{kind:"setter",name:"leftCustomElements",static:!1,private:!1,access:{has:t=>"leftCustomElements"in t,set:(t,e)=>{t.leftCustomElements=e}},metadata:e},null,g),t(this,null,r,{kind:"setter",name:"leftIcon",static:!1,private:!1,access:{has:t=>"leftIcon"in t,set:(t,e)=>{t.leftIcon=e}},metadata:e},null,g),t(this,null,o,{kind:"setter",name:"prefixEntry",static:!1,private:!1,access:{has:t=>"prefixEntry"in t,set:(t,e)=>{t.prefixEntry=e}},metadata:e},null,g),t(this,null,l,{kind:"setter",name:"element",static:!1,private:!1,access:{has:t=>"element"in t,set:(t,e)=>{t.element=e}},metadata:e},null,g),t(this,null,c,{kind:"setter",name:"suffixEntry",static:!1,private:!1,access:{has:t=>"suffixEntry"in t,set:(t,e)=>{t.suffixEntry=e}},metadata:e},null,g),t(this,null,h,{kind:"setter",name:"rightIcon",static:!1,private:!1,access:{has:t=>"rightIcon"in t,set:(t,e)=>{t.rightIcon=e}},metadata:e},null,g),t(this,null,u,{kind:"setter",name:"rightCustomElements",static:!1,private:!1,access:{has:t=>"rightCustomElements"in t,set:(t,e)=>{t.rightCustomElements=e}},metadata:e},null,g),t(null,null,n,{kind:"field",name:"elementTag",static:!1,private:!1,access:{has:t=>"elementTag"in t,get:t=>t.elementTag,set:(t,e)=>{t.elementTag=e}},metadata:e},b,y),t(null,s={value:i},d,{kind:"class",name:i.name,metadata:e},null,p),i=s.value,e&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ms.config,defaultElementTag:"h4"};childrenOrder=(e(this,g),["leftCustomElements","leftIcon","prefixEntry","element","suffixEntry","rightIcon","rightCustomElements"]);addAtPosition(t,e){if(!t||!e)return;let s=0;for(let t=0;t<this.childrenOrder.length;t++){const i=this.childrenOrder[t];if(i===e)break;const n=this[i];n&&n instanceof Element?s++:n&&Array.isArray(n)&&(s+=n.length)}He(this).addChild(t,s)}elementTag=e(this,b,void 0);set leftCustomElements(t){He(this).remChild(this.leftCustomElements),this.addAtPosition(t,"leftCustomElements")}set leftIcon(t){}get leftIcon(){}set prefixEntry(t){}get prefixEntry(){}set element(t){}get element(){}get text(){const t=this.element;return t?t.textContent:""}set text(t){t||(t=""),this.element=t}set suffixEntry(t){}get suffixEntry(){}set rightIcon(t){}get rightIcon(){}set rightCustomElements(t){He(this).remChild(this.rightCustomElements),this.addAtPosition(t,"rightCustomElements")}constructor(){super(...arguments),e(this,y)}static{e(i,p)}},i})();function vs(t){return t.text&&!t.element&&(t.element=t.text),!t.elementTag||"object"!=typeof t.element||t.element instanceof Element||(t.element.tag=t.elementTag),t.tag||(t.tag="turbo-rich-element"),D({...t,text:void 0})}let ks=(()=>{let s,i,n=[Xe("turbo-button")],a=[],r=ys;return class extends r{static{i=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t(null,s={value:i},n,{kind:"class",name:i.name,metadata:e},null,a),i=s.value,e&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ys.config,defaultElementTag:"h4"};static{e(i,a)}},i})();function Es(t){return t.tag||(t.tag="turbo-button"),vs({...t})}let Ss=(()=>{let s,i,n,a,r,o=[Xe("turbo-icon-switch")],l=[],c=gs,h=[];return class extends c{static{i=this}static{const u="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;n=[f({preprocessValue:function(t){return t instanceof Ce?t:new Ce(t||{})}})],a=[f()],r=[f()],t(this,null,n,{kind:"setter",name:"switchReifect",static:!1,private:!1,access:{has:t=>"switchReifect"in t,set:(t,e)=>{t.switchReifect=e}},metadata:u},null,h),t(this,null,a,{kind:"setter",name:"defaultState",static:!1,private:!1,access:{has:t=>"defaultState"in t,set:(t,e)=>{t.defaultState=e}},metadata:u},null,h),t(this,null,r,{kind:"setter",name:"appendStateToIconName",static:!1,private:!1,access:{has:t=>"appendStateToIconName"in t,set:(t,e)=>{t.appendStateToIconName=e}},metadata:u},null,h),t(null,s={value:i},o,{kind:"class",name:i.name,metadata:u},null,l),i=s.value,u&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),e(i,l)}config=(e(this,h),{...gs.config});get switchReifect(){}set switchReifect(t){this.switchReifect.attach(this),this.defaultState&&this.switchReifect.apply(this.defaultState,this)}set defaultState(t){this.switchReifect?.apply(t,this)}set appendStateToIconName(t){if(t){const t=this.switchReifect?.properties;this.switchReifect.states.forEach(e=>{t[e]||(t[e]={}),t[e].icon=this.icon+"-"+e.toString()})}}initialize(){super.initialize(),this.defaultState&&this.switchReifect&&this.switchReifect.apply(this.defaultState,this)}},i})();function ws(t){return t.tag||(t.tag="turbo-icon-switch"),bs({...t})}let Cs=(()=>{let s,i,n,a,r=[Xe("turbo-icon-toggle")],o=[],l=gs,c=[];return class extends l{static{i=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;n=[f({initialValue:!1})],a=[f({initialValue:!1})],t(this,null,n,{kind:"setter",name:"toggled",static:!1,private:!1,access:{has:t=>"toggled"in t,set:(t,e)=>{t.toggled=e}},metadata:h},null,c),t(this,null,a,{kind:"setter",name:"toggleOnClick",static:!1,private:!1,access:{has:t=>"toggleOnClick"in t,set:(t,e)=>{t.toggleOnClick=e}},metadata:h},null,c),t(null,s={value:i},r,{kind:"class",name:i.name,metadata:h},null,o),i=s.value,h&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),e(i,o)}config=(e(this,c),{...gs.config});stopPropagationOnClick=!0;onToggle;clickListener=()=>(this.toggle(),this.stopPropagationOnClick);set toggled(t){this.onToggle&&this.onToggle(t,this)}set toggleOnClick(t){t?He(this).on(Ct.click,this.clickListener):He(this).removeListener(Ct.click,this.clickListener)}toggle(){this.toggled=!this.toggled}},i})();function Ts(t){return t.tag||(t.tag="turbo-icon-toggle"),bs({...t})}function Os(t=8){const e=new Uint8Array(t);return crypto.getRandomValues(e),Array.from(e).map(t=>t.toString(36).padStart(2,"0")).join("").slice(0,t)}function Ps(t,e){if("number"!=typeof t||"number"!=typeof e)return 0;const s=Math.min(t,e),i=Math.max(t,e);return Math.random()*(i-s)+s}function Ds(t=[50,70],e=[70,85]){return"number"!=typeof t&&t.length>=2&&(t=Ps(t[0],t[1])),"number"!=typeof e&&e.length>=2&&(e=Ps(e[0],e[1])),"hsl("+360*Math.random()+" "+t+" "+e+")"}function xs(t=12){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let i=0;i<t;i++)s+=e.charAt(Math.floor(62*Math.random()));return s}class As extends os{keyName="__input__interactor__";_composing=!1;_resizeQueued=!1;options={compositionStart:{capture:!0},compositionEnd:{capture:!0},input:{capture:!0}};get inputElement(){return this.element.element}initialize(){super.initialize(),He(this.target).bypassManagerOn=()=>!0}setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("valueSet",()=>this.handleInput())}click(){return this.element.locked||this.inputElement?.focus(),!1}focusIn(t){if(t.target===this.inputElement){if(!this.element.locked)return this.element.selectTextOnFocus&&requestAnimationFrame(()=>{try{this.inputElement.select?.()}catch{}}),this.element.onFocus.fire(),!0;this.inputElement.blur()}}focusOut(t){t.target===this.inputElement&&(this.element.value=this.element.element?.value,this.element.onBlur.fire())}compositionStart(t){t.target===this.inputElement&&(this._composing=!0)}compositionEnd(t){if(t.target===this.inputElement)return this._composing=!1,this.handleInput(),!0}input(t){if(t.target===this.inputElement)return this.handleInput(),!0}handleInput(){this._composing||this.inputElement&&(this.element.dynamicVerticalResize&&this.inputElement instanceof HTMLTextAreaElement&&(this._resizeQueued||(this._resizeQueued=!0,queueMicrotask(()=>{this._resizeQueued=!1,He(this.inputElement).setStyle("height","auto",!0).setStyle("height",this.inputElement.scrollHeight+"px",!0)}))),this.emitter.fire("processValue"))}}let Ms=(()=>{let s,i,n,a=[Xe("turbo-input")],r=[],o=ys,l=[];return class extends o{static{i=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(o[Symbol.metadata]??null):void 0;n=[f()],t(this,null,n,{kind:"setter",name:"label",static:!1,private:!1,access:{has:t=>"label"in t,set:(t,e)=>{t.label=e}},metadata:e},null,l),t(null,s={value:i},a,{kind:"class",name:i.name,metadata:e},null,r),i=s.value,e&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ys.config,defaultElementTag:"input"};labelElement=e(this,l);_content;get content(){return this._content}set content(t){this._content=t}defaultId="turbo-input-"+Os();locked=!1;selectTextOnFocus=!1;dynamicVerticalResize=!1;inputRegexCheck;blurRegexCheck;lastValidForInput="";lastValidForBlur="";onFocus=new Z;onBlur=new Z;onInput=new Z;set label(t){t&&0!==t.length?(this.labelElement||(this.labelElement=D({tag:"label",htmlFor:this.element?.id??this.defaultId}),He(this).childHandler=this,He(this).addChild(this.labelElement,0),this.content&&(He(this).childHandler=this.content)),this.labelElement.textContent=t):this.labelElement&&this.labelElement.remove()}set element(t){t instanceof Node||"object"!=typeof t||(t.name||(t.name=Os()),"input"!==this.elementTag||t.type||(t.type="text")),super.element=t,this.element&&(this.element.id?this.labelElement&&(this.labelElement.htmlFor=this.element.id):this.element.id=this.defaultId)}get element(){return super.element}initialize(){super.initialize(),this.mvc.generate({interactors:[As]}),this.mvc.getInteractor("__input__interactor__").target=this.content}setupUIElements(){super.setupUIElements(),this.content=I()}setupUILayout(){super.setupUILayout(),He(this.content).addChild(He(this).childrenArray),He(this).addChild([this.labelElement,this.content]),He(this).childHandler=this.content}setupChangedCallbacks(){super.setupChangedCallbacks(),this.mvc.emitter.add("processValue",()=>this.processInputValue())}get value(){const t=this.element?.value;try{const e=parseFloat(t);if(!isNaN(e))return e}catch{}return t}set value(t){if(!(this.element instanceof HTMLInputElement||this.element instanceof HTMLTextAreaElement))return;let e=t.toString();if(this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(e)||(e=this.lastValidForBlur)}this.element.value=e,this.mvc.emitter.fire("valueSet")}processInputValue(t=this.element.value){if(this.inputRegexCheck){const e=new RegExp(this.inputRegexCheck);if(!e.test(t)){const s=this.sanitizeByRegex(t,this.inputRegexCheck);t=e.test(s)?s:this.lastValidForInput}}if(this.lastValidForInput=t.toString(),this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(t.toString())&&(this.lastValidForBlur=t)}else this.lastValidForBlur=t;this.element.value=t,this.onInput.fire()}sanitizeByRegex(t,e){const s="string"==typeof e?e:e.source,i="string"==typeof e?"":e.flags.replace("g",""),n=new RegExp(s,i);let a="";for(const e of t){const t=a+e;n.lastIndex=0,n.test(t)&&(a=t)}return a}static{e(i,r)}},i})();function js(t){return t.element=t.input,t.elementTag=t.inputTag,t.elementTag||(t.elementTag="input"),t.element||(t.element={}),t.tag||(t.tag="turbo-input"),vs({...t,input:void 0,inputTag:void 0})}let Is=(()=>{let s,i,n=[Xe("turbo-numerical-input")],a=[],r=Ms;return class extends r{static{i=this}static{const o="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t(null,s={value:i},n,{kind:"class",name:i.name,metadata:o},null,a),i=s.value,o&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),e(i,a)}multiplier=1;decimalPlaces;min;max;get value(){return Number.parseFloat(this.element.value)/this.multiplier}set value(t){t&&""!=t||(t=0),"string"==typeof t&&(t=Number.parseFloat(t)),t*=this.multiplier,null!=this.min&&t<this.min&&(t=this.min),null!=this.max&&t>this.max&&(t=this.max),null!=this.decimalPlaces&&(t=Math.round(t*Math.pow(10,this.decimalPlaces))/Math.pow(10,this.decimalPlaces)),super.value=t}},i})();function Bs(t){return t.inputRegexCheck||(t.inputRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?\.?$|^-$|^$/),t.blurRegexCheck||(t.blurRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?(?<=\d)$/),t.tag||(t.tag="turbo-numerical-input"),js({...t})}class Ns extends Ut{toggledEntry;values;constructor(t){super(t),this.toggledEntry=t.toggledEntry,this.values=t.values}}class Vs{static config={};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}}ae(Vs);let _s=(()=>{let s,i,n,a,r,o,l,c,h,p=Vs,m=[],g=[],b=[],y=[],v=[],k=[],E=[],S=[],w=[],C=[],T=[],O=[],P=[],D=[],x=[];return class extends p{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;s=[f()],i=[f({defaultValue:t=>t instanceof ys?t.text:t instanceof HTMLElement?t.textContent:t instanceof Element?t.innerHTML:void 0})],n=[f({defaultValue:()=>""})],a=[f({defaultValue:t=>vs({text:Tt(t)})})],r=[f({defaultValue:function(t){this.initializeSelection(),He(t).on(Ct.click,()=>(this.select(t,!this.isSelected(t)),!0))}})],o=[f({defaultValue:function(t){}})],l=[f({defaultValue:!1})],c=[f({defaultValueCallback:function(){return!this.multiSelection}})],h=[f({callBefore:function(){this.selectedEntries?.forEach(t=>Re(t).removeClass(this.selectedEntryClasses))},callAfter:function(){this.selectedEntries?.forEach(t=>Re(t).addClass(this.selectedEntryClasses))},initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectedEntryClasses")}})],t(this,null,s,{kind:"setter",name:"parent",static:!1,private:!1,access:{has:t=>"parent"in t,set:(t,e)=>{t.parent=e}},metadata:e},null,m),t(this,null,l,{kind:"setter",name:"multiSelection",static:!1,private:!1,access:{has:t=>"multiSelection"in t,set:(t,e)=>{t.multiSelection=e}},metadata:e},null,m),t(null,null,i,{kind:"field",name:"getValue",static:!1,private:!1,access:{has:t=>"getValue"in t,get:t=>t.getValue,set:(t,e)=>{t.getValue=e}},metadata:e},g,b),t(null,null,n,{kind:"field",name:"getSecondaryValue",static:!1,private:!1,access:{has:t=>"getSecondaryValue"in t,get:t=>t.getSecondaryValue,set:(t,e)=>{t.getSecondaryValue=e}},metadata:e},y,v),t(null,null,a,{kind:"field",name:"createEntry",static:!1,private:!1,access:{has:t=>"createEntry"in t,get:t=>t.createEntry,set:(t,e)=>{t.createEntry=e}},metadata:e},k,E),t(null,null,r,{kind:"field",name:"onEntryAdded",static:!1,private:!1,access:{has:t=>"onEntryAdded"in t,get:t=>t.onEntryAdded,set:(t,e)=>{t.onEntryAdded=e}},metadata:e},S,w),t(null,null,o,{kind:"field",name:"onEntryRemoved",static:!1,private:!1,access:{has:t=>"onEntryRemoved"in t,get:t=>t.onEntryRemoved,set:(t,e)=>{t.onEntryRemoved=e}},metadata:e},C,T),t(null,null,c,{kind:"field",name:"forceSelection",static:!1,private:!1,access:{has:t=>"forceSelection"in t,get:t=>t.forceSelection,set:(t,e)=>{t.forceSelection=e}},metadata:e},O,P),t(null,null,h,{kind:"field",name:"selectedEntryClasses",static:!1,private:!1,access:{has:t=>"selectedEntryClasses"in t,get:t=>t.selectedEntryClasses,set:(t,e)=>{t.selectedEntryClasses=e}},metadata:e},D,x),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={defaultSelectedEntryClasses:"selected"};_inputField=e(this,m);_entries=[];_entriesData=new WeakMap;parentObserver;onSelectDelegate=new Z;onEnabledDelegate=new Z;get entries(){return this._entries}set entries(t){this.enableObserver(!1);const e=this.selectedValues;this.clear(),this._entries=(Array.isArray(t)?t:Array.from(t)).filter(t=>t!==this.inputField),console.log(this.entries),t instanceof HTMLCollection&&t.item(0)&&(this.parent=t.item(0).parentElement);const s=this.entries;for(let t=0;t<s.length;t++)this.onEntryAdded?.call(this,s[t],t);this.deselectAll();for(let t=0;t<s.length;t++)e.includes(this.getValue(s[t]))&&this.select(s[t]);0===this.selectedEntries.length&&this.initializeSelection(),this.refreshInputField(),this.enableObserver(!0)}get values(){return this.entries.map(t=>this.getValue(t))}set values(t){const e=[];t.forEach(t=>{const s=this.createEntry(t);s instanceof Node&&this.parent&&He(this.parent).addChild(s),e.push(s)}),console.log(e),this.entries=e}get selectedEntries(){return this.entries.filter(t=>this.getEntryData(t).selected)}set selectedEntries(t){this.deselectAll(),t&&t.forEach(t=>this.select(t))}set parent(t){t instanceof Element&&(He(t).addChild(this.entries.filter(t=>t instanceof Node)),this.inputField&&t.appendChild(this.inputField),this.setupParentObserver())}getValue=e(this,g,void 0);getSecondaryValue=(e(this,b),e(this,y,void 0));createEntry=(e(this,v),e(this,k,void 0));onEntryAdded=(e(this,E),e(this,S,void 0));onEntryRemoved=(e(this,w),e(this,C,void 0));get inputName(){return this.inputField?.name}set inputName(t){this._inputField||(this._inputField=W({value:this.stringSelectedValue,type:"hidden",parent:this.parent??document.body})),this.inputField.name=t}get inputField(){return this._inputField}set multiSelection(t){this.forceSelection=!t}forceSelection=(e(this,T),e(this,O,void 0));set onSelect(t){t&&this.onSelectDelegate.add(t)}set onEnabled(t){t&&this.onEnabledDelegate.add(t)}selectedEntryClasses=(e(this,P),e(this,D,void 0));constructor(t={}){super(),e(this,x);const s=t.selectedValues||[];t.selectedValues=void 0,t.onEnabled||(t.onEnabled=(t,e)=>{e instanceof HTMLElement&&He(e).setStyle("visibility",t?"":"hidden")});for(const e of Object.keys(t))try{this[e]=t[e]}catch{}this.forceSelection||this.deselectAll(),this.entries.forEach(t=>{s.includes(this.getValue(t))&&this.select(t)})}getEntryData(t){if(!t)return{};let e=this._entriesData.get(t);return e||(e={selected:!1,enabled:!0},this._entriesData.set(t,e)),e}clearEntryData(t){this._entriesData.delete(t);const e=this.entries.indexOf(t);e>=0&&this.entries.splice(e,1)}addEntry(t,e=this.entries.length){(void 0===e||"number"!=typeof e||e>this.entries.length)&&(e=this.entries.length),e<0&&(e=0),this.enableObserver(!1),this.onEntryAdded?.call(this,t,e),Array.isArray(this.entries)&&!this.entries.includes(t)&&this.entries.splice(e,0,t),t instanceof Node&&!t.parentElement&&this.parent&&He(this.parent).addChild(t,e),this.enableObserver(!0),requestAnimationFrame(()=>this.select(this.selectedEntry))}getEntryFromSecondaryValue(t){return this.entries.find(e=>this.getSecondaryValue(e)===t)}isSelected(t){return this.selectedEntries.includes(t)}getEntry(t){let e;try{const s=this.find(t);if(s)e=s;else{const s=this.entries.find(e=>e===t);s&&(e=s)}}catch{}return e}select(t,e=!0){if(u(t)||d(t))return this;let s;try{const e=this.getEntry(t);if(e)s=e;else{const e=this.entries.find(e=>e===t);e&&(s=e)}}catch{}if(!s)return this;const i=this.isSelected(s);return e===i||!e&&i&&this.selectedEntries.length<=1&&this.forceSelection||(this.multiSelection||this.deselectAll(),this.getEntryData(s).selected=e,s instanceof HTMLElement&&He(s).toggleClass(this.selectedEntryClasses,e),this.initializeSelection(),this.refreshInputField(),this.onSelectDelegate.fire(e,s,this.getIndex(s)),(this.parent??document).dispatchEvent(new Ns({toggledEntry:s,values:this.selectedValues}))),this}selectByIndex(t,e=Se){return t=e(t,this.entries.length-1,0),this.select(this.entries[t])}getIndex(t){return this.entries.indexOf(t)}deselectAll(){this.selectedEntries.forEach(t=>{t instanceof HTMLElement&&He(t).toggleClass(this.selectedEntryClasses,!1),this.getEntryData(t).selected=!1}),this.refreshInputField()}reset(){this.deselectAll()}get enabledEntries(){return this.entries.filter(t=>this.getEntryData(t).enabled)}get enabledValues(){return this.enabledEntries.map(t=>this.getValue(t))}get enabledSecondaryValues(){return this.enabledEntries.map(t=>this.getSecondaryValue(t))}find(t){return this.entries.find(e=>this.getValue(e)===t)}findBySecondaryValue(t){return this.entries.find(e=>this.getSecondaryValue(e)===t)}findAll(...t){return this.entries.filter(e=>t.includes(this.getValue(e)))}findAllBySecondaryValue(...t){return this.entries.filter(e=>t.includes(this.getSecondaryValue(e)))}enable(t,...e){e&&0!==e.length||(e=this.entries),e.forEach(e=>{const s=this.getEntry(e);s&&(this.getEntryData(s).enabled=t,this.onEnabledDelegate.fire(t,s,this.getIndex(s)))})}get selectedEntry(){return this.selectedEntries[0]}get selectedValues(){return this.selectedEntries.map(t=>this.getValue(t))}get selectedValue(){const t=this.selectedEntry;if(t)return this.getValue(t)}get selectedSecondaryValues(){return this.selectedEntries.map(t=>this.getSecondaryValue(t))}get selectedSecondaryValue(){const t=this.selectedEntry;if(t)return this.getSecondaryValue(t)}get stringSelectedValue(){return this.selectedEntries.map(t=>Tt(this.getValue(t))).join(", ")}clear(){this.enableObserver(!1);for(const t of this.entries)this.clearEntryData(t),this.onEntryRemoved(t),this.parent&&t instanceof HTMLElement&&t.remove();this._entries=[],this.refreshInputField(),this.enableObserver(!0)}refreshInputField(){this.inputField&&(this.inputField.value=this.stringSelectedValue)}destroy(){return this.enableObserver(!1),this.parentObserver=null,this}enableObserver(t){if(!t)return this.parentObserver?.disconnect();this.parent instanceof Element&&this.parentObserver&&this.parentObserver.observe(this.parent,{childList:!0})}initializeSelection(){if(this.forceSelection&&this.enabledEntries.length&&0===this.selectedEntries.length){const t=this.enabledEntries[0];t&&this.select(t)}}setupParentObserver(){this.enableObserver(!1),this.parentObserver=new MutationObserver(t=>{for(const e of t){for(const t of e.addedNodes){if(!(t instanceof Element)||t.parentElement!==this.parent)continue;if(t===this.inputField)continue;const e=t,s=Array.from(this.parent.children).filter(t=>t!==this.inputField).filter(t=>this.entries.includes(t)||t===e),i=s.indexOf(e);if(!(i<0)){if(0===i)this.entries.splice(i,0,e);else{const t=this.entries.indexOf(s[i-1]);this.entries.splice(t+1,0,e)}this.getEntryData(e),this.onEntryAdded?.call(this,e,this.getIndex(e))}}for(const t of e.removedNodes)t instanceof Element&&t!==this.inputField&&queueMicrotask(()=>{if(t.isConnected)return;const e=this.getEntryData(t);if(e.selected&&this.forceSelection&&this.enabledEntries.length){const t=this.enabledEntries[0];t&&this.select(t)}e.selected=!1,this.onEntryRemoved?.call(this,t),this.clearEntryData(t)})}}),this.enableObserver(!0)}}})();hs(".turbo-drawer{align-items:center;direction:ltr;display:inline-flex}.turbo-drawer-panel-container{align-items:center;display:flex;overflow:hidden;position:relative}.turbo-drawer-thumb{display:inline-block;position:relative}.top-drawer .turbo-drawer-panel-container,.turbo-drawer.top-drawer{flex-direction:column}.bottom-drawer .turbo-drawer-panel-container,.turbo-drawer.bottom-drawer{flex-direction:column-reverse}.left-drawer .turbo-drawer-panel-container,.turbo-drawer.left-drawer{flex-direction:row}.right-drawer .turbo-drawer-panel-container,.turbo-drawer.right-drawer{flex-direction:row-reverse}");class Fs extends Ce{constructor(t){t.states=[""],super(t)}get properties(){const t=super.properties;return"object"==typeof t&&""in t?t[""]:t}set properties(t){super.properties=t}get styles(){const t=super.styles;return"object"==typeof t&&""in t?t[""]:t}set styles(t){super.styles=t}get classes(){const t=super.classes;return"object"==typeof t&&""in t?t[""]:t}set classes(t){super.classes=t}get replaceWith(){const t=super.replaceWith;return"object"==typeof t&&""in t?t[""]:t}set replaceWith(t){super.replaceWith=t}set transition(t){super.transition=t}get transitionProperties(){const t=super.transitionProperties;return"object"==typeof t&&""in t?t[""]:t}set transitionProperties(t){super.transitionProperties=t}get transitionDuration(){const t=super.transitionDuration;return"object"==typeof t&&""in t?t[""]:t}set transitionDuration(t){super.transitionDuration=t}get transitionTimingFunction(){const t=super.transitionTimingFunction;return"object"==typeof t&&""in t?t[""]:t}set transitionTimingFunction(t){super.transitionTimingFunction=t}get transitionDelay(){const t=super.transitionDelay;return"object"==typeof t&&""in t?t[""]:t}set transitionDelay(t){super.transitionDelay=t}initialize(t,e){super.initialize("",t,e)}apply(t,e){super.apply("",t,e)}}function Ls(t){return new Fs(t)}let zs=(()=>{let s,i,n,a,r,o,l,c,h,u,d,p,m,g=[Xe("turbo-drawer")],b=[],y=ms,v=[],k=[],E=[];return class extends y{static{i=this}static{const S="function"==typeof Symbol&&Symbol.metadata?Object.create(y[Symbol.metadata]??null):void 0;n=[f({setIfUndefined:!0,callBefore:function(){this.thumb&&He(this).remChild(this.thumb)},preprocessValue:t=>t instanceof HTMLElement?t:I(t)})],a=[f({setIfUndefined:!0,callBefore:function(){this.panel&&He(this).remChild(this.panel)},preprocessValue:t=>t instanceof HTMLElement?t:I(t)})],r=[f({callBefore:function(){this.icon?.parentElement===this.thumb&&this.thumb.removeChild(this.icon)},preprocessValue:function(t){return t instanceof Element?t:("string"!=typeof t||this.attachSideToIconName||this.rotateIconBasedOnSide||(this.attachSideToIconName=!0),ws("object"==typeof t?t:{icon:t,switchReifect:{states:Object.values(xe)},defaultState:this.open?this.getOppositeSide():this.side,appendStateToIconName:this.attachSideToIconName}))}})],o=[f({defaultValue:!1})],l=[f({defaultValue:!1})],c=[f({defaultValue:!1})],h=[f({defaultValue:xe.bottom,cancelIfUnchanged:!1})],u=[f({defaultValue:{open:0,closed:0},preprocessValue:t=>"number"==typeof t?{open:t,closed:t}:{open:t?.open||0,closed:t?.closed||0}})],d=[f({defaultValue:!1})],p=[f()],m=[f({defaultValueCallback:function(){return new Fs({transitionProperties:["transform",this.isVertical?"height":"width"],transitionDuration:.2,transitionTimingFunction:"ease-out"})},callAfter:function(){this.transition.attachAll(this,this.panelContainer)}})],t(this,null,n,{kind:"setter",name:"thumb",static:!1,private:!1,access:{has:t=>"thumb"in t,set:(t,e)=>{t.thumb=e}},metadata:S},null,v),t(this,null,a,{kind:"setter",name:"panel",static:!1,private:!1,access:{has:t=>"panel"in t,set:(t,e)=>{t.panel=e}},metadata:S},null,v),t(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:t=>"icon"in t,set:(t,e)=>{t.icon=e}},metadata:S},null,v),t(this,null,o,{kind:"setter",name:"hideOverflow",static:!1,private:!1,access:{has:t=>"hideOverflow"in t,set:(t,e)=>{t.hideOverflow=e}},metadata:S},null,v),t(this,null,l,{kind:"setter",name:"attachSideToIconName",static:!1,private:!1,access:{has:t=>"attachSideToIconName"in t,set:(t,e)=>{t.attachSideToIconName=e}},metadata:S},null,v),t(this,null,c,{kind:"setter",name:"rotateIconBasedOnSide",static:!1,private:!1,access:{has:t=>"rotateIconBasedOnSide"in t,set:(t,e)=>{t.rotateIconBasedOnSide=e}},metadata:S},null,v),t(this,null,h,{kind:"setter",name:"side",static:!1,private:!1,access:{has:t=>"side"in t,set:(t,e)=>{t.side=e}},metadata:S},null,v),t(this,null,u,{kind:"setter",name:"offset",static:!1,private:!1,access:{has:t=>"offset"in t,set:(t,e)=>{t.offset=e}},metadata:S},null,v),t(this,null,d,{kind:"setter",name:"open",static:!1,private:!1,access:{has:t=>"open"in t,set:(t,e)=>{t.open=e}},metadata:S},null,v),t(this,null,p,{kind:"setter",name:"translation",static:!1,private:!1,access:{has:t=>"translation"in t,set:(t,e)=>{t.translation=e}},metadata:S},null,v),t(null,null,m,{kind:"field",name:"transition",static:!1,private:!1,access:{has:t=>"transition"in t,get:t=>t.transition,set:(t,e)=>{t.transition=e}},metadata:S},k,E),t(null,s={value:i},g,{kind:"class",name:i.name,metadata:S},null,b),i=s.value,S&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:S}),e(i,b)}_panelContainer=e(this,v);get panelContainer(){return this._panelContainer}dragging=!1;animationOn=!1;resizeObserver;set thumb(t){He(t).addClass("turbo-drawer-thumb"),this.initialized&&this.setupUILayout()}get thumb(){}set panel(t){He(t).addClass("turbo-drawer-panel"),this.initialized&&this.setupUILayout()}get panel(){}set icon(t){this.initialized&&this.setupUILayout()}get icon(){}set hideOverflow(t){He(this.panelContainer).setStyle("overflow",t?"hidden":"")}set attachSideToIconName(t){this.icon instanceof Ss&&(this.icon.appendStateToIconName=t),t&&(this.rotateIconBasedOnSide=!1)}set rotateIconBasedOnSide(t){t&&(this.attachSideToIconName=!1),this.icon instanceof Ss&&(this.icon.switchReifect.styles={top:"transform: rotate(180deg)",bottom:"transform: rotate(0deg)",left:"transform: rotate(90deg)",right:"transform: rotate(270deg)"})}set side(t){He(this).toggleClass("top-drawer",t==xe.top),He(this).toggleClass("bottom-drawer",t==xe.bottom),He(this).toggleClass("left-drawer",t==xe.left),He(this).toggleClass("right-drawer",t==xe.right),this.refresh()}set offset(t){}get offset(){}get isVertical(){return this.side==xe.top||this.side==xe.bottom}set open(t){t?this.resizeObserver.observe(this.panel,{box:"border-box"}):this.resizeObserver.unobserve(this.panel),this.refresh()}set translation(t){switch(this.side){case xe.top:case xe.bottom:this.hideOverflow?He(this.panelContainer).setStyle("height",t+"px"):He(this).setStyle("transform",`translateY(${-t}px)`);break;case xe.left:case xe.right:this.hideOverflow?He(this.panelContainer).setStyle("width",t+"px"):He(this).setStyle("transform",`translateX(${-t}px)`)}}transition=e(this,k,void 0);get translation(){}initialize(){super.initialize(),this.transition.attachAll(this,this.panelContainer);let t=!1;this.resizeObserver=new ResizeObserver(e=>{this.open&&!this.dragging&&(t||(t=!0,requestAnimationFrame(()=>{const s=Array.isArray(e[0].borderBoxSize)?e[0].borderBoxSize[0]:e[0].borderBoxSize;this.translation=(this.open?this.offset.open:this.offset.closed)+(this.isVertical?s.blockSize:s.inlineSize),t=!1})))}),this.animationOn=!0}setupUIElements(){super.setupUIElements(),this._panelContainer=I({classes:"turbo-drawer-panel-container"})}setupUILayout(){super.setupUILayout(),He(this).childHandler=this,He(this.panel).addChild(He(this).childrenArray.filter(t=>t!==this.panelContainer)),He(this).addChild([this.thumb,this.panelContainer]),He(this.panelContainer).addChild(this.panel),He(this.thumb).addChild(this.icon),He(this).childHandler=this.panel}setupUIListeners(){this.thumb.addEventListener(Ct.click,t=>{t.stopImmediatePropagation(),this.open=!this.open}),this.thumb.addEventListener(wt.dragStart,t=>{t.stopImmediatePropagation(),this.dragging=!0,this.animationOn&&(this.transition.enabled=!1)}),this.thumb.addEventListener(wt.drag,t=>{this.dragging&&(t.stopImmediatePropagation(),this.translation+=this.isVertical?t.scaledDeltaPosition.y:t.scaledDeltaPosition.x)}),this.thumb.addEventListener(wt.dragEnd,t=>{if(!this.dragging)return;t.stopImmediatePropagation(),this.dragging=!1;const e=t.positions.first.sub(t.origins.first);switch(this.side){case xe.top:this.open&&e.y>100?this.open=!1:!this.open&&e.y<-100&&(this.open=!0);break;case xe.bottom:this.open&&e.y<-100?this.open=!1:!this.open&&e.y>100&&(this.open=!0);break;case xe.left:this.open&&e.x>100?this.open=!1:!this.open&&e.x<-100&&(this.open=!0);break;case xe.right:this.open&&e.x<-100?this.open=!1:!this.open&&e.x>100&&(this.open=!0)}this.refresh()})}getOppositeSide(t=this.side){switch(t){case xe.top:return xe.bottom;case xe.bottom:return xe.top;case xe.left:return xe.right;case xe.right:return xe.left}}getAdjacentSide(t=this.side){switch(t){case xe.top:return xe.right;case xe.bottom:return xe.left;case xe.left:return xe.top;case xe.right:return xe.bottom}}refresh(){this.animationOn&&(this.transition.enabled=!0,this.transition.apply()),this.hideOverflow&&He(this.panel).setStyle("position","absolute",!0),this.icon instanceof Ss&&this.icon.switchReifect.apply(this.open?this.getOppositeSide():this.side),requestAnimationFrame(()=>{this.translation=(this.open?this.offset.open:this.offset.closed)+(this.open?this.isVertical?this.panel.offsetHeight:this.panel.offsetWidth:0),this.hideOverflow&&He(this.panel).setStyle("position","relative",!0)})}constructor(){super(...arguments),e(this,E)}},i})();function Rs(t){return t.tag||(t.tag="turbo-drawer"),D({...t,text:void 0})}var Ws;!function(t){t.invert="invert",t.offset="offset",t.none="none"}(Ws||(Ws={}));hs("#turbo-popup-parent-element{display:block;left:0;position:fixed;top:0;z-index:1000}.turbo-popup{display:block;inset:auto;overflow:auto;position:fixed}");let Ks=(()=>{let s,i,n,a,r,o,l,c,h,u,d,p,m,g,b=[Xe("turbo-popup")],y=[],v=ms,k=[],E=[],S=[],w=[],C=[];var T=class extends v{static{i=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(v[Symbol.metadata]??null):void 0;n=[f({defaultValue:I({parent:document.body,id:"turbo-popup-parent-element"})})],a=[f({defaultValue:document.body})],r=[f({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupAnchor",{x:50,y:0})},preprocessValue:t=>new Xt(t).bound(0,100)})],o=[f({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultAnchorPosition",{x:50,y:100})},preprocessValue:t=>new Xt(t).bound(0,100)})],l=[f({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultViewportMargin",0)},preprocessValue:t=>new Xt(t)})],c=[f({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultOffsetFromAnchor",0)},preprocessValue:t=>new Xt(t)})],h=[f({preprocessValue:t=>"object"!=typeof t?{x:t,y:t}:t,initialValueCallback:function(){return{x:Math.abs(this.anchorPosition.x-50)>25?Ws.invert:Ws.offset,y:Math.abs(this.anchorPosition.y-50)>25?Ws.invert:Ws.offset}}})],u=[$e({clearOnNextFrame:!0})],d=[$e({clearOnNextFrame:!0})],p=[$e({clearOnNextFrame:!0})],m=[$e({clearOnNextFrame:!0})],g=[$e({clearOnNextFrame:!0})],t(this,null,r,{kind:"setter",name:"popupPosition",static:!1,private:!1,access:{has:t=>"popupPosition"in t,set:(t,e)=>{t.popupPosition=e}},metadata:e},null,k),t(this,null,o,{kind:"setter",name:"anchorPosition",static:!1,private:!1,access:{has:t=>"anchorPosition"in t,set:(t,e)=>{t.anchorPosition=e}},metadata:e},null,k),t(this,null,l,{kind:"setter",name:"viewportMargin",static:!1,private:!1,access:{has:t=>"viewportMargin"in t,set:(t,e)=>{t.viewportMargin=e}},metadata:e},null,k),t(this,null,c,{kind:"setter",name:"offsetFromAnchor",static:!1,private:!1,access:{has:t=>"offsetFromAnchor"in t,set:(t,e)=>{t.offsetFromAnchor=e}},metadata:e},null,k),t(this,null,h,{kind:"setter",name:"fallbackModes",static:!1,private:!1,access:{has:t=>"fallbackModes"in t,set:(t,e)=>{t.fallbackModes=e}},metadata:e},null,k),t(this,null,u,{kind:"getter",name:"rect",static:!1,private:!1,access:{has:t=>"rect"in t,get:t=>t.rect},metadata:e},null,k),t(this,null,d,{kind:"getter",name:"anchorRect",static:!1,private:!1,access:{has:t=>"anchorRect"in t,get:t=>t.anchorRect},metadata:e},null,k),t(this,null,p,{kind:"getter",name:"computedStyle",static:!1,private:!1,access:{has:t=>"computedStyle"in t,get:t=>t.computedStyle},metadata:e},null,k),t(this,null,m,{kind:"getter",name:"anchorComputedStyle",static:!1,private:!1,access:{has:t=>"anchorComputedStyle"in t,get:t=>t.anchorComputedStyle},metadata:e},null,k),t(this,null,g,{kind:"getter",name:"computedMargins",static:!1,private:!1,access:{has:t=>"computedMargins"in t,get:t=>t.computedMargins},metadata:e},null,k),t(null,null,n,{kind:"field",name:"parentElement",static:!0,private:!1,access:{has:t=>"parentElement"in t,get:t=>t.parentElement,set:(t,e)=>{t.parentElement=e}},metadata:e},E,S),t(null,null,a,{kind:"field",name:"anchor",static:!1,private:!1,access:{has:t=>"anchor"in t,get:t=>t.anchor,set:(t,e)=>{t.anchor=e}},metadata:e},w,C),t(null,s={value:i},b,{kind:"class",name:i.name,metadata:e},null,y),T=i=s.value,e&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ms.config,defaultPopupPosition:{x:0,y:-100},defaultAnchorPosition:{x:0,y:100},defaultViewportMargin:4,defaultOffsetFromAnchor:{x:0,y:4}};static parentElement=e(i,E,void 0);anchor=(e(this,k),e(this,w,void 0));set popupPosition(t){}get popupPosition(){}set anchorPosition(t){}get anchorPosition(){}set viewportMargin(t){}get viewportMargin(){}set offsetFromAnchor(t){}get offsetFromAnchor(){}set fallbackModes(t){}get fallbackModes(){}get rect(){return this.getBoundingClientRect()}get anchorRect(){return this.anchor.getBoundingClientRect()}get computedStyle(){return window.getComputedStyle(this)}get anchorComputedStyle(){return window.getComputedStyle(this.anchor)}get computedMargins(){return{x:parseFloat(this.computedStyle.marginLeft)+parseFloat(this.computedStyle.marginRight),y:parseFloat(this.computedStyle.marginTop)+parseFloat(this.computedStyle.marginBottom)}}initialize(){super.initialize(),this.show(!1),this.parentElement||Re(this).addToParent(T.parentElement)}setupUIListeners(){super.setupUIListeners(),document.addEventListener(Ct.scroll,()=>this.show(!1),{capture:!0,passive:!0}),window.addEventListener(Ct.resize,()=>{Re(this).isShown&&this.recomputePosition()},{passive:!0}),Re(document.body).on(Ct.click,t=>{if(!Re(this).isShown)return;const e=t.target;this.contains(e)||this.anchor instanceof Node&&this.anchor.contains(e)||this.show(!1)},{capture:!0})}recomputePosition(){if(!this.anchor)return;Re(this).setStyles({maxHeight:"",maxWidth:""},!0);const t=this.computeAxis(Oe.horizontal),e=this.computeAxis(Oe.vertical);Re(this).setStyles({left:`${t}px`,top:`${e}px`});const s=Math.max(0,Math.min(window.innerWidth-2*this.viewportMargin.x,window.innerWidth-2*this.viewportMargin.x-this.computedMargins.x)),i=Math.max(0,Math.min(window.innerHeight-2*this.viewportMargin.y,window.innerHeight-2*this.viewportMargin.y-this.computedMargins.y));Re(this).setStyle("maxWidth",`${s}px`),Re(this).setStyle("maxHeight",`${i}px`)}computeAxis(t){const e=t===Oe.horizontal?"x":"y",s=t===Oe.horizontal?"width":"height",i=t===Oe.horizontal?window.innerWidth:window.innerHeight,n=this.anchorRect[t===Oe.horizontal?"left":"top"],a=this.rect[s]+this.computedMargins[e],r=this.viewportMargin[e],o=i-this.viewportMargin[e]-a,l=n+this.anchorRect[s]*this.anchorPosition[e]/100-a*this.popupPosition[e]/100+this.offsetFromAnchor[e],c=l>=r&&l<=o;if(c||this.fallbackModes[e]===Ws.offset)return Math.min(Math.max(l,r),o);const h=n+this.anchorRect[s]*(1-this.anchorPosition[e]/100)-a*(1-this.popupPosition[e]/100)-this.offsetFromAnchor[e];let u;if(h>=r&&h<=o)u=h;else if(c)u=l;else{const t=Math.abs(l-Math.min(Math.max(l,r),o))<=Math.abs(h-Math.min(Math.max(h,r),o))?l:h;u=Math.min(Math.max(t,r),o)}return u}show(t){return t?(this.style.visibility="hidden",this.style.display="",this.recomputePosition(),this.style.visibility="",Re(this).show(!0)):Re(this).setStyles({maxHeight:"",maxWidth:""},!0).show(!1),this}constructor(){super(...arguments),e(this,C)}static{e(i,S),e(i,y)}};return T=i})();function Hs(t={}){return D({...t,text:void 0,tag:"turbo-popup"})}hs("turbo-dropdown{display:inline-block;position:relative}turbo-dropdown>.turbo-popup{background-color:#fff;border:.1em solid #5e5e5e;border-radius:.4em;display:flex;flex-direction:column;overflow:hidden}turbo-dropdown>.turbo-popup>turbo-select-entry{padding:.5em}turbo-dropdown>.turbo-popup>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}turbo-dropdown>turbo-select-entry{padding:.5em .7em;width:100%}turbo-dropdown>turbo-select-entry:hover{background-color:#d7d7d7}turbo-dropdown>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}");let Us=(()=>{let s,i,n,a,r,o,l,c,h,u=[Xe("turbo-dropdown")],d=[],p=ms,m=[],g=[],b=[],y=[],v=[],k=[],E=[],S=[],w=[],C=[],T=[];return class extends p{static{i=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;n=[f({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorTag")}})],a=[f({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorClasses")},callBefore:function(){Re(this.selector).removeClass(this.selectorClasses)},callAfter:function(){Re(this.selector).addClass(this.selectorClasses)}})],r=[f({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupClasses")},callBefore:function(){Re(this.popup).removeClass(this.popupClasses)},callAfter:function(){Re(this.popup).addClass(this.popupClasses)}})],o=[Je("select")],l=[Je("select")],c=[f({setIfUndefined:!0,preprocessValue:function(t){if(t instanceof HTMLElement)return t;const e="string"==typeof t?t:Tt(this.select.getValue(this.entries[0]));if(!(this.selector instanceof ks))return Es({text:e,elementTag:this.selectorTag});this.selector.text=e}})],h=[f({defaultValueCallback:()=>Hs()})],t(this,null,c,{kind:"setter",name:"selector",static:!1,private:!1,access:{has:t=>"selector"in t,set:(t,e)=>{t.selector=e}},metadata:e},null,m),t(this,null,h,{kind:"setter",name:"popup",static:!1,private:!1,access:{has:t=>"popup"in t,set:(t,e)=>{t.popup=e}},metadata:e},null,m),t(null,null,n,{kind:"field",name:"selectorTag",static:!1,private:!1,access:{has:t=>"selectorTag"in t,get:t=>t.selectorTag,set:(t,e)=>{t.selectorTag=e}},metadata:e},g,b),t(null,null,a,{kind:"field",name:"selectorClasses",static:!1,private:!1,access:{has:t=>"selectorClasses"in t,get:t=>t.selectorClasses,set:(t,e)=>{t.selectorClasses=e}},metadata:e},y,v),t(null,null,r,{kind:"field",name:"popupClasses",static:!1,private:!1,access:{has:t=>"popupClasses"in t,get:t=>t.popupClasses,set:(t,e)=>{t.popupClasses=e}},metadata:e},k,E),t(null,null,o,{kind:"field",name:"entries",static:!1,private:!1,access:{has:t=>"entries"in t,get:t=>t.entries,set:(t,e)=>{t.entries=e}},metadata:e},S,w),t(null,null,l,{kind:"field",name:"values",static:!1,private:!1,access:{has:t=>"values"in t,get:t=>t.values,set:(t,e)=>{t.values=e}},metadata:e},C,T),t(null,s={value:i},u,{kind:"class",name:i.name,metadata:e},null,d),i=s.value,e&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ms.config,defaultSelectorTag:"h4"};select=(e(this,m),new _s({onEntryAdded:t=>this.onEntryAdded(t)}));popupOpen=!1;selectorTag=e(this,g,void 0);selectorClasses=(e(this,b),e(this,y,void 0));popupClasses=(e(this,v),e(this,k,void 0));entries=(e(this,E),e(this,S,void 0));values=(e(this,w),e(this,C,void 0));onEntryAdded(t){this.select.initializeSelection(),Re(t).on(Ct.click,()=>(this.select.select(t,!this.select.isSelected(t)),this.openPopup(!1),!0))}set selector(t){t instanceof HTMLElement&&(Re(t).addClass(this.selectorClasses).on(Ct.click,t=>(this.openPopup(!this.popupOpen),!0)),this.popup instanceof Ks&&(this.popup.anchor=t),Re(this).addChild(t),t instanceof ks&&(this.select.onSelect=()=>t.text=this.stringSelectedValue))}get selector(){}set popup(t){t instanceof Ks&&(t.anchor=this.selector),Re(t).addClass(this.popupClasses),this.select.parent=t}initialize(){super.initialize(),this.selector,Re(document.body).on(Ct.click,()=>t=>{this.popupOpen&&!this.contains(t.target)&&this.openPopup(!1)},{capture:!0})}openPopup(t){this.popupOpen!=t&&(this.popupOpen=t,"show"in this.popup&&"function"==typeof this.popup.show?this.popup.show(t):Re(this.popup).show(t))}get selectedValues(){return this.select.selectedValues}get selectedValue(){return this.select.selectedValue}get selectedSecondaryValues(){return this.select.selectedSecondaryValues}get selectedSecondaryValue(){return this.select.selectedSecondaryValue}get stringSelectedValue(){return this.select.stringSelectedValue}constructor(){super(...arguments),e(this,T)}static{e(i,d)}},i})();function $s(t={}){return t.tag||(t.tag="turbo-dropdown"),D({...t,text:void 0})}let Gs=(()=>{let s,i,n,a,r=[Xe("turbo-marking-menu")],o=[],l=ms,c=[],h=[],u=[],d=[];return class extends l{static{i=this}static{const p="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;n=[f({initialValue:0,preprocessValue:t=>t-Math.PI/2})],a=[f({initialValue:2*Math.PI,preprocessValue:t=>t-Math.PI/2})],t(null,null,n,{kind:"field",name:"startAngle",static:!1,private:!1,access:{has:t=>"startAngle"in t,get:t=>t.startAngle,set:(t,e)=>{t.startAngle=e}},metadata:p},c,h),t(null,null,a,{kind:"field",name:"endAngle",static:!1,private:!1,access:{has:t=>"endAngle"in t,get:t=>t.endAngle,set:(t,e)=>{t.endAngle=e}},metadata:p},u,d),t(null,s={value:i},r,{kind:"class",name:i.name,metadata:p},null,o),i=s.value,p&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p}),e(i,o)}transition;currentOrigin;minDragDistance=20;semiMajor=50;semiMinor=45;startAngle=e(this,c,void 0);endAngle=(e(this,h),e(this,u,void 0));constructor(){super(...arguments),e(this,d)}},i})(),qs=(()=>{let s,i,n,a,r=[Xe("turbo-select-wheel")],o=[],l=ms,c=[];return class extends l{static{i=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;n=[f()],a=[f()],t(this,null,n,{kind:"setter",name:"alwaysOpen",static:!1,private:!1,access:{has:t=>"alwaysOpen"in t,set:(t,e)=>{t.alwaysOpen=e}},metadata:h},null,c),t(this,null,a,{kind:"setter",name:"open",static:!1,private:!1,access:{has:t=>"open"in t,set:(t,e)=>{t.open=e}},metadata:h},null,c),t(null,s={value:i},r,{kind:"class",name:i.name,metadata:h},null,o),i=s.value,h&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),e(i,o)}_currentPosition=(e(this,c),0);_reifect;_size={max:100,min:-100};sizePerEntry=[];positionPerEntry=[];totalSize=0;dragLimitOffset=30;openTimeout=3e3;direction=Oe.horizontal;scale={max:1,min:.5};generateCustomStyling;dragging;openTimer;set alwaysOpen(t){t?He(document).removeListener(Ct.click,this.closeOnClick):He(document).on(Ct.click,this.closeOnClick),this.open=t}closeOnClick=()=>this.open=!1;get isVertical(){return this.direction==Oe.vertical}set open(t){He(this).setStyle("overflow",t?"visible":"hidden")}get currentPosition(){return this._currentPosition}computeDragValue(t){return-t[this.isVertical?"y":"x"]}clearOpenTimer(){this.openTimer&&clearTimeout(this.openTimer)}setOpenTimer(){this.clearOpenTimer(),"number"!=typeof this.openTimeout||this.openTimeout<0||(this.openTimer=setTimeout(()=>this.open=!1,this.openTimeout))}},i})();class Ys{static config={shadowDOM:!1,defaultSelectedClass:"selected"};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}element;mvc=new J({element:this});constructor(t={}){this.element=x(t)}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}async function Xs(t){const e=(new TextEncoder).encode(t),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map(t=>t.toString(16).padStart(2,"0")).join("")}async function Js(t,e=12){const s=Math.ceil(6*e/8),i=new TextEncoder,n=await crypto.subtle.digest("SHA-256",i.encode(t)),a=new Uint8Array(n).slice(0,s);return("function"==typeof btoa?btoa(String.fromCharCode(...a)):Buffer.from(a).toString("base64")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"").slice(0,e)}function Qs(t,e,s,i,n,a=!0){if(a){const i=Math.max(e,s),n=Math.min(e,s);t>i&&(t=i),t<n&&(t=n)}return i+(t-e)*(n-i)/(s-e)}function Zs(t){return t instanceof Ut?t.scaledPosition:t instanceof PointerEvent?new Xt(t.clientX,t.clientY):void 0}function ti(t){if(!t)return NaN;const e=parseInt(t.substring(1),16);return.2126*((e>>16&255)/255)+.7152*((e>>8&255)/255)+.0722*((255&e)/255)}function ei(t,e){if(!t||!e)return NaN;const s=ti(t),i=ti(e);return(Math.max(s,i)+.1)/(Math.min(s,i)+.1)}function si(t,e="#000000",s="#FFFFFF"){return ei(t,s)>ei(e,t)?s:e}function ii(t,...e){let s="";return t.forEach((t,i)=>{s+=t+(e[i]||"")}),s}ae(Ys),ne(Ys),fs(Ys);const ni={900:{Black:"normal",BlackItalic:"italic"},800:{ExtraBold:"normal",ExtraBoldItalic:"italic"},700:{Bold:"normal",BoldItalic:"italic"},600:{SemiBold:"normal",SemiBoldItalic:"italic"},500:{Medium:"normal",MediumItalic:"italic"},400:{Regular:"normal",Italic:"italic"},300:{Light:"normal",LightItalic:"italic"},200:{ExtraLight:"normal",ExtraLightItalic:"italic"},100:{Thin:"normal",ThinItalic:"italic"}};function ai(t,e,s,i,n){return ii`
        @font-face {
            font-family: "${t}";
            src: url("${e}") format("${s}"), 
            url("${e}") format("woff"),
            url("${e}") format("truetype");
            font-weight: ${"string"==typeof i?'"'+i+'"':i};
            font-style: "${n}";
        }`}function ri(t){t.name&&t.pathOrDirectory||console.error("Please specify font name and path/directory");const e=0==Pt(t.pathOrDirectory).length;t.stylesPerWeights||(t.stylesPerWeights=e?ni:{normal:"normal"}),t.format||(t.format="woff2"),t.extension||(t.extension=".ttf"),"."!=t.extension[0]&&(t.extension="."+t.extension),Y(Object.entries(t.stylesPerWeights).map(([e,s])=>{const i=Number.parseInt(e),n=i||e;return"string"==typeof s?ai(t.name,t.pathOrDirectory,t.format,n,s):Object.entries(s).map(([e,s])=>ai(t.name,`${t.pathOrDirectory}/${t.name}-${e}${t.extension}`,t.format,n,s)).join("\n")}).join("\n"))}let oi=(()=>{let a,r=dt,o=[];return class extends r{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;a=[f()],t(this,null,a,{kind:"setter",name:"enabledCallbacks",static:!1,private:!1,access:{has:t=>"enabledCallbacks"in t,set:(t,e)=>{t.enabledCallbacks=e}},metadata:e},null,o),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}constructor(t,s){super(t,s),e(this,o)}get data(){return super.data}set data(t){t instanceof s&&(super.data=t)}set enabledCallbacks(t){this.getAllBlocks().forEach(e=>{e.observer&&e.data&&(t?e.data.observe(e.observer):e.data.unobserve(e.observer))})}getData(t,e=this.defaultBlockKey){const s=this.getBlockData(e);if(s instanceof i)return s.get(t.toString());if(s instanceof n){const e=Number(t);if(e>=0&&e<s.length)return s.get(e)}return null}setData(t,e,s=this.defaultBlockKey){const a=this.getBlockData(s);if(a instanceof i)a.set(t.toString(),e);else if(a instanceof n){const s=Number(t);if(s<0)return;s<a.length&&a.delete(s,1),a.insert(s,[e])}}getSize(t=this.defaultBlockKey){const e=this.getBlockData(t);return e instanceof i||e instanceof n?e instanceof n?e.length:e.size:0}createBlock(t,e,s=this.defaultBlockKey){return{...super.createBlock(t,e),observer:(t,e)=>this.observeChanges(t,e,s)}}setBlock(t,e,s=this.defaultBlockKey,i=!0){if(this.enabledCallbacks){const t=this.getBlock(s);t&&t.data&&t.observer&&t.data.unobserve(t.observer)}this.clear(s),super.setBlock(t,e,s,i)}initialize(t=this.defaultBlockKey){super.initialize(t);const e=this.getBlock(t);e?.data?.observe(e?.observer)}getAllKeys(t=this.defaultComputationBlockKey){const e=[];for(const s of this.getAllBlocks(t)){const t=s.data;if(t instanceof i)e.push(...Array.from(t.keys()));else if(t instanceof n)for(let s=0;s<t.length;s++)e.push(s)}return e}getAllObservers(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).map(t=>t.observer)}}})();class li extends oi{observeChanges(t,e,s){t.keysChanged.forEach(e=>{const i=t.changes.keys.get(e);i?this.fireKeyChangedCallback(e,s,"delete"===i?.action):console.warn(`No change info for key "${e}". Event:`,t)})}}class ci extends oi{onAdded=new Z;onUpdated=new Z;onDeleted=new Z;constructor(t,e){super(t,e),this.onUpdated.add((t,e,s)=>{(e instanceof ms||e instanceof Ys)&&(e.data=t,e.dataId=s.toString())}),this.onDeleted.add((t,e,s,i)=>{this.removeInstance(e),this.getBlock(i).instances?.delete(s)})}createBlock(t,e,s=this.defaultBlockKey){return{...super.createBlock(t,e,s),instances:new Map}}getInstance(t,e=this.defaultComputationBlockKey){for(const s of this.getAllBlocks(e))if(s.instances&&s.instances.has(t))return s.instances.get(t);return null}getAllComponents(t=this.defaultComputationBlockKey){const e=this.getBlock(t);if(e&&e.data instanceof n){const e=this.getBlock(t)?.instances;if(!e)return[];const s=[];for(const[t,i]of e.entries())s.push([t,i]);return s.sort((t,e)=>"string"==typeof t[0]&&"string"==typeof e[0]?t[0].localeCompare(e[0]):"number"==typeof t[0]&&"number"==typeof e[0]?t[0]-e[0]:0),s.map(([,t])=>t)}return this.getAllBlocks(t).flatMap(t=>Array.from(t.instances?.values())||[])}clear(t=this.defaultComputationBlockKey){super.clear(t),this.getAllBlocks(t).forEach(t=>{t?.instances?.forEach(t=>this.removeInstance(t)),t?.instances?.clear()})}getAllData(t=this.defaultComputationBlockKey){return super.getAllData(t)}fireKeyChangedCallback(t,e=this.defaultBlockKey,s=!1){if(!this.getAllKeys(e).includes(t))return super.fireKeyChangedCallback(t,e,s);const i=this.getData(t,e),n=this.onAdded.fire(i,t,e);n&&(this.getBlock(e).instances?.set(t,n),"object"==typeof n&&("data"in n&&(n.data=i),"dataId"in n&&(n.dataId=t.toString())),this.onUpdated.fire(i,n,t,e))}removeInstance(t){t&&"object"==typeof t&&"remove"in t&&"function"==typeof t.remove&&t?.remove()}observeChanges(t,e,s=this.defaultBlockKey){if(t instanceof a)t.keysChanged.forEach(e=>{const i=t.changes.keys.get(e);switch(i.action){case"add":this.fireKeyChangedCallback(e,s);break;case"delete":this.onDeleted.fire(i.oldValue,this.getInstance(e,s),e,s);break;case"update":this.onUpdated.fire(this.getData(e,s),this.getInstance(e,s),e,s)}});else if(t instanceof r){let e=0;for(const i of t.delta)if(void 0!==i.retain)e+=i.retain;else if(i.insert){const t=(Array.isArray(i.insert)?i.insert:[i.insert]).length;this.shiftIndices(e,t,s);for(let i=0;i<t;i++)this.fireKeyChangedCallback(e+i,s);e+=t}else if(i.delete){const t=i.delete;for(let i=0;i<t;i++)this.onDeleted.fire(void 0,this.getInstance(e+i,s),e+i,s);this.shiftIndices(e+t,-t,s)}}}shiftIndices(t,e,s=this.defaultBlockKey){const i=this.getBlock(s)?.instances;if(!i)return;const n=[];for(const[e,s]of i.entries()){const i=Number(e);i>=t&&n.push([i,s])}n.sort((t,e)=>t[0]-e[0]);for(const[t]of n)i.delete(t);for(const[t,s]of n){const n=t+e;"object"==typeof s&&"dataId"in s&&(s.dataId=n),i.set(t+e,s)}}}function hi(t){const e=new i;for(const[s,i]of Object.entries(t))e.set(s,i);return e}function ui(t){const e=new n;return e.push(t),e}async function di(t,e,s){const i=async()=>await Js(e?.doc?.clientID?.toString(32)+Os());if(!s)for(s=await i();void 0!==e?.get(s);)s=await i();return e.set(s,t),s}function pi(t,e,s){return null==s||s>e.length?(s=e.length,e.push([t])):(s<0&&(s=0),e.insert(s,[t])),s}function fi(t,e){for(const[s,i]of e.toArray())if(t==i)return e.delete(s),!0;return!1}function mi(t,e,...s){if(!t)return;const n=new Set(s);t.observeDeep(t=>{for(const s of t){const t=s.target,o=t._item?.parent,l=t._item?.parentSub;for(const c of n)if(s instanceof a&&s.changes.keys.has(c)||s instanceof r&&o instanceof i&&l===c||s.path?.some(t=>t===c))return void e(c,s,t)}})}function gi(t,e,...s){if(!t)return;const n=new Set(s);t.observeDeep(t=>{const s=new Set;for(const o of t){const t=o.target,l=t._item?.parent,c=t._item?.parentSub;for(const t of n)(o instanceof a&&o.changes.keys.has(t)||o instanceof r&&l instanceof i&&c===t||o.path?.some(e=>e===t))&&s.add(t);if(s.size===n.size)return void e(o,t)}})}export{He as $,Be as AccessLevel,It as ActionMode,y as ApplyDefaultsMergeProperties,Mt as BasicInputEvents,Bt as ClickMode,Ht as ClosestOrigin,gt as DefaultClickEventName,kt as DefaultDragEventName,Ct as DefaultEventName,ft as DefaultKeyEventName,yt as DefaultMoveEventName,St as DefaultWheelEventName,Z as Delegate,Oe as Direction,Ae as InOut,Nt as InputDevice,w as MathMLNamespace,T as MathMLTags,J as Mvc,jt as NonPassiveEvents,Me as OnOff,je as Open,Xt as Point,Ws as PopupFallbackMode,Ne as Range,Fs as Reifect,Ve as ReifectHandler,Ie as Shown,xe as Side,Pe as SideH,De as SideV,Ce as StatefulReifect,S as SvgNamespace,C as SvgTags,Vs as TurboBaseElement,ks as TurboButton,mt as TurboClickEventName,Gt as TurboController,Qt as TurboDragEvent,vt as TurboDragEventName,zs as TurboDrawer,Us as TurboDropdown,ms as TurboElement,X as TurboEmitter,Ut as TurboEvent,oe as TurboEventManager,wt as TurboEventName,se as TurboHandler,re as TurboHeadlessElement,gs as TurboIcon,Ss as TurboIconSwitch,Cs as TurboIconToggle,Ms as TurboInput,os as TurboInteractor,$t as TurboKeyEvent,pt as TurboKeyEventName,Vt as TurboMap,Gs as TurboMarkingMenu,dt as TurboModel,bt as TurboMoveEventName,Is as TurboNumericalInput,Ks as TurboPopup,Ys as TurboProxiedElement,ys as TurboRichElement,_s as TurboSelect,Ns as TurboSelectInputEvent,qs as TurboSelectWheel,m as TurboSelector,ls as TurboSubstrate,cs as TurboTool,rs as TurboView,te as TurboWeakSet,Yt as TurboWheelEvent,Et as TurboWheelEventName,li as YComponentModel,ci as YManagerModel,oi as YModel,M as a,pi as addInYArray,di as addInYMap,ve as areEqual,f as auto,si as bestOverlayColor,x as blindElement,Es as button,$e as cache,be as callOnce,ye as callOncePerInstance,Dt as camelToKebabCase,j as canvas,Ge as clearCache,qe as clearCacheEntry,ei as contrast,Ft as controller,ds as createProxy,ui as createYArray,hi as createYMap,ii as css,gi as deepObserveAll,mi as deepObserveAny,Xe as define,ht as disposeEffect,ut as disposeEffects,I as div,Rs as drawer,$s as dropdown,Ee as eachEqualToAny,at as effect,D as element,ke as equalToAny,Je as expose,ps as fetchSvg,es as flexCol,ss as flexColCenter,is as flexRow,ns as flexRowCenter,B as form,A as generateTagFunction,Zs as getEventPosition,Pt as getFileExtension,o as getFirstDescriptorInChain,c as getFirstPrototypeInChainWith,rt as getSignal,h as getSuperMethod,N as h1,V as h2,_ as h3,F as h4,L as h5,z as h6,Lt as handler,l as hasPropertyInChain,Js as hashBySize,Xs as hashString,bs as icon,ws as iconSwitch,Ts as iconToggle,R as img,ct as initializeEffects,W as input,zt as interactor,P as isMathMLTag,u as isNull,O as isSvgTag,d as isUndefined,xt as kebabToCamelCase,Qs as linearInterpolation,K as link,ri as loadLocalFont,ti as luminance,lt as markDirty,we as mod,nt as modelSignal,Bs as numericalInput,Ze as observe,H as p,Ot as parse,Hs as popup,Ds as randomColor,Ps as randomFromRange,Os as randomId,xs as randomString,Ls as reifect,fi as removeFromYArray,vs as richElement,ot as setSignal,E as setupClassFunctions,At as setupElementFunctions,ce as setupEventFunctions,b as setupHierarchyFunctions,v as setupMiscFunctions,Le as setupReifectFunctions,ue as setupStyleFunctions,me as setupSubstrateFunctions,pe as setupToolFunctions,it as signal,ts as solver,as as spacer,U as span,Te as statefulReifier,Tt as stringify,$ as style,Y as stylesheet,Wt as substrate,Ke as t,us as textToElement,G as textarea,Rt as tool,Se as trim,We as tu,Re as turbo,js as turboInput,Ue as turbofy,q as video};
