import{__esDecorate as t,__runInitializers as e}from"tslib";import{AbstractType as s,Map as n,Array as i,YMapEvent as a,YArrayEvent as r}from"yjs";export{AbstractType as YAbstractType,Array as YArray,YArrayEvent,Doc as YDoc,YEvent,Map as YMap,YMapEvent,Text as YText}from"yjs";function o(t,e){let s=t;for(;s&&s!==Object.prototype;){const t=Object.getOwnPropertyDescriptor(s,e);if(t)return t;s=Object.getPrototypeOf(s)}}function l(t,e){let s=t;for(;s&&s!==Object.prototype;){if(Object.prototype.hasOwnProperty.call(s,e))return!0;s=Object.getPrototypeOf(s)}return!1}function c(t,e){let s=Object.getPrototypeOf(t);for(;s&&s!==Object.prototype;){if(Object.getOwnPropertyDescriptor(s,e))return s;s=Object.getPrototypeOf(s)}}function h(t,e,s){let n=Object.getPrototypeOf(t);for(;n&&n!==Object.prototype;){const t=Object.getOwnPropertyDescriptor(n,e),i=t?.value??t?.get??t?.set;if("function"==typeof i&&i!==s)return i;n=Object.getPrototypeOf(n)}}const u=(t,e)=>{let s=Object.getPrototypeOf(t);for(s&&(s=Object.getPrototypeOf(s));s&&s!==Object.prototype;){const t=Object.getOwnPropertyDescriptor(s,e);if(t)return t;s=Object.getPrototypeOf(s)}};function d(t){return null==t&&null!=t}function f(t){return void 0===t}const p=new class{constructorMap=new WeakMap;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}};function m(t){return function(e,s){t||(t={});const{kind:n,name:i,static:a}=s,r=i,l=Symbol(`__auto_${r}`);s.addInitializer(function(){const s=a?this:c(this,r);let i,h;const u=function(){return i&&t?.returnDefinedGetterValue?i.call(this):this[l]},d=function(t){this[l]=t};let m=!1;const g=function(){let e=u.call(this);if(!m&&!t.returnDefinedGetterValue&&f(e)){if(m=!0,t.defaultValue)e=t.defaultValue;else if(t.defaultValueCallback)e=t.defaultValueCallback.call(this);else if(!t.setIfUndefined)return e;b.call(this,e),e=u.call(this),m=!1}return e},b=function(e){t.callBefore?.call(this,e);let s=t?.preprocessValue?t.preprocessValue.call(this,e):e;(t.cancelIfUnchanged??1)&&u.call(this)===s||(t.executeSetterBeforeStoring&&h&&h.call(this,s),d.call(this,s),!t.executeSetterBeforeStoring&&h&&h.call(this,s),t.callAfter?.call(this,s))};if(f(u.call(this))){let s="field"===n?e:void 0;f(s)&&(t.initialValue?s=t.initialValue:t.initialValueCallback&&(s=t.initialValueCallback.call(this))),!f(s)&&t.preprocessValue&&(s=t.preprocessValue.call(this,s)),this[l]=s}if("field"===n||"accessor"===n){const t=e;t?.get&&(i=t.get),t?.set&&(h=t.set);const s=o(this,r)??{enumerable:!0};Object.defineProperty(this,r,{configurable:!0,enumerable:s.enumerable??!0,get:()=>g.call(this),set:t=>b.call(this,t)})}else if("getter"===n||"setter"===n){const t=p.constructorData(s).installed;if(t.get(r))return;t.set(r,!0);const e=o(s,r)??{enumerable:!0};"function"==typeof e.get&&(i=e.get),"function"==typeof e.set&&(h=e.set),Object.defineProperty(s,r,{configurable:!0,enumerable:e.enumerable??!0,get:function(){return g.call(this)},set:function(t){b.call(this,t)}})}})}}class g{element;#t(){return new Proxy(this,{get(t,e,s){if(e in t)return Reflect.get(t,e,s);const n=t.element?.[e];return"function"==typeof n?n.bind(t.element):n},set:(t,e,s,n)=>e in t?Reflect.set(t,e,s,n):(t.element[e]=s,!0),has:(t,e)=>e in t||e in t.element,ownKeys:t=>Array.from([...Reflect.ownKeys(t),...Reflect.ownKeys(t.element)]),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t,e)||Object.getOwnPropertyDescriptor(t.element,e)||void 0})}constructor(){return this.#t()}}const b=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}};function y(){Object.defineProperty(g.prototype,"childHandler",{set:function(t){t instanceof g&&(t=t.element),b.data(this).childHandler=t},get:function(){const t=b.data(this).childHandler;return t||(this.element instanceof Element&&this.element.shadowRoot?this.element.shadowRoot:this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"childNodesArray",{get:function(){return this.element&&Array.from(this.childHandler?.childNodes)||[]},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"childrenArray",{get:function(){return this.childNodesArray.filter(t=>1===t.nodeType)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"siblingNodes",{get:function(){const t=this.element?.parentNode;return t&&Ge(t).childNodesArray||[]},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"siblings",{get:function(){const t=this.element?.parentElement;return t&&Ge(t).childrenArray||[]},configurable:!1,enumerable:!0}),g.prototype.bringToFront=function(){const t=this.element?.parentNode;return t?(Ge(t).addChild(this.element),this):this},g.prototype.sendToBack=function(){const t=this.element?.parentNode;return t?(Ge(t).addChild(this.element,0),this):this},g.prototype.remove=function(){return this.element?.parentNode?.removeChild(this.element),this},g.prototype.addChild=function(t,e,s=this.childrenArray){if(!this.element||!t)return this;if(void 0!==e&&(e<0||e>s.length)&&(e=void 0),null!=e)this.addChildBefore(t,s[e]);else try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof g&&(t=t.element),this.childHandler.appendChild(t))})}catch(t){console.error(t)}return this},g.prototype.remChild=function(t){if(!this.element||!t)return this;try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof g&&(t=t.element),this.childHandler.removeChild(t))})}catch(t){console.error(t)}return this},g.prototype.addChildBefore=function(t,e){if(!this.element||!t)return this;if(!e)return this.addChild(t);try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof g&&(t=t.element),this.childHandler.insertBefore(t,e))})}catch(t){console.error(t)}return this},g.prototype.removeChildAt=function(t,e=1,s=this.childrenArray){if(!this.element||void 0===t||t<0)return this;if(t>=s.length)return this;try{for(let n=t+e-1;n>=t;n--)n>=s.length||this.removeChild(s[n])}catch(t){console.error(t)}return this},g.prototype.removeAllChildren=function(t=this.childrenArray){if(!this.element)return this;try{for(let e=0;e<t.length;e++)this.removeChild(t[e])}catch(t){console.error(t)}return this},g.prototype.childAt=function(t,e=this.childrenArray){if(!this.element||void 0===t)return null;for(t>=e.length&&(t=e.length-1);t<0;)t+=e.length;return e[t]},g.prototype.indexOfChild=function(t,e=this.childrenArray){return this.element&&t?(e instanceof Array||(e=Array.from(e)),e.indexOf(t)):-1},g.prototype.hasChild=function(t){if(!this.element||!t)return!1;const e=Array.from(this.element?.childNodes);if(t instanceof Node)return e.includes(t);for(const s of t)if(!e.includes(s))return!1;return!0},g.prototype.closest=function(t){if(!(this.element&&t&&this.element instanceof Element))return null;if("string"==typeof t)return this.element.closest(t);if("function"==typeof t){let e=this.element;for(;e&&!(e instanceof t);)e=e.parentElement;return e||null}return null},g.prototype.findInParents=function(t){if(!t||!this.element)return!1;t instanceof Node&&(t=[t]);let e=this.element,s=0;for(;e&&s<t.length;)t.includes(e)&&s++,e=e.parentNode;return s===t.length},g.prototype.findInSubTree=function(t){if(!t||!this.element)return!1;t instanceof Node&&(t=[t]);let e=0;const s=n=>{t.includes(n)&&e++,e>=t.length||n.childNodes.forEach(t=>s(t))};return s(this.element),e>=t.length},g.prototype.indexInParent=function(t=this.siblings){return t&&this.element?t.indexOf(this.element):-1},g.prototype.addToParent=function(t,e,s){return this.element&&t?(Ge(t).addChild(this.element,e,s),this):this}}const v=["interactors","tools","substrates","controllers","handlers"];function k(){g.prototype.execute=function(t){return t(this),this},g.prototype.applyDefaults=function(t,e={}){if(!this.element||"object"!=typeof this.element)return this;const{mergeProperties:s=v,removeDuplicates:n=!0}=e;for(const[e,i]of Object.entries(t)){const t=s?.includes(e);if(t){const t=Array.isArray(i)?i:[i];let s=(f(this.element[e])?[]:Array.isArray(this.element[e])?this.element[e].slice():[this.element[e]]).concat(t);n&&(s=Array.from(new Set(s))),this.element[e]=s}else f(this.element[e])&&(this.element[e]=i)}return this}}const E=new class{operateOnClasses(t,e,s=()=>{}){if(!t||!e||!t.element)return t;try{"string"==typeof e&&(e=e.split(" ")),e.filter(t=>t.trim().length>0).forEach(t=>s(t))}catch(t){console.error(t)}return t}};function S(){g.prototype.addClass=function(t){return this.element instanceof Element?E.operateOnClasses(this,t,t=>this.element.classList.add(t)):this},g.prototype.removeClass=function(t){return this.element instanceof Element?E.operateOnClasses(this,t,t=>this.element.classList.remove(t)):this},g.prototype.toggleClass=function(t,e){return this.element instanceof Element?E.operateOnClasses(this,t,t=>this.element.classList.toggle(t,e)):this},g.prototype.hasClass=function(t){if(!(t&&this.element instanceof Element))return!1;if("string"==typeof t)return this.element.classList.contains(t);for(let e of t)if(!this.element.classList.contains(e))return!1;return!0}}const w="http://www.w3.org/2000/svg",C="http://www.w3.org/1998/Math/MathML",O=new Set(["a","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tspan","use","view"]),T=new Set(["annotation","annotation-xml","maction","math","merror","mfrac","mi","mmultiscripts","mn","mo","mover","mpadded","mphantom","mprescripts","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]);function P(t){return O.has(t)||t?.startsWith("svg")}function D(t){return T.has(t)||t?.startsWith("math")}function x(t={}){let e;return e=t.namespace?"svg"==t.namespace?document.createElementNS(w,t.tag||"svg"):"mathML"==t.namespace?document.createElementNS(C,t.tag||"math"):document.createElementNS(t.namespace,t.tag||"div"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),Ge(e).setProperties(t),e}function A(t={}){let e;return e=P(t.tag)?document.createElementNS(w,t.tag||"svg"):D(t.tag)?document.createElementNS(C,t.tag||"math"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),Ge(e).setProperties(t),e}function M(t){return(e={})=>(e.tag=t,x({...e,tag:t}))}function j(t={}){return x({...t,tag:"a"})}function I(t={}){return x({...t,tag:"canvas"})}function B(t={}){return x({...t,tag:"div"})}function N(t={}){return x({...t,tag:"form"})}function V(t={}){return x({...t,tag:"h1"})}function _(t={}){return x({...t,tag:"h2"})}function F(t={}){return x({...t,tag:"h3"})}function L(t={}){return x({...t,tag:"h4"})}function z(t={}){return x({...t,tag:"h5"})}function R(t={}){return x({...t,tag:"h6"})}function W(t={}){return x({...t,tag:"img"})}function K(t={}){return x({...t,tag:"input"})}function H(t={}){return x({...t,tag:"link"})}function U(t={}){return x({...t,tag:"p"})}function $(t={}){return x({...t,tag:"span"})}function G(t={}){return x({...t,tag:"style"})}function q(t={}){return x({...t,tag:"textarea"})}function Y(t={}){return x({...t,tag:"video"})}function X(t,e=document.head){if(!t)return;const s=G({innerHTML:t});Ge(e).addChild(s)}class J{callbacks=new Map;model;constructor(t){t&&(this.model=t)}get defaultBlockKey(){return this.model?this.model.defaultBlockKey:"__defaultBlockKey__"}getBlock(t){return this.callbacks.get(t?.toString())}getOrGenerateBlock(t){return this.callbacks.has(t.toString())||this.callbacks.set(t.toString(),new Map),this.callbacks.get(t.toString())}getKey(t,e){const s=this.getBlock(e);return s?s.get(t):[]}getOrGenerateKey(t,e){const s=this.getOrGenerateBlock(e);return s.has(t)||s.set(t,[]),s.get(t)}addWithBlock(t,e,s){this.getOrGenerateKey(t,e).push(s)}add(t,e){this.addWithBlock(t,this.defaultBlockKey,e)}removeWithBlock(t,e,s){if(null==s)this.getBlock(e)?.delete(t);else{const n=this.getKey(t,e),i=n.indexOf(s);i>=0&&n.splice(i,1)}}remove(t,e){this.removeWithBlock(t,this.defaultBlockKey,e)}fireWithBlock(t,e,...s){this.callbacks.get(e.toString())?.get(t)?.forEach(t=>{t&&"function"==typeof t&&t(...s)})}fire(t,...e){this.fireWithBlock(t,this.defaultBlockKey,...e)}}class Q{element;_view;_model;_emitter;_controllers=new Map;_handlers=new Map;_interactors=new Map;_tools=new Map;_substrates=new Map;constructor(t){t.element&&(this.element=t.element),t.emitter||(this.emitter=new J),this.generate(t)}get view(){return this._view}set view(t){this._view=this.generateInstance(t,{element:this.element}),this.linkPieces()}get model(){return this._model}set model(t){this.model?.keyChangedCallback.remove(this.emitterFireCallback),this._model=this.generateInstance(t),this._model.handlers=this._handlers,this._model.addHandler=t=>this.addHandler(t),this.linkPieces()}get emitter(){return this._emitter}set emitter(t){this._emitter=this.generateInstance(t),this.linkPieces()}get controllers(){return Array.from(this._controllers.values())||[]}set controllers(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addController(t)),this.linkPieces()}get handlers(){return Array.from(this._handlers.values())||[]}set handlers(t){this.generateInstances(t).forEach(t=>this.addHandler(t)),this.linkPieces()}get interactors(){return Array.from(this._interactors.values())||[]}set interactors(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addInteractor(t)),this.linkPieces()}get tools(){return Array.from(this._tools.values())||[]}set tools(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addTool(t)),this.linkPieces()}get substrates(){return Array.from(this._substrates.values())||[]}set substrates(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addSubstrate(t)),this.linkPieces()}get data(){return this.model?.data}set data(t){this.model&&(this.model.data=t)}get dataId(){return this.model?.dataId}set dataId(t){this.model&&(this.model.dataId=t)}get dataIndex(){return Number.parseInt(this.dataId)}set dataIndex(t){this.model&&(this.model.dataId=t.toString())}get dataSize(){return this.model?.getSize?.()}getController(t){return this._controllers.get(t)}addController(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Controller")),this._controllers.set(t.keyName,t),this.updateController(t)}getHandler(t){return this._handlers.get(t)}addHandler(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Handler")),this._handlers.set(t.keyName,t),this.updateHandler(t)}getInteractor(t){return this._interactors.get(t)}addInteractor(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Interactor")),this._interactors.set(t.keyName,t),this.updateInteractor(t)}getTool(t){return this._tools.get(t)}addTool(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Tool")),this._tools.set(t.keyName,t),this.updateTool(t)}getSubstrate(t){return this._substrates.get(t)}addSubstrate(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Substrate")),this._substrates.set(t.keyName,t),this.updateSubstrate(t)}generate(t={}){for(const e of Object.keys(t)){const s=t[e];void 0!==s&&"initialize"!==e&&"data"!==e&&(this[e]=s)}this._emitter||(this.emitter=new J),t.data&&this.model&&this.model.setBlock(t.data,void 0,void 0,!1),(void 0===t.initialize||t.initialize)&&this.initialize()}initialize(){this.view?.initialize(),this._controllers.forEach(t=>t.initialize()),this._interactors.forEach(t=>t.initialize()),this._tools.forEach(t=>t.initialize()),this._substrates.forEach(t=>t.initialize()),this.model?.initialize()}updateController(t){t.emitter=this.emitter,t.model=this.model,t.view=this.view}updateHandler(t){t.model=this.model}updateInteractor(t){t.model=this.model,t.view=this.view,t.emitter=this.emitter}updateTool(t){t.emitter=this.emitter,t.model=this.model,t.view=this.view}updateSubstrate(t){t.model=this.model,t.view=this.view,t.emitter=this.emitter}linkPieces(){this.model&&!this.model.keyChangedCallback.has(this.emitterFireCallback)&&this.model.keyChangedCallback.add(this.emitterFireCallback),this.emitter&&(this.emitter.model=this.model),this.view&&(this.view.emitter=this.emitter,this.view.model=this.model),this._controllers.forEach(t=>this.updateController(t)),this._handlers.forEach(t=>this.updateHandler(t)),this._interactors.forEach(t=>this.updateInteractor(t)),this._tools.forEach(t=>this.updateTool(t)),this._substrates.forEach(t=>this.updateSubstrate(t))}generateInstance(t,e,s=!0){if(t){if("function"==typeof t){return new t(s&&e&&"object"==typeof e?{...e}:e)}return t}}generateInstances(t,e,s=!0){if(!t)return[];"object"==typeof t&&Array.isArray(t)||(t=[t]);const n=[];return t.forEach(t=>{const i=this.generateInstance(t,e,s);i&&n.push(i)}),n}emitterFireCallback=(t,e,...s)=>this.emitter?.fireWithBlock(t,e,...s);extractClassEssenceName(t,e){let s=t.name,n=Object.getPrototypeOf(this.element);for(;n&&n.constructor!==Object;){const t=n.constructor.name.replaceAll("_","");if(s.startsWith(t)){s=s.slice(t.length);break}n=Object.getPrototypeOf(n)}return s.endsWith(e)&&(s=s.slice(0,-e.length)),s.charAt(0).toLowerCase()+s.slice(1)}}class Z{callbacks=new Set;add(t){this.callbacks.add(t)}remove(t){return this.callbacks.delete(t)}has(t){return this.callbacks.has(t)}fire(...t){let e;for(const s of this.callbacks)try{const n=s(...t);f(n)||(e=n)}catch(t){console.error("Error invoking callback:",t)}return e}clear(){this.callbacks.clear()}}class tt extends Z{onAdded=new Z;add(t){super.add(t),this.onAdded.fire(t)}}const et=new class{constructorMap=new WeakMap;dataMap=new WeakMap;activeEffect=null;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}data(t){let e=this.dataMap.get(t);return e||(e=new Map,this.dataMap.set(t,e)),e}track(t){this.activeEffect&&this.activeEffect.dependencies.add(t)}createSignalEntry(t,e,s,n,i){const a=new Set,r=this,o=void 0!==e||void 0!==s;let l=t;i||(i={diffOnWrite:!0});const c={get:()=>(r.track(c),o?s():l),set(a){if(o)if(n&&!i.diffOnWrite)n(a),c.emit();else if(n){const t=s();n(a);const e=s();Object.is(t,e)||c.emit()}else Reflect.set(t,e,a,t);else{const t=l;l=a,Object.is(t,a)||c.emit()}},update(t){c.set(t(o?s():l))},sub:t=>(a.add(t),()=>a.delete(t)),emit(){for(const t of Array.from(a))queueMicrotask(t)}};return c}getReactivityData(t,e){const s=this.data(t);return s.has(e)||s.set(e,{}),s.get(e)}getSignal(t,e){return this.getReactivityData(t,e).signal}setSignal(t,e,s){const n=this.getSignal(t,e);n?n.set(s):Reflect.set(t,e,s,t)}getEffect(t,e){return this.getReactivityData(t,e).effect}setEffect(t,e,s){this.getReactivityData(t,e).effect=s}markDirty(t,e){this.getSignal(t,e)?.emit()}schedule(t){t.scheduled||(t.scheduled=!0,queueMicrotask(()=>{t.scheduled=!1,t.run()}))}},st=new class{utils;constructor(t){this.utils=t}createBoxFromEntry(t){return new Proxy({...t,toJSON:()=>t.get(),valueOf:()=>t.get(),[Symbol.toPrimitive]:e=>{const s=t.get();return"string"===e?String(s):"number"==typeof s?s:null!=s&&"function"==typeof s.valueOf?s.valueOf():s},get value(){return t.get()},set value(e){t.set(e)}},{get:(t,e,s)=>Reflect.get(t,e,s),set:(t,e,s,n)=>"value"===e?(t.value=s,!0):Reflect.set(t,e,s,n)})}signalDecorator(t,e,s,n){const{kind:i,name:a,static:r,private:l}=e;if(l)throw new Error("@signal does not support private class elements.");const c=a,h=Symbol(`[[signal:${String(c)}]]`),u=Symbol(`[[signal:${String(c)}:shadow]]`),d=this.utils;e.addInitializer(function(){const e=r?this:this.constructor.prototype;let a,l;const f=function(){return s&&!this[u]?s.call(this):a&&!this[u]?a.call(this):this[h]},p=function(t){l||n?(n&&n.call(this,t),l&&l.call(this,t),a||s||(this[h]=t,this[u]=!0)):(this[h]=t,this[u]=!0)},m=(t,e=!0)=>{let n=d.getSignal(t,c);return n||("field"!==i||a||s||(t[h]=t[c]),n=d.createSignalEntry(t,c,()=>f.call(t),e=>p.call(t,e),{diffOnWrite:e}),d.getReactivityData(t,c).signal=n,"field"===i&&delete t[c],n)};if("field"===i||"accessor"===i){const e=t;e?.get&&(a=e.get),e?.set&&(l=e.set);const n=m(this,!a&&!s),i=o(this,c);Object.defineProperty(this,c,{configurable:i?.configurable??!0,enumerable:i?.enumerable??!0,get:()=>(d.track(n),f.call(this)),set:t=>n.set(t)})}else if("getter"===i||"setter"===i){const t=d.constructorData(e).installed;if(t.get(c))return;t.set(c,!0);const n=o(e,c)??{};"function"==typeof n.get&&(a=n.get),"function"==typeof n.set&&(l=n.set),Object.defineProperty(e,c,{configurable:n?.configurable??!0,enumerable:!!n?.enumerable,get:function(){const t=m(this,!a&&!s);return d.track(t),f.call(this)},set:function(t){m(this,!a&&!s).set(t)}})}})}}(et),nt=new class{utils;constructor(t){this.utils=t}makeEffect(t){const e=this.utils;return{callback:t,dependencies:new Set,cleanups:[],scheduled:!1,run(){for(const t of this.cleanups)t();this.cleanups=[],this.dependencies=new Set,e.activeEffect=this;try{this.callback()}finally{e.activeEffect=null}for(const t of this.dependencies){const s=t.sub(()=>e.schedule(this));this.cleanups.push(s)}},dispose(){for(const t of this.cleanups)t();this.cleanups=[],this.dependencies.clear()}}}}(et);function it(...t){if(t[1]&&"object"==typeof t[1]&&"kind"in t[1]&&"name"in t[1]&&"static"in t[1]&&"private"in t[1])return st.signalDecorator(t[0],t[1]);const e=t[0];return st.createBoxFromEntry(et.createSignalEntry(e))}function at(t,e){return function(s,n){const i=t??String(n.name);return st.signalDecorator(s,n,function(){return this.getData?.(i,e)},function(t){this.setData?.(i,t,e)})}}function rt(t,e){return function(s,n){const i=t??String(n.name);return st.signalDecorator(s,n,function(){return this.getBlockData?.(i)},function(t){this.setBlock?.(t,e,i)})}}function ot(t){return function(e,s){const n=t??String(s.name);return st.signalDecorator(e,s,function(){return this.getBlockId?.(n)},function(t){this.setBlockId?.(t,n)})}}function lt(...t){const e=t[0],s=t[1];if(s&&"object"==typeof s&&"kind"in s&&"name"in s&&"static"in s&&"private"in s){const{kind:t,name:n,static:i}=s,a=String(n);if("method"!==t&&"getter"!==t&&("field"!==t||"function"!=typeof e))throw new Error("@effect can only decorate zero-arg instance methods or getters.");if(i)throw new Error("@effect does not support static methods/getters.");s.addInitializer?.(function(){const t=this,s=function(){e?.call(this)},n=nt.makeEffect(()=>s.call(t));et.setEffect(t,a,n)})}else if("function"==typeof e){const t=nt.makeEffect(e);return t.run(),()=>t.dispose()}}function ct(t,e){return et.getSignal(t,e)}function ht(t,e,s){return et.setSignal(t,e,s)}function ut(t,e){return et.markDirty(t,e)}function dt(t){for(const[,e]of et.data(t))e.effect?.run()}function ft(t,e){const s=et.getReactivityData(t,e);s.effect?.dispose(),s.effect=void 0}function pt(t){for(const[,e]of et.data(t))e.effect?.dispose(),e.effect=void 0}let mt=(()=>{let s,n=[],i=[];return class{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[m()],t(this,null,s,{kind:"accessor",name:"enabledCallbacks",static:!1,private:!1,access:{has:t=>"enabledCallbacks"in t,get:t=>t.enabledCallbacks,set:(t,e)=>{t.enabledCallbacks=e}},metadata:e},n,i),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}isInitialized=new Map;isDataBlocksArray=!1;dataBlocks;handlers;keyChangedCallback;constructor(t,s){e(this,i),this.keyChangedCallback=new tt,"array"===s?(this.isDataBlocksArray=!0,this.dataBlocks=[]):(this.isDataBlocksArray=!1,this.dataBlocks=new Map),this.enabledCallbacks=!0,this.setBlock(t,void 0,this.defaultBlockKey,!1)}get data(){return this.getBlockData()}set data(t){this.setBlock(t)}get dataId(){return this.getBlockId()}set dataId(t){this.setBlockId(t)}#e=e(this,n,void 0);get enabledCallbacks(){return this.#e}set enabledCallbacks(t){this.#e=t}getData(t,e=this.defaultBlockKey){return this.isValidBlockKey(e)?this.getBlockData(e)?.[t]:null}setData(t,e,s=this.defaultBlockKey){if(!this.isValidBlockKey(s))return;const n=this.getBlockData(s);n&&(n[t]=e),this.enabledCallbacks&&this.fireKeyChangedCallback(t,s)}getSize(t=this.defaultBlockKey){return this.getAllKeys(t)?.length??0}getBlock(t=this.defaultBlockKey){if(!this.isValidBlockKey(t))return null;if(this.isDataBlocksArray){const e=Number(t);return Number.isInteger(e)&&e>=0?this.dataBlocks[e]??null:null}return this.dataBlocks.get(t.toString())??null}createBlock(t,e,s=this.defaultBlockKey){return{id:e??null,data:t}}setBlock(t,e,s=this.defaultBlockKey,n=!0){if(!this.isValidBlockKey(s)||null==t)return;const i=this.createBlock(t,e,s);if(this.isDataBlocksArray){const t=Number(s);Number.isInteger(t)&&t>=0&&(this.dataBlocks[t]=i)}else this.dataBlocks.set(s.toString(),i);n?this.initialize(s):this.isInitialized.set(s,!1)}hasBlock(t){if(this.isDataBlocksArray){const e=Number(t);return Number.isInteger(e)&&e>=0&&e<this.dataBlocks.length}return this.dataBlocks.has(t.toString())}addBlock(t,e,s,n=!0){if(!t)return;if(!this.isDataBlocksArray)return this.setBlock(t,e,s,n);const i=this.createBlock(t,e,s);let a=Number(s);(!Number.isInteger(a)||a<0)&&(a=this.dataBlocks.length),this.dataBlocks.splice(a,0,i),n&&this.initialize(a)}getBlockData(t=this.defaultBlockKey){const e=this.getBlock(t);return e?e.data:null}getBlockId(t=this.defaultBlockKey){const e=this.getBlock(t);return e?e.id:null}setBlockId(t,e=this.defaultBlockKey){if(!t)return;const s=this.getBlock(e);s&&(s.id=t)}fireKeyChangedCallback(t,e=this.defaultBlockKey,s=!1){this.isValidBlockKey(e)||(e=this.getAllBlockKeys()[0]),ut(this,t),this.keyChangedCallback.fire(t,e,s?void 0:this.getData(t,e))}fireCallback(t,...e){this.keyChangedCallback.fire(t,this.defaultBlockKey,...e)}fireBlockCallback(t,e=this.defaultBlockKey,...s){this.isValidBlockKey(e)||(e=this.getAllBlockKeys()[0]),this.keyChangedCallback.fire(t,e,...s)}initialize(t=this.defaultBlockKey){const e=this.getAllKeys(t);e&&this.enabledCallbacks&&(e.forEach(e=>this.fireKeyChangedCallback(e,t)),this.isInitialized.set(t,!0))}clear(t=this.defaultBlockKey){}get defaultBlockKey(){return this.isDataBlocksArray?0:"__turbo_default_block_key__"}get defaultComputationBlockKey(){return(this.isDataBlocksArray?this.dataBlocks.length:this.dataBlocks.size)>1?null:this.defaultBlockKey}isValidBlockKey(t){return null!=t&&("string"==typeof t&&0!==t.length||"number"==typeof t)}getAllBlockKeys(){return this.isDataBlocksArray?this.dataBlocks.map((t,e)=>e):Array.from(this.dataBlocks.keys())}getAllIds(){return this.isDataBlocksArray?this.dataBlocks.map(t=>t.id):Array.from(this.dataBlocks.values()).map(t=>t.id)}getAllBlocks(t=this.defaultComputationBlockKey){const e=[];if(null!==t){const s=this.getBlock(t);s&&e.push(s)}else for(const t of this.getAllBlockKeys()){const s=this.getBlock(t);s&&e.push(s)}return e}getAllKeys(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap(t=>Object.keys(t.data))}getAllData(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap(t=>Object.values(t.data))}getHandler(t){return this.handlers.get(t)}addHandler(t){t.keyName&&this.handlers.set(t.keyName,t)}}})();const gt={keyPressed:"turbo-key-pressed",keyReleased:"turbo-key-released"},bt={keyPressed:"keydown",keyReleased:"keyup"},yt={click:"turbo-click",clickStart:"turbo-click-start",clickEnd:"turbo-click-end",longPress:"turbo-long-press"},vt={click:"click",clickStart:"mousedown",clickEnd:"mouseup",longPress:yt.longPress},kt={move:"turbo-move"},Et={move:"mousemove"},St={drag:"turbo-drag",dragStart:"turbo-drag-start",dragEnd:"turbo-drag-end"},wt={drag:St.drag,dragStart:St.dragStart,dragEnd:St.dragEnd},Ct={trackpadScroll:"turbo-trackpad-scroll",trackpadPinch:"turbo-trackpad-pinch",mouseWheel:"turbo-mouse-wheel"},Ot={trackpadScroll:"wheel",trackpadPinch:"wheel",mouseWheel:"wheel"},Tt={...yt,...gt,...kt,...St,...Ct,selectInput:"turbo-select-input"},Pt={...bt,...vt,...Et,...wt,...Ot,wheel:"wheel",scroll:"scroll",input:"input",change:"change",focus:"focus",focusIn:"focusin",focusOut:"focusout",blur:"blur",resize:"resize",compositionStart:"compositionstart",compositionEnd:"compositionend"};function Dt(t){if(null!=t)switch(typeof t){case"string":return t;case"number":case"boolean":case"bigint":case"symbol":case"function":return t.toString();case"object":if(Array.isArray(t))return JSON.stringify(t);if(t instanceof Date)return t.toISOString();try{return JSON.stringify(t)}catch{return"[object Object]"}default:return String(t)}}function xt(t){if(!f(t)){switch(t){case"null":return null;case"true":return!0;case"false":return!1}if(!isNaN(Number(t)))return Number(t);if(/^\d+n$/.test(t))return BigInt(t.slice(0,-1));if(t.startsWith("function")||t.startsWith("("))try{const e=new Function(`return (${t})`)();if("function"==typeof e)return e}catch{}try{const e=JSON.parse(t);if("object"==typeof e&&null!=e)return e}catch{}return t}}function At(t){if(!t||0==t.length)return"";const e=t.match(/\.\S{1,4}$/);return e?e[0]:""}function Mt(t){if(t&&0!=t.length)return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function jt(t){if(t&&0!=t.length)return t.replace(/-([a-z])/g,t=>t[1].toUpperCase())}function It(){g.prototype.setProperties=function(t={},e=!1){if(!this)return this;if(t.out&&("string"==typeof t.out?this.__outName=t.out:Object.assign(t.out,this)),!this.element.shadowRoot){let e=!!t.shadowDOM;if("getPropertiesValue"in this.element&&"function"==typeof this.element.getPropertiesValue&&(e=this.element.getPropertiesValue(t.shadowDOM,"shadowDOM")),e)try{this.element.attachShadow({mode:"open"})}catch{}}const s=this.element?.mvc instanceof Q?this.element.mvc:"model"in this.element&&"view"in this.element?this.element:void 0;for(const n of Object.keys(t)){const i=t[n];if(void 0!==i)switch(n){case"tag":case"namespace":case"shadowDOM":break;case"text":this.element instanceof HTMLElement&&(this.element.innerText=i);break;case"style":if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))break;this.setStyles(i,!0);break;case"stylesheet":X(i,this.closestRoot);break;case"id":this.element.id=i;break;case"classes":this.addClass(i);break;case"listeners":Object.entries(i).forEach(([t,e])=>this.on(t,e));break;case"onClick":this.on(Pt.click,i);break;case"onDrag":this.on(Pt.drag,i);break;case"children":this.addChild(i);break;case"parent":Ge(i).addChild(this.element);break;case"data":case"initialize":if(s)break;case"model":case"view":case"emitter":case"controllers":case"handlers":case"interactors":case"tools":case"substrates":if(e)break;if(s){try{s[n]=i,"model"===n&&t.data&&s.model instanceof mt&&s.model.setBlock(t.data,void 0,void 0,!1)}catch{}break}default:if(e)break;try{this.element[n]=i}catch(t){try{this.setAttribute(n,Dt(i))}catch(t){console.error(t)}}}}return(void 0===t.initialize||t.initialize)&&(this.element&&"initialize"in this.element&&"function"==typeof this.element.initialize?this.element.initialize():s&&"initialize"in s&&"function"==typeof s.initialize&&s.initialize()),this},g.prototype.setMvc=function(t){if(this.element)return"mvc"in this.element&&this.element.mvc instanceof Q?(this.element.mvc.generate(t),this.element.mvc):new Q({...t,element:this.element})},g.prototype.destroy=function(){return this.removeAllListeners(),this.remove(),this.element&&"destroy"in this.element&&"function"==typeof this.element.destroy&&this.element.destroy(),this},g.prototype.setAttribute=function(t,e){return this.element instanceof Element&&this.element.setAttribute(t,e?.toString()||"true"),this},g.prototype.removeAttribute=function(t){return this.element instanceof Element&&this.element.removeAttribute(t),this},g.prototype.blur=function(){return this.element instanceof HTMLElement&&this.element.blur(),this},g.prototype.focus=function(){return this.element instanceof HTMLElement&&this.element.focus(),this}}const Bt=["mousedown","mouseup","mousemove","click","dblclick","contextmenu","dragstart","selectstart","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","wheel"],Nt=["wheel","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointercancel"];var Vt,_t,Ft;!function(t){t[t.none=0]="none",t[t.click=1]="click",t[t.longPress=2]="longPress",t[t.drag=3]="drag"}(Vt||(Vt={})),function(t){t[t.none=0]="none",t[t.left=1]="left",t[t.right=2]="right",t[t.middle=3]="middle",t[t.other=4]="other",t[t.key=5]="key"}(_t||(_t={})),function(t){t[t.unknown=0]="unknown",t[t.mouse=1]="mouse",t[t.trackpad=2]="trackpad",t[t.touch=3]="touch"}(Ft||(Ft={}));class Lt extends Map{enforceImmutability=!0;set(t,e){return super.set(t,this.enforceImmutability?this.copy(e):e)}get(t){const e=super.get(t);return this.enforceImmutability?this.copy(e):e}get first(){if(0==this.size)return null;const t=this.values().next().value;return this.enforceImmutability?this.copy(t):t}get last(){if(0==this.size)return null;const t=this.valuesArray()[this.size-1];return this.enforceImmutability?this.copy(t):t}keysArray(){return Array.from(this.keys())}valuesArray(){return Array.from(this.values())}copy(t){if(t&&"object"==typeof t){if(t instanceof Array)return t.map(t=>this.copy(t));if(t.constructor&&t.constructor!=Object){if("function"==typeof t.clone)return t.clone();if("function"==typeof t.copy)return t.copy()}return{...t}}return t}mapKeys(t){const e=new Lt;for(let[s,n]of this)e.set(t(s,n),n);return e}mapValues(t){const e=new Lt;for(let[s,n]of this)e.set(s,t(s,n));return e}filter(t){const e=new Lt;for(let[s,n]of this)t(s,n)&&e.set(s,n);return e}merge(t){for(let[e,s]of t)this.set(e,s);return this}}function zt(t,e,s){const n=Symbol(`__${e.toLowerCase()}_${String(t.name)}`),i=function(t,e,s){return t??(String(s.name).endsWith(e)?String(s.name).slice(0,-e.length):String(s.name))}(s,e,t);t.addInitializer(function(){Object.defineProperty(this,t.name,{configurable:!0,enumerable:!1,get:function(){if(this[n])return this[n];let t,s;switch(e){case"Controller":s="getController";break;case"Handler":s="getHandler";break;case"Interactor":s="getInteractor";break;case"Tool":s="getTool";break;case"Substrate":s="getSubstrate"}if(s){if(this.mvc&&this.mvc instanceof Q?t=this.mvc[s](i):this[s]&&"function"==typeof this[s]&&(t=this[s](i)),!t)throw new Error(`${e} "${i}" not found on ${this?.constructor?.name}.`);return this[n]=t,t}},set:function(t){this[n]=t}})})}function Rt(t){return function(e,s){zt(s,"Controller",t)}}function Wt(t){return function(e,s){zt(s,"Handler",t)}}function Kt(t){return function(e,s){zt(s,"Interactor",t)}}function Ht(t){return function(e,s){zt(s,"Tool",t)}}function Ut(t){return function(e,s){zt(s,"Substrate",t)}}let $t=(()=>{let s,n,i=mt,a=[],r=[],o=[];return class extends i{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(i[Symbol.metadata]??null):void 0;s=[Wt()],n=[m({callBefore:function(t){t==Ft.trackpad&&(this.wasRecentlyTrackpad=!0)}})],t(this,null,n,{kind:"setter",name:"inputDevice",static:!1,private:!1,access:{has:t=>"inputDevice"in t,set:(t,e)=>{t.inputDevice=e}},metadata:e},null,a),t(null,null,s,{kind:"field",name:"utils",static:!1,private:!1,access:{has:t=>"utils"in t,get:t=>t.utils,set:(t,e)=>{t.utils=e}},metadata:e},r,o),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}utils=(e(this,a),e(this,r,void 0));state=(e(this,o),{});lockState={};onInputDeviceChange=new tt;onToolChange=new tt;currentKeys=[];currentAction=Vt.none;currentClick=_t.none;wasRecentlyTrackpad=!1;moveThreshold;longPressDuration;authorizeEventScaling;scaleEventPosition;activePointers=new Set;origins=new Lt;previousPositions=new Lt;positions;lastTargetOrigin;timerMap=new Lt;tools=new Map;mappedKeysToTool=new Map;currentTools=new Map;set inputDevice(t){this.onInputDeviceChange.fire(t)}}})();var Gt;!function(t){t.target="target",t.position="position"}(Gt||(Gt={}));let qt=(()=>{let s,n,i=Event,a=[];return class extends i{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(i[Symbol.metadata]??null):void 0;s=[Ye()],n=[Ye()],t(this,null,s,{kind:"method",name:"closest",static:!1,private:!1,access:{has:t=>"closest"in t,get:t=>t.closest},metadata:e},null,a),t(this,null,n,{kind:"getter",name:"scaledPosition",static:!1,private:!1,access:{has:t=>"scaledPosition"in t,get:t=>t.scaledPosition},metadata:e},null,a),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}eventManager=e(this,a);toolName;eventName;clickMode;keys;position;authorizeScaling;scalePosition;constructor(t){super(t.eventName,{bubbles:!0,cancelable:!0,...t.eventInitDict}),this.eventManager=t.eventManager??he.instance,this.authorizeScaling=t.authorizeScaling??!0,this.scalePosition=t.scalePosition??(t=>t),this.clickMode=t.clickMode??he.instance.currentClick,this.keys=t.keys??he.instance.currentKeys,this.eventName=t.eventName,this.position=t.position,this.toolName=t.toolName}get tool(){return this.toolName&&this.eventManager instanceof he?this.eventManager.getToolByName(this.toolName):null}closest(t,e=!0,s=Gt.target){const n=s==Gt.target?[this.target]:document.elementsFromPoint(this.position.x,this.position.y),i=e instanceof Element?e:null,a=!0===e||null!==i;for(let e of n){for(;e&&(!(e instanceof t)||a&&!this.isPositionInsideElement(this.position,i??e));)e=e.parentElement;if(e)return e}return null}isPositionInsideElement(t,e){const s=e.getBoundingClientRect();return t.x>=s.left&&t.x<=s.right&&t.y>=s.top&&t.y<=s.bottom}get target(){return super.target||document}get scaledPosition(){return this.scalingAuthorized?this.scalePosition(this.position):this.position}get scalingAuthorized(){return"function"==typeof this.authorizeScaling?this.authorizeScaling():this.authorizeScaling}scalePositionsMap(t){return t.mapValues((t,e)=>this.scalePosition(e))}}})();class Yt extends qt{keyPressed;keyReleased;constructor(t){super({...t,position:null}),this.keyPressed=t.keyPressed,this.keyReleased=t.keyReleased}}class Xt{keyName;element;view;model;emitter;constructor(t){this.element=t.element,t.model&&(this.model=t.model),t.emitter&&(this.emitter=t.emitter),t.view&&(this.view=t.view)}initialize(){this.setupChangedCallbacks()}setupChangedCallbacks(){dt(this)}}class Jt extends Xt{keyName="key";keyDown=t=>this.keyDownFn(t);keyDownFn(t){this.element.enabled&&(this.model.currentKeys.includes(t.key)||(this.model.currentKeys.push(t.key),this.emitter.fire("dispatchEvent",document,Yt,{eventName:gt.keyPressed,keyPressed:t.key})))}keyUp=t=>this.keyUpFn(t);keyUpFn(t){this.element.enabled&&this.model.currentKeys.includes(t.key)&&(this.model.currentKeys.splice(this.model.currentKeys.indexOf(t.key),1),this.emitter.fire("dispatchEvent",document,Yt,{eventName:gt.keyReleased,keyReleased:t.key}))}}class Qt extends qt{delta;constructor(t){super({...t,position:null}),this.delta=t.delta}}class Zt{x;y;constructor(t=0,e=("number"==typeof t?t:0)){"number"==typeof t?(this.x=t,this.y=e):"clientX"in t?(this.x=t.clientX,this.y=t.clientY):"x"in t?(this.x=t.x,this.y=t.y):(this.x=t[0],this.y=t[1])}static dist(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static midPoint(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>t+e.x,0)/t.length,s=t.reduce((t,e)=>t+e.y,0)/t.length;return new Zt(e,s)}static max(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>Math.max(t,e.x),-1/0),s=t.reduce((t,e)=>Math.max(t,e.y),-1/0);return new Zt(e,s)}static min(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>Math.min(t,e.x),1/0),s=t.reduce((t,e)=>Math.min(t,e.y),1/0);return new Zt(e,s)}get object(){return{x:this.x,y:this.y}}equals(t,e=0){return"number"==typeof t?this.x==t&&this.y==e:this.x==t.x&&this.y==t.y}boundX(t,e){return this.x<t?t:this.x>e?e:this.x}boundY(t,e){return this.y<t?t:this.y>e?e:this.y}bound(t,e,s=t,n=e){return new Zt(this.boundX(t,e),this.boundY(s,n))}add(t,e){return"number"==typeof t?new Zt(this.x+t,this.y+(e||0==e?e:t)):new Zt(this.x+t.x,this.y+t.y)}sub(t,e){return"number"==typeof t?new Zt(this.x-t,this.y-(e||0==e?e:t)):new Zt(this.x-t.x,this.y-t.y)}mul(t,e){return"number"==typeof t?new Zt(this.x*t,this.y*(e||0==e?e:t)):new Zt(this.x*t.x,this.y*t.y)}div(t,e){return"number"==typeof t?new Zt(this.x/t,this.y/(e||0==e?e:t)):new Zt(this.x/t.x,this.y/t.y)}mod(t,e){const s="number"==typeof t?{x:t,y:e||0==e?e:t}:{x:t.x,y:t.y},n=this.object;for(;n.x<0;)n.x+=s.x;for(;n.x>=s.x;)n.x-=s.x;for(;n.y<0;)n.y+=s.y;for(;n.y>=s.y;)n.y-=s.y;return new Zt(n)}get abs(){return new Zt(Math.abs(this.x),Math.abs(this.y))}get max(){return Math.max(this.x,this.y)}get min(){return Math.min(this.x,this.y)}get length2(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length2)}dot(t){return this.x*t.x+this.y*t.y}copy(){return new Zt(this.x,this.y)}arr(){return[this.x,this.y]}}class te extends Xt{keyName="wheel";wheel=t=>{if(!this.element.enabled)return;let e;this.element.preventDefaultWheel&&t.preventDefault(),(Math.abs(t.deltaY)<=40||0!=t.deltaX)&&(this.model.inputDevice=Ft.trackpad),this.model.wasRecentlyTrackpad||(this.model.inputDevice=Ft.mouse),this.model.utils.clearTimer("recentlyTrackpadTimer"),this.model.utils.setTimer("recentlyTrackpadTimer",()=>{this.model.inputDevice==Ft.trackpad&&(this.model.wasRecentlyTrackpad=!1)},800),e=this.model.inputDevice==Ft.trackpad&&t.ctrlKey?Tt.trackpadPinch:this.model.inputDevice==Ft.trackpad?Tt.trackpadScroll:Tt.mouseWheel,this.emitter.fire("dispatchEvent",document,Qt,{delta:new Zt(t.deltaX,t.deltaY),eventName:e})}}let ee=(()=>{let s,n,i,a,r,o,l,c=qt,h=[];return class extends c{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;s=[Ye()],n=[Ye()],i=[Ye()],a=[Ye()],r=[Ye()],o=[Ye()],l=[Ye()],t(this,null,s,{kind:"getter",name:"scaledOrigins",static:!1,private:!1,access:{has:t=>"scaledOrigins"in t,get:t=>t.scaledOrigins},metadata:e},null,h),t(this,null,n,{kind:"getter",name:"scaledPreviousPositions",static:!1,private:!1,access:{has:t=>"scaledPreviousPositions"in t,get:t=>t.scaledPreviousPositions},metadata:e},null,h),t(this,null,i,{kind:"getter",name:"scaledPositions",static:!1,private:!1,access:{has:t=>"scaledPositions"in t,get:t=>t.scaledPositions},metadata:e},null,h),t(this,null,a,{kind:"getter",name:"deltaPositions",static:!1,private:!1,access:{has:t=>"deltaPositions"in t,get:t=>t.deltaPositions},metadata:e},null,h),t(this,null,r,{kind:"getter",name:"deltaPosition",static:!1,private:!1,access:{has:t=>"deltaPosition"in t,get:t=>t.deltaPosition},metadata:e},null,h),t(this,null,o,{kind:"getter",name:"scaledDeltaPositions",static:!1,private:!1,access:{has:t=>"scaledDeltaPositions"in t,get:t=>t.scaledDeltaPositions},metadata:e},null,h),t(this,null,l,{kind:"getter",name:"scaledDeltaPosition",static:!1,private:!1,access:{has:t=>"scaledDeltaPosition"in t,get:t=>t.scaledDeltaPosition},metadata:e},null,h),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}origins=e(this,h);previousPositions;positions;constructor(t){super({...t,position:t.positions.first}),this.origins=t.origins,this.previousPositions=t.previousPositions,this.positions=t.positions}get scaledOrigins(){return this.scalingAuthorized?this.scalePositionsMap(this.origins):this.origins}get scaledPreviousPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.previousPositions):this.previousPositions}get scaledPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.positions):this.positions}get deltaPositions(){return this.positions.mapValues((t,e)=>{const s=this.previousPositions.get(t);if(s)return e.sub(s)})}get deltaPosition(){return Zt.midPoint(...this.deltaPositions.valuesArray())}get scaledDeltaPositions(){return this.scaledPositions.mapValues((t,e)=>{const s=this.scaledPreviousPositions.get(t);if(s)return e.sub(s)})}get scaledDeltaPosition(){return Zt.midPoint(...this.scaledDeltaPositions.valuesArray())}}})();class se extends Xt{keyName="pointer";pointerDown=t=>this.pointerDownFn(t);pointerMove=t=>this.pointerMoveFn(t);pointerUp=t=>this.pointerUpFn(t);pointerCancel=t=>this.pointerCancelFn(t);lostPointerCapture=t=>this.lostPointerCaptureFn(t);pointerDownFn(t){if(t.composedPath().includes(this.model.lockState.lockOrigin)||(document.activeElement?.blur?.(),this.element.unlock()),!this.element.enabled)return;const e="touch"===t.pointerType;this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),e?this.model.inputDevice=Ft.touch:this.model.inputDevice!==Ft.unknown&&this.model.inputDevice!==Ft.touch||(this.model.inputDevice=Ft.mouse);const s=t.pointerId,n=new Zt(t.clientX,t.clientY);this.model.origins.set(s,n),this.model.previousPositions.set(s,n);const i=document.elementFromPoint(n.x,n.y);i&&i.setPointerCapture?.(t.pointerId),this.model.activePointers.add(s),this.model.utils.setClickMode(e?this.model.activePointers.size:t.button,e),this.element.clickEventEnabled&&(this.fireClick(this.model.origins.first,Tt.clickStart),this.model.currentAction=Vt.click,this.model.utils.setTimer(Tt.longPress,()=>{this.model.currentAction===Vt.click&&(this.model.currentAction=Vt.longPress,this.fireClick(this.model.origins.first,Tt.longPress))},this.model.longPressDuration))}pointerMoveFn(t){if(!this.element.enabled)return;if(!this.element.moveEventsEnabled&&!this.element.dragEventEnabled)return;const e="touch"===t.pointerType;if(this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),this.model.positions=new Lt,this.model.positions.set(t.pointerId,new Zt(t.clientX,t.clientY)),this.model.currentAction!==Vt.drag&&(this.model.lastTargetOrigin=null),this.element.moveEventsEnabled&&this.fireDrag(this.model.positions,Tt.move),this.model.currentAction!==Vt.none&&this.element.dragEventEnabled){if(this.model.currentAction!==Vt.drag){if(!Array.from(this.model.origins.entries()).some(([e,s])=>{const n=e===t.pointerId?this.model.positions.get(e):this.model.previousPositions.get(e);return n&&Zt.dist(n,s)>this.model.moveThreshold}))return;Xe(this),this.fireDrag(this.model.origins,Tt.dragStart),this.model.currentAction=Vt.drag}this.fireDrag(this.model.positions)}this.model.previousPositions.set(t.pointerId,this.model.positions.get(t.pointerId))}pointerUpFn(t){if(!this.element.enabled)return;const e="touch"===t.pointerType;this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),this.model.utils.clearTimer(Tt.longPress),this.model.positions=new Lt,this.model.positions.set(t.pointerId,new Zt(t.clientX,t.clientY)),this.model.currentAction===Vt.drag&&this.element.dragEventEnabled&&this.fireDrag(this.model.positions,Tt.dragEnd),this.element.clickEventEnabled&&(this.model.currentAction===Vt.click&&this.fireClick(this.model.positions.first,Tt.click),this.fireClick(this.model.origins.first,Tt.clickEnd)),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=Vt.none,this.model.currentClick=_t.none)}pointerCancelFn(t){this.model.utils.clearTimer(Tt.longPress),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=Vt.none,this.model.currentClick=_t.none)}lostPointerCaptureFn(t){}fireClick(t,e=Tt.click){if(!t)return;const s=document.elementFromPoint(t.x,t.y)||document;this.emitter.fire("dispatchEvent",s,qt,{position:t,eventName:e})}fireDrag(t,e=Tt.drag){t&&this.emitter.fire("dispatchEvent",this.getFireOrigin(t),ee,{positions:t,previousPositions:this.model.previousPositions,origins:this.model.origins,eventName:e})}getFireOrigin(t,e=!1){if(!this.model.lastTargetOrigin||e){const e=this.model.origins.first?this.model.origins.first:t.first;this.model.lastTargetOrigin=document.elementFromPoint(e.x,e.y)}return this.model.lastTargetOrigin}}class ne{_weakRefs;constructor(){this._weakRefs=new Set}add(t){return this.has(t)||this._weakRefs.add(new WeakRef(t)),this}has(t){for(const e of this._weakRefs)if(e.deref()===t)return!0;return!1}delete(t){for(const e of this._weakRefs)if(e.deref()===t)return this._weakRefs.delete(e),!0;return!1}cleanup(){for(const t of this._weakRefs)void 0===t.deref()&&this._weakRefs.delete(t)}toArray(){const t=[];for(const e of this._weakRefs){const s=e.deref();void 0!==s?t.push(s):this._weakRefs.delete(e)}return t}get size(){return this.cleanup(),this.toArray().length}clear(){this._weakRefs.clear()}}class ie extends Xt{keyName="dispatch";boundHooks=new Map;setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("dispatchEvent",this.dispatchEvent)}dispatchEvent=(t,e,s)=>{t&&(s.keys=this.model.currentKeys,s.toolName=this.element.getCurrentToolName(this.model.currentClick),s.clickMode=this.model.currentClick,s.eventManager=this.element,s.eventInitDict={bubbles:!0,cancelable:!0,composed:!0},s.authorizeScaling=this.element.authorizeEventScaling,s.scalePosition=this.element.scaleEventPosition,s.eventName===gt.keyPressed?this.element.setToolByKey(s.keyPressed):s.eventName===gt.keyReleased&&this.element.setTool(void 0,_t.key,{select:!1}),t.dispatchEvent(new e(s)))};getToolHandlingCallback(t,e){const s=this.element.getCurrentToolName(this.model.currentClick),n=e.composedPath?.()||[];for(let i=n.length-1;i>=0;i--)if(n[i]instanceof Node&&Ge(n[i]).executeAction(t,s,e,{capture:!0},this.element)){e.stopPropagation();break}for(let i=0;i<n.length;i++)if(n[i]instanceof Node&&Ge(n[i]).executeAction(t,s,e,void 0,this.element)){e.stopPropagation();break}}setupCustomDispatcher(t){if(this.boundHooks.has(t))return;const e=e=>this.getToolHandlingCallback(t,e);this.boundHooks.set(t,e),document.addEventListener(t,e,{capture:!0})}removeCustomDispatcher(t){const e=this.boundHooks.get(t);e&&(document.removeEventListener(t,e,{capture:!0}),this.boundHooks.delete(t))}}class ae{keyName;model;constructor(t){this.model&&(this.model=t)}}class re extends ae{keyName="utils";setClickMode(t,e=!1){switch(e&&t--,t){case-1:return void(this.model.currentClick=_t.none);case 0:return void(this.model.currentClick=_t.left);case 1:return void(this.model.currentClick=_t.middle);case 2:return void(this.model.currentClick=_t.right);default:return void(this.model.currentClick=_t.other)}}applyEventNames(t){for(const e in t)Pt[e]=t[e]}setTimer(t,e,s){this.clearTimer(t),this.model.timerMap.set(t,setTimeout(()=>{e(),this.clearTimer(t)},s))}clearTimer(t){const e=this.model.timerMap.get(t);e&&(clearTimeout(e),this.model.timerMap.delete(t))}selectTool(t,e){"selected"in t&&"boolean"==typeof t.selected&&(t.selected=e)}activateTool(t,e,s){s?Ge(t).onToolActivate(e).fire():Ge(t).onToolDeactivate(e).fire()}}function oe(t){const e=t.prototype;Object.defineProperty(e,"view",{get(){return this.mvc?.view},set(t){if(!this.mvc)throw new Error("view: missing this.mvc");this.mvc.view=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"model",{get(){return this.mvc?.model},set(t){if(!this.mvc)throw new Error("model: missing this.mvc");this.mvc.model=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"data",{get(){return this.mvc?.data},set(t){if(!this.mvc)throw new Error("data: missing this.mvc");this.mvc.data=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataId",{get(){return this.mvc?.dataId},set(t){if(!this.mvc)throw new Error("dataId: missing this.mvc");this.mvc.dataId=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataIndex",{get(){return this.mvc?.dataIndex},set(t){if(!this.mvc)throw new Error("dataIndex: missing this.mvc");this.mvc.dataIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataSize",{get(){return this.mvc?.dataSize},enumerable:!0,configurable:!0})}function le(t){const e=t.prototype,s=Symbol("__selected__"),n=Symbol("__selectedClass__"),i=Symbol("__initialized__");Object.defineProperty(e,"selected",{get(){return!!this[s]},set(t){const e=this instanceof Element?this:this.element instanceof Element?this.element:void 0;if(!e)return void(this[s]=t);const i=this[n],a=this.getPropertiesValue?.(null,"defaultSelectedClass","selected")??"selected";this[s]=t,this[n]=a,i&&i!==a&&Ge(e).toggleClass(i,!1),Ge(e).toggleClass(a,!!t)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"getPropertiesValue",{value:function(t,e,s){if(null!=t)return t;let n=this.constructor;for(;n;){const t=n.config?.[e];if(null!=t)return t;n=Object.getPrototypeOf(n)}return s},configurable:!0,enumerable:!1}),Object.defineProperty(e,"destroy",{value:function(){},configurable:!0,enumerable:!1}),Object.defineProperty(e,"initialized",{get:function(){return this[i]??!1},configurable:!0,enumerable:!1}),Object.defineProperty(e,"initialize",{value:function(){this[i]||(this.setupUIElements?.(),this.setupUILayout?.(),this.setupUIListeners?.(),this.setupChangedCallbacks?.(),this.mvc&&this.mvc instanceof Q&&this.mvc.initialize(),dt(this),this[i]=!0)},configurable:!0,enumerable:!1})}class ce{static config={};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}mvc;constructor(t={}){this.mvc=new Q({...t,element:this})}}le(ce),oe(ce);let he=(()=>{let s,n,i,a,r,o,l,c,h,u,d,p=ce,g=[],b=[],y=[],v=[],k=[],E=[],S=[],w=[],C=[];return class O extends p{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;s=[Rt()],n=[Rt()],i=[Rt()],a=[Rt()],r=[m()],o=[m()],l=[m()],c=[m()],h=[m()],u=[m()],d=[m()],t(this,null,r,{kind:"setter",name:"keyEventsEnabled",static:!1,private:!1,access:{has:t=>"keyEventsEnabled"in t,set:(t,e)=>{t.keyEventsEnabled=e}},metadata:e},null,g),t(this,null,o,{kind:"setter",name:"wheelEventsEnabled",static:!1,private:!1,access:{has:t=>"wheelEventsEnabled"in t,set:(t,e)=>{t.wheelEventsEnabled=e}},metadata:e},null,g),t(this,null,l,{kind:"setter",name:"moveEventsEnabled",static:!1,private:!1,access:{has:t=>"moveEventsEnabled"in t,set:(t,e)=>{t.moveEventsEnabled=e}},metadata:e},null,g),t(this,null,c,{kind:"setter",name:"mouseEventsEnabled",static:!1,private:!1,access:{has:t=>"mouseEventsEnabled"in t,set:(t,e)=>{t.mouseEventsEnabled=e}},metadata:e},null,g),t(this,null,h,{kind:"setter",name:"touchEventsEnabled",static:!1,private:!1,access:{has:t=>"touchEventsEnabled"in t,set:(t,e)=>{t.touchEventsEnabled=e}},metadata:e},null,g),t(this,null,u,{kind:"setter",name:"clickEventEnabled",static:!1,private:!1,access:{has:t=>"clickEventEnabled"in t,set:(t,e)=>{t.clickEventEnabled=e}},metadata:e},null,g),t(this,null,d,{kind:"setter",name:"dragEventEnabled",static:!1,private:!1,access:{has:t=>"dragEventEnabled"in t,set:(t,e)=>{t.dragEventEnabled=e}},metadata:e},null,g),t(null,null,s,{kind:"field",name:"keyController",static:!1,private:!1,access:{has:t=>"keyController"in t,get:t=>t.keyController,set:(t,e)=>{t.keyController=e}},metadata:e},b,y),t(null,null,n,{kind:"field",name:"wheelController",static:!1,private:!1,access:{has:t=>"wheelController"in t,get:t=>t.wheelController,set:(t,e)=>{t.wheelController=e}},metadata:e},v,k),t(null,null,i,{kind:"field",name:"pointerController",static:!1,private:!1,access:{has:t=>"pointerController"in t,get:t=>t.pointerController,set:(t,e)=>{t.pointerController=e}},metadata:e},E,S),t(null,null,a,{kind:"field",name:"dispatchController",static:!1,private:!1,access:{has:t=>"dispatchController"in t,get:t=>t.dispatchController,set:(t,e)=>{t.dispatchController=e}},metadata:e},w,C),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static managers=[];static get instance(){return O.managers.length>0?O.managers[0]:new O}static get allManagers(){return[...this.managers]}static set allManagers(t){this.managers=t}keyController=(e(this,g),e(this,b,void 0));wheelController=(e(this,y),e(this,v,void 0));pointerController=(e(this,k),e(this,E,void 0));dispatchController=(e(this,S),e(this,w,void 0));constructor(t={}){super(),e(this,C),this.mvc.generate({model:$t,controllers:[Jt,te,se,ie],handlers:[re]}),O.managers.push(this),this.model.authorizeEventScaling=t.authorizeEventScaling,this.model.scaleEventPosition=t.scaleEventPosition,this.model.state.enabled=t.enabled??!0,this.model.state.preventDefaultMouse=t.preventDefaultMouse??!0,this.model.state.preventDefaultTouch=t.preventDefaultTouch??!0,this.model.state.preventDefaultWheel=t.preventDefaultWheel??!0,this.unlock(),this.model.moveThreshold=t.moveThreshold||10,this.model.longPressDuration=t.longPressDuration||500,t.disableKeyEvents||(this.keyEventsEnabled=!0),t.disableWheelEvents||(this.wheelEventsEnabled=!0),t.disableMouseEvents||(this.mouseEventsEnabled=!0),t.disableTouchEvents||(this.touchEventsEnabled=!0),t.disableDragEvents||(this.dragEventEnabled=!0),t.disableClickEvents||(this.clickEventEnabled=!0),t.disableMoveEvent||(this.moveEventsEnabled=!0),document.addEventListener("pointerdown",this.pointerController.pointerDown,{passive:!1}),document.addEventListener("pointermove",this.pointerController.pointerMove,{passive:!1}),document.addEventListener("pointerup",this.pointerController.pointerUp,{passive:!1}),document.addEventListener("pointercancel",this.pointerController.pointerCancel,{passive:!1}),this.dispatchController.setupCustomDispatcher("pointerdown")}get inputDevice(){return this.model.inputDevice}get onInputDeviceChange(){return this.model.onInputDeviceChange}get currentClick(){return this.model.currentClick}get currentKeys(){return this.model.currentKeys}get onToolChange(){return this.model.onToolChange}get authorizeEventScaling(){return this.model.authorizeEventScaling}set authorizeEventScaling(t){this.model.authorizeEventScaling=t}get scaleEventPosition(){return this.model.scaleEventPosition}set scaleEventPosition(t){this.model.scaleEventPosition=t}get moveThreshold(){return this.model.moveThreshold}set moveThreshold(t){this.model.moveThreshold=t}get longPressDuration(){return this.model.longPressDuration}set longPressDuration(t){this.model.longPressDuration=t}set keyEventsEnabled(t){t?(document.addEventListener("keydown",this.keyController.keyDown),document.addEventListener("keyup",this.keyController.keyUp)):(document.removeEventListener("keydown",this.keyController.keyDown),document.removeEventListener("keyup",this.keyController.keyUp)),this.applyAndHookEvents(gt,bt,t)}set wheelEventsEnabled(t){t?document.body.addEventListener("wheel",this.wheelController.wheel,{passive:!1}):document.body.removeEventListener("wheel",this.wheelController.wheel),this.applyAndHookEvents(Ct,Ot,t)}set moveEventsEnabled(t){this.applyAndHookEvents(kt,Et,t)}set mouseEventsEnabled(t){}set touchEventsEnabled(t){}set clickEventEnabled(t){this.applyAndHookEvents(yt,vt,t)}set dragEventEnabled(t){this.applyAndHookEvents(St,wt,t)}lock(t,e){this.unlock(),this.model.lockState.lockOrigin=t;for(const t in e)this.model.lockState[t]=e[t]}unlock(){const t=this.model.state,e=this.model.lockState;e.enabled=t.enabled,e.preventDefaultMouse=t.preventDefaultMouse,e.preventDefaultTouch=t.preventDefaultTouch,e.preventDefaultWheel=t.preventDefaultWheel,e.lockOrigin=document.body}get enabled(){return this.model.state.enabled&&this.model.lockState.enabled}set enabled(t){this.model.state.enabled=t}get preventDefaultWheel(){return this.model.state.preventDefaultWheel&&this.model.lockState.preventDefaultWheel}set preventDefaultWheel(t){this.model.state.preventDefaultWheel=t}get preventDefaultMouse(){return this.model.state.preventDefaultMouse&&this.model.lockState.preventDefaultMouse}set preventDefaultMouse(t){this.model.state.preventDefaultMouse=t}get preventDefaultTouch(){return this.model.state.preventDefaultTouch&&this.model.lockState.preventDefaultTouch}set preventDefaultTouch(t){this.model.state.preventDefaultTouch=t}get toolsArray(){const t=[];for(const e of this.model.tools.values())t.push(...e.toArray());return t}getCurrentTool(t=this.model.currentClick){return this.model.currentTools.get(t)}getCurrentTools(t=this.model.currentClick){return this.getToolsByName(this.getCurrentToolName(t))}getCurrentToolName(t=this.model.currentClick){return this.getToolName(this.getCurrentTool(t))}getToolName(t){for(const[e,s]of this.model.tools.entries())if(s.has(t))return e}getSimilarTools(t){for(const[e,s]of this.model.tools.entries())if(s.has(t))return s.toArray();return[]}getToolsByName(t){return this.model.tools.get(t)?.toArray()||[]}getToolByName(t,e){const s=this.getToolsByName(t);return e?s?.find(e):s?.[0]}getToolsByKey(t){const e=this.model.mappedKeysToTool.get(t);return e?this.getToolsByName(e):[]}getToolByKey(t,e){const s=this.getToolsByKey(t);return e?s?.find(e):s?.[0]}addTool(t,e,s){this.model.tools.has(t)||this.model.tools.set(t,new ne);const n=this.model.tools.get(t);n.has(e)||n.add(e),s&&this.model.mappedKeysToTool.set(s,t)}setTool(t,e,s={}){if(!f(t)&&!Ge(t).isTool(this))return;null==s.select&&(s.select=!0),null==s.activate&&(s.activate=!0),null==s.setAsNoAction&&(s.setAsNoAction=e==_t.left);const n=this.model.currentTools.get(e);if(n){if(n===t)return;this.getSimilarTools(n).forEach(t=>{s.select&&this.model.utils.selectTool(t,!1),s.activate&&this.model.utils.activateTool(t,this.getToolName(n),!1)})}this.model.currentTools.set(e,t),s.setAsNoAction&&this.model.currentTools.set(_t.none,t),this.getSimilarTools(t).forEach(e=>{s.activate&&this.model.utils.activateTool(e,this.getToolName(t),!0),s.select&&this.model.utils.selectTool(e,!0)}),this.onToolChange.fire(n,t,e)}setToolByKey(t){const e=this.model.mappedKeysToTool.get(t);return!!e&&(this.setTool(this.getToolByName(e),_t.key,{select:!1}),!0)}setupCustomDispatcher(t){return this.dispatchController.setupCustomDispatcher(t)}applyAndHookEvents(t,e,s){this.model.utils.applyEventNames(s?t:e);for(const e in t)s?this.dispatchController.setupCustomDispatcher(e):this.dispatchController.removeCustomDispatcher(e)}destroy(){return this.keyEventsEnabled=!1,this.wheelEventsEnabled=!1,this.mouseEventsEnabled=!1,this.touchEventsEnabled=!1,this.dragEventEnabled=!1,this.clickEventEnabled=!1,this.onToolChange.clear(),this}}})();const ue=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}getBoundListenersSet(t){let e=this.data(t).boundListeners;return e||(e=new Set,this.data(t).boundListeners=e),e}getPreventDefaultListeners(t){let e=this.data(t).preventDefaultListeners;return e||(e={},this.data(t).preventDefaultListeners=e),e}bypassManager(t,e,s){t instanceof g&&(t=t.element),t&&("boolean"==typeof s?e.lock(t,{enabled:s,preventDefaultWheel:s,preventDefaultMouse:s,preventDefaultTouch:s}):e.lock(t,{enabled:s.enabled??!1,preventDefaultWheel:s.preventDefaultWheel??!1,preventDefaultMouse:s.preventDefaultMouse??!1,preventDefaultTouch:s.preventDefaultTouch??!1}))}getBoundListeners(t,e,s,n,i=he.instance){return t instanceof g&&(t=t.element),t?(n||(n={}),[...this.getBoundListenersSet(t)].filter(t=>t.type===e&&t.manager===i&&t.toolName===s).filter(t=>{if(!n)return!0;for(const[e,s]of Object.entries(n))if(t.options?.[e]!==s)return!1;return!0})):[]}};function de(){Object.defineProperty(g.prototype,"boundListeners",{get:function(){return ue.getBoundListenersSet(this)},configurable:!0,enumerable:!0}),Object.defineProperty(g.prototype,"bypassManagerOn",{get:function(){return ue.data(this).bypassCallback},set:function(t){ue.data(this).bypassCallback=t},configurable:!0,enumerable:!0}),g.prototype.onTool=function(t,e,s,n,i=he.instance){if(this.hasToolListener(t,e,s,i))return this;return i.setupCustomDispatcher?.(t),ue.getBoundListenersSet(this).add({target:this,type:t,toolName:e,listener:s,bundledListener:t=>s(t,this),options:n,manager:i}),this},g.prototype.on=function(t,e,s,n=he.instance){return this.onTool(t,void 0,e,s,n)},g.prototype.executeAction=function(t,e,s,n,i=he.instance){if(!t)return!1;n||(n={});const a=e??i.getCurrentToolName();this.bypassManagerOn&&ue.bypassManager(this,i,this.bypassManagerOn(s));const r=new Set,o=(e,a)=>{const o=e instanceof g?e:Ge(e),l=ue.getBoundListenersSet(e),c=[...ue.getBoundListeners(e,t,a,n,i)];if(0===c.length)return!1;let h=!1;for(const t of c)if(!r.has(t))try{t.listener(s,o)&&(h=!0)}finally{r.add(t),t.options?.once&&l.delete(t)}return h};if(a&&o(this,a))return!0;if(!n.capture&&a&&!this.isToolIgnored(a,t,i)&&this.applyTool(a,t,s,i))return!0;const l=this.getEmbeddedToolTarget(i),c=this.getToolNames(i);if(l&&c.length>0){let e=!1;for(const t of c)o(l,t)&&(e=!0);if(e)return!0;const a=Ge(l);if(!n.capture)for(const n of c)!a.isToolIgnored(n,t,i)&&Ge(l).applyTool(n,t,s,i)&&(e=!0);if(e)return!0}return o(this,void 0)},g.prototype.hasListener=function(t,e,s=he.instance){return this.hasToolListener(t,void 0,e,s)},g.prototype.hasToolListener=function(t,e,s,n=he.instance){return ue.getBoundListeners(this,t,e,void 0,n).filter(t=>t.listener===s).length>0},g.prototype.hasListenersByType=function(t,e,s=he.instance){return ue.getBoundListeners(this,t,e,void 0,s).length>0},g.prototype.removeListener=function(t,e,s=he.instance){return this.removeToolListener(t,void 0,e,s)},g.prototype.removeToolListener=function(t,e,s,n=he.instance){const i=ue.getBoundListenersSet(this);return ue.getBoundListeners(this,t,e,void 0,n).filter(t=>t.listener===s).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),i.delete(t)}),this},g.prototype.removeListenersByType=function(t,e,s=he.instance){const n=ue.getBoundListenersSet(this);return ue.getBoundListeners(this,t,e,void 0,s).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),n.delete(t)}),this},g.prototype.removeAllListeners=function(t=he.instance){const e=this.boundListeners;return[...e].filter(e=>e.manager===t).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),e.delete(t)}),this},g.prototype.preventDefault=function(t){t||(t={});const e=t.manager??he.instance,s=t.types??Bt,n=t.phase??"capture",i=t.stop??!1;ue.data(this.element).preventDefaultOn=t.preventDefaultOn??ue.data(this.element).preventDefaultOn??(()=>!0);const a=ue.getPreventDefaultListeners(this);if(t.clearPreviousListeners)for(const[t,e]of Object.entries(a))this.removeListener(t,e),delete a[t];const r=new Set(Nt);for(const t of new Set(s)){const s=e=>!!ue.data(this.element).preventDefaultOn(t,e)&&(e.preventDefault?.(),"immediate"===i?e.stopImmediatePropagation?.():"stop"===i&&e.stopPropagation?.(),!0);a[t]=s;const o={};"capture"===n&&(o.capture=!0),r.has(t)&&(o.passive=!1),this.on(t,s,o,e)}return this}}const fe=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}setStyle(t,e,s,n=!1,i=!0){if(n)return void(t.element.style[e]=s.toString());let a=this.data(t.element).pendingStyles;a&&"object"==typeof a||(a={},this.data(t.element).pendingStyles=a),a[e]=s,i&&this.applyStyles(t)}applyStyles(t){const e=this.data(t.element).pendingStyles;e&&"object"==typeof e&&requestAnimationFrame(()=>{for(const s in e)"cssText"==s?t.element.style.cssText+=";"+e.cssText:t.element.style[s]=e[s];this.data(t.element).pendingStyles={}})}};function pe(){Object.defineProperty(g.prototype,"closestRoot",{get:function(){let t=this.element;for(;t;){if(t instanceof Element&&t.shadowRoot)return t.shadowRoot;t=t.parentElement}return document.head},configurable:!1,enumerable:!0}),g.prototype.setStyle=function(t,e,s=!1){return t&&null!=e&&(this.element instanceof HTMLElement||this.element instanceof SVGElement)?(fe.setStyle(this,t,e,s),this):this},g.prototype.appendStyle=function(t,e,s=", ",n=!1){if(!t||null==e)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;const i=this.element.style[t]||"";return s=i.length>0?s:"",fe.setStyle(this,t,i+s+e,n),this},g.prototype.setStyles=function(t,e=!1){if(!t||"number"==typeof t)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;let s={};return"object"==typeof t?s=t:"string"==typeof t&&t.split(";").forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());e&&n&&(s[e]=n)}),Object.entries(s).forEach(([t,s])=>fe.setStyle(this,t,s,e,!1)),e||fe.applyStyles(this),this}}const me=new class{elements=new WeakMap;tools=new WeakMap;getOrCreate(t,e,s){let n=t.get(e);return n||(n=s(),t.set(e,n)),n}getElementData(t,e){t instanceof g&&(t=t.element);const s=this.getOrCreate(this.elements,t,()=>new WeakMap);return this.getOrCreate(s,e,()=>({tools:new Set,ignoreAllTools:!1,ignoredTools:new Map,activationDelegates:new Map,deactivationDelegates:new Map}))}getToolsData(t,e){const s=this.getOrCreate(this.tools,t,()=>new Map);return this.getOrCreate(s,e,()=>({behaviors:new Map}))}getActivationDelegate(t,e,s){const n=this.getElementData(t,s).activationDelegates;return n.get(e)||n.set(e,new tt),n.get(e)}getDeactivationDelegate(t,e,s){const n=this.getElementData(t,s).deactivationDelegates;return n.get(e)||n.set(e,new tt),n.get(e)}saveTool(t,e,s){t instanceof g&&(t=t.element),t&&this.getElementData(t,s).tools.add(e)}getToolNames(t,e){return t instanceof g&&(t=t.element),t?[...this.getElementData(t,e).tools]:[]}setEmbeddedToolTarget(t,e,s){e instanceof g&&(e=e.element),e&&(t instanceof g&&(t=t.element),t&&(this.getElementData(t,s).embeddedTarget=e))}getEmbeddedToolTarget(t,e){if(t instanceof g&&(t=t.element),t)return this.getElementData(t,e).embeddedTarget}addToolBehavior(t,e,s,n){const i=this.getToolsData(n,t).behaviors;this.getOrCreate(i,e,()=>new Set).add(s)}getToolBehaviors(t,e,s){const n=this.getToolsData(s,t).behaviors;return[...this.getOrCreate(n,e,()=>new Set)]}removeToolBehaviors(t,e,s){const n=this.getToolsData(s,t).behaviors;this.getOrCreate(n,e,()=>new Set).clear()}clearToolBehaviors(t){this.getOrCreate(this.tools,t,()=>new Map).clear()}ignoreTool(t,e,s,n,i){const a=this.getElementData(t,i).ignoredTools;if(s){const t=a.get(e);if(!n)return void(t instanceof Set&&t.delete(s));t instanceof Set||a.set(e,new Set),a.get(e).add(s)}else n?a.set(e,"all"):a.delete(e)}isToolIgnored(t,e,s,n){const i=this.getElementData(t,n).ignoredTools?.get(e);return!!i&&("all"===i||!s||i.has(s))}};function ge(){g.prototype.makeTool=function(t,e){return t?(e||(e={}),e.manager||(e.manager=he.instance),e.manager.addTool(t,this.element,e.key),e.customActivation&&"function"==typeof e.customActivation?e.customActivation(this,e.manager):(e.activationEvent??=Pt.click,e.clickMode??=_t.left,this.on(e.activationEvent,()=>(e.manager.setTool(this.element,e.clickMode),!0),void 0,e.manager)),me.saveTool(this,t,e.manager),e.onActivate&&me.getActivationDelegate(this,t,e.manager).add(e.onActivate),e.onDeactivate&&me.getDeactivationDelegate(this,t,e.manager).add(e.onDeactivate),this):this},g.prototype.isTool=function(t=he.instance){return me.getToolNames(this.element,t).length>0},g.prototype.getToolNames=function(t=he.instance){return me.getToolNames(this.element,t)},g.prototype.getToolName=function(t=he.instance){const e=me.getToolNames(this.element,t);if(e.length>0)return e[0]},g.prototype.onToolActivate=function(t,e=he.instance){return t||(t=this.getToolName(e)),me.getActivationDelegate(this,t,e)},g.prototype.onToolDeactivate=function(t,e=he.instance){return t||(t=this.getToolName(e)),me.getDeactivationDelegate(this,t,e)},g.prototype.addToolBehavior=function(t,e,s=this.getToolName(),n=he.instance){return t&&s&&(n.setupCustomDispatcher?.(t),me.addToolBehavior(s,t,e,n)),this},g.prototype.hasToolBehavior=function(t,e=this.getToolName(),s=he.instance){return!(!t||!e)&&me.getToolBehaviors(e,t,s).length>0},g.prototype.removeToolBehaviors=function(t,e=this.getToolName(),s=he.instance){return t&&e&&me.removeToolBehaviors(e,t,s),this},g.prototype.clearToolBehaviors=function(t=he.instance){return me.clearToolBehaviors(t),this},g.prototype.embedTool=function(t,e=he.instance){return this.isTool(e)&&me.setEmbeddedToolTarget(this.element,t,e),this},g.prototype.isEmbeddedTool=function(t=he.instance){return!!me.getEmbeddedToolTarget(this.element,t)},g.prototype.getEmbeddedToolTarget=function(t=he.instance){return me.getEmbeddedToolTarget(this.element,t)},g.prototype.applyTool=function(t,e,s,n=he.instance){let i=!1;const a=me.getToolBehaviors(t,e,n),r={};return r.embeddedTarget=me.getEmbeddedToolTarget(this.element,n),r.isEmbedded=!!r.embeddedTarget,a.forEach(t=>{t(s,this.element,r)&&(i=!0)}),i},g.prototype.ignoreTool=function(t,e,s=!0,n=he.instance){return me.ignoreTool(this.element,t,e,s,n),this},g.prototype.ignoreAllTools=function(t=!0,e=he.instance){return me.getElementData(this.element,e).ignoreAllTools=t,this},g.prototype.isToolIgnored=function(t,e,s=he.instance){return!!me.getElementData(this.element,s).ignoreAllTools||me.isToolIgnored(this.element,t,e,s)}}const be=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{substrates:new Map,onChange:new tt}),this.dataMap.get(t)):{}}createSubstrate(t,e){const s={objects:t instanceof Element?t.children:t.childNodes,temporaryMetadata:new WeakMap,persistentMetadata:new WeakMap,onActivate:new tt,onDeactivate:new tt,solvers:new Set};return this.data(t).substrates.set(e,s),s}setCurrent(t,e){return!!this.getSubstrates(t).includes(e)&&(this.data(t).current=e,!0)}getSubstrateData(t,e){return this.data(t).substrates.get(e)}getSubstrates(t){return[...this.data(t).substrates.keys()]}getPersistentMetadata(t,e,s){const n=this.getSubstrateData(t,e);if(!n||!n.persistentMetadata)return{};let i=n.persistentMetadata.get(s);return i||(i={},n.persistentMetadata.set(s,i)),i}setPersistentMetadata(t,e,s,n){const i=this.getSubstrateData(t,e);i&&i.persistentMetadata&&i.persistentMetadata.set(s,n)}getTemporaryMetadata(t,e,s){const n=this.getSubstrateData(t,e);if(!n||!n.temporaryMetadata)return;let i=n.temporaryMetadata.get(s);return i||(i={},n.temporaryMetadata.set(s,i)),i}setTemporaryMetadata(t,e,s,n){const i=this.getSubstrateData(t,e);i&&i.temporaryMetadata&&i.temporaryMetadata.set(s,n)}};function ye(){g.prototype.makeSubstrate=function(t,e){return be.createSubstrate(this,t),e?.onActivate&&this.onSubstrateActivate(t).add(e.onActivate),e?.onDeactivate&&this.onSubstrateDeactivate(t).add(e.onDeactivate),this.currentSubstrate||(this.currentSubstrate=t),this},Object.defineProperty(g.prototype,"substrates",{get:function(){return be.getSubstrates(this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"currentSubstrate",{get:function(){return be.data(this).current},set:function(t){if(!t)return;const e=this.currentSubstrate;be.setCurrent(this,t)&&this.onSubstrateChange.fire(e,t)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"onSubstrateChange",{get:function(){return be.data(this).onChange},configurable:!1,enumerable:!0}),g.prototype.onSubstrateActivate=function(t=this.currentSubstrate){return be.getSubstrateData(this,t)?.onActivate??new tt},g.prototype.onSubstrateDeactivate=function(t=this.currentSubstrate){return be.getSubstrateData(this,t)?.onDeactivate??new tt},g.prototype.getSubstrateObjectList=function(t=this.currentSubstrate){const e=new Set;return t?(Array.from(be.getSubstrateData(this,t).objects).forEach(s=>{be.getPersistentMetadata(this,t,s).ignored||e.add(s)}),e):e},g.prototype.setSubstrateObjectList=function(t,e=this.currentSubstrate){return t&&e?(be.getSubstrateData(this,e).objects=t,this):this},g.prototype.addObjectToSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return this;be.getPersistentMetadata(this,e,t).ignored=!1;const s=be.getSubstrateData(this,e).objects;if(s instanceof HTMLCollection||s instanceof NodeList)return this;try{s.has(t)||s.add(t)}catch{}return this},g.prototype.removeObjectFromSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return this;be.getPersistentMetadata(this,e,t).ignored=!0;const s=be.getSubstrateData(this,e).objects;return s instanceof Set&&s.delete(t),this},g.prototype.hasObjectInSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return!1;const s=this.getSubstrateObjectList(e);for(const e of s)if(e===t)return!0;return!1},g.prototype.wasObjectProcessedBySubstrate=function(t,e=this.currentSubstrate){return!(!t||!e)&&!!be.getTemporaryMetadata(this,e,t)?.processed},g.prototype.addSolver=function(t,e=this.currentSubstrate){return be.getSubstrateData(this,e).solvers?.add(t),this},g.prototype.removeSolver=function(t,e=this.currentSubstrate){return be.getSubstrateData(this,e).solvers?.delete(t),this},g.prototype.clearSolvers=function(t=this.currentSubstrate){return be.getSubstrateData(this,t).solvers?.clear(),this},g.prototype.resolveSubstrate=function(t={},e=this.currentSubstrate){if(t||(t={}),t.substrate=t.substrate??e,!t.substrate)return this;t.manager||(t.manager=he.instance),t.eventOptions||(t.eventOptions={});const s=be.getSubstrateData(this,t.substrate);return s?(s.solvers?.forEach(e=>{let n;s.temporaryMetadata=new WeakMap,t.eventTarget&&(s.temporaryMetadata.set(t.eventTarget,{processed:!0,isMainTarget:!0}),e({...t,target:t.eventTarget}));do{n=Array.from(this.getSubstrateObjectList(t.substrate)).find(t=>!s.temporaryMetadata.get(t)?.processed),n&&(s.temporaryMetadata.set(n,{processed:!0}),e({...t,target:n}))}while(n)}),this):this}}const ve=new WeakMap;function ke(t){if(ve.has(t))return ve.get(t);let e,s,n=!1;const i=function(...i){if(n)return e;if(s)return s;try{const a=t.apply(this,i);return a instanceof Promise?(s=a.then(t=>(e=t,n=!0,s=null,t)).catch(t=>{throw s=null,t}),s):(e=a,n=!0,a)}catch(t){throw t}};return ve.set(t,i),i}function Ee(t,e){if("method"!==e.kind)throw new Error(`@callOnce can only be used on methods (got: ${e.kind}).`);const s=String(e.name),n=Symbol(`__callOnce__${s}`);return function(...e){if(!this[n])return this[n]=!0,t.apply(this,e);console.warn(`Function ${s} has already been called once on this instance and will not be called again.`)}}function Se(...t){if(t.length<2)return!0;for(let e=0;e<t.length-1;e++)if(t[e]!=t[e+1])return!1;return!0}function we(t,...e){if(e.length<1)return!0;for(const s of e)if(t==s)return!0;return!1}function Ce(t,...e){if(e.length<1)return!0;for(const s of e){let e=!1;for(const n of t)s==n&&(e=!0);if(!e)return!1}return!0}function Oe(t,e,s=0){return t<s&&(t=s),t>e&&(t=e),t}function Te(t,e=0){for(;t<0;)t+=e;for(;t>=e;)t-=e;return t}let Pe=(()=>{let s,n,i,a,r,o,l,c,h,u,f,p,g,b,y,v=[];return class k{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[m()],n=[m()],i=[m()],a=[m()],r=[m()],o=[m()],l=[m()],c=[m()],h=[m()],u=[m()],f=[m()],p=[m()],g=[m()],b=[m()],y=[m()],t(this,null,s,{kind:"setter",name:"enabled",static:!1,private:!1,access:{has:t=>"enabled"in t,set:(t,e)=>{t.enabled=e}},metadata:e},null,v),t(this,null,n,{kind:"setter",name:"propertiesEnabled",static:!1,private:!1,access:{has:t=>"propertiesEnabled"in t,set:(t,e)=>{t.propertiesEnabled=e}},metadata:e},null,v),t(this,null,i,{kind:"setter",name:"stylesEnabled",static:!1,private:!1,access:{has:t=>"stylesEnabled"in t,set:(t,e)=>{t.stylesEnabled=e}},metadata:e},null,v),t(this,null,a,{kind:"setter",name:"classesEnabled",static:!1,private:!1,access:{has:t=>"classesEnabled"in t,set:(t,e)=>{t.classesEnabled=e}},metadata:e},null,v),t(this,null,r,{kind:"setter",name:"replaceWithEnabled",static:!1,private:!1,access:{has:t=>"replaceWithEnabled"in t,set:(t,e)=>{t.replaceWithEnabled=e}},metadata:e},null,v),t(this,null,o,{kind:"setter",name:"transitionEnabled",static:!1,private:!1,access:{has:t=>"transitionEnabled"in t,set:(t,e)=>{t.transitionEnabled=e}},metadata:e},null,v),t(this,null,l,{kind:"setter",name:"properties",static:!1,private:!1,access:{has:t=>"properties"in t,set:(t,e)=>{t.properties=e}},metadata:e},null,v),t(this,null,c,{kind:"setter",name:"styles",static:!1,private:!1,access:{has:t=>"styles"in t,set:(t,e)=>{t.styles=e}},metadata:e},null,v),t(this,null,h,{kind:"setter",name:"classes",static:!1,private:!1,access:{has:t=>"classes"in t,set:(t,e)=>{t.classes=e}},metadata:e},null,v),t(this,null,u,{kind:"setter",name:"replaceWith",static:!1,private:!1,access:{has:t=>"replaceWith"in t,set:(t,e)=>{t.replaceWith=e}},metadata:e},null,v),t(this,null,f,{kind:"setter",name:"transitionProperties",static:!1,private:!1,access:{has:t=>"transitionProperties"in t,set:(t,e)=>{t.transitionProperties=e}},metadata:e},null,v),t(this,null,p,{kind:"setter",name:"transitionDuration",static:!1,private:!1,access:{has:t=>"transitionDuration"in t,set:(t,e)=>{t.transitionDuration=e}},metadata:e},null,v),t(this,null,g,{kind:"setter",name:"transitionTimingFunction",static:!1,private:!1,access:{has:t=>"transitionTimingFunction"in t,set:(t,e)=>{t.transitionTimingFunction=e}},metadata:e},null,v),t(this,null,b,{kind:"setter",name:"transitionDelay",static:!1,private:!1,access:{has:t=>"transitionDelay"in t,set:(t,e)=>{t.transitionDelay=e}},metadata:e},null,v),t(this,null,y,{kind:"setter",name:"transition",static:!1,private:!1,access:{has:t=>"transition"in t,set:(t,e)=>{t.transition=e}},metadata:e},null,v),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}timeRegex=(e(this,v),/^(\d+(?:\.\d+)?)(ms|s)?$/i);attachedObjects=[];_states;values;constructor(t){this.enable({global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0}),this.properties=t.properties||{},this.classes=t.classes||{},this.styles=t.styles||{},this.replaceWith=t.replaceWith||{},this.transition=t.transition??"all 0s linear 0s",t.transitionProperties&&(this.transitionProperties=t.transitionProperties),void 0!==t.transitionDuration&&(this.transitionDuration=t.transitionDuration),t.transitionTimingFunction&&(this.transitionTimingFunction=t.transitionTimingFunction),void 0!==t.transitionDelay&&(this.transitionDelay=t.transitionDelay),t.transition||t.transitionProperties||t.transitionDuration||t.transitionTimingFunction||t.transitionDelay||(this.transitionEnabled=!1),t.states&&(this.states=t.states),t.attachedObjects&&this.attachAll(...t.attachedObjects)}attach(t,e,s){const n=this.getData(t);if(n&&e&&(n.onSwitch=e),!n)return this.attachObject(t,s,e),this}attachAll(...t){return t.forEach(t=>{this.getData(t)||this.attachObject(t)}),this}attachAllAt(t,...e){return e.forEach((e,s)=>{this.getData(e)||this.attachObject(e,t+s)}),this}detach(...t){return t.forEach(t=>{const e=this.getData(t);e&&this.detachObject(e)}),this}attachObject(t,e,s){(null==e||isNaN(e))&&(e=this.attachedObjects.length),e<0&&(e=0);const n=this.generateNewData(t,s);return this.attachedObjects.splice(e,0,n),Ge(t).reifects?.attach(this),n.lastState=this.stateOf(t),this.applyResolvedValues(n,!1,!0),n}detachObject(t){this.attachedObjects.splice(this.attachedObjects.indexOf(t),1)}getData(t){if(!t)return null;for(const e of this.attachedObjects){const s=this.getObject(e);if(s&&s==t)return e}return null}getObject(t){if(!t)return null;return t.object.deref()||null}get states(){return this._states}set states(t){this._states=t||this.getAllStates()}stateOf(t){if(!t)return;const e=this.getData(t);if(e){if(e.lastState)return e.lastState;if(!(t instanceof HTMLElement))return this.states[0];e.resolvedValues||this.processRawProperties(e);for(const s of this.states){if(!e.resolvedValues?.styles?.[s])continue;let n=!0;for(const[i,a]of Object.entries(e.resolvedValues.styles[s]))if(t.style[i]!=a){n=!1;break}if(n)return e.lastState=s,s}return this.states[0]}}getAllStates(){const t=[...this.states];for(const e of[this.properties,this.classes,this.styles,this.replaceWith])if("object"==typeof e)for(const s of Object.keys(e))t.includes(s)||t.push(s);return 0==t.length&&console.warn("No states found for this particular reifect:",this),t}parseState(t){if("boolean"!=typeof t)return this.states.includes(t)?t:this.states[0];for(const e of t?["true","on","in","enabled","shown"]:["false","off","out","disabled","hidden"])if(this.states.includes(e))return e;return this.states[0]}set enabled(t){this.refreshResolvedValues()}set propertiesEnabled(t){this.refreshProperties()}set stylesEnabled(t){this.refreshStyles()}set classesEnabled(t){this.refreshClasses()}set replaceWithEnabled(t){this.refreshReplaceWith()}set transitionEnabled(t){this.refreshTransition()}enable(t,e){if("boolean"==typeof t)this.enabled=t;else{if(!t)return;Object.entries(t).forEach(([t,e])=>{"global"==t?this.enabled=e:this[t+"Enabled"]=e})}}enableObject(t,e){const s=this.getData(t);if(s)if("boolean"==typeof e)s.enabled.global=e;else{if(!e)return;Object.entries(e).forEach(([t,e])=>s.enabled[t]=e)}}getObjectEnabledState(t){return this.getData(t)?.enabled}set properties(t){}set styles(t){}set classes(t){}set replaceWith(t){}set transitionProperties(t){}set transitionDuration(t){}set transitionTimingFunction(t){}set transitionDelay(t){}set transition(t){if(!t)return;const e="string"==typeof t?this.processTransitionString(t):this.processTransitionObject(t);void 0!==e.transitionProperties&&(this.transitionProperties=e.transitionProperties),void 0!==e.transitionDuration&&(this.transitionDuration=e.transitionDuration),void 0!==e.transitionDelay&&(this.transitionDelay=e.transitionDelay),void 0!==e.transitionTimingFunction&&(this.transitionTimingFunction=e.transitionTimingFunction)}processTransitionObject(t){const e={};for(const[s,n]of Object.entries(t)){if(!this.states.includes(s))continue;if("string"!=typeof n)continue;const t=this.processTransitionString(n);void 0!==t.transitionProperties&&(e.transitionProperties[s]=t.transitionProperties),void 0!==t.transitionDuration&&(e.transitionDuration[s]=t.transitionDuration),void 0!==t.transitionDelay&&(e.transitionDelay[s]=t.transitionDelay),void 0!==t.transitionTimingFunction&&(e.transitionTimingFunction[s]=t.transitionTimingFunction)}return e}processTransitionString(t){const e=t.trim().replace(/,/g," ").split(/\s+/).filter(t=>t.length>0),s={transitionProperties:[]};let n=0;for(;n<e.length&&!this.timeRegex.test(e[n]);)s.transitionProperties.push(e[n]),n++;if(n<e.length){const t=this.parseTime(e[n]);isNaN(t)||(s.transitionDuration=t),n++}if(n<e.length&&(s.transitionTimingFunction=e[n],n++),n<e.length){const t=this.parseTime(e[n]);isNaN(t)||(s.transitionDelay=t),n++}return s}getTransitionString(t,e=t.lastState){let s="";return t.resolvedValues.transitionProperties[e].forEach(n=>s+=", "+n+" "+(t.resolvedValues.transitionDuration[e]||0)+"s "+(t.resolvedValues.transitionTimingFunction[e]||"linear")+" "+(t.resolvedValues.transitionDelay[e]||0)+"s"),s.substring(2)}initialize(t,e,s){this.enabled&&(t=this.parseState(t),s=this.initializeOptions(s,e),this.getEnabledObjectsData(e,s).forEach(e=>{!s.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,s.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!0,s?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))}))}apply(t,e,s){this.enabled&&(t=this.parseState(t),s=this.initializeOptions(s,e),this.getEnabledObjectsData(e,s).forEach(e=>{!s.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,s.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!1,s?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))}))}toggle(t,e){if(!this.enabled)return;t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[];const s=this.getData(t[0])?.lastState,n=Te(s?this.states.indexOf(s)+1:0,this.states.length);this.apply(this.states[n],t,e)}reloadFor(t){if(!this.enabled)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global?(this.applyResolvedValues(e),this):this}reloadTransitionFor(t){if(!this.enabled||!this.transitionEnabled)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global&&e.enabled.transition?(this.applyTransition(e,e.lastState),this):this}getEnabledObjectsData(t,e){if(!this.enabled)return console.warn("The reifier object you are trying to access is disabled."),[];t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[],(e=this.initializeOptions(e,t)).attachObjects&&t.forEach(t=>this.attach(t)),e.executeForAll&&(t=[],this.attachedObjects.forEach(e=>{const s=e.object.deref();s&&t.push(s)}));const s=[];return t.forEach(t=>{const n=this.getData(t)||this.generateNewData(t);this.filterEnabledObjects(n)&&((e.recomputeIndices||null==n.objectIndex)&&(n.objectIndex=s.length),s.push(n))}),s.forEach(t=>{(e.recomputeIndices||null==t.totalObjectCount)&&(t.totalObjectCount=s.length)}),s}applyResolvedValues(t,e=!1,s=!1){if(this.applyStyles(t,t.lastState,s),!e){const e=Ge(t.object.deref()).reifects;this.attachedObjects.includes(t)&&e?e.reloadTransitions():this.applyTransition(t,t.lastState)}this.applyReplaceWith(t,t.lastState),this.applyProperties(t,t.lastState),this.applyClasses(t,t.lastState)}refreshResolvedValues(){this.refreshProperties(),this.refreshStyles(),this.refreshClasses(),this.refreshReplaceWith(),this.refreshTransition()}applyProperties(t,e=t.lastState){if(!this.enabled||!this.propertiesEnabled)return;if(!t.enabled.global||!t.enabled.properties)return;const s=t.resolvedValues?.properties?.[e];if(!s)return;const n=t.object.deref();if(n)for(const[t,e]of Object.entries(s))if(t&&null!=e)try{n[t]=e}catch(s){console.error(`Unable to set property ${t} to ${e}: ${s.message}`)}}refreshProperties(){this.enabled&&this.propertiesEnabled&&this.attachedObjects.forEach(t=>this.applyProperties(t))}applyReplaceWith(t,e=t.lastState){if(!this.enabled||!this.replaceWithEnabled)return;if(!t.enabled.global||!t.enabled.replaceWith)return;const s=t.resolvedValues?.replaceWith?.[e];if(s)try{const e=t.object.deref();e&&e instanceof Node&&s instanceof Node&&e.parentNode?.replaceChild(s,e),t.object=new WeakRef(s)}catch(t){console.error(`Unable to replace object: ${t.message}`)}}refreshReplaceWith(){this.enabled&&this.replaceWithEnabled&&this.attachedObjects.forEach(t=>this.applyReplaceWith(t))}applyClasses(t,e=t.lastState){if(!this.enabled||!this.classesEnabled)return;if(!t.enabled.global||!t.enabled.classes)return;const s=t.resolvedValues?.classes;if(!s)return;const n=t.object.deref();if(n&&n instanceof Element)for(const[t,i]of Object.entries(s))Ge(n).toggleClass(i,e==t)}refreshClasses(){this.enabled&&this.classesEnabled&&this.attachedObjects.forEach(t=>this.applyClasses(t))}applyStyles(t,e=t.lastState,s=!1){if(!this.enabled||!this.stylesEnabled)return;if(!t.enabled.global||!t.enabled.styles)return;if(!t.resolvedValues?.styles)return;const n=t.object.deref();n&&n instanceof Element&&Ge(n).setStyles(t.resolvedValues.styles[e],s)}refreshStyles(){this.enabled&&this.stylesEnabled&&this.attachedObjects.forEach(t=>this.applyStyles(t))}applyTransition(t,e=t.lastState){if(!this.enabled||!this.transitionEnabled)return;if(!t.enabled.global||!t.enabled.transition)return;const s=t.object.deref();s&&s instanceof Element&&t.resolvedValues&&Ge(s).appendStyle("transition",this.getTransitionString(t,e),", ",!0)}refreshTransition(){for(const t of this.attachedObjects){const e=Ge(t.object?.deref()).reifects;e&&e.reloadTransitions()}}filterEnabledObjects(t){return!(!t.enabled||!t.enabled.global)||(console.warn("The reified properties instance you are trying to set on an object is disabled for this particular object."),!1)}processRawProperties(t,e){if(t.resolvedValues||(t.resolvedValues={properties:void 0,styles:void 0,classes:void 0,replaceWith:void 0,transitionProperties:void 0,transitionDuration:void 0,transitionTimingFunction:void 0,transitionDelay:void 0}),d(e))return;const s={properties:this.properties,styles:this.styles,classes:this.classes,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay,...e||{}};t.resolvedValues.properties={},this.states.forEach(e=>this.processRawPropertyForState(t,"properties",s.properties,e)),"transitionProperties"in s&&(t.resolvedValues.transitionProperties={},this.states.forEach(e=>this.processRawPropertyForState(t,"transitionProperties",s.transitionProperties,e)));for(const[e,n]of Object.entries(s))"transitionProperties"!=e&&"properties"!=e&&(t.resolvedValues[e]={},this.states.forEach(s=>this.processRawPropertyForState(t,e,n,s)))}generateNewData(t,e){return{object:new WeakRef(t),enabled:{global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0},lastState:this.stateOf(t),onSwitch:e}}initializeOptions(t,e){return e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[],(t=t||{}).attachObjects=t.attachObjects??!0,t.executeForAll=t.executeForAll??0===e.length,t.recomputeIndices=t.recomputeIndices??0!==e.length,t.recomputeProperties=t.recomputeProperties??0!==e.length,t}clone(){return new k({states:this.states,properties:this.properties,classes:this.classes,styles:this.styles,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay})}processRawPropertyForState(t,e,s,n){let i;const a=t.object.deref();if(a){if("function"==typeof s)i=s(n,t.objectIndex,t.totalObjectCount,a);else if("object"==typeof s&&Ce(this.states,...Object.keys(s))){const e=s[n];i="function"==typeof e?e(t.objectIndex,t.totalObjectCount,a):e}else i=s;if("properties"!=e&&"transitionProperties"!=e||"string"!=typeof i){if("styles"==e){if(null==t.resolvedValues.styles[n]&&(t.resolvedValues.styles[n]={}),"number"==typeof i)return void t.resolvedValues.transitionProperties[n].forEach(e=>t.resolvedValues.styles[n][e]=i);if("string"==typeof i){const e=i.split(";").map(t=>t.split(":").map(t=>t.trim()));if(1==e.length&&1==e[0].length)return void t.resolvedValues.transitionProperties[n].forEach(s=>t.resolvedValues.styles[n][s]=e[0][0])}}}else i=i.split(" ");t.resolvedValues[e][n]=i}}parseTime(t){const e=t.match(this.timeRegex);if(!e)return NaN;const s=parseFloat(e[1]);return"ms"===(e[2]?.toLowerCase()??"s")?s/1e3:s}}})();function De(t){return new Pe(t)}var xe,Ae,Me,je,Ie,Be,Ne,Ve,_e,Fe;!function(t){t.vertical="vertical",t.horizontal="horizontal"}(xe||(xe={})),function(t){t.left="left",t.right="right"}(Ae||(Ae={})),function(t){t.top="top",t.bottom="bottom"}(Me||(Me={})),function(t){t.top="top",t.bottom="bottom",t.left="left",t.right="right"}(je||(je={})),function(t){t.in="in",t.out="out"}(Ie||(Ie={})),function(t){t.on="on",t.off="off"}(Be||(Be={})),function(t){t.open="open",t.closed="closed"}(Ne||(Ne={})),function(t){t.visible="visible",t.hidden="hidden"}(Ve||(Ve={})),function(t){t.public="public",t.protected="protected",t.private="private"}(_e||(_e={})),function(t){t.min="min",t.max="max"}(Fe||(Fe={}));class Le{attachedNode;reifects;_enabled;constructor(t){this.attachedNode=t,this.reifects=[],this._enabled={},this.enabled=!0}attach(...t){return t.forEach(t=>{this.reifects.some(e=>e.deref()==t)||(this.reifects.push(new WeakRef(t)),t.attach(this.attachedNode))}),this}detach(...t){return t.forEach(t=>{const e=this.reifects.find(e=>e.deref()==t);e&&(this.reifects.splice(this.reifects.indexOf(e),1),t.detach(this.attachedNode))}),this}initialize(t,e,s){return t.initialize(e,this.attachedNode,s),this}apply(t,e,s){return t.apply(e,this.attachedNode,s),this}toggle(t,e){return t.toggle(this.attachedNode,e),this}clear(){this.attachedNode instanceof Node&&Ge(this.attachedNode).setStyle("transition","",!0)}reload(){this.clear(),this.reifects.forEach(t=>t.deref()?.reloadFor(this.attachedNode))}reloadTransitions(){this.clear(),this.reifects.forEach(t=>t.deref()?.reloadTransitionFor(this.attachedNode))}get enabled(){return this._enabled}set enabled(t){if("boolean"==typeof t)this._enabled.global=t;else{if(!t)return;for(const[e,s]of Object.entries(t))this._enabled[e]=s}}getReifectEnabledState(t){return t.getObjectEnabledState(this.attachedNode)}enableReifect(t,e){t.enableObject(this.attachedNode,e)}}const ze=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}},Re=new Pe({states:[Ve.visible,Ve.hidden],styles:t=>`visibility: ${t}`});function We(){Object.defineProperty(g.prototype,"reifects",{get:function(){if(!this.element)return;const t=ze.data(this.element);return t.reifects||(t.reifects=new Le(this)),t.reifects},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"showTransition",{get:function(){if(!this.element)return;const t=ze.data(this.element);return t.showTransition||(t.showTransition=Re),t.showTransition},set:function(t){this.element&&(ze.data(this.element).showTransition=t)},configurable:!0,enumerable:!0}),Object.defineProperty(g.prototype,"isShown",{get:function(){if(!this.element)return;const t=this.showTransition.stateOf(this);return t==Ve.visible||t!=Ve.hidden&&("none"!=this.element.style.display&&"hidden"!=this.element.style.visibility&&"0"!=this.element.style.opacity)},configurable:!1,enumerable:!0}),g.prototype.show=function(t,e={executeForAll:!1}){if(this.element)return this.showTransition.apply(t?Ve.visible:Ve.hidden,this.element,e),this}}const Ke=new WeakMap;function He(t){let e;if(qe(),t||(t="div"),"string"==typeof t)e=x({tag:t});else if("object"==typeof t){if(t instanceof g)return t;e=t instanceof Node?t:t.element&&"object"==typeof t.element?t.element:t}const s=Ke.get(e);if(s)return s;const n=new g;return n.element=e,Ke.set(e,n),n}function Ue(t){return He(t)}function $e(t){return He(t)}function Ge(t){return He(t)}const qe=ke(function(t={}){t.excludeHierarchyFunctions||y(),t.excludeMiscFunctions||k(),t.excludeClassFunctions||S(),t.excludeElementFunctions||It(),t.excludeEventFunctions||de(),t.excludeStyleFunctions||pe(),t.excludeToolFunctions||ge(),t.excludeSubstrateFunctions||ye(),t.excludeReifectFunctions||We()});function Ye(t={}){return function(e,s){const{kind:n,name:i,static:a}=s,r=i,l=function(t){return Symbol(`__cache__${t}`)}(r),c=Symbol(`__cache__setup__${r}`),h=[],u=function(t=!0){if(!t)return;const e=this[l];if(e){e instanceof Map?e.clear():delete this[l];for(const t of h)clearTimeout(t);h.length=0}},d=function(){this[c]||(this[c]=!0,function(t,e,s,n,i,a,r){if(a.onEvent){const e="function"==typeof t?.addEventListener?t:document,s=Array.isArray(a.onEvent)?a.onEvent:String(a.onEvent).split(/\s+/).filter(Boolean);for(const t of s)Ge(e).on(t,()=>r())}if(a.onFieldChange){const e=Array.isArray(a.onFieldChange)?a.onFieldChange:[a.onFieldChange];for(const s of e){const e="string"==typeof s?s:s.name;if(!e)continue;const n=o(t,e),i=t[e];if("function"==typeof i){const s=i;Object.defineProperty(t,e,{configurable:!0,enumerable:n?.enumerable??!0,writable:!0,value:function(...t){return r(),s.apply(this,t)}})}else{const s=()=>n?.get?n.get.call(t):i,a=s=>{n?.set?n.set.call(t,s):Object.defineProperty(t,e,{configurable:!0,enumerable:!0,writable:!0,value:s})};Object.defineProperty(t,e,{configurable:!0,enumerable:n?.enumerable??!0,get:()=>s(),set(t){r(),a(t)}})}}}if(a.onCallback){const e=setInterval(()=>{const e=a.onCallback.call(t);e instanceof Promise?e.then(t=>r(Boolean(t))):r(Boolean(e))},a.onCallbackFrequency??50);"function"==typeof t?.addEventListener&&t.addEventListener("destroy",()=>clearInterval(e),{once:!0})}}(this,0,0,0,0,t,u.bind(this)))};if("method"===n){const n=e;return s.addInitializer(function(){this[l]||(this[l]=new Map)}),function(...e){d.call(this);const s=this[l]??(this[l]=new Map),i=function(t){return t&&0!==t.length?JSON.stringify(t.map(t=>{if("function"==typeof t)return`function:${t.name}`;if(t&&"object"==typeof t)try{return JSON.stringify(Object.entries(t).sort())}catch{return"[[unserializable-object]]"}return void 0===t?"undefined":t})):"__no_args__"}(e);if(s.has(i))return s.get(i);const a=n.apply(this,e);if(s.set(i,a),t.timeout){const e=setTimeout(()=>s.delete(i),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}return a}}if("getter"===n){const s=e;return function(){if(d.call(this),void 0===this[l]){if(this[l]=s.call(this),t.timeout){const e=setTimeout(()=>u.call(this),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}}return this[l]}}if("accessor"===n){const s=e;return{get(){if(d.call(this),void 0===this[l]){const e=s.get?s.get.call(this):void 0;if(this[l]=e,t.timeout){const e=setTimeout(()=>u.call(this),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}}return this[l]},set(t){u.call(this),s.set&&s.set.call(this,t)},init:t=>t}}}}function Xe(t){for(const e of Object.getOwnPropertySymbols(t))String(e).startsWith("Symbol(__cache__")&&delete t[e]}function Je(t,e){const s="function"==typeof e?e.name:e,n=Object.getOwnPropertySymbols(t).find(t=>String(t)===`Symbol(__cache__${s})`);n&&delete t[n]}const Qe=new class{prototypeMap=new WeakMap;dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}prototype(t){return t?(this.prototypeMap.has(t)||this.prototypeMap.set(t,{}),this.prototypeMap.get(t)):{}}fieldSetInPrototype(t,e){for(;t&&t!==HTMLElement.prototype;){if(this.prototype(t)[e])return!0;t=Object.getPrototypeOf(t)}return!1}skipAttributeChangedCallback(t){return this.fieldSetInPrototype(t,"setupAttributeChangedCallback")}skipConnectedCallback(t){return this.fieldSetInPrototype(t,"setupConnectedCallback")}getNamesOfPrototypeChain(t){const e=[];for(;t&&t!==HTMLElement.prototype;){const s=this.prototype(t).name;s&&e.push(s),t=Object.getPrototypeOf(t)}return e}};function Ze(t,e={injectAttributeBridge:!0}){return function(s,n){const i=t??Mt(n.name),a=s.prototype;if(i&&(Qe.prototype(a).name=i),Object.defineProperty(s,"observedAttributes",{configurable:!0,enumerable:!1,get:function(){const t=new Set;let e=this;for(;e&&e!==Function.prototype;){const s=e[Symbol.metadata]?.observedAttributes;if(s)for(const e of s)t.add(e);e=Object.getPrototypeOf(e)}return Array.from(t)}}),!1!==e.injectAttributeBridge&&!Qe.skipAttributeChangedCallback(a)){Qe.prototype(a).setupAttributeChangedCallback=!0;const t=function(e,s,n){if(h(this,"attributeChangedCallback",t)?.call(this,e,s,n),n===s)return;if(Qe.data(this).attributeBridgePass)return;const i=jt(e);if(i in this)try{Qe.data(this).attributeBridgePass=!0,this[i]=null===n?void 0:xt(n)}finally{Qe.data(this).attributeBridgePass=!1}};Object.defineProperty(a,"attributeChangedCallback",{configurable:!0,enumerable:!1,writable:!0,value:t})}if(!Qe.skipConnectedCallback(a)){Qe.prototype(a).setupConnectedCallback=!0;const t=function(){if(h(this,"connectedCallback",t)?.call(this),this instanceof HTMLElement){for(const t of this.constructor.observedAttributes??[]){const e=this[jt(t)];if(void 0===e)continue;const s=Dt(e);this.getAttribute(t)!==s&&this.setAttribute(t,s)}Qe.getNamesOfPrototypeChain(Object.getPrototypeOf(this)).forEach(t=>this.classList?.add(t))}};Object.defineProperty(a,"connectedCallback",{configurable:!0,enumerable:!1,writable:!0,value:t})}return n.addInitializer(function(){i&&!customElements.get(i)&&customElements.define(i,s)}),s}}function ts(t,e=!0){return function(s,n){if(!t)return s;const{kind:i,name:a}=n,r=String(a),l=t.split(".").filter(Boolean),c=function(t){if(!t)return;let e=t;for(const t of l)if(e=e[t],!e)return;return e};if("method"===i)return function(...t){const e=c(this),s=e?.[r];if("function"==typeof s)return s.apply(e,t)};n.addInitializer(function(){const t=function(){return c(this)?.[r]},s=function(t){const e=c(this);e&&(e[r]=t)};if("field"===i||"accessor"===i){const n=o(this,r);Object.defineProperty(this,r,{configurable:!0,enumerable:n?.enumerable??!0,get:()=>t.call(this),set:t=>{e&&s.call(this,t)}})}})}}"metadata"in Symbol||Object.defineProperty(Symbol,"metadata",{value:Symbol.for("Symbol.metadata"),writable:!1,enumerable:!1,configurable:!0});const es=new class{constructorMap=new WeakMap;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}};function ss(t,e){const{kind:s,name:n,static:i}=e,a=String(n),r=Mt(a),l=Symbol(`__observed_${a}`);if(e.metadata){const t=e.metadata.observedAttributes;Object.prototype.hasOwnProperty.call(e.metadata,"observedAttributes")?t||(e.metadata.observedAttributes=new Set):e.metadata.observedAttributes=new Set(t),e.metadata.observedAttributes.add(r)}e.addInitializer(function(){const e=i?this:c(this,a);let h,u;if("field"===s||"accessor"===s)try{this[l]=this[n]}catch{}const d=function(){return h?h.call(this):this[l]},f=function(t){this[a]!==t&&(u?u.call(this,t):this[l]=t,this.setAttribute?.(r,Dt(this[a])))};if("field"===s||"accessor"===s){const e=t;e?.get&&(h=e.get),e?.set&&(u=e.set);const s=o(this,a);s?.get&&(h=s.get),s?.set&&(u=s.set),Object.defineProperty(this,a,{configurable:!0,enumerable:s?.enumerable??!0,get:()=>d.call(this),set:t=>f.call(this,t)})}else if("getter"===s||"setter"===s){const t=es.constructorData(e).installed;if(t.get(a))return;t.set(a,!0);const s=o(e,a)??{};"function"==typeof s.get&&(h=s.get),"function"==typeof s.set&&(u=s.set),Object.defineProperty(e,a,{configurable:!0,enumerable:!!s?.enumerable,get:function(){return d.call(this)},set:function(t){f.call(this,t)}})}})}function ns(t,e){const{name:s}=e;return e.addInitializer(function(){this.solverKeys?.push(s)}),t}function is(t){const e=x(t);return Ge(e).setStyles({display:"flex",flexDirection:"column"},!0),e}function as(t){const e=is(t);return Ge(e).setStyles({justifyContent:"center",alignItems:"center"},!0),e}function rs(t){const e=x(t);return Ge(e).setStyles({display:"flex",flexDirection:"row"},!0),e}function os(t){const e=rs(t);return Ge(e).setStyles({justifyContent:"center",alignItems:"center"},!0),e}function ls(t){const e=x(t);return Ge(e).setStyle("flexGrow",1,!0),e}class cs{element;model;emitter;constructor(t){this.element=t.element,t.model&&(this.model=t.model),t.emitter&&(this.emitter=t.emitter)}initialize(){this.setupUIElements(),this.setupUILayout(),this.setupUIListeners(),this.setupChangedCallbacks()}setupChangedCallbacks(){dt(this)}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}class hs extends Xt{#s;get target(){return this.#s}set target(t){this.#s=t}toolName;manager;options;constructor(t){super(t),this.manager=t.manager??this.manager??he.instance,this.toolName=t.toolName??this.toolName??void 0,this.options=t.listenerOptions??{};const e=this.element;this.target=t.target??this.target??e instanceof Node?e:e?.element instanceof Node?e.element:void 0}initialize(){super.initialize();const t=this.target??this;for(const[e,s]of Object.entries(Pt)){const n=this[e];if("function"!=typeof n)continue;const i=this.options?.[e];this.toolName?Ge(t).onTool(s,this.toolName,t=>n.call(this,t),i,this.manager):Ge(t).on(s,t=>n.call(this,t),i,this.manager)}}}class us extends Xt{substrateName;solverKeys=[];get objectList(){return Ge(this).getSubstrateObjectList(this.substrateName)}set objectList(t){Ge(this).setSubstrateObjectList(t,this.substrateName)}constructor(t){super(t),this.substrateName=t.substrateName??this.substrateName??void 0,t.onActivate&&(this.onActivate=t.onActivate),t.onDeactivate&&(this.onDeactivate=t.onDeactivate)}initialize(){super.initialize(),this.substrateName&&(Ge(this).makeSubstrate(this.substrateName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0}),this.solverKeys.forEach(t=>{Ge(this).addSolver(e=>this[t]?.(e))}))}addObject(t){Ge(this).addObjectToSubstrate(t,this.substrateName)}removeObject(t){Ge(this).removeObjectFromSubstrate(t,this.substrateName)}hasObject(t){return Ge(this).hasObjectInSubstrate(t,this.substrateName)}isProcessed(t){return Ge(this).wasObjectProcessedBySubstrate(t,this.substrateName)}addSolver(t){Ge(this).addSolver(t,this.substrateName)}removeSolver(t){Ge(this).removeSolver(t,this.substrateName)}clearSolvers(){Ge(this).clearSolvers(this.substrateName)}resolve(t={}){Ge(this).resolveSubstrate({...t,substrate:this.substrateName})}}class ds extends Xt{toolName;embeddedTarget;manager;activationEvent=Pt.click;clickMode=_t.left;key;constructor(t){super(t),this.toolName=t.toolName??this.toolName??void 0,t.embeddedTarget&&(this.embeddedTarget=t.embeddedTarget),t.onActivate&&(this.onActivate=t.onActivate),t.onDeactivate&&(this.onDeactivate=t.onDeactivate),t.activationEvent&&(this.activationEvent=t.activationEvent),t.clickMode&&(this.clickMode=t.clickMode),t.customActivation&&(this.customActivation=t.customActivation),t.key&&(this.key=t.key),this.manager=t.manager??this.manager??he.instance}initialize(){if(super.initialize(),this.toolName){Ge(this).makeTool(this.toolName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0,activationEvent:this.activationEvent,clickMode:this.clickMode,customActivation:"function"==typeof this.customActivation?this.customActivation.bind(this):void 0,key:this.key,manager:this.manager}),this.embeddedTarget&&Ge(this).embedTool(this.embeddedTarget,this.manager);for(const[t,e]of Object.entries(Pt)){const s=this[t];"function"==typeof s&&Ge(this).addToolBehavior(e,(t,e)=>s.call(this,t,e),this.toolName,this.manager)}}}}function fs(t,e){void 0===e&&(e={});var s=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===s&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}function ps(t){let e=document.createElement("div");return e.innerHTML=t,e.children[0]}function ms(t,e){return new Proxy(t,{get:(t,s,n)=>s in t?Reflect.get(t,s,n):s in e?Reflect.get(e,s,n):void 0,set:(t,s,n,i)=>s in t?Reflect.set(t,s,n,i):Reflect.set(e,s,n,i)})}function gs(t,e=!0){return new Promise((s,n)=>{t&&0!==t.length?fetch(t).then(t=>{if(!t.ok)throw new Error("Network response was not ok while loading your SVG");return t.text()}).then(t=>{const e=ps(t);if(!e)throw new Error("Error parsing SVG text");s(e)}).catch(t=>{e||n(t),console.error("Error fetching SVG:",t),n(t)}):n(new Error("Invalid path"))})}function bs(t){const e=t.prototype,s=Symbol("__unset_default_classes__");Object.defineProperty(e,"unsetDefaultClasses",{get:function(){return this[s]??!1},set:function(t){this[s]=t;const e=this.constructor?.config?.defaultClasses;e&&Ge(this).toggleClass(e,t)},enumerable:!0,configurable:!0})}fs("turbo-button{align-items:center;background-color:#dadada;border:1px solid #000;border-radius:.4em;color:#000;display:inline-flex;flex-direction:row;gap:.4em;padding:.5em .7em;text-decoration:none}turbo-button>h4{flex-grow:1}");class ys extends HTMLElement{static config={shadowDOM:!1,defaultSelectedClass:"selected"};mvc=new Q({element:this});onAttach=new tt;onDetach=new tt;onAdopt=new tt;static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}connectedCallback(){this.onAttach.fire()}disconnectedCallback(){this.onDetach.fire()}adoptedCallback(){this.onAdopt.fire()}}le(ys),oe(ys),bs(ys);let vs=(()=>{let s,n,i,a,r,o,l,c=[Ze("turbo-icon")],h=[],u=ys,d=[],p=[],g=[],b=[],y=[];return class extends u{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(u[Symbol.metadata]??null):void 0;i=[ss,m({initialValueCallback:function(){return this.getPropertiesValue(this.type,"defaultType","svg")},preprocessValue:function(t){return t&&0!=t.length?("."==t[0]&&(t=t.substring(1)),t):this.type},callAfter:function(){this.generateIcon()}})],a=[ss,m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultDirectory","")},preprocessValue:function(t){return f(t)?this.directory:(t.length>0&&!t.endsWith("/")&&(t+="/"),t)},callAfter:function(){this.generateIcon()}})],r=[ss,m()],o=[ss,m()],l=[Ye()],t(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:t=>"icon"in t,set:(t,e)=>{t.icon=e}},metadata:e},null,d),t(this,null,o,{kind:"setter",name:"iconColor",static:!1,private:!1,access:{has:t=>"iconColor"in t,set:(t,e)=>{t.iconColor=e}},metadata:e},null,d),t(this,null,l,{kind:"method",name:"loadSvg",static:!1,private:!1,access:{has:t=>"loadSvg"in t,get:t=>t.loadSvg},metadata:e},null,d),t(null,null,i,{kind:"field",name:"type",static:!1,private:!1,access:{has:t=>"type"in t,get:t=>t.type,set:(t,e)=>{t.type=e}},metadata:e},p,g),t(null,null,a,{kind:"field",name:"directory",static:!1,private:!1,access:{has:t=>"directory"in t,get:t=>t.directory,set:(t,e)=>{t.directory=e}},metadata:e},b,y),t(null,s={value:n},c,{kind:"class",name:n.name,metadata:e},null,h),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ys.config,defaultType:"svg",customLoaders:{}};static imageTypes=["png","jpg","jpeg","gif","webp","PNG","JPG","JPEG","GIF","WEBP"];_element=e(this,d);_loadToken=0;onLoaded;type=e(this,p,void 0);directory=(e(this,g),e(this,b,void 0));get path(){let t=At(this.icon);const e=this.icon?.replace(t,"");return 0===t.length&&this.type?.length>0&&(t="."+this.type),this.directory+e+t}set icon(t){const e=At(t).substring(1);e&&(this.type=e),this.generateIcon()}set iconColor(t){this.updateColor(t)}set element(t){this._element=t}get element(){return this._element}loadSvg(t){return gs(t)}loadImg(t){return W({src:t,alt:this.icon})}updateColor(t=this.iconColor){t&&this.element instanceof SVGElement&&(this.element.style.fill=t)}generateIcon(){const t=this.path,e=At(t)?.substring(1);if(this.element instanceof HTMLImageElement&&we(e,...this.constructor.imageTypes))return this.element.src=this.path,void(this.element.alt=this.icon);if(this.clear(),!this.icon)return;const s=++this._loadToken,n=this.getLoader(e)(t);n instanceof Element?this.setupLoadedElement(n):n.then(t=>{s===this._loadToken&&this.setupLoadedElement(t)}).catch(t=>console.error(`Failed to load icon: ${t}`))}getLoader(t){if(!t)return;const e=this.constructor.config.customLoaders[t];if(e)return e;if(we(t,"svg","SVG"))return this.loadSvg.bind(this);if(we(t,...this.constructor.imageTypes))return this.loadImg.bind(this);throw new Error(`Unsupported icon type: ${t}`)}setupLoadedElement(t){!this.element&&t&&(t.parentElement&&(t=t.cloneNode(!0)),Ge(this).addChild(t),this.updateColor(),this.onLoaded?.(t),this.element=t)}clear(){Ge(this.element).destroy(),this.element=null}constructor(){super(...arguments),e(this,y)}static{e(n,h)}},n})();function ks(t){return t.tag||(t.tag="turbo-icon"),x({...t})}let Es=(()=>{let s,n,i,a,r,o,l,c,h,u,d=[Ze("turbo-rich-element")],f=[],p=ys,g=[],b=[],y=[];return class extends p{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;i=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultElementTag","h4")}})],a=[m({executeSetterBeforeStoring:!0})],r=[m({preprocessValue:function(t){if("string"==typeof t){if(this.leftIcon)return this.leftIcon.icon=t,this.leftIcon;t=ks({icon:t})}return Ge(this).remChild(this.leftIcon),this.addAtPosition(t,"leftIcon"),t}})],o=[m({preprocessValue:function(t){if("string"==typeof t){if(this.prefixEntry)return this.prefixEntry.textContent=t,this.prefixEntry;t=x({text:t})}return Ge(this).remChild(this.prefixEntry),this.addAtPosition(t,"prefixEntry"),t}})],l=[m({preprocessValue:function(t){if("string"==typeof t){if(this.element&&"textContent"in this.element)return this.element.textContent=t,this.element;t=x({tag:this.elementTag,text:t})}else"object"!=typeof t||t instanceof Element||(t.tag||(t.tag=this.elementTag),t=x(t));return Ge(this).remChild(this.element),this.addAtPosition(t,"element"),t}})],c=[m({preprocessValue:function(t){if("string"==typeof t){if(this.suffixEntry)return this.suffixEntry.textContent=t,this.suffixEntry;t=x({text:t})}return Ge(this).remChild(this.suffixEntry),this.addAtPosition(t,"suffixEntry"),t}})],h=[m({preprocessValue:function(t){if("string"==typeof t){if(this.rightIcon)return this.rightIcon.icon=t,this.rightIcon;t=ks({icon:t})}return Ge(this).remChild(this.rightIcon),this.addAtPosition(t,"rightIcon"),t}})],u=[m({executeSetterBeforeStoring:!0})],t(this,null,a,{kind:"setter",name:"leftCustomElements",static:!1,private:!1,access:{has:t=>"leftCustomElements"in t,set:(t,e)=>{t.leftCustomElements=e}},metadata:e},null,g),t(this,null,r,{kind:"setter",name:"leftIcon",static:!1,private:!1,access:{has:t=>"leftIcon"in t,set:(t,e)=>{t.leftIcon=e}},metadata:e},null,g),t(this,null,o,{kind:"setter",name:"prefixEntry",static:!1,private:!1,access:{has:t=>"prefixEntry"in t,set:(t,e)=>{t.prefixEntry=e}},metadata:e},null,g),t(this,null,l,{kind:"setter",name:"element",static:!1,private:!1,access:{has:t=>"element"in t,set:(t,e)=>{t.element=e}},metadata:e},null,g),t(this,null,c,{kind:"setter",name:"suffixEntry",static:!1,private:!1,access:{has:t=>"suffixEntry"in t,set:(t,e)=>{t.suffixEntry=e}},metadata:e},null,g),t(this,null,h,{kind:"setter",name:"rightIcon",static:!1,private:!1,access:{has:t=>"rightIcon"in t,set:(t,e)=>{t.rightIcon=e}},metadata:e},null,g),t(this,null,u,{kind:"setter",name:"rightCustomElements",static:!1,private:!1,access:{has:t=>"rightCustomElements"in t,set:(t,e)=>{t.rightCustomElements=e}},metadata:e},null,g),t(null,null,i,{kind:"field",name:"elementTag",static:!1,private:!1,access:{has:t=>"elementTag"in t,get:t=>t.elementTag,set:(t,e)=>{t.elementTag=e}},metadata:e},b,y),t(null,s={value:n},d,{kind:"class",name:n.name,metadata:e},null,f),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ys.config,defaultElementTag:"h4"};childrenOrder=(e(this,g),["leftCustomElements","leftIcon","prefixEntry","element","suffixEntry","rightIcon","rightCustomElements"]);addAtPosition(t,e){if(!t||!e)return;let s=0;for(let t=0;t<this.childrenOrder.length;t++){const n=this.childrenOrder[t];if(n===e)break;const i=this[n];i&&i instanceof Element?s++:i&&Array.isArray(i)&&(s+=i.length)}Ge(this).addChild(t,s)}elementTag=e(this,b,void 0);set leftCustomElements(t){Ge(this).remChild(this.leftCustomElements),this.addAtPosition(t,"leftCustomElements")}set leftIcon(t){}get leftIcon(){}set prefixEntry(t){}get prefixEntry(){}set element(t){}get element(){}get text(){const t=this.element;return t?t.textContent:""}set text(t){t||(t=""),this.element=t}set suffixEntry(t){}get suffixEntry(){}set rightIcon(t){}get rightIcon(){}set rightCustomElements(t){Ge(this).remChild(this.rightCustomElements),this.addAtPosition(t,"rightCustomElements")}constructor(){super(...arguments),e(this,y)}static{e(n,f)}},n})();function Ss(t){return t.text&&!t.element&&(t.element=t.text),!t.elementTag||"object"!=typeof t.element||t.element instanceof Element||(t.element.tag=t.elementTag),t.tag||(t.tag="turbo-rich-element"),x({...t,text:void 0})}let ws=(()=>{let s,n,i=[Ze("turbo-button")],a=[],r=Es;return class extends r{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t(null,s={value:n},i,{kind:"class",name:n.name,metadata:e},null,a),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...Es.config,defaultElementTag:"h4"};static{e(n,a)}},n})();function Cs(t){return t.tag||(t.tag="turbo-button"),Ss({...t})}let Os=(()=>{let s,n,i,a,r,o=[Ze("turbo-icon-switch")],l=[],c=vs,h=[];return class extends c{static{n=this}static{const u="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;i=[m({preprocessValue:function(t){return t instanceof Pe?t:new Pe(t||{})}})],a=[m()],r=[m()],t(this,null,i,{kind:"setter",name:"switchReifect",static:!1,private:!1,access:{has:t=>"switchReifect"in t,set:(t,e)=>{t.switchReifect=e}},metadata:u},null,h),t(this,null,a,{kind:"setter",name:"defaultState",static:!1,private:!1,access:{has:t=>"defaultState"in t,set:(t,e)=>{t.defaultState=e}},metadata:u},null,h),t(this,null,r,{kind:"setter",name:"appendStateToIconName",static:!1,private:!1,access:{has:t=>"appendStateToIconName"in t,set:(t,e)=>{t.appendStateToIconName=e}},metadata:u},null,h),t(null,s={value:n},o,{kind:"class",name:n.name,metadata:u},null,l),n=s.value,u&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),e(n,l)}config=(e(this,h),{...vs.config});get switchReifect(){}set switchReifect(t){this.switchReifect.attach(this),this.defaultState&&this.switchReifect.apply(this.defaultState,this)}set defaultState(t){this.switchReifect?.apply(t,this)}set appendStateToIconName(t){if(t){const t=this.switchReifect?.properties;this.switchReifect.states.forEach(e=>{t[e]||(t[e]={}),t[e].icon=this.icon+"-"+e.toString()})}}initialize(){super.initialize(),this.defaultState&&this.switchReifect&&this.switchReifect.apply(this.defaultState,this)}},n})();function Ts(t){return t.tag||(t.tag="turbo-icon-switch"),ks({...t})}let Ps=(()=>{let s,n,i,a,r=[Ze("turbo-icon-toggle")],o=[],l=vs,c=[];return class extends l{static{n=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;i=[m({initialValue:!1})],a=[m({initialValue:!1})],t(this,null,i,{kind:"setter",name:"toggled",static:!1,private:!1,access:{has:t=>"toggled"in t,set:(t,e)=>{t.toggled=e}},metadata:h},null,c),t(this,null,a,{kind:"setter",name:"toggleOnClick",static:!1,private:!1,access:{has:t=>"toggleOnClick"in t,set:(t,e)=>{t.toggleOnClick=e}},metadata:h},null,c),t(null,s={value:n},r,{kind:"class",name:n.name,metadata:h},null,o),n=s.value,h&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),e(n,o)}config=(e(this,c),{...vs.config});stopPropagationOnClick=!0;onToggle;clickListener=()=>(this.toggle(),this.stopPropagationOnClick);set toggled(t){this.onToggle&&this.onToggle(t,this)}set toggleOnClick(t){t?Ge(this).on(Pt.click,this.clickListener):Ge(this).removeListener(Pt.click,this.clickListener)}toggle(){this.toggled=!this.toggled}},n})();function Ds(t){return t.tag||(t.tag="turbo-icon-toggle"),ks({...t})}function xs(t=8){const e=new Uint8Array(t);return crypto.getRandomValues(e),Array.from(e).map(t=>t.toString(36).padStart(2,"0")).join("").slice(0,t)}function As(t,e){if("number"!=typeof t||"number"!=typeof e)return 0;const s=Math.min(t,e),n=Math.max(t,e);return Math.random()*(n-s)+s}function Ms(t=[50,70],e=[70,85]){return"number"!=typeof t&&t.length>=2&&(t=As(t[0],t[1])),"number"!=typeof e&&e.length>=2&&(e=As(e[0],e[1])),"hsl("+360*Math.random()+" "+t+" "+e+")"}function js(t=12){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let n=0;n<t;n++)s+=e.charAt(Math.floor(62*Math.random()));return s}class Is extends hs{keyName="__input__interactor__";_composing=!1;_resizeQueued=!1;options={compositionStart:{capture:!0},compositionEnd:{capture:!0},input:{capture:!0}};get inputElement(){return this.element.element}initialize(){super.initialize(),Ge(this.target).bypassManagerOn=()=>!0}setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("valueSet",()=>this.handleInput())}click(){return this.element.locked||this.inputElement?.focus(),!1}focusIn(t){if(t.target===this.inputElement){if(!this.element.locked)return this.element.selectTextOnFocus&&requestAnimationFrame(()=>{try{this.inputElement.select?.()}catch{}}),this.element.onFocus.fire(),!0;this.inputElement.blur()}}focusOut(t){t.target===this.inputElement&&(this.element.value=this.element.element?.value,this.element.onBlur.fire())}compositionStart(t){t.target===this.inputElement&&(this._composing=!0)}compositionEnd(t){if(t.target===this.inputElement)return this._composing=!1,this.handleInput(),!0}input(t){if(t.target===this.inputElement)return this.handleInput(),!0}handleInput(){this._composing||this.inputElement&&(this.element.dynamicVerticalResize&&this.inputElement instanceof HTMLTextAreaElement&&(this._resizeQueued||(this._resizeQueued=!0,queueMicrotask(()=>{this._resizeQueued=!1,Ge(this.inputElement).setStyle("height","auto",!0).setStyle("height",this.inputElement.scrollHeight+"px",!0)}))),this.emitter.fire("processValue"))}}let Bs=(()=>{let s,n,i,a=[Ze("turbo-input")],r=[],o=Es,l=[];return class extends o{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(o[Symbol.metadata]??null):void 0;i=[m()],t(this,null,i,{kind:"setter",name:"label",static:!1,private:!1,access:{has:t=>"label"in t,set:(t,e)=>{t.label=e}},metadata:e},null,l),t(null,s={value:n},a,{kind:"class",name:n.name,metadata:e},null,r),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...Es.config,defaultElementTag:"input"};labelElement=e(this,l);_content;get content(){return this._content}set content(t){this._content=t}defaultId="turbo-input-"+xs();locked=!1;selectTextOnFocus=!1;dynamicVerticalResize=!1;inputRegexCheck;blurRegexCheck;lastValidForInput="";lastValidForBlur="";onFocus=new tt;onBlur=new tt;onInput=new tt;set label(t){t&&0!==t.length?(this.labelElement||(this.labelElement=x({tag:"label",htmlFor:this.element?.id??this.defaultId}),Ge(this).childHandler=this,Ge(this).addChild(this.labelElement,0),this.content&&(Ge(this).childHandler=this.content)),this.labelElement.textContent=t):this.labelElement&&this.labelElement.remove()}set element(t){t instanceof Node||"object"!=typeof t||(t.name||(t.name=xs()),"input"!==this.elementTag||t.type||(t.type="text")),super.element=t,this.element&&(this.element.id?this.labelElement&&(this.labelElement.htmlFor=this.element.id):this.element.id=this.defaultId)}get element(){return super.element}initialize(){super.initialize(),this.mvc.generate({interactors:[Is]}),this.mvc.getInteractor("__input__interactor__").target=this.content}setupUIElements(){super.setupUIElements(),this.content=B()}setupUILayout(){super.setupUILayout(),Ge(this.content).addChild(Ge(this).childrenArray),Ge(this).addChild([this.labelElement,this.content]),Ge(this).childHandler=this.content}setupChangedCallbacks(){super.setupChangedCallbacks(),this.mvc.emitter.add("processValue",()=>this.processInputValue())}get value(){const t=this.element?.value;try{const e=parseFloat(t);if(!isNaN(e))return e}catch{}return t}set value(t){if(!(this.element instanceof HTMLInputElement||this.element instanceof HTMLTextAreaElement))return;let e=t.toString();if(this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(e)||(e=this.lastValidForBlur)}this.element.value=e,this.mvc.emitter.fire("valueSet")}processInputValue(t=this.element.value){if(this.inputRegexCheck){const e=new RegExp(this.inputRegexCheck);if(!e.test(t)){const s=this.sanitizeByRegex(t,this.inputRegexCheck);t=e.test(s)?s:this.lastValidForInput}}if(this.lastValidForInput=t.toString(),this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(t.toString())&&(this.lastValidForBlur=t)}else this.lastValidForBlur=t;this.element.value=t,this.onInput.fire()}sanitizeByRegex(t,e){const s="string"==typeof e?e:e.source,n="string"==typeof e?"":e.flags.replace("g",""),i=new RegExp(s,n);let a="";for(const e of t){const t=a+e;i.lastIndex=0,i.test(t)&&(a=t)}return a}static{e(n,r)}},n})();function Ns(t){return t.element=t.input,t.elementTag=t.inputTag,t.elementTag||(t.elementTag="input"),t.element||(t.element={}),t.tag||(t.tag="turbo-input"),Ss({...t,input:void 0,inputTag:void 0})}let Vs=(()=>{let s,n,i=[Ze("turbo-numerical-input")],a=[],r=Bs;return class extends r{static{n=this}static{const o="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t(null,s={value:n},i,{kind:"class",name:n.name,metadata:o},null,a),n=s.value,o&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),e(n,a)}multiplier=1;decimalPlaces;min;max;get value(){return Number.parseFloat(this.element.value)/this.multiplier}set value(t){t&&""!=t||(t=0),"string"==typeof t&&(t=Number.parseFloat(t)),t*=this.multiplier,null!=this.min&&t<this.min&&(t=this.min),null!=this.max&&t>this.max&&(t=this.max),null!=this.decimalPlaces&&(t=Math.round(t*Math.pow(10,this.decimalPlaces))/Math.pow(10,this.decimalPlaces)),super.value=t}},n})();function _s(t){return t.inputRegexCheck||(t.inputRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?\.?$|^-$|^$/),t.blurRegexCheck||(t.blurRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?(?<=\d)$/),t.tag||(t.tag="turbo-numerical-input"),Ns({...t})}class Fs extends qt{toggledEntry;values;constructor(t){super(t),this.toggledEntry=t.toggledEntry,this.values=t.values}}class Ls{static config={};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}}le(Ls);let zs=(()=>{let s,n,i,a,r,o,l,c,h,u=Ls,p=[],g=[],b=[],y=[],v=[],k=[],E=[],S=[],w=[],C=[],O=[],T=[],P=[],D=[],x=[];return class extends u{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(u[Symbol.metadata]??null):void 0;s=[m()],n=[m({defaultValue:t=>t instanceof Es?t.text:t instanceof HTMLElement?t.textContent:t instanceof Element?t.innerHTML:void 0})],i=[m({defaultValue:()=>""})],a=[m({defaultValue:t=>Ss({text:Dt(t)})})],r=[m({defaultValue:function(t){this.initializeSelection(),Ge(t).on(Pt.click,()=>(this.select(t,!this.isSelected(t)),!0))}})],o=[m({defaultValue:function(t){}})],l=[m({defaultValue:!1})],c=[m({defaultValueCallback:function(){return!this.multiSelection}})],h=[m({callBefore:function(){this.selectedEntries?.forEach(t=>He(t).removeClass(this.selectedEntryClasses))},callAfter:function(){this.selectedEntries?.forEach(t=>He(t).addClass(this.selectedEntryClasses))},initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectedEntryClasses")}})],t(this,null,s,{kind:"setter",name:"parent",static:!1,private:!1,access:{has:t=>"parent"in t,set:(t,e)=>{t.parent=e}},metadata:e},null,p),t(this,null,l,{kind:"setter",name:"multiSelection",static:!1,private:!1,access:{has:t=>"multiSelection"in t,set:(t,e)=>{t.multiSelection=e}},metadata:e},null,p),t(null,null,n,{kind:"field",name:"getValue",static:!1,private:!1,access:{has:t=>"getValue"in t,get:t=>t.getValue,set:(t,e)=>{t.getValue=e}},metadata:e},g,b),t(null,null,i,{kind:"field",name:"getSecondaryValue",static:!1,private:!1,access:{has:t=>"getSecondaryValue"in t,get:t=>t.getSecondaryValue,set:(t,e)=>{t.getSecondaryValue=e}},metadata:e},y,v),t(null,null,a,{kind:"field",name:"createEntry",static:!1,private:!1,access:{has:t=>"createEntry"in t,get:t=>t.createEntry,set:(t,e)=>{t.createEntry=e}},metadata:e},k,E),t(null,null,r,{kind:"field",name:"onEntryAdded",static:!1,private:!1,access:{has:t=>"onEntryAdded"in t,get:t=>t.onEntryAdded,set:(t,e)=>{t.onEntryAdded=e}},metadata:e},S,w),t(null,null,o,{kind:"field",name:"onEntryRemoved",static:!1,private:!1,access:{has:t=>"onEntryRemoved"in t,get:t=>t.onEntryRemoved,set:(t,e)=>{t.onEntryRemoved=e}},metadata:e},C,O),t(null,null,c,{kind:"field",name:"forceSelection",static:!1,private:!1,access:{has:t=>"forceSelection"in t,get:t=>t.forceSelection,set:(t,e)=>{t.forceSelection=e}},metadata:e},T,P),t(null,null,h,{kind:"field",name:"selectedEntryClasses",static:!1,private:!1,access:{has:t=>"selectedEntryClasses"in t,get:t=>t.selectedEntryClasses,set:(t,e)=>{t.selectedEntryClasses=e}},metadata:e},D,x),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={defaultSelectedEntryClasses:"selected"};_inputField=e(this,p);_entries=[];_entriesData=new WeakMap;parentObserver;onSelectDelegate=new tt;onEnabledDelegate=new tt;get entries(){return this._entries}set entries(t){this.enableObserver(!1);const e=this.selectedValues;this.clear(),this._entries=(Array.isArray(t)?t:Array.from(t)).filter(t=>t!==this.inputField),t instanceof HTMLCollection&&t.item(0)&&(this.parent=t.item(0).parentElement);const s=this.entries;for(let t=0;t<s.length;t++)this.onEntryAdded?.call(this,s[t],t);this.deselectAll();for(let t=0;t<s.length;t++)e.includes(this.getValue(s[t]))&&this.select(s[t]);0===this.selectedEntries.length&&this.initializeSelection(),this.refreshInputField(),this.enableObserver(!0)}get values(){return this.entries.map(t=>this.getValue(t))}set values(t){const e=[];t.forEach(t=>{const s=this.createEntry(t);s instanceof Node&&this.parent&&Ge(this.parent).addChild(s),e.push(s)}),this.entries=e}get selectedEntries(){return this.entries.filter(t=>this.getEntryData(t).selected)}set selectedEntries(t){this.deselectAll(),t&&t.forEach(t=>this.select(t))}set parent(t){t instanceof Element&&(Ge(t).addChild(this.entries.filter(t=>t instanceof Node)),this.inputField&&t.appendChild(this.inputField),this.setupParentObserver())}getValue=e(this,g,void 0);getSecondaryValue=(e(this,b),e(this,y,void 0));createEntry=(e(this,v),e(this,k,void 0));onEntryAdded=(e(this,E),e(this,S,void 0));onEntryRemoved=(e(this,w),e(this,C,void 0));get inputName(){return this.inputField?.name}set inputName(t){this._inputField||(this._inputField=K({value:this.stringSelectedValue,type:"hidden",parent:this.parent??document.body})),this.inputField.name=t}get inputField(){return this._inputField}set multiSelection(t){this.forceSelection=!t}forceSelection=(e(this,O),e(this,T,void 0));set onSelect(t){t&&this.onSelectDelegate.add(t)}set onEnabled(t){t&&this.onEnabledDelegate.add(t)}selectedEntryClasses=(e(this,P),e(this,D,void 0));constructor(t={}){super(),e(this,x);const s=t.selectedValues||[];t.selectedValues=void 0,t.onEnabled||(t.onEnabled=(t,e)=>{e instanceof HTMLElement&&Ge(e).setStyle("visibility",t?"":"hidden")});for(const e of Object.keys(t))try{this[e]=t[e]}catch{}this.forceSelection||this.deselectAll(),this.entries.forEach(t=>{s.includes(this.getValue(t))&&this.select(t)})}getEntryData(t){if(!t)return{};let e=this._entriesData.get(t);return e||(e={selected:!1,enabled:!0},this._entriesData.set(t,e)),e}clearEntryData(t){this._entriesData.delete(t);const e=this.entries.indexOf(t);e>=0&&this.entries.splice(e,1)}addEntry(t,e=this.entries.length){(void 0===e||"number"!=typeof e||e>this.entries.length)&&(e=this.entries.length),e<0&&(e=0),this.enableObserver(!1),this.onEntryAdded?.call(this,t,e),Array.isArray(this.entries)&&!this.entries.includes(t)&&this.entries.splice(e,0,t),t instanceof Node&&!t.parentElement&&this.parent&&Ge(this.parent).addChild(t,e),this.enableObserver(!0),requestAnimationFrame(()=>this.select(this.selectedEntry))}getEntryFromSecondaryValue(t){return this.entries.find(e=>this.getSecondaryValue(e)===t)}isSelected(t){return this.selectedEntries.includes(t)}getEntry(t){let e;try{const s=this.find(t);if(s)e=s;else{const s=this.entries.find(e=>e===t);s&&(e=s)}}catch{}return e}select(t,e=!0){if(d(t)||f(t))return this;let s;try{const e=this.getEntry(t);if(e)s=e;else{const e=this.entries.find(e=>e===t);e&&(s=e)}}catch{}if(!s)return this;const n=this.isSelected(s);return e===n||!e&&n&&this.selectedEntries.length<=1&&this.forceSelection||(this.multiSelection||this.deselectAll(),this.getEntryData(s).selected=e,s instanceof HTMLElement&&Ge(s).toggleClass(this.selectedEntryClasses,e),this.initializeSelection(),this.refreshInputField(),this.onSelectDelegate.fire(e,s,this.getIndex(s)),(this.parent??document).dispatchEvent(new Fs({toggledEntry:s,values:this.selectedValues}))),this}selectByIndex(t,e=Oe){return t=e(t,this.entries.length-1,0),this.select(this.entries[t])}getIndex(t){return this.entries.indexOf(t)}deselectAll(){this.selectedEntries.forEach(t=>{t instanceof HTMLElement&&Ge(t).toggleClass(this.selectedEntryClasses,!1),this.getEntryData(t).selected=!1}),this.refreshInputField()}reset(){this.deselectAll()}get enabledEntries(){return this.entries.filter(t=>this.getEntryData(t).enabled)}get enabledValues(){return this.enabledEntries.map(t=>this.getValue(t))}get enabledSecondaryValues(){return this.enabledEntries.map(t=>this.getSecondaryValue(t))}find(t){return this.entries.find(e=>this.getValue(e)===t)}findBySecondaryValue(t){return this.entries.find(e=>this.getSecondaryValue(e)===t)}findAll(...t){return this.entries.filter(e=>t.includes(this.getValue(e)))}findAllBySecondaryValue(...t){return this.entries.filter(e=>t.includes(this.getSecondaryValue(e)))}enable(t,...e){e&&0!==e.length||(e=this.entries),e.forEach(e=>{const s=this.getEntry(e);s&&(this.getEntryData(s).enabled=t,this.onEnabledDelegate.fire(t,s,this.getIndex(s)))})}get selectedEntry(){return this.selectedEntries[0]}get selectedValues(){return this.selectedEntries.map(t=>this.getValue(t))}get selectedValue(){const t=this.selectedEntry;if(t)return this.getValue(t)}get selectedSecondaryValues(){return this.selectedEntries.map(t=>this.getSecondaryValue(t))}get selectedSecondaryValue(){const t=this.selectedEntry;if(t)return this.getSecondaryValue(t)}get stringSelectedValue(){return this.selectedEntries.map(t=>Dt(this.getValue(t))).join(", ")}clear(){this.enableObserver(!1);for(const t of this.entries)this.clearEntryData(t),this.onEntryRemoved(t),this.parent&&t instanceof HTMLElement&&t.remove();this._entries=[],this.refreshInputField(),this.enableObserver(!0)}refreshInputField(){this.inputField&&(this.inputField.value=this.stringSelectedValue)}destroy(){return this.enableObserver(!1),this.parentObserver=null,this}enableObserver(t){if(!t)return this.parentObserver?.disconnect();this.parent instanceof Element&&this.parentObserver&&this.parentObserver.observe(this.parent,{childList:!0})}initializeSelection(){if(this.forceSelection&&this.enabledEntries.length&&0===this.selectedEntries.length){const t=this.enabledEntries[0];t&&this.select(t)}}setupParentObserver(){this.enableObserver(!1),this.parentObserver=new MutationObserver(t=>{for(const e of t){for(const t of e.addedNodes){if(!(t instanceof Element)||t.parentElement!==this.parent)continue;if(t===this.inputField)continue;const e=t,s=Array.from(this.parent.children).filter(t=>t!==this.inputField).filter(t=>this.entries.includes(t)||t===e),n=s.indexOf(e);if(!(n<0)){if(0===n)this.entries.splice(n,0,e);else{const t=this.entries.indexOf(s[n-1]);this.entries.splice(t+1,0,e)}this.getEntryData(e),this.onEntryAdded?.call(this,e,this.getIndex(e))}}for(const t of e.removedNodes)t instanceof Element&&t!==this.inputField&&queueMicrotask(()=>{if(t.isConnected)return;const e=this.getEntryData(t);if(e.selected&&this.forceSelection&&this.enabledEntries.length){const t=this.enabledEntries[0];t&&this.select(t)}e.selected=!1,this.onEntryRemoved?.call(this,t),this.clearEntryData(t)})}}),this.enableObserver(!0)}}})();fs(".turbo-drawer{align-items:center;direction:ltr;display:inline-flex}.turbo-drawer-panel-container{align-items:center;display:flex;overflow:hidden;position:relative}.turbo-drawer-thumb{display:inline-block;position:relative}.top-drawer .turbo-drawer-panel-container,.turbo-drawer.top-drawer{flex-direction:column}.bottom-drawer .turbo-drawer-panel-container,.turbo-drawer.bottom-drawer{flex-direction:column-reverse}.left-drawer .turbo-drawer-panel-container,.turbo-drawer.left-drawer{flex-direction:row}.right-drawer .turbo-drawer-panel-container,.turbo-drawer.right-drawer{flex-direction:row-reverse}");class Rs extends Pe{constructor(t){t.states=[""],super(t)}get properties(){const t=super.properties;return"object"==typeof t&&""in t?t[""]:t}set properties(t){super.properties=t}get styles(){const t=super.styles;return"object"==typeof t&&""in t?t[""]:t}set styles(t){super.styles=t}get classes(){const t=super.classes;return"object"==typeof t&&""in t?t[""]:t}set classes(t){super.classes=t}get replaceWith(){const t=super.replaceWith;return"object"==typeof t&&""in t?t[""]:t}set replaceWith(t){super.replaceWith=t}set transition(t){super.transition=t}get transitionProperties(){const t=super.transitionProperties;return"object"==typeof t&&""in t?t[""]:t}set transitionProperties(t){super.transitionProperties=t}get transitionDuration(){const t=super.transitionDuration;return"object"==typeof t&&""in t?t[""]:t}set transitionDuration(t){super.transitionDuration=t}get transitionTimingFunction(){const t=super.transitionTimingFunction;return"object"==typeof t&&""in t?t[""]:t}set transitionTimingFunction(t){super.transitionTimingFunction=t}get transitionDelay(){const t=super.transitionDelay;return"object"==typeof t&&""in t?t[""]:t}set transitionDelay(t){super.transitionDelay=t}initialize(t,e){super.initialize("",t,e)}apply(t,e){super.apply("",t,e)}}function Ws(t){return new Rs(t)}let Ks=(()=>{let s,n,i,a,r,o,l,c,h,u,d,f,p,g=[Ze("turbo-drawer")],b=[],y=ys,v=[],k=[],E=[];return class extends y{static{n=this}static{const S="function"==typeof Symbol&&Symbol.metadata?Object.create(y[Symbol.metadata]??null):void 0;i=[m({setIfUndefined:!0,callBefore:function(){this.thumb&&Ge(this).remChild(this.thumb)},preprocessValue:t=>t instanceof HTMLElement?t:B(t)})],a=[m({setIfUndefined:!0,callBefore:function(){this.panel&&Ge(this).remChild(this.panel),console.log("EWFFEWFWWWWWWWWWWWWWW")},preprocessValue:t=>t instanceof HTMLElement?t:B(t)})],r=[m({callBefore:function(){this.icon?.parentElement===this.thumb&&this.thumb.removeChild(this.icon)},preprocessValue:function(t){return t instanceof Element?t:("string"!=typeof t||this.attachSideToIconName||this.rotateIconBasedOnSide||(this.attachSideToIconName=!0),Ts("object"==typeof t?t:{icon:t,switchReifect:{states:Object.values(je)},defaultState:this.open?this.getOppositeSide():this.side,appendStateToIconName:this.attachSideToIconName}))}})],o=[m({defaultValue:!1})],l=[m({defaultValue:!1})],c=[m({defaultValue:!1})],h=[m({defaultValue:je.bottom,cancelIfUnchanged:!1})],u=[m({defaultValue:{open:0,closed:0},preprocessValue:t=>"number"==typeof t?{open:t,closed:t}:{open:t?.open||0,closed:t?.closed||0}})],d=[m({defaultValue:!1})],f=[m()],p=[m({defaultValueCallback:function(){return new Rs({transitionProperties:["transform",this.isVertical?"height":"width"],transitionDuration:.2,transitionTimingFunction:"ease-out"})},callAfter:function(){this.transition.attachAll(this,this.panelContainer)}})],t(this,null,i,{kind:"setter",name:"thumb",static:!1,private:!1,access:{has:t=>"thumb"in t,set:(t,e)=>{t.thumb=e}},metadata:S},null,v),t(this,null,a,{kind:"setter",name:"panel",static:!1,private:!1,access:{has:t=>"panel"in t,set:(t,e)=>{t.panel=e}},metadata:S},null,v),t(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:t=>"icon"in t,set:(t,e)=>{t.icon=e}},metadata:S},null,v),t(this,null,o,{kind:"setter",name:"hideOverflow",static:!1,private:!1,access:{has:t=>"hideOverflow"in t,set:(t,e)=>{t.hideOverflow=e}},metadata:S},null,v),t(this,null,l,{kind:"setter",name:"attachSideToIconName",static:!1,private:!1,access:{has:t=>"attachSideToIconName"in t,set:(t,e)=>{t.attachSideToIconName=e}},metadata:S},null,v),t(this,null,c,{kind:"setter",name:"rotateIconBasedOnSide",static:!1,private:!1,access:{has:t=>"rotateIconBasedOnSide"in t,set:(t,e)=>{t.rotateIconBasedOnSide=e}},metadata:S},null,v),t(this,null,h,{kind:"setter",name:"side",static:!1,private:!1,access:{has:t=>"side"in t,set:(t,e)=>{t.side=e}},metadata:S},null,v),t(this,null,u,{kind:"setter",name:"offset",static:!1,private:!1,access:{has:t=>"offset"in t,set:(t,e)=>{t.offset=e}},metadata:S},null,v),t(this,null,d,{kind:"setter",name:"open",static:!1,private:!1,access:{has:t=>"open"in t,set:(t,e)=>{t.open=e}},metadata:S},null,v),t(this,null,f,{kind:"setter",name:"translation",static:!1,private:!1,access:{has:t=>"translation"in t,set:(t,e)=>{t.translation=e}},metadata:S},null,v),t(null,null,p,{kind:"field",name:"transition",static:!1,private:!1,access:{has:t=>"transition"in t,get:t=>t.transition,set:(t,e)=>{t.transition=e}},metadata:S},k,E),t(null,s={value:n},g,{kind:"class",name:n.name,metadata:S},null,b),n=s.value,S&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:S}),e(n,b)}_panelContainer=e(this,v);get panelContainer(){return this._panelContainer}dragging=!1;animationOn=!1;resizeObserver;set thumb(t){Ge(t).addClass("turbo-drawer-thumb"),this.initialized&&this.setupUILayout()}get thumb(){}set panel(t){console.log("WEEWFEFEFEFEFFEWFWEFEWFEW"),Ge(t).addClass("turbo-drawer-panel"),this.initialized&&this.setupUILayout()}get panel(){}set icon(t){this.initialized&&this.setupUILayout()}get icon(){}set hideOverflow(t){Ge(this.panelContainer).setStyle("overflow",t?"hidden":"")}set attachSideToIconName(t){this.icon instanceof Os&&(this.icon.appendStateToIconName=t),t&&(this.rotateIconBasedOnSide=!1)}set rotateIconBasedOnSide(t){t&&(this.attachSideToIconName=!1),this.icon instanceof Os&&(this.icon.switchReifect.styles={top:"transform: rotate(180deg)",bottom:"transform: rotate(0deg)",left:"transform: rotate(90deg)",right:"transform: rotate(270deg)"})}set side(t){Ge(this).toggleClass("top-drawer",t==je.top),Ge(this).toggleClass("bottom-drawer",t==je.bottom),Ge(this).toggleClass("left-drawer",t==je.left),Ge(this).toggleClass("right-drawer",t==je.right),this.refresh()}set offset(t){}get offset(){}get isVertical(){return this.side==je.top||this.side==je.bottom}set open(t){t?this.resizeObserver?.observe(this.panel,{box:"border-box"}):this.resizeObserver?.unobserve(this.panel),this.refresh()}set translation(t){switch(this.side){case je.top:case je.bottom:this.hideOverflow?Ge(this.panelContainer).setStyle("height",t+"px"):Ge(this).setStyle("transform",`translateY(${-t}px)`);break;case je.left:case je.right:this.hideOverflow?Ge(this.panelContainer).setStyle("width",t+"px"):Ge(this).setStyle("transform",`translateX(${-t}px)`)}}transition=e(this,k,void 0);get translation(){}initialize(){super.initialize(),this.transition.attachAll(this,this.panelContainer),this.animationOn=!0}setupUIElements(){super.setupUIElements(),this._panelContainer=B({classes:"turbo-drawer-panel-container"})}setupUILayout(){super.setupUILayout(),Ge(this).childHandler=this,Ge(this.panel).addChild(Ge(this).childrenArray.filter(t=>t!==this.panelContainer)),Ge(this).addChild([this.thumb,this.panelContainer]),Ge(this.panelContainer).addChild(this.panel),Ge(this.thumb).addChild(this.icon),Ge(this).childHandler=this.panel}setupUIListeners(){this.thumb.addEventListener(Pt.click,t=>{t.stopImmediatePropagation(),this.open=!this.open}),this.thumb.addEventListener(Tt.dragStart,t=>{t.stopImmediatePropagation(),this.dragging=!0,this.animationOn&&(this.transition.enabled=!1)}),this.thumb.addEventListener(Tt.drag,t=>{this.dragging&&(t.stopImmediatePropagation(),this.translation+=this.isVertical?t.scaledDeltaPosition.y:t.scaledDeltaPosition.x)}),this.thumb.addEventListener(Tt.dragEnd,t=>{if(!this.dragging)return;t.stopImmediatePropagation(),this.dragging=!1;const e=t.positions.first.sub(t.origins.first);switch(this.side){case je.top:this.open&&e.y>100?this.open=!1:!this.open&&e.y<-100&&(this.open=!0);break;case je.bottom:this.open&&e.y<-100?this.open=!1:!this.open&&e.y>100&&(this.open=!0);break;case je.left:this.open&&e.x>100?this.open=!1:!this.open&&e.x<-100&&(this.open=!0);break;case je.right:this.open&&e.x<-100?this.open=!1:!this.open&&e.x>100&&(this.open=!0)}this.refresh()})}getOppositeSide(t=this.side){switch(t){case je.top:return je.bottom;case je.bottom:return je.top;case je.left:return je.right;case je.right:return je.left}}getAdjacentSide(t=this.side){switch(t){case je.top:return je.right;case je.bottom:return je.left;case je.left:return je.top;case je.right:return je.bottom}}refresh(){this.animationOn&&(this.transition.enabled=!0,this.transition.apply()),this.hideOverflow&&Ge(this.panel).setStyle("position","absolute",!0),this.icon instanceof Os&&this.icon.switchReifect.apply(this.open?this.getOppositeSide():this.side),requestAnimationFrame(()=>{this.translation=(this.open?this.offset.open:this.offset.closed)+(this.open?this.isVertical?this.panel.offsetHeight:this.panel.offsetWidth:0),this.hideOverflow&&Ge(this.panel).setStyle("position","relative",!0)})}constructor(){super(...arguments),e(this,E)}},n})();function Hs(t){return t.tag||(t.tag="turbo-drawer"),x({...t,text:void 0})}var Us;!function(t){t.invert="invert",t.offset="offset",t.none="none"}(Us||(Us={}));fs("#turbo-popup-parent-element{display:block;left:0;position:fixed;top:0;z-index:1000}.turbo-popup{display:block;inset:auto;overflow:auto;position:fixed}");let $s=(()=>{let s,n,i,a,r,o,l,c,h,u,d,f,p,g,b=[Ze("turbo-popup")],y=[],v=ys,k=[],E=[],S=[],w=[],C=[];var O=class extends v{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(v[Symbol.metadata]??null):void 0;i=[m({defaultValue:B({parent:document.body,id:"turbo-popup-parent-element"})})],a=[m({defaultValue:document.body})],r=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupAnchor",{x:50,y:0})},preprocessValue:t=>new Zt(t).bound(0,100)})],o=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultAnchorPosition",{x:50,y:100})},preprocessValue:t=>new Zt(t).bound(0,100)})],l=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultViewportMargin",0)},preprocessValue:t=>new Zt(t)})],c=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultOffsetFromAnchor",0)},preprocessValue:t=>new Zt(t)})],h=[m({preprocessValue:t=>"object"!=typeof t?{x:t,y:t}:t,initialValueCallback:function(){return{x:Math.abs(this.anchorPosition.x-50)>25?Us.invert:Us.offset,y:Math.abs(this.anchorPosition.y-50)>25?Us.invert:Us.offset}}})],u=[Ye({clearOnNextFrame:!0})],d=[Ye({clearOnNextFrame:!0})],f=[Ye({clearOnNextFrame:!0})],p=[Ye({clearOnNextFrame:!0})],g=[Ye({clearOnNextFrame:!0})],t(this,null,r,{kind:"setter",name:"popupPosition",static:!1,private:!1,access:{has:t=>"popupPosition"in t,set:(t,e)=>{t.popupPosition=e}},metadata:e},null,k),t(this,null,o,{kind:"setter",name:"anchorPosition",static:!1,private:!1,access:{has:t=>"anchorPosition"in t,set:(t,e)=>{t.anchorPosition=e}},metadata:e},null,k),t(this,null,l,{kind:"setter",name:"viewportMargin",static:!1,private:!1,access:{has:t=>"viewportMargin"in t,set:(t,e)=>{t.viewportMargin=e}},metadata:e},null,k),t(this,null,c,{kind:"setter",name:"offsetFromAnchor",static:!1,private:!1,access:{has:t=>"offsetFromAnchor"in t,set:(t,e)=>{t.offsetFromAnchor=e}},metadata:e},null,k),t(this,null,h,{kind:"setter",name:"fallbackModes",static:!1,private:!1,access:{has:t=>"fallbackModes"in t,set:(t,e)=>{t.fallbackModes=e}},metadata:e},null,k),t(this,null,u,{kind:"getter",name:"rect",static:!1,private:!1,access:{has:t=>"rect"in t,get:t=>t.rect},metadata:e},null,k),t(this,null,d,{kind:"getter",name:"anchorRect",static:!1,private:!1,access:{has:t=>"anchorRect"in t,get:t=>t.anchorRect},metadata:e},null,k),t(this,null,f,{kind:"getter",name:"computedStyle",static:!1,private:!1,access:{has:t=>"computedStyle"in t,get:t=>t.computedStyle},metadata:e},null,k),t(this,null,p,{kind:"getter",name:"anchorComputedStyle",static:!1,private:!1,access:{has:t=>"anchorComputedStyle"in t,get:t=>t.anchorComputedStyle},metadata:e},null,k),t(this,null,g,{kind:"getter",name:"computedMargins",static:!1,private:!1,access:{has:t=>"computedMargins"in t,get:t=>t.computedMargins},metadata:e},null,k),t(null,null,i,{kind:"field",name:"parentElement",static:!0,private:!1,access:{has:t=>"parentElement"in t,get:t=>t.parentElement,set:(t,e)=>{t.parentElement=e}},metadata:e},E,S),t(null,null,a,{kind:"field",name:"anchor",static:!1,private:!1,access:{has:t=>"anchor"in t,get:t=>t.anchor,set:(t,e)=>{t.anchor=e}},metadata:e},w,C),t(null,s={value:n},b,{kind:"class",name:n.name,metadata:e},null,y),O=n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ys.config,defaultPopupPosition:{x:0,y:-100},defaultAnchorPosition:{x:0,y:100},defaultViewportMargin:4,defaultOffsetFromAnchor:{x:0,y:4}};static parentElement=e(n,E,void 0);anchor=(e(this,k),e(this,w,void 0));set popupPosition(t){}get popupPosition(){}set anchorPosition(t){}get anchorPosition(){}set viewportMargin(t){}get viewportMargin(){}set offsetFromAnchor(t){}get offsetFromAnchor(){}set fallbackModes(t){}get fallbackModes(){}get rect(){return this.getBoundingClientRect()}get anchorRect(){return this.anchor.getBoundingClientRect()}get computedStyle(){return window.getComputedStyle(this)}get anchorComputedStyle(){return window.getComputedStyle(this.anchor)}get computedMargins(){return{x:parseFloat(this.computedStyle.marginLeft)+parseFloat(this.computedStyle.marginRight),y:parseFloat(this.computedStyle.marginTop)+parseFloat(this.computedStyle.marginBottom)}}initialize(){super.initialize(),this.show(!1),this.parentElement||He(this).addToParent(O.parentElement)}setupUIListeners(){super.setupUIListeners(),document.addEventListener(Pt.scroll,()=>this.show(!1),{capture:!0,passive:!0}),window.addEventListener(Pt.resize,()=>{He(this).isShown&&this.recomputePosition()},{passive:!0}),He(document.body).on(Pt.click,t=>{if(!He(this).isShown)return;const e=t.target;this.contains(e)||this.anchor instanceof Node&&this.anchor.contains(e)||this.show(!1)},{capture:!0})}recomputePosition(){if(!this.anchor)return;He(this).setStyles({maxHeight:"",maxWidth:""},!0);const t=this.computeAxis(xe.horizontal),e=this.computeAxis(xe.vertical);He(this).setStyles({left:`${t}px`,top:`${e}px`});const s=Math.max(0,Math.min(window.innerWidth-2*this.viewportMargin.x,window.innerWidth-2*this.viewportMargin.x-this.computedMargins.x)),n=Math.max(0,Math.min(window.innerHeight-2*this.viewportMargin.y,window.innerHeight-2*this.viewportMargin.y-this.computedMargins.y));He(this).setStyle("maxWidth",`${s}px`),He(this).setStyle("maxHeight",`${n}px`)}computeAxis(t){const e=t===xe.horizontal?"x":"y",s=t===xe.horizontal?"width":"height",n=t===xe.horizontal?window.innerWidth:window.innerHeight,i=this.anchorRect[t===xe.horizontal?"left":"top"],a=this.rect[s]+this.computedMargins[e],r=this.viewportMargin[e],o=n-this.viewportMargin[e]-a,l=i+this.anchorRect[s]*this.anchorPosition[e]/100-a*this.popupPosition[e]/100+this.offsetFromAnchor[e],c=l>=r&&l<=o;if(c||this.fallbackModes[e]===Us.offset)return Math.min(Math.max(l,r),o);const h=i+this.anchorRect[s]*(1-this.anchorPosition[e]/100)-a*(1-this.popupPosition[e]/100)-this.offsetFromAnchor[e];let u;if(h>=r&&h<=o)u=h;else if(c)u=l;else{const t=Math.abs(l-Math.min(Math.max(l,r),o))<=Math.abs(h-Math.min(Math.max(h,r),o))?l:h;u=Math.min(Math.max(t,r),o)}return u}show(t){return t?(this.style.visibility="hidden",this.style.display="",this.recomputePosition(),this.style.visibility="",He(this).show(!0)):He(this).setStyles({maxHeight:"",maxWidth:""},!0).show(!1),this}constructor(){super(...arguments),e(this,C)}static{e(n,S),e(n,y)}};return O=n})();function Gs(t={}){return x({...t,text:void 0,tag:"turbo-popup"})}fs("turbo-dropdown{display:inline-block;position:relative}turbo-dropdown>.turbo-popup{background-color:#fff;border:.1em solid #5e5e5e;border-radius:.4em;display:flex;flex-direction:column;overflow:hidden}turbo-dropdown>.turbo-popup>turbo-select-entry{padding:.5em}turbo-dropdown>.turbo-popup>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}turbo-dropdown>turbo-select-entry{padding:.5em .7em;width:100%}turbo-dropdown>turbo-select-entry:hover{background-color:#d7d7d7}turbo-dropdown>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}");let qs=(()=>{let s,n,i,a,r,o,l,c,h,u=[Ze("turbo-dropdown")],d=[],f=ys,p=[],g=[],b=[],y=[],v=[],k=[],E=[],S=[],w=[],C=[],O=[];return class extends f{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(f[Symbol.metadata]??null):void 0;i=[m({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorTag")}})],a=[m({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorClasses")},callBefore:function(){He(this.selector).removeClass(this.selectorClasses)},callAfter:function(){He(this.selector).addClass(this.selectorClasses)}})],r=[m({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupClasses")},callBefore:function(){He(this.popup).removeClass(this.popupClasses)},callAfter:function(){He(this.popup).addClass(this.popupClasses)}})],o=[ts("select")],l=[ts("select")],c=[m({setIfUndefined:!0,preprocessValue:function(t){if(t instanceof HTMLElement)return t;const e="string"==typeof t?t:Dt(this.select.getValue(this.entries[0]));if(!(this.selector instanceof ws))return Cs({text:e,elementTag:this.selectorTag});this.selector.text=e}})],h=[m({defaultValueCallback:()=>Gs()})],t(this,null,c,{kind:"setter",name:"selector",static:!1,private:!1,access:{has:t=>"selector"in t,set:(t,e)=>{t.selector=e}},metadata:e},null,p),t(this,null,h,{kind:"setter",name:"popup",static:!1,private:!1,access:{has:t=>"popup"in t,set:(t,e)=>{t.popup=e}},metadata:e},null,p),t(null,null,i,{kind:"field",name:"selectorTag",static:!1,private:!1,access:{has:t=>"selectorTag"in t,get:t=>t.selectorTag,set:(t,e)=>{t.selectorTag=e}},metadata:e},g,b),t(null,null,a,{kind:"field",name:"selectorClasses",static:!1,private:!1,access:{has:t=>"selectorClasses"in t,get:t=>t.selectorClasses,set:(t,e)=>{t.selectorClasses=e}},metadata:e},y,v),t(null,null,r,{kind:"field",name:"popupClasses",static:!1,private:!1,access:{has:t=>"popupClasses"in t,get:t=>t.popupClasses,set:(t,e)=>{t.popupClasses=e}},metadata:e},k,E),t(null,null,o,{kind:"field",name:"entries",static:!1,private:!1,access:{has:t=>"entries"in t,get:t=>t.entries,set:(t,e)=>{t.entries=e}},metadata:e},S,w),t(null,null,l,{kind:"field",name:"values",static:!1,private:!1,access:{has:t=>"values"in t,get:t=>t.values,set:(t,e)=>{t.values=e}},metadata:e},C,O),t(null,s={value:n},u,{kind:"class",name:n.name,metadata:e},null,d),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ys.config,defaultSelectorTag:"h4"};select=(e(this,p),new zs({onEntryAdded:t=>this.onEntryAdded(t)}));popupOpen=!1;selectorTag=e(this,g,void 0);selectorClasses=(e(this,b),e(this,y,void 0));popupClasses=(e(this,v),e(this,k,void 0));entries=(e(this,E),e(this,S,void 0));values=(e(this,w),e(this,C,void 0));onEntryAdded(t){this.select.initializeSelection(),He(t).on(Pt.click,()=>(this.select.select(t,!this.select.isSelected(t)),this.openPopup(!1),!0))}set selector(t){t instanceof HTMLElement&&(He(t).addClass(this.selectorClasses).on(Pt.click,t=>(this.openPopup(!this.popupOpen),!0)),this.popup instanceof $s&&(this.popup.anchor=t),He(this).addChild(t),t instanceof ws&&(this.select.onSelect=()=>t.text=this.stringSelectedValue))}get selector(){}set popup(t){t instanceof $s&&(t.anchor=this.selector),He(t).addClass(this.popupClasses),this.select.parent=t}initialize(){super.initialize(),this.selector,He(document.body).on(Pt.click,()=>t=>{this.popupOpen&&!this.contains(t.target)&&this.openPopup(!1)},{capture:!0})}openPopup(t){this.popupOpen!=t&&(this.popupOpen=t,"show"in this.popup&&"function"==typeof this.popup.show?this.popup.show(t):He(this.popup).show(t))}get selectedValues(){return this.select.selectedValues}get selectedValue(){return this.select.selectedValue}get selectedSecondaryValues(){return this.select.selectedSecondaryValues}get selectedSecondaryValue(){return this.select.selectedSecondaryValue}get stringSelectedValue(){return this.select.stringSelectedValue}constructor(){super(...arguments),e(this,O)}static{e(n,d)}},n})();function Ys(t={}){return t.tag||(t.tag="turbo-dropdown"),x({...t,text:void 0})}let Xs=(()=>{let s,n,i,a,r=[Ze("turbo-marking-menu")],o=[],l=ys,c=[],h=[],u=[],d=[];return class extends l{static{n=this}static{const f="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;i=[m({initialValue:0,preprocessValue:t=>t-Math.PI/2})],a=[m({initialValue:2*Math.PI,preprocessValue:t=>t-Math.PI/2})],t(null,null,i,{kind:"field",name:"startAngle",static:!1,private:!1,access:{has:t=>"startAngle"in t,get:t=>t.startAngle,set:(t,e)=>{t.startAngle=e}},metadata:f},c,h),t(null,null,a,{kind:"field",name:"endAngle",static:!1,private:!1,access:{has:t=>"endAngle"in t,get:t=>t.endAngle,set:(t,e)=>{t.endAngle=e}},metadata:f},u,d),t(null,s={value:n},r,{kind:"class",name:n.name,metadata:f},null,o),n=s.value,f&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f}),e(n,o)}transition;currentOrigin;minDragDistance=20;semiMajor=50;semiMinor=45;startAngle=e(this,c,void 0);endAngle=(e(this,h),e(this,u,void 0));constructor(){super(...arguments),e(this,d)}},n})(),Js=(()=>{let s,n,i,a,r=[Ze("turbo-select-wheel")],o=[],l=ys,c=[];return class extends l{static{n=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;i=[m()],a=[m()],t(this,null,i,{kind:"setter",name:"alwaysOpen",static:!1,private:!1,access:{has:t=>"alwaysOpen"in t,set:(t,e)=>{t.alwaysOpen=e}},metadata:h},null,c),t(this,null,a,{kind:"setter",name:"open",static:!1,private:!1,access:{has:t=>"open"in t,set:(t,e)=>{t.open=e}},metadata:h},null,c),t(null,s={value:n},r,{kind:"class",name:n.name,metadata:h},null,o),n=s.value,h&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),e(n,o)}_currentPosition=(e(this,c),0);_reifect;_size={max:100,min:-100};sizePerEntry=[];positionPerEntry=[];totalSize=0;dragLimitOffset=30;openTimeout=3e3;direction=xe.horizontal;scale={max:1,min:.5};generateCustomStyling;dragging;openTimer;set alwaysOpen(t){t?Ge(document).removeListener(Pt.click,this.closeOnClick):Ge(document).on(Pt.click,this.closeOnClick),this.open=t}closeOnClick=()=>this.open=!1;get isVertical(){return this.direction==xe.vertical}set open(t){Ge(this).setStyle("overflow",t?"visible":"hidden")}get currentPosition(){return this._currentPosition}computeDragValue(t){return-t[this.isVertical?"y":"x"]}clearOpenTimer(){this.openTimer&&clearTimeout(this.openTimer)}setOpenTimer(){this.clearOpenTimer(),"number"!=typeof this.openTimeout||this.openTimeout<0||(this.openTimer=setTimeout(()=>this.open=!1,this.openTimeout))}},n})();class Qs{static config={shadowDOM:!1,defaultSelectedClass:"selected"};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}element;mvc=new Q({element:this});constructor(t={}){this.element=A(t)}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}async function Zs(t){const e=(new TextEncoder).encode(t),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map(t=>t.toString(16).padStart(2,"0")).join("")}async function tn(t,e=12){const s=Math.ceil(6*e/8),n=new TextEncoder,i=await crypto.subtle.digest("SHA-256",n.encode(t)),a=new Uint8Array(i).slice(0,s);return("function"==typeof btoa?btoa(String.fromCharCode(...a)):Buffer.from(a).toString("base64")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"").slice(0,e)}function en(t,e,s,n,i,a=!0){if(a){const n=Math.max(e,s),i=Math.min(e,s);t>n&&(t=n),t<i&&(t=i)}return n+(t-e)*(i-n)/(s-e)}function sn(t){return t instanceof qt?t.scaledPosition:t instanceof PointerEvent?new Zt(t.clientX,t.clientY):void 0}function nn(t){if(!t)return NaN;const e=parseInt(t.substring(1),16);return.2126*((e>>16&255)/255)+.7152*((e>>8&255)/255)+.0722*((255&e)/255)}function an(t,e){if(!t||!e)return NaN;const s=nn(t),n=nn(e);return(Math.max(s,n)+.1)/(Math.min(s,n)+.1)}function rn(t,e="#000000",s="#FFFFFF"){return an(t,s)>an(e,t)?s:e}function on(t,...e){let s="";return t.forEach((t,n)=>{s+=t+(e[n]||"")}),s}le(Qs),oe(Qs),bs(Qs);const ln={900:{Black:"normal",BlackItalic:"italic"},800:{ExtraBold:"normal",ExtraBoldItalic:"italic"},700:{Bold:"normal",BoldItalic:"italic"},600:{SemiBold:"normal",SemiBoldItalic:"italic"},500:{Medium:"normal",MediumItalic:"italic"},400:{Regular:"normal",Italic:"italic"},300:{Light:"normal",LightItalic:"italic"},200:{ExtraLight:"normal",ExtraLightItalic:"italic"},100:{Thin:"normal",ThinItalic:"italic"}};function cn(t,e,s,n,i){return on`
        @font-face {
            font-family: "${t}";
            src: url("${e}") format("${s}"), 
            url("${e}") format("woff"),
            url("${e}") format("truetype");
            font-weight: ${"string"==typeof n?'"'+n+'"':n};
            font-style: "${i}";
        }`}function hn(t){t.name&&t.pathOrDirectory||console.error("Please specify font name and path/directory");const e=0==At(t.pathOrDirectory).length;t.stylesPerWeights||(t.stylesPerWeights=e?ln:{normal:"normal"}),t.format||(t.format="woff2"),t.extension||(t.extension=".ttf"),"."!=t.extension[0]&&(t.extension="."+t.extension),X(Object.entries(t.stylesPerWeights).map(([e,s])=>{const n=Number.parseInt(e),i=n||e;return"string"==typeof s?cn(t.name,t.pathOrDirectory,t.format,i,s):Object.entries(s).map(([e,s])=>cn(t.name,`${t.pathOrDirectory}/${t.name}-${e}${t.extension}`,t.format,i,s)).join("\n")}).join("\n"))}let un=(()=>{let a,r=mt,o=[];return class extends r{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;a=[m()],t(this,null,a,{kind:"setter",name:"enabledCallbacks",static:!1,private:!1,access:{has:t=>"enabledCallbacks"in t,set:(t,e)=>{t.enabledCallbacks=e}},metadata:e},null,o),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}constructor(t,s){super(t,s),e(this,o)}get data(){return super.data}set data(t){t instanceof s&&(super.data=t)}set enabledCallbacks(t){this.getAllBlocks().forEach(e=>{e.observer&&e.data&&(t?e.data.observe(e.observer):e.data.unobserve(e.observer))})}getData(t,e=this.defaultBlockKey){const s=this.getBlockData(e);if(s instanceof n)return s.get(t.toString());if(s instanceof i){const e=Number(t);if(e>=0&&e<s.length)return s.get(e)}return null}setData(t,e,s=this.defaultBlockKey){const a=this.getBlockData(s);if(a instanceof n)a.set(t.toString(),e);else if(a instanceof i){const s=Number(t);if(s<0)return;s<a.length&&a.delete(s,1),a.insert(s,[e])}}getSize(t=this.defaultBlockKey){const e=this.getBlockData(t);return e instanceof n||e instanceof i?e instanceof i?e.length:e.size:0}createBlock(t,e,s=this.defaultBlockKey){return{...super.createBlock(t,e),observer:(t,e)=>this.observeChanges(t,e,s)}}setBlock(t,e,s=this.defaultBlockKey,n=!0){if(this.enabledCallbacks){const t=this.getBlock(s);t&&t.data&&t.observer&&t.data.unobserve(t.observer)}this.clear(s),super.setBlock(t,e,s,n)}initialize(t=this.defaultBlockKey){super.initialize(t);const e=this.getBlock(t);e?.data?.observe(e?.observer)}getAllKeys(t=this.defaultComputationBlockKey){const e=[];for(const s of this.getAllBlocks(t)){const t=s.data;if(t instanceof n)e.push(...Array.from(t.keys()));else if(t instanceof i)for(let s=0;s<t.length;s++)e.push(s)}return e}getAllObservers(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).map(t=>t.observer)}}})();class dn extends un{observeChanges(t,e,s){t.keysChanged.forEach(e=>{const n=t.changes.keys.get(e);n?this.fireKeyChangedCallback(e,s,"delete"===n?.action):console.warn(`No change info for key "${e}". Event:`,t)})}}class fn extends un{changeObservers=new ne;constructor(t,e){super(t,e)}generateObserver(t={}){const e={onAdded:new tt,onUpdated:new tt,onDeleted:new tt,instances:new Map,getInstance:(t,s=this.defaultComputationBlockKey)=>this.getInstance(e,t,s),getAllInstances:(t=this.defaultComputationBlockKey)=>this.getAllInstances(e,t),initialize:t=>{if(this.isInitialized.get(t))for(const s of this.getAllKeys(t))this.fireKeyChangedCallbackForObserver(e,this.getData(s,t),s,t)},clear:(t=this.defaultComputationBlockKey)=>this.clearInstances(e,t),destroy:()=>{this.getAllBlockKeys().forEach(t=>e.clear(t)),this.changeObservers?.delete(e)}};if(e.onUpdated.add((t,e,s)=>{"object"==typeof e&&("data"in e&&(e.data=t),"dataId"in e&&(e.dataId=s.toString()))}),e.onDeleted.add((t,s,n,i)=>{this.removeInstance(s),this.getInstancesMaps(e,i).forEach(t=>t.delete(n))}),t.onAdded&&e.onAdded.add((e,s,n)=>t.onAdded(e,s,n)),t.onUpdated&&e.onUpdated.add((e,s,n,i)=>t.onUpdated(e,s,n,i)),t.onDeleted&&e.onDeleted.add((e,s,n,i)=>t.onDeleted(e,s,n,i)),t.initialize)for(const t of this.getAllBlockKeys())e.initialize(t);return this.changeObservers?.add(e),e}clear(t=this.defaultComputationBlockKey){super.clear(t),this.changeObservers?.toArray().forEach(e=>this.clearInstances(e,t))}getAllData(t=this.defaultComputationBlockKey){return super.getAllData(t)}fireKeyChangedCallback(t,e=this.defaultBlockKey,s=!1){if(!this.getAllKeys(e).includes(t))return super.fireKeyChangedCallback(t,e,s);const n=this.getData(t,e);this.changeObservers?.toArray().forEach(s=>this.fireKeyChangedCallbackForObserver(s,n,t,e))}fireKeyChangedCallbackForObserver(t,e,s,n=this.defaultBlockKey){t.instances.has(n)||t.instances.set(n,new Map);const i=t.instances.get(n),a=i.get(s);if(a)return void t.onUpdated.fire(e,a,s,n);const r=t.onAdded.fire(e,s,n);r&&(i.set(s,r),t.onUpdated.fire(e,r,s,n))}getInstancesMaps(t,e,s=!1){const n=[];if(null!==e){const s=t.instances.get(e);s&&n.push(s)}else{const e=this.getAllBlockKeys();s&&e.sort(this.sortingFunction);for(const s of e){const e=t.instances.get(s);e&&n.push(e)}}return n}getInstance(t,e,s=this.defaultComputationBlockKey){for(const n of this.getInstancesMaps(t,s))if(n.has(e))return n.get(e);return null}getAllInstances(t,e=this.defaultComputationBlockKey){const s=this.getInstancesMaps(t,e,!0);if(!this.isDataBlocksArray)return s.flatMap(t=>Array.from(t.values())||[]);let n=[];for(const t of s){const e=Array.from(t.entries());e.sort((t,e)=>this.sortingFunction(t[0],e[0])),n=n.concat(...e.map(t=>t[1]))}return n}removeInstance(t){t&&"object"==typeof t&&"remove"in t&&"function"==typeof t.remove&&t?.remove()}clearInstances(t,e=this.defaultComputationBlockKey){this.getInstancesMaps(t,e).forEach(t=>{t.forEach(t=>this.removeInstance(t)),t.clear()})}sortingFunction(t,e){return"string"==typeof t&&"string"==typeof e?t.localeCompare(e):"number"==typeof t&&"number"==typeof e?t-e:0}observeChanges(t,e,s=this.defaultBlockKey){if(t instanceof a)t.keysChanged.forEach(e=>{const n=t.changes.keys.get(e);switch(n.action){case"add":this.fireKeyChangedCallback(e,s);break;case"delete":this.changeObservers?.toArray().forEach(t=>t.onDeleted.fire(n.oldValue,this.getInstance(t,e,s),e,s));break;case"update":this.changeObservers?.toArray().forEach(t=>t.onUpdated.fire(this.getData(e,s),this.getInstance(t,e,s),e,s))}});else if(t instanceof r){let e=0;for(const n of t.delta)if(void 0!==n.retain)e+=n.retain;else if(n.insert){const t=(Array.isArray(n.insert)?n.insert:[n.insert]).length;this.changeObservers?.toArray().forEach(n=>this.shiftIndices(n,e,t,s));for(let n=0;n<t;n++)this.fireKeyChangedCallback(e+n,s);e+=t}else if(n.delete){const t=n.delete;for(let n=0;n<t;n++)this.changeObservers?.toArray().forEach(t=>t.onDeleted.fire(void 0,this.getInstance(t,e+n,s),e+n,s));this.changeObservers?.toArray().forEach(n=>this.shiftIndices(n,e+t,-t,s))}}}shiftIndices(t,e,s,n=this.defaultBlockKey){const i=this.getInstancesMaps(t,n)[0];if(!i)return;const a=[];for(const[t,s]of i.entries()){const n=Number(t);n>=e&&a.push([n,s])}a.sort((t,e)=>t[0]-e[0]);for(const[t]of a)i.delete(t);for(const[t,e]of a){const n=t+s;"object"==typeof e&&"dataId"in e&&(e.dataId=n),i.set(t+s,e)}}}function pn(t){const e=new n;for(const[s,n]of Object.entries(t))e.set(s,n);return e}function mn(t){const e=new i;return e.push(t),e}async function gn(t,e,s){const n=async()=>await tn(e?.doc?.clientID?.toString(32)+xs());if(!s)for(s=await n();void 0!==e?.get(s);)s=await n();return e.set(s,t),s}function bn(t,e,s){return null==s||s>e.length?(s=e.length,e.push([t])):(s<0&&(s=0),e.insert(s,[t])),s}function yn(t,e){for(const[s,n]of e.toArray())if(t==n)return e.delete(s),!0;return!1}function vn(t,e,...s){if(!t)return;const i=new Set(s);t.observeDeep(t=>{for(const s of t){const t=s.target,o=t._item?.parent,l=t._item?.parentSub;for(const c of i)if(s instanceof a&&s.changes.keys.has(c)||s instanceof r&&o instanceof n&&l===c||s.path?.some(t=>t===c))return void e(c,s,t)}})}function kn(t,e,...s){if(!t)return;const i=new Set(s);t.observeDeep(t=>{const s=new Set;for(const o of t){const t=o.target,l=t._item?.parent,c=t._item?.parentSub;for(const t of i)(o instanceof a&&o.changes.keys.has(t)||o instanceof r&&l instanceof n&&c===t||o.path?.some(e=>e===t))&&s.add(t);if(s.size===i.size)return void e(o,t)}})}export{Ge as $,_e as AccessLevel,Vt as ActionMode,v as ApplyDefaultsMergeProperties,Bt as BasicInputEvents,_t as ClickMode,Gt as ClosestOrigin,vt as DefaultClickEventName,wt as DefaultDragEventName,Pt as DefaultEventName,bt as DefaultKeyEventName,Et as DefaultMoveEventName,Ot as DefaultWheelEventName,tt as Delegate,xe as Direction,Ie as InOut,Ft as InputDevice,C as MathMLNamespace,T as MathMLTags,Q as Mvc,Nt as NonPassiveEvents,Be as OnOff,Ne as Open,Zt as Point,Us as PopupFallbackMode,Fe as Range,Rs as Reifect,Le as ReifectHandler,Ve as Shown,je as Side,Ae as SideH,Me as SideV,Pe as StatefulReifect,w as SvgNamespace,O as SvgTags,Ls as TurboBaseElement,ws as TurboButton,yt as TurboClickEventName,Xt as TurboController,ee as TurboDragEvent,St as TurboDragEventName,Ks as TurboDrawer,qs as TurboDropdown,ys as TurboElement,J as TurboEmitter,qt as TurboEvent,he as TurboEventManager,Tt as TurboEventName,ae as TurboHandler,ce as TurboHeadlessElement,vs as TurboIcon,Os as TurboIconSwitch,Ps as TurboIconToggle,Bs as TurboInput,hs as TurboInteractor,Yt as TurboKeyEvent,gt as TurboKeyEventName,Lt as TurboMap,Xs as TurboMarkingMenu,mt as TurboModel,kt as TurboMoveEventName,Vs as TurboNumericalInput,$s as TurboPopup,Qs as TurboProxiedElement,Es as TurboRichElement,zs as TurboSelect,Fs as TurboSelectInputEvent,Js as TurboSelectWheel,g as TurboSelector,us as TurboSubstrate,ds as TurboTool,cs as TurboView,ne as TurboWeakSet,Qt as TurboWheelEvent,Ct as TurboWheelEventName,dn as YComponentModel,fn as YManagerModel,un as YModel,j as a,bn as addInYArray,gn as addInYMap,Se as areEqual,m as auto,rn as bestOverlayColor,A as blindElement,ot as blockIdSignal,rt as blockSignal,Cs as button,Ye as cache,ke as callOnce,Ee as callOncePerInstance,Mt as camelToKebabCase,I as canvas,Xe as clearCache,Je as clearCacheEntry,an as contrast,Rt as controller,ms as createProxy,mn as createYArray,pn as createYMap,on as css,kn as deepObserveAll,vn as deepObserveAny,Ze as define,ft as disposeEffect,pt as disposeEffects,B as div,Hs as drawer,Ys as dropdown,Ce as eachEqualToAny,lt as effect,x as element,we as equalToAny,ts as expose,gs as fetchSvg,is as flexCol,as as flexColCenter,rs as flexRow,os as flexRowCenter,N as form,M as generateTagFunction,sn as getEventPosition,At as getFileExtension,o as getFirstDescriptorInChain,c as getFirstPrototypeInChainWith,ct as getSignal,u as getSuperDescriptor,h as getSuperMethod,V as h1,_ as h2,F as h3,L as h4,z as h5,R as h6,Wt as handler,l as hasPropertyInChain,tn as hashBySize,Zs as hashString,ks as icon,Ts as iconSwitch,Ds as iconToggle,W as img,dt as initializeEffects,K as input,Kt as interactor,D as isMathMLTag,d as isNull,P as isSvgTag,f as isUndefined,jt as kebabToCamelCase,en as linearInterpolation,H as link,hn as loadLocalFont,nn as luminance,ut as markDirty,Te as mod,at as modelSignal,_s as numericalInput,ss as observe,U as p,xt as parse,Gs as popup,Ms as randomColor,As as randomFromRange,xs as randomId,js as randomString,Ws as reifect,yn as removeFromYArray,Ss as richElement,ht as setSignal,S as setupClassFunctions,It as setupElementFunctions,de as setupEventFunctions,y as setupHierarchyFunctions,k as setupMiscFunctions,We as setupReifectFunctions,pe as setupStyleFunctions,ye as setupSubstrateFunctions,ge as setupToolFunctions,it as signal,ns as solver,ls as spacer,$ as span,De as statefulReifier,Dt as stringify,G as style,X as stylesheet,Ut as substrate,$e as t,ps as textToElement,q as textarea,Ht as tool,Oe as trim,Ue as tu,He as turbo,Ns as turboInput,qe as turbofy,Y as video};
