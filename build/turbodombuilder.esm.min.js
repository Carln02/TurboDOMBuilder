function t(t){return function(e,i,s){const n=s?.get,r=s?.set;if(!r&&!t?.callBefore)return s;const o=Symbol(`__${String(i)}__`),a=function(){if(n){const e=n.call(this);if(t?.returnDefinedGetterValue)return e}return this[o]},l=function(e){0!=t?.cancelIfUnchanged&&e==this[o]||(t?.callBefore&&(e=function(){return t.callBefore.call(this,e)}.call(this)),this[o]=e,r&&r.call(this,e))};return s?(!t?.returnDefinedGetterValue&&n||(s.get=a),s.set=l):Object.defineProperty(e,i,{get:a,set:l,enumerable:!0,configurable:!0}),s}}function e(t,e,i=Object.getOwnPropertyDescriptor(t,e)){const s=i?.value;if(!s)throw new Error(`No method ${e} found on target`);const n=Symbol(`__callOnce__${e}`);return i.value=function(...t){if(!this[n])return this[n]=!0,s.apply(this,t);console.warn(`Function ${e} has already been called once on this instance and will not be called again.`)},i}function i(t,e=Symbol(`__callOncePerInstance__${t.name}`)){return function(...i){if(!this[e])return this[e]=!0,t.apply(this,i)}}function s(t={}){return function(e,s,o=Object.getOwnPropertyDescriptor(e,s)){const a=o?.value||o?.get;if(!a)throw new Error(`No method ${s} found on target`);const l=!!o.get,c=Symbol(`__cache__${s}`),h=Symbol(`__cache__setup__${s}`),u=[],d=function(t=!0){n.call(this,l,c,u,t)},p=i((function(i){!function(t,e,i,s,n){if(i.onEvent){const e="function"==typeof s.addEventListener?s:document;(Array.isArray(i.onEvent)?i.onEvent:i.onEvent.split(" ")).forEach((i=>e.addEventListener(i,(()=>n.call(t)))))}if(i.onFieldChange){(Array.isArray(i.onFieldChange)?i.onFieldChange:[i.onFieldChange]).forEach((i=>{"string"==typeof i?i.split(" ").forEach((i=>r(t,i,e,n))):r(t,i.name,e,n)}))}if(i.onCallback){const e=setInterval((()=>{const e=i.onCallback.call(t);e instanceof Promise?e.then((e=>n.call(t,e))):n.call(t,e)}),i.onCallbackFrequency||50);"function"==typeof s.addEventListener&&s.addEventListener("destroy",(()=>clearInterval(e)))}}(i,s,t,e,d)}),h);l?o.get=function(){const i=this||e;return i[c]||(p.call(i,i),i[c]=a.apply(i),t.timeout&&u.push(setTimeout((()=>d.call(i)),t.timeout)),t.clearOnNextFrame&&requestAnimationFrame((()=>d.call(i)))),i[c]}:o.value=function(...i){const s=this||e;s[c]||(s[c]=new Map,p.call(s,s));const n=0==i.length?"__no_args__":JSON.stringify(i.map((t=>"function"==typeof t?`function:${t.name}`:"object"==typeof t&&null!=t?JSON.stringify(Object.entries(t).sort()):null==t?"undefined":t)));if(s[c].has(n))return s[c].get(n);{const e=a.apply(s,i);return s[c].set(n,e),t.timeout&&u.push(setTimeout((()=>s[c].delete(n)),t.timeout)),t.clearOnNextFrame&&requestAnimationFrame((()=>d.call(s))),e}}}}function n(t,e,i,s){s&&(t?delete this[e]:this[e]?.clear(),i.forEach((t=>clearTimeout(t))),i.splice(0,i.length))}function r(t,e,i,s){const n=t[e];if(null!=n)if("function"==typeof n)t[e]=function(...e){return s.call(t),n.apply(t,e)};else{const i=Object.getOwnPropertyDescriptor(t,e);console.log(i),Object.defineProperty(t,e,{get:()=>i?.get?.call(t)||t[n],set(e){s.call(t),i?.set?i.set.call(t,e):t[n]=e},configurable:!0,enumerable:!0})}else console.warn(`No method ${i} found on target. It will be ignored.`)}function o(t){for(const e of Object.getOwnPropertySymbols(t))e.toString().startsWith("Symbol(__cache__)")&&delete t[e]}function a(t,e){const i="function"==typeof e?e.name:e,s=Object.getOwnPropertySymbols(t).find((t=>t.toString()===`Symbol(__cache__${i})`));s&&t[s]&&delete t[s]}function l(t){if(null==t)return"";switch(typeof t){case"string":return t;case"number":case"boolean":case"bigint":case"symbol":case"function":return t.toString();case"object":if(Array.isArray(t))return JSON.stringify(t);if(t instanceof Date)return t.toISOString();try{return JSON.stringify(t)}catch{return"[object Object]"}default:return String(t)}}function c(t){switch(t){case"":return;case"null":return null;case"true":return!0;case"false":return!1}if(!isNaN(Number(t)))return Number(t);if(/^\d+n$/.test(t))return BigInt(t.slice(0,-1));if(t.startsWith("function")||t.startsWith("("))try{const e=new Function(`return (${t})`)();if("function"==typeof e)return e}catch{}try{const e=JSON.parse(t);if("object"==typeof e&&null!=e)return e}catch{}return t}function h(t){if(!t||0==t.length)return"";const e=t.match(/\.\S{1,4}$/);return e?e[0]:""}function u(t){if(t&&0!=t.length)return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function d(t){if(t&&0!=t.length)return t.replace(/-([a-z])/g,(t=>t[1].toUpperCase()))}const p=t=>e=>{customElements.define(t||u(e.name),e)};function f(t,e){let i=t.constructor;i.observedAttributes||(i.observedAttributes=[]);const s=u(e),n=Symbol(`__observed__${e}`);i.observedAttributes.push(s);let r=function(t,e){for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Object.getPrototypeOf(t)}}(i.prototype,e)||{enumerable:!0,configurable:!0};Object.defineProperty(i.prototype,e,{get:r.get||function(){return this[n]},set:function(t){this[e]!==t&&(r.set?r.set.call(this,t):this[n]=t,"function"==typeof this.setAttribute&&this.setAttribute(s,l(this[n])))},enumerable:r.enumerable,configurable:r.configurable})}const m="http://www.w3.org/2000/svg",g="http://www.w3.org/1998/Math/MathML",y={a:SVGAElement,animate:SVGAnimateElement,animateMotion:SVGAnimateMotionElement,animateTransform:SVGAnimateTransformElement,circle:SVGCircleElement,clipPath:SVGClipPathElement,defs:SVGDefsElement,desc:SVGDescElement,ellipse:SVGEllipseElement,feBlend:SVGFEBlendElement,feColorMatrix:SVGFEColorMatrixElement,feComponentTransfer:SVGFEComponentTransferElement,feComposite:SVGFECompositeElement,feConvolveMatrix:SVGFEConvolveMatrixElement,feDiffuseLighting:SVGFEDiffuseLightingElement,feDisplacementMap:SVGFEDisplacementMapElement,feDistantLight:SVGFEDistantLightElement,feDropShadow:SVGFEDropShadowElement,feFlood:SVGFEFloodElement,feFuncA:SVGFEFuncAElement,feFuncB:SVGFEFuncBElement,feFuncG:SVGFEFuncGElement,feFuncR:SVGFEFuncRElement,feGaussianBlur:SVGFEGaussianBlurElement,feImage:SVGFEImageElement,feMerge:SVGFEMergeElement,feMergeNode:SVGFEMergeNodeElement,feMorphology:SVGFEMorphologyElement,feOffset:SVGFEOffsetElement,fePointLight:SVGFEPointLightElement,feSpecularLighting:SVGFESpecularLightingElement,feSpotLight:SVGFESpotLightElement,feTile:SVGFETileElement,feTurbulence:SVGFETurbulenceElement,filter:SVGFilterElement,foreignObject:SVGForeignObjectElement,g:SVGGElement,image:SVGImageElement,line:SVGLineElement,linearGradient:SVGLinearGradientElement,marker:SVGMarkerElement,mask:SVGMaskElement,metadata:SVGMetadataElement,mpath:SVGMPathElement,path:SVGPathElement,pattern:SVGPatternElement,polygon:SVGPolygonElement,polyline:SVGPolylineElement,radialGradient:SVGRadialGradientElement,rect:SVGRectElement,script:SVGScriptElement,set:SVGSetElement,stop:SVGStopElement,style:SVGStyleElement,svg:SVGSVGElement,switch:SVGSwitchElement,symbol:SVGSymbolElement,text:SVGTextElement,textPath:SVGTextPathElement,title:SVGTitleElement,tspan:SVGTSpanElement,use:SVGUseElement,view:SVGViewElement},b={annotation:MathMLElement,"annotation-xml":MathMLElement,maction:MathMLElement,math:MathMLElement,merror:MathMLElement,mfrac:MathMLElement,mi:MathMLElement,mmultiscripts:MathMLElement,mn:MathMLElement,mo:MathMLElement,mover:MathMLElement,mpadded:MathMLElement,mphantom:MathMLElement,mprescripts:MathMLElement,mroot:MathMLElement,mrow:MathMLElement,ms:MathMLElement,mspace:MathMLElement,msqrt:MathMLElement,mstyle:MathMLElement,msub:MathMLElement,msubsup:MathMLElement,msup:MathMLElement,mtable:MathMLElement,mtd:MathMLElement,mtext:MathMLElement,mtr:MathMLElement,munder:MathMLElement,munderover:MathMLElement,semantics:MathMLElement};function E(t){return Object.keys(y).includes(t)||t?.startsWith("svg")}function v(t){return Object.keys(b).includes(t)||t?.startsWith("math")}function S(t={}){let e;return e=t.namespace?"svg"==t.namespace?document.createElementNS(m,t.tag||"svg"):"mathML"==t.namespace?document.createElementNS(g,t.tag||"math"):document.createElementNS(t.namespace,t.tag||"div"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),e.setProperties(t),e}function k(t={}){let e;return e=E(t.tag)?document.createElementNS(m,t.tag||"svg"):v(t.tag)?document.createElementNS(g,t.tag||"math"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),e.setProperties(t),e}function w(t){return(e={})=>(e.tag=t,S({...e,tag:t}))}function x(t={}){return S({...t,tag:"a"})}function C(t={}){return S({...t,tag:"canvas"})}function P(t={}){return S({...t,tag:"div"})}function T(t={}){return S({...t,tag:"form"})}function M(t={}){return S({...t,tag:"h1"})}function O(t={}){return S({...t,tag:"h2"})}function D(t={}){return S({...t,tag:"h3"})}function I(t={}){return S({...t,tag:"h4"})}function L(t={}){return S({...t,tag:"h5"})}function V(t={}){return S({...t,tag:"h6"})}function A(t={}){return S({...t,tag:"img"})}function N(t={}){return S({...t,tag:"input"})}function j(t={}){return S({...t,tag:"link"})}function B(t={}){return S({...t,tag:"p"})}function F(t={}){return S({...t,tag:"span"})}function _(t={}){return S({...t,tag:"style"})}function z(t={}){return S({...t,tag:"textarea"})}function R(t={}){return S({...t,tag:"video"})}function G(t){const e=S(t);return e.setStyles({display:"flex",flexDirection:"column"},!0),e}function W(t){const e=G(t);return e.setStyles({justifyContent:"center",alignItems:"center"},!0),e}function K(t){const e=S(t);return e.setStyles({display:"flex",flexDirection:"row"},!0),e}function U(t){const e=K(t);return e.setStyles({justifyContent:"center",alignItems:"center"},!0),e}function $(t){const e=S(t);return e.setStyle("flexGrow",1,!0),e}function H(t,e=document.head){if(!t)return;const i=_({innerHTML:t});e.addChild(i)}function q(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}"function"==typeof SuppressedError&&SuppressedError;class X{callbacks=new Map;model;constructor(t){this.model=t}getBlock(t){return this.callbacks.get(t?.toString())}getOrGenerateBlock(t){return this.callbacks.has(t.toString())||this.callbacks.set(t.toString(),new Map),this.callbacks.get(t.toString())}getKey(t,e){const i=this.getBlock(e);return i?i.get(t):[]}getOrGenerateKey(t,e){const i=this.getOrGenerateBlock(e);return i.has(t)||i.set(t,[]),i.get(t)}addWithBlock(t,e,i){this.getOrGenerateKey(t,e).push(i)}add(t,e){this.addWithBlock(t,this.model.defaultBlockKey,e)}removeWithBlock(t,e,i){if(null==i)this.getBlock(e)?.delete(t);else{const s=this.getKey(t,e),n=s.indexOf(i);n>=0&&s.splice(n,1)}}remove(t,e){this.removeWithBlock(t,this.model.defaultBlockKey,e)}fireWithBlock(t,e,...i){this.callbacks.get(e.toString())?.get(t)?.forEach((t=>{t&&"function"==typeof t&&t(...i)}))}fire(t,...e){this.fireWithBlock(t,this.model.defaultBlockKey,...e)}}class Y{element;_model;controllers=new Map;interactors=new Map;constructor(t){t.element&&(this.element=t.element),t.emitter&&(this.emitter=t.emitter),t.view&&(this.view=t.view),t.model&&(this.model=t.model,t.data&&(this.model.data=t.data)),t.generate&&this.generate(t)}set view(t){this.linkModelToView()}get model(){return this._model}set model(t){this.deLinkModelFromEmitter(),this._model=t,this.linkModelToEmitter(),this.linkModelToView()}set emitter(t){this.linkModelToEmitter()}get data(){return this.model?.data}set data(t){this.model&&(this.model.data=t)}get dataId(){return this.model?.dataId}set dataId(t){this.model&&(this.model.dataId=t)}get dataIndex(){return Number.parseInt(this.dataId)}set dataIndex(t){this.model&&(this.model.dataId=t.toString())}get dataSize(){return this.model?.getSize()}findInteractor(t){for(const[e,i]of this.interactors)if(i.tool&&i.tool===t.name)return i}propagatesUp(t,e){const i=this.findInteractor(e);if(i)switch(typeof i.propagateUp){case"boolean":return i.propagateUp;case"function":return i.propagateUp(t);case"object":const e=i.propagateUp[t.eventName];switch(typeof e){case"undefined":return!1;case"boolean":return e;case"function":return e(t)}}}interact(t,e){const i=this.findInteractor(e);if(i)return i.interact(t,e),!0}getController(t){return this.controllers.get(t)}addController(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor)),this.controllers.set(t.keyName,t)}getInteractor(t){return this.interactors.get(t)}addInteractor(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor)),this.interactors.set(t.keyName,t)}getHandler(t){return this.model.getHandler(t)}addHandler(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor)),this.model.addHandler(t.keyName,t)}generate(t={}){if(null==t.initialize&&(t.initialize=!0),!t.modelConstructor||this.model&&!t.force||(this.model=new t.modelConstructor(t.data)),!(t.emitterConstructor||t.modelConstructor||this.model)||this.emitter&&!t.force||(this.emitter=t.emitterConstructor?new t.emitterConstructor(this.model):new X(this.model)),!t.viewConstructor||this.view&&!t.force||(this.view=new t.viewConstructor({element:this.element,model:this.model,emitter:this.emitter})),t.controllerConstructors){const e={element:this.element,view:this.view,model:this.model,emitter:this.emitter};t.controllerConstructors.forEach((t=>this.addController(new t(e))))}if(t.interactorConstructors){const e={element:this.element,view:this.view,model:this.model};t.interactorConstructors.forEach((t=>this.addInteractor(new t(e))))}t.handlerConstructors&&t.handlerConstructors.forEach((t=>this.addHandler(new t(this.model)))),t.initialize&&this.initialize()}initialize(){this.view?.initialize(),this.controllers.forEach((t=>t.initialize())),this.model?.initialize(),this.interactors.forEach((t=>t.initialize()))}linkModelToView(){this.view&&this.model&&(this.view.model=this.model)}emitterFireCallback=(t,e,...i)=>this.emitter.fireWithBlock(t,e,...i);deLinkModelFromEmitter(){this.emitter&&this.model&&this.model.keyChangedCallback.remove(this.emitterFireCallback)}linkModelToEmitter(){this.emitter&&this.model&&(this.emitter.model=this.model,this.model.keyChangedCallback.add(this.emitterFireCallback))}extractClassEssenceName(t){let e=t.name,i=Object.getPrototypeOf(this.element);for(;i&&i.constructor!==Object;){const t=i.constructor.name;if(e.startsWith(t)){e=e.slice(t.length);break}i=Object.getPrototypeOf(i)}return e.endsWith("Handler")?e=e.slice(0,-7):e.endsWith("Controller")&&(e=e.slice(0,-10)),e.charAt(0).toLowerCase()+e.slice(1)}}q([t()],Y.prototype,"view",null),q([t()],Y.prototype,"emitter",null);class J{keyName;element;view;model;emitter;constructor(t){this.element=t.element,this.view=t.view,this.model=t.model,this.emitter=t.emitter}initialize(){this.setupChangedCallbacks()}setupChangedCallbacks(){}}class Z{keyName;model;constructor(t){this.model=t}}const Q={keyPressed:"turbo-key-pressed",keyReleased:"turbo-key-released"},tt={click:"turbo-click",clickStart:"turbo-click-start",clickEnd:"turbo-click-end",longPress:"turbo-long-press"},et={move:"turbo-move"},it={drag:"turbo-drag",dragStart:"turbo-drag-start",dragEnd:"turbo-drag-end"},st={trackpadScroll:"turbo-trackpad-scroll",trackpadPinch:"turbo-trackpad-pinch",mouseWheel:"turbo-mouse-wheel"},nt={...tt,...Q,...et,...it,...st,selectInput:"turbo-select-input"},rt={keyPressed:"keydown",keyReleased:"keyup",click:"click",clickStart:"mousedown",clickEnd:"mouseup",longPress:nt.longPress,move:"mousemove",drag:nt.drag,dragStart:nt.dragStart,dragEnd:nt.dragEnd,wheel:"wheel",trackpadScroll:"wheel",trackpadPinch:"wheel",mouseWheel:"wheel",scroll:"scroll",input:"input",change:"change",focus:"focus",blur:"blur",resize:"resize"};class ot{keyName;propagateUp;target;tool;element;view;model;constructor(t){this.element=t.element,this.view=t.view,this.model=t.model,this.target=this.element,this.propagateUp=!1}reverseTurboEventName=Object.fromEntries(Object.entries(nt).map((([t,e])=>[e,t])));interact(t,e){const i=this.reverseTurboEventName[t.eventName];i&&"function"==typeof this[i]&&this[i](t,e)}initialize(){}clickStart(t,e){}click(t,e){}clickEnd(t,e){}move(t,e){}dragStart(t,e){}drag(t,e){}dragEnd(t,e){}}class at{callbacks=new Set;add(t){this.callbacks.add(t)}remove(t){return this.callbacks.delete(t)}fire(...t){for(const e of this.callbacks)try{e(...t)}catch(t){console.error("Error invoking callback:",t)}}clear(){this.callbacks.clear()}}class lt{isDataBlocksArray=!1;dataBlocks;handlers=new Map;keyChangedCallback;constructor(t,e){this.keyChangedCallback=new at,"array"===e?(this.isDataBlocksArray=!0,this.dataBlocks=[]):(this.isDataBlocksArray=!1,this.dataBlocks=new Map),this.enabledCallbacks=!0,this.setBlock(t,void 0,this.defaultBlockKey,!1)}get data(){return this.getBlockData()}set data(t){this.setBlock(t)}get dataId(){return this.getBlockId()}set dataId(t){this.setBlockId(t)}set enabledCallbacks(t){}getData(t,e=this.defaultBlockKey){return this.isValidBlockKey(e)?this.getBlockData(e)?.[t]:null}setData(t,e,i=this.defaultBlockKey){if(!this.isValidBlockKey(i))return;const s=this.getBlockData(i);s&&(s[t]=e),this.enabledCallbacks&&this.fireKeyChangedCallback(t,i)}getSize(t=this.defaultBlockKey){return this.getAllKeys(t)?.length??0}getBlock(t=this.defaultBlockKey){if(!this.isValidBlockKey(t))return null;if(this.isDataBlocksArray){const e=Number(t);return Number.isInteger(e)&&e>=0?this.dataBlocks[e]??null:null}return this.dataBlocks.get(t.toString())??null}createBlock(t,e,i=this.defaultBlockKey){return{id:e??null,data:t}}setBlock(t,e,i=this.defaultBlockKey,s=!0){if(!this.isValidBlockKey(i)||null==t)return;const n=this.createBlock(t,e,i);if(this.isDataBlocksArray){const t=Number(i);Number.isInteger(t)&&t>=0&&(this.dataBlocks[t]=n)}else this.dataBlocks.set(i.toString(),n);s&&this.initialize(i)}hasBlock(t){if(this.isDataBlocksArray){const e=Number(t);return Number.isInteger(e)&&e>=0&&e<this.dataBlocks.length}return this.dataBlocks.has(t.toString())}addBlock(t,e,i,s=!0){if(!t)return;if(!this.isDataBlocksArray)return this.setBlock(t,e,i,s);const n=this.createBlock(t,e,i);let r=Number(i);(!Number.isInteger(r)||r<0)&&(r=this.dataBlocks.length),this.dataBlocks.splice(r,0,n),s&&this.initialize(r)}getBlockData(t=this.defaultBlockKey){const e=this.getBlock(t);return e?e.data:null}getBlockId(t=this.defaultBlockKey){const e=this.getBlock(t);return e?e.id:null}setBlockId(t,e=this.defaultBlockKey){if(!t)return;const i=this.getBlock(e);i&&(i.id=t)}fireKeyChangedCallback(t,e=this.defaultBlockKey,i=!1){this.isValidBlockKey(e)||(e=this.getAllBlockKeys()[0]),this.keyChangedCallback.fire(t,e,i?void 0:this.getData(t,e))}fireCallback(t,...e){this.keyChangedCallback.fire(t,this.defaultBlockKey,...e)}fireBlockCallback(t,e=this.defaultBlockKey,...i){this.isValidBlockKey(e)||(e=this.getAllBlockKeys()[0]),this.keyChangedCallback.fire(t,e,...i)}initialize(t=this.defaultBlockKey){const e=this.getAllKeys(t);e&&this.enabledCallbacks&&e.forEach((e=>this.fireKeyChangedCallback(e,t)))}clear(t=this.defaultBlockKey){}get defaultBlockKey(){return this.isDataBlocksArray?0:"__turbo_default_block_key__"}get defaultComputationBlockKey(){return(this.isDataBlocksArray?this.dataBlocks.length:this.dataBlocks.size)>1?null:this.defaultBlockKey}isValidBlockKey(t){return null!=t&&("string"==typeof t&&0!==t.length||"number"==typeof t)}getAllBlockKeys(){return this.isDataBlocksArray?this.dataBlocks.map(((t,e)=>e)):Array.from(this.dataBlocks.keys())}getAllIds(){return this.isDataBlocksArray?this.dataBlocks.map((t=>t.id)):Array.from(this.dataBlocks.values()).map((t=>t.id))}getAllBlocks(t=this.defaultComputationBlockKey){const e=[];if(null!==t){const i=this.getBlock(t);i&&e.push(i)}else for(const t of this.getAllBlockKeys()){const i=this.getBlock(t);i&&e.push(i)}return e}getAllKeys(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap((t=>Object.keys(t.data)))}getAllData(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap((t=>Object.values(t.data)))}getHandler(t){return this.handlers.get(t)}addHandler(t,e){this.handlers.set(t,e)}}q([t()],lt.prototype,"enabledCallbacks",null);class ct{element;model;emitter;constructor(t){this.element=t.element,this.emitter=t.emitter,this.model=t.model}initialize(){this.setupChangedCallbacks(),this.setupUIElements(),this.setupUILayout(),this.setupUIListeners()}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}class ht extends HTMLElement{static config={shadowDOM:!1,defaultSelectedClass:"selected"};mvc;onAttach=new at;onDetach=new at;onAdopt=new at;static configure(t){Object.entries(t).forEach((([t,e])=>{void 0!==e&&(this.config[t]=e)}))}constructor(t={}){super(),this.getPropertiesValue(t.shadowDOM,"shadowDOM")&&this.attachShadow({mode:"open"}),this.setProperties(t,!0),this.mvc=new Y({...t,element:this})}connectedCallback(){this.onAttach.fire()}disconnectedCallback(){this.onDetach.fire()}adoptedCallback(){this.onAdopt.fire()}attributeChangedCallback(t,e,i){i&&i!=e&&(this[d(t)]=c(i))}initializeUI(){this.setupChangedCallbacks(),this.setupUIElements(),this.setupUILayout(),this.setupUIListeners()}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}set selected(t){const e=this.getPropertiesValue(null,"defaultSelectedClass","selected");this.toggleClass(e,t)}get view(){return this.mvc.view}set view(t){this.mvc.view=t}get model(){return this.mvc.model}set model(t){this.mvc.model=t}get data(){return this.mvc.data}set data(t){this.mvc.data=t}get dataId(){return this.mvc.dataId}set dataId(t){this.mvc.dataId=t}get dataIndex(){return this.mvc.dataIndex}set dataIndex(t){this.mvc.dataIndex=t}get dataSize(){return this.mvc.dataSize}propagatesUp(t,e){return this.mvc.propagatesUp(t,e)}interact(t,e){return this.mvc.interact(t,e)}getPropertiesValue(t,e,i){if(null!=t)return t;const s=this.constructor.config[e];return null!=s?s:i}}q([t()],ht.prototype,"selected",null);class ut{static config={};static configure(t){Object.entries(t).forEach((([t,e])=>{void 0!==e&&(this.config[t]=e)}))}mvc;constructor(t={}){this.mvc=new Y({...t,element:this})}set selected(t){}get view(){return this.mvc.view}set view(t){this.mvc.view=t}get model(){return this.mvc.model}set model(t){this.mvc.model=t}get data(){return this.mvc.data}set data(t){this.mvc.data=t}get dataId(){return this.mvc.dataId}set dataId(t){this.mvc.dataId=t}get dataIndex(){return this.mvc.dataIndex}set dataIndex(t){this.mvc.dataIndex=t}get dataSize(){return this.mvc.dataSize}propagatesUp(t,e){return this.mvc.propagatesUp(t,e)}interact(t,e){return this.mvc.interact(t,e)}getPropertiesValue(t,e,i){if(null!=t)return t;const s=this.constructor.config[e];return null!=s?s:i}}q([t()],ut.prototype,"selected",null);class dt{static config={shadowDOM:!1,defaultSelectedClass:"selected"};static configure(t){Object.entries(t).forEach((([t,e])=>{void 0!==e&&(this.config[t]=e)}))}element;mvc;constructor(t={}){this.element=k(t),this.getPropertiesValue(t.shadowDOM,"shadowDOM")&&this.element.attachShadow({mode:"open"}),this.mvc=new Y({...t,element:this})}attributeChangedCallback(t,e,i){i&&i!=e&&(this[d(t)]=c(i))}initializeUI(){this.setupChangedCallbacks(),this.setupUIElements(),this.setupUILayout(),this.setupUIListeners()}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}set selected(t){const e=this.getPropertiesValue(null,"defaultSelectedClass","selected");this.element.toggleClass(e,t)}get view(){return this.mvc.view}set view(t){this.mvc.view=t}get model(){return this.mvc.model}set model(t){this.mvc.model=t}get data(){return this.mvc.data}set data(t){this.mvc.data=t}get dataId(){return this.mvc.dataId}set dataId(t){this.mvc.dataId=t}get dataIndex(){return this.mvc.dataIndex}set dataIndex(t){this.mvc.dataIndex=t}get dataSize(){return this.mvc.dataSize}propagatesUp(t,e){return this.mvc.propagatesUp(t,e)}interact(t,e){return this.mvc.interact(t,e)}getPropertiesValue(t,e,i){if(null!=t)return t;const s=this.constructor.config[e];return null!=s?s:i}}function pt(){const t=Element.prototype.setAttribute,e=Element.prototype.removeAttribute,i=HTMLElement.prototype.blur,s=HTMLElement.prototype.focus;Node.prototype.execute=function(t){return t(this),this},Element.prototype.setAttribute=function(e,i){return t.call(this,e,i?.toString()||"true"),this},Element.prototype.removeAttribute=function(t){return e.call(this,t),this},HTMLElement.prototype.blur=function(){return i.call(this),this},HTMLElement.prototype.focus=function(){return s.call(this),this}}function ft(){const t=Node.prototype.removeChild,e=Element.prototype.remove,i=Element.prototype.closest;Object.defineProperty(Node.prototype,"childHandler",{set:function(t){this.__childHandler__=t},get:function(){return this.__childHandler__?this.__childHandler__:this instanceof Element&&this.shadowRoot?this.shadowRoot:this},configurable:!1,enumerable:!0}),Object.defineProperty(Node.prototype,"childNodesArray",{get:function(){return Array.from(this.childHandler.childNodes)},configurable:!1,enumerable:!0}),Object.defineProperty(Node.prototype,"childrenArray",{get:function(){return this.childNodesArray.filter((t=>1===t.nodeType))},configurable:!1,enumerable:!0}),Object.defineProperty(Node.prototype,"siblingNodes",{get:function(){return this.parentNode?.childNodesArray||[]},configurable:!1,enumerable:!0}),Object.defineProperty(Node.prototype,"siblings",{get:function(){return this.parentElement?.childrenArray},configurable:!1,enumerable:!0}),Node.prototype.bringToFront=function(){return this.parentNode?.addChild(this),this},Node.prototype.sendToBack=function(){return this.parentNode?.addChild(this,0),this},Node.prototype.remove=function(){return this.parentNode?.removeChild(this),this},Element.prototype.remove=function(){return e.call(this),this},Node.prototype.addChild=function(t,e,i=this.childrenArray){if(!this||!t)return this;if(void 0!==e&&(e<0||e>i.length)&&(e=void 0),null!=e)this.addChildBefore(t,i[e]);else try{Array.isArray(t)||(t=[t]),t.forEach((t=>{t&&(this.childHandler.appendChild(t),t.__outName&&!this[t.__outName]&&(this[t.__outName]=t))}))}catch(t){console.error(t)}return this},Node.prototype.removeChild=function(e){if(!this||!e)return this;try{Array.isArray(e)||(e=[e]),e.forEach((e=>{e&&t.call(this.childHandler,e)}))}catch(t){console.error(t)}return this},Node.prototype.addChildBefore=function(t,e){if(!this||!t)return this;if(!e)return this.addChild(t);try{Array.isArray(t)||(t=[t]),t.forEach((t=>{t&&this.childHandler.insertBefore(t,e)}))}catch(t){console.error(t)}return this},Node.prototype.removeChildAt=function(t,e=1,i=this.childrenArray){if(!this||void 0===t||t<0)return this;if(t>=i.length)return this;try{for(let s=t+e-1;s>=t;s--)s>=i.length||this.removeChild(i[s])}catch(t){console.error(t)}return this},Node.prototype.removeAllChildren=function(t=this.childrenArray){if(!this)return this;try{for(let e=0;e<t.length;e++)this.removeChild(t[e])}catch(t){console.error(t)}return this},Node.prototype.childAt=function(t,e=this.childrenArray){if(!this||void 0===t)return null;for(t>=e.length&&(t=e.length-1);t<0;)t+=e.length;return e[t]},Node.prototype.indexOfChild=function(t,e=this.childrenArray){return this&&t?(e instanceof Array||(e=Array.from(e)),e.indexOf(t)):-1},Node.prototype.hasChild=function(t){if(!this||!t)return!1;const e=Array.from(this.childNodes);if(t instanceof Node)return e.includes(t);for(const i of t)if(!e.includes(i))return!1;return!0},Element.prototype.closest=function(t){if(!this||!t)return null;if("string"==typeof t)return i.call(this,t);if("function"==typeof t){let e=this;for(;e&&!(e instanceof t);)e=e.parentElement;return e||null}return null},Node.prototype.findInParents=function(t){if(!t)return!1;t instanceof Node&&(t=[t]);let e=this,i=0;for(;e&&i<t.length;)t.includes(e)&&i++,e=e.parentNode;return i===t.length},Node.prototype.findInSubTree=function(t){if(!t)return!1;t instanceof Node&&(t=[t]);let e=0;const i=s=>{t.includes(s)&&e++,e>=t.length||s.childNodes.forEach((t=>i(t)))};return i(this),e>=t.length},Node.prototype.indexInParent=function(t=this.siblings){return t?t.indexOf(this):-1}}function mt(){function t(t,e,i=(()=>{})){if(!t||!e)return t;try{"string"==typeof e&&(e=e.split(" ")),e.filter((t=>t.trim().length>0)).forEach((t=>i(t)))}catch(t){console.error(t)}return t}Element.prototype.addClass=function(e){return t(this,e,(t=>this.classList.add(t)))},Element.prototype.removeClass=function(e){return t(this,e,(t=>this.classList.remove(t)))},Element.prototype.toggleClass=function(e,i){return t(this,e,(t=>this.classList.toggle(t,i)))},Element.prototype.hasClass=function(t){if(!this||!t)return!1;if("string"==typeof t)return this.classList.contains(t);for(let e of t)if(!this.classList.contains(e))return!1;return!0}}function gt(){Element.prototype.setProperties=function(t={},e=!1){return this?(t.out&&("string"==typeof t.out?this.__outName=t.out:Object.assign(t.out,this)),Object.keys(t).forEach((i=>{switch(i){case"tag":case"namespace":case"shadowDOM":return;case"text":if(!(this instanceof HTMLElement))return;return void(this.innerText=t.text);case"style":if(!(this instanceof HTMLElement||this instanceof SVGElement))return;return void(this.style.cssText+=t.style);case"stylesheet":return void H(t.stylesheet,this.closestRoot);case"id":return void(this.id=t.id);case"classes":return void this.addClass(t.classes);case"listeners":return void Object.keys(t.listeners).forEach((e=>this.addListener(e,t.listeners[e],this)));case"children":return void this.addChild(t.children);case"parent":if(!t.parent)return;return void t.parent.addChild(this);default:if(e)return;try{this[i]=t[i]}catch(t){console.error(t)}return}})),this):this},Node.prototype.destroy=function(){return this.removeAllListeners(),this.remove(),this}}function yt(){Object.defineProperty(Node.prototype,"boundListeners",{value:new Set,writable:!1,configurable:!0,enumerable:!0}),Node.prototype.addListener=function(t,e,i=this,s){const n=t=>{this instanceof Document&&this===document||this instanceof HTMLElement&&this===document.body||"object"==typeof s&&s.propagate||t.stopPropagation(),"object"==typeof e&&e.handleEvent&&e.handleEvent(t),"function"==typeof e&&e(t,this)};return i.boundListeners.add({target:this,type:t,originalListener:e,listener:n,options:s}),this.addEventListener(t,n,s),this},Node.prototype.removeListener=function(t,e,i){for(let s of this.boundListeners)if(s.type===t&&s.originalListener===e&&s.options===i){s.target.removeEventListener(t,s.listener,i),this.boundListeners.delete(s);break}return this},Node.prototype.removeListenersByType=function(t){for(let e of this.boundListeners)e.type===t&&(this.removeEventListener(t,e.listener,e.options),this.boundListeners.delete(e));return this},Node.prototype.removeAllListeners=function(){for(let t of this.boundListeners)this.removeEventListener(t.type,t.listener,t.options),this.boundListeners.delete(t);return this}}function bt(){Object.defineProperty(Node.prototype,"closestRoot",{get:function(){let t=this;for(;t;){if(t instanceof Element&&t.shadowRoot)return t.shadowRoot;t=t.parentElement}return document.head},configurable:!1,enumerable:!0}),Node.prototype.setStyle=function(t,e,i=!1){return t&&null!=e&&(this instanceof HTMLElement||this instanceof SVGElement)?(this.pendingStyles||(this.pendingStyles={}),i?this.style[t]=e.toString():this.pendingStyles[t]=e.toString(),i||this.applyStyles(),this):this},Node.prototype.appendStyle=function(t,e,i=", ",s=!1){if(!t||null==e)return this;if(!(this instanceof HTMLElement||this instanceof SVGElement))return this;this.pendingStyles||(this.pendingStyles={});const n=this.style[t]||"";return i=n.length>0?i:"",s?this.style[t]=n+i+e:this.pendingStyles[t]=n+i+e,s||this.applyStyles(),this},Node.prototype.setStyles=function(t,e=!1){if(!t||"number"==typeof t)return this;if(!(this instanceof HTMLElement||this instanceof SVGElement))return this;if(this.pendingStyles||(this.pendingStyles={}),"string"==typeof t)t.split(";").forEach((t=>{const[i,s]=t.split(":").map((t=>t.trim()));i&&s&&(e?this.style[i]=s:this.pendingStyles[i]=s)}));else for(const[i,s]of Object.entries(t))e?this.style[i]=s.toString():this.pendingStyles[i]=s.toString();return e||this.applyStyles(),this},Node.prototype.applyStyles=function(){(this instanceof HTMLElement||this instanceof SVGElement)&&requestAnimationFrame((()=>{for(const t in this.pendingStyles)"cssText"==t?this.style.cssText+=";"+this.pendingStyles.cssText:this.style[t]=this.pendingStyles[t];this.pendingStyles={}}))}}var Et,vt,St,kt,wt,xt,Ct,Pt,Tt,Mt,Ot,Dt,It,Lt;q([t()],dt.prototype,"selected",null),function(t){t.vertical="vertical",t.horizontal="horizontal"}(Et||(Et={})),function(t){t.left="left",t.right="right"}(vt||(vt={})),function(t){t.top="top",t.bottom="bottom"}(St||(St={})),function(t){t.top="top",t.bottom="bottom",t.left="left",t.right="right"}(kt||(kt={})),function(t){t.in="in",t.out="out"}(wt||(wt={})),function(t){t.on="on",t.off="off"}(xt||(xt={})),function(t){t.open="open",t.closed="closed"}(Ct||(Ct={})),function(t){t.visible="visible",t.hidden="hidden"}(Pt||(Pt={})),function(t){t.public="public",t.protected="protected",t.private="private"}(Tt||(Tt={})),function(t){t.min="min",t.max="max"}(Mt||(Mt={}));class Vt{attachedNode;reifects;_enabled;constructor(t){this.attachedNode=t,this.reifects=[],this._enabled={},this.enabled=!0}attach(...t){return t.forEach((t=>{this.reifects.some((e=>e.deref()==t))||(this.reifects.push(new WeakRef(t)),t.attach(this.attachedNode))})),this}detach(...t){return t.forEach((t=>{const e=this.reifects.find((e=>e.deref()==t));e&&(this.reifects.splice(this.reifects.indexOf(e),1),t.detach(this.attachedNode))})),this}initialize(t,e,i){return t.initialize(e,this.attachedNode,i),this}apply(t,e,i){return t.apply(e,this.attachedNode,i),this}toggle(t,e){return t.toggle(this.attachedNode,e),this}clear(){this.attachedNode instanceof Node&&this.attachedNode.setStyle("transition","",!0)}reload(){this.clear(),this.reifects.forEach((t=>t.deref()?.reloadFor(this.attachedNode)))}reloadTransitions(){this.clear(),this.reifects.forEach((t=>t.deref()?.reloadTransitionFor(this.attachedNode)))}get enabled(){return this._enabled}set enabled(t){if("boolean"==typeof t)this._enabled.global=t;else{if(!t)return;for(const[e,i]of Object.entries(t))this._enabled[e]=i}}getReifectEnabledState(t){return t.getObjectEnabledState(this.attachedNode)}enableReifect(t,e){t.enableObject(this.attachedNode,e)}}function At(t){return null==t&&null!=t}function Nt(t){return void 0===t}function jt(...t){if(t.length<2)return!0;for(let e=0;e<t.length-1;e++)if(t[e]!=t[e+1])return!1;return!0}function Bt(t,...e){if(e.length<1)return!0;for(const i of e)if(t==i)return!0;return!1}function Ft(t,...e){if(e.length<1)return!0;for(const i of e){let e=!1;for(const s of t)i==s&&(e=!0);if(!e)return!1}return!0}function _t(t,e,i=0){return t<i&&(t=i),t>e&&(t=e),t}function zt(t,e=0){for(;t<0;)t+=e;for(;t>=e;)t-=e;return t}class Rt{timeRegex=/^(\d+(?:\.\d+)?)(ms|s)?$/i;attachedObjects=[];_states;values;constructor(t){this.enable({global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0}),this.properties=t.properties||{},this.classes=t.classes||{},this.styles=t.styles||{},this.replaceWith=t.replaceWith||{},this.transition=t.transition??"all 0s linear 0s",t.transitionProperties&&(this.transitionProperties=t.transitionProperties),void 0!==t.transitionDuration&&(this.transitionDuration=t.transitionDuration),t.transitionTimingFunction&&(this.transitionTimingFunction=t.transitionTimingFunction),void 0!==t.transitionDelay&&(this.transitionDelay=t.transitionDelay),t.transition||t.transitionProperties||t.transitionDuration||t.transitionTimingFunction||t.transitionDelay||(this.transitionEnabled=!1),t.states&&(this.states=t.states),t.attachedObjects&&this.attachAll(...t.attachedObjects)}attach(t,e,i){const s=this.getData(t);if(s&&e&&(s.onSwitch=e),!s)return this.attachObject(t,i,e),this}attachAll(...t){return t.forEach((t=>{this.getData(t)||this.attachObject(t)})),this}attachAllAt(t,...e){return e.forEach(((e,i)=>{this.getData(e)||this.attachObject(e,t+i)})),this}detach(...t){return t.forEach((t=>{const e=this.getData(t);e&&this.detachObject(e)})),this}attachObject(t,e,i){(null==e||isNaN(e))&&(e=this.attachedObjects.length),e<0&&(e=0);const s=this.generateNewData(t,i);return this.attachedObjects.splice(e,0,s),t.reifects?.attach(this),s.lastState=this.stateOf(t),this.applyResolvedValues(s,!1,!0),s}detachObject(t){this.attachedObjects.splice(this.attachedObjects.indexOf(t),1)}getData(t){if(!t)return null;for(const e of this.attachedObjects){const i=this.getObject(e);if(i&&i==t)return e}return null}getObject(t){if(!t)return null;return t.object.deref()||null}get states(){return this._states}set states(t){this._states=t||this.getAllStates()}stateOf(t){if(!t)return;const e=this.getData(t);if(e){if(e.lastState)return e.lastState;if(!(t instanceof HTMLElement))return this.states[0];e.resolvedValues||this.processRawProperties(e);for(const i of this.states){if(!e.resolvedValues?.styles?.[i])continue;let s=!0;for(const[n,r]of Object.entries(e.resolvedValues.styles[i]))if(t.style[n]!=r){s=!1;break}if(s)return e.lastState=i,i}return this.states[0]}}getAllStates(){const t=[...this.states];for(const e of[this.properties,this.classes,this.styles,this.replaceWith])if("object"==typeof e)for(const i of Object.keys(e))t.includes(i)||t.push(i);return 0==t.length&&console.warn("No states found for this particular reifect:",this),t}parseState(t){if("boolean"!=typeof t)return this.states.includes(t)?t:this.states[0];for(const e of t?["true","on","in","enabled","shown"]:["false","off","out","disabled","hidden"])if(this.states.includes(e))return e;return this.states[0]}set enabled(t){this.refreshResolvedValues()}set propertiesEnabled(t){this.refreshProperties()}set stylesEnabled(t){this.refreshStyles()}set classesEnabled(t){this.refreshClasses()}set replaceWithEnabled(t){this.refreshReplaceWith()}set transitionEnabled(t){this.refreshTransition()}enable(t,e){if("boolean"==typeof t)this.enabled=t;else{if(!t)return;Object.entries(t).forEach((([t,e])=>{"global"==t?this.enabled=e:this[t+"Enabled"]=e}))}}enableObject(t,e){const i=this.getData(t);if(i)if("boolean"==typeof e)i.enabled.global=e;else{if(!e)return;Object.entries(e).forEach((([t,e])=>i.enabled[t]=e))}}getObjectEnabledState(t){return this.getData(t)?.enabled}set properties(t){}set styles(t){}set classes(t){}set replaceWith(t){}set transitionProperties(t){}set transitionDuration(t){}set transitionTimingFunction(t){}set transitionDelay(t){}set transition(t){if(!t)return;const e="string"==typeof t?this.processTransitionString(t):this.processTransitionObject(t);void 0!==e.transitionProperties&&(this.transitionProperties=e.transitionProperties),void 0!==e.transitionDuration&&(this.transitionDuration=e.transitionDuration),void 0!==e.transitionDelay&&(this.transitionDelay=e.transitionDelay),void 0!==e.transitionTimingFunction&&(this.transitionTimingFunction=e.transitionTimingFunction)}processTransitionObject(t){const e={};for(const[i,s]of Object.entries(t)){if(!this.states.includes(i))continue;if("string"!=typeof s)continue;const t=this.processTransitionString(s);void 0!==t.transitionProperties&&(e.transitionProperties[i]=t.transitionProperties),void 0!==t.transitionDuration&&(e.transitionDuration[i]=t.transitionDuration),void 0!==t.transitionDelay&&(e.transitionDelay[i]=t.transitionDelay),void 0!==t.transitionTimingFunction&&(e.transitionTimingFunction[i]=t.transitionTimingFunction)}return e}processTransitionString(t){const e=t.trim().replace(/,/g," ").split(/\s+/).filter((t=>t.length>0)),i={transitionProperties:[]};let s=0;for(;s<e.length&&!this.timeRegex.test(e[s]);)i.transitionProperties.push(e[s]),s++;if(s<e.length){const t=this.parseTime(e[s]);isNaN(t)||(i.transitionDuration=t),s++}if(s<e.length&&(i.transitionTimingFunction=e[s],s++),s<e.length){const t=this.parseTime(e[s]);isNaN(t)||(i.transitionDelay=t),s++}return i}getTransitionString(t,e=t.lastState){let i="";return t.resolvedValues.transitionProperties[e].forEach((s=>i+=", "+s+" "+(t.resolvedValues.transitionDuration[e]||0)+"s "+(t.resolvedValues.transitionTimingFunction[e]||"linear")+" "+(t.resolvedValues.transitionDelay[e]||0)+"s")),i.substring(2)}initialize(t,e,i){this.enabled&&(t=this.parseState(t),i=this.initializeOptions(i,e),this.getEnabledObjectsData(e,i).forEach((e=>{!i.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,i.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!0,i?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))})))}apply(t,e,i){this.enabled&&(t=this.parseState(t),i=this.initializeOptions(i,e),this.getEnabledObjectsData(e,i).forEach((e=>{!i.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,i.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!1,i?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))})))}toggle(t,e){if(!this.enabled)return;t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[];const i=this.getData(t[0])?.lastState,s=zt(i?this.states.indexOf(i)+1:0,this.states.length);this.apply(this.states[s],t,e)}reloadFor(t){if(!this.enabled)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global?(this.applyResolvedValues(e),this):this}reloadTransitionFor(t){if(!this.enabled||!this.transitionEnabled)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global&&e.enabled.transition?(this.applyTransition(e,e.lastState),this):this}getEnabledObjectsData(t,e){if(!this.enabled)return console.warn("The reifier object you are trying to access is disabled."),[];t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[],(e=this.initializeOptions(e,t)).attachObjects&&t.forEach((t=>this.attach(t))),e.executeForAll&&(t=[],this.attachedObjects.forEach((e=>{const i=e.object.deref();i&&t.push(i)})));const i=[];return t.forEach((t=>{const s=this.getData(t)||this.generateNewData(t);this.filterEnabledObjects(s)&&((e.recomputeIndices||null==s.objectIndex)&&(s.objectIndex=i.length),i.push(s))})),i.forEach((t=>{(e.recomputeIndices||null==t.totalObjectCount)&&(t.totalObjectCount=i.length)})),i}applyResolvedValues(t,e=!1,i=!1){if(this.applyStyles(t,t.lastState,i),!e){const e=t.object.deref()?.reifects;this.attachedObjects.includes(t)&&e?e.reloadTransitions():this.applyTransition(t,t.lastState)}this.applyReplaceWith(t,t.lastState),this.applyProperties(t,t.lastState),this.applyClasses(t,t.lastState)}refreshResolvedValues(){this.refreshProperties(),this.refreshStyles(),this.refreshClasses(),this.refreshReplaceWith(),this.refreshTransition()}applyProperties(t,e=t.lastState){if(!this.enabled||!this.propertiesEnabled)return;if(!t.enabled.global||!t.enabled.properties)return;const i=t.resolvedValues?.properties?.[e];if(!i)return;const s=t.object.deref();if(s)for(const[t,e]of Object.entries(i))if(t&&null!=e)try{s[t]=e}catch(i){console.error(`Unable to set property ${t} to ${e}: ${i.message}`)}}refreshProperties(){this.enabled&&this.propertiesEnabled&&this.attachedObjects.forEach((t=>this.applyProperties(t)))}applyReplaceWith(t,e=t.lastState){if(!this.enabled||!this.replaceWithEnabled)return;if(!t.enabled.global||!t.enabled.replaceWith)return;const i=t.resolvedValues.replaceWith[e];if(i)try{const e=t.object.deref();e&&e instanceof Node&&i instanceof Node&&e.parentNode?.replaceChild(i,e),t.object=new WeakRef(i)}catch(t){console.error(`Unable to replace object: ${t.message}`)}}refreshReplaceWith(){this.enabled&&this.replaceWithEnabled&&this.attachedObjects.forEach((t=>this.applyReplaceWith(t)))}applyClasses(t,e=t.lastState){if(!this.enabled||!this.classesEnabled)return;if(!t.enabled.global||!t.enabled.classes)return;const i=t.resolvedValues.classes;if(!i)return;const s=t.object.deref();if(s&&s instanceof Element)for(const[t,n]of Object.entries(i))s.toggleClass(n,e==t)}refreshClasses(){this.enabled&&this.classesEnabled&&this.attachedObjects.forEach((t=>this.applyClasses(t)))}applyStyles(t,e=t.lastState,i=!1){if(!this.enabled||!this.stylesEnabled)return;if(!t.enabled.global||!t.enabled.styles)return;const s=t.object.deref();s&&s instanceof Element&&s.setStyles(t.resolvedValues.styles[e],i)}refreshStyles(){this.enabled&&this.stylesEnabled&&this.attachedObjects.forEach((t=>this.applyStyles(t)))}applyTransition(t,e=t.lastState){if(!this.enabled||!this.transitionEnabled)return;if(!t.enabled.global||!t.enabled.transition)return;const i=t.object.deref();i&&i instanceof Element&&t.resolvedValues&&i.appendStyle("transition",this.getTransitionString(t,e),", ",!0)}refreshTransition(){for(const t of this.attachedObjects){const e=t.object?.deref()?.reifects;e&&e.reloadTransitions()}}filterEnabledObjects(t){return!(!t.enabled||!t.enabled.global)||(console.warn("The reified properties instance you are trying to set on an object is disabled for this particular object."),!1)}processRawProperties(t,e){if(t.resolvedValues||(t.resolvedValues={properties:void 0,styles:void 0,classes:void 0,replaceWith:void 0,transitionProperties:void 0,transitionDuration:void 0,transitionTimingFunction:void 0,transitionDelay:void 0}),At(e))return;const i={properties:this.properties,styles:this.styles,classes:this.classes,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay,...e||{}};t.resolvedValues.properties={},this.states.forEach((e=>this.processRawPropertyForState(t,"properties",i.properties,e))),"transitionProperties"in i&&(t.resolvedValues.transitionProperties={},this.states.forEach((e=>this.processRawPropertyForState(t,"transitionProperties",i.transitionProperties,e))));for(const[e,s]of Object.entries(i))"transitionProperties"!=e&&"properties"!=e&&(t.resolvedValues[e]={},this.states.forEach((i=>this.processRawPropertyForState(t,e,s,i))))}generateNewData(t,e){return{object:new WeakRef(t),enabled:{global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0},lastState:this.stateOf(t),onSwitch:e}}initializeOptions(t,e){return e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[],(t=t||{}).attachObjects=t.attachObjects??!0,t.executeForAll=t.executeForAll??0===e.length,t.recomputeIndices=t.recomputeIndices??0!==e.length,t.recomputeProperties=t.recomputeProperties??0!==e.length,t}clone(){return new Rt({states:this.states,properties:this.properties,classes:this.classes,styles:this.styles,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay})}processRawPropertyForState(t,e,i,s){let n;const r=t.object.deref();if(r){if("function"==typeof i)n=i(s,t.objectIndex,t.totalObjectCount,r);else if("object"==typeof i&&Ft(this.states,...Object.keys(i))){const e=i[s];n="function"==typeof e?e(t.objectIndex,t.totalObjectCount,r):e}else n=i;if("properties"!=e&&"transitionProperties"!=e||"string"!=typeof n){if("styles"==e){if(null==t.resolvedValues.styles[s]&&(t.resolvedValues.styles[s]={}),"number"==typeof n)return void t.resolvedValues.transitionProperties[s].forEach((e=>t.resolvedValues.styles[s][e]=n));if("string"==typeof n){const e=n.split(";").map((t=>t.split(":").map((t=>t.trim()))));if(1==e.length&&1==e[0].length)return void t.resolvedValues.transitionProperties[s].forEach((i=>t.resolvedValues.styles[s][i]=e[0][0]))}}}else n=n.split(" ");t.resolvedValues[e][s]=n}}parseTime(t){const e=t.match(this.timeRegex);if(!e)return NaN;const i=parseFloat(e[1]);return"ms"===(e[2]?.toLowerCase()??"s")?i/1e3:i}}function Gt(t){return new Rt(t)}function Wt(){const t=new Rt({states:[Pt.visible,Pt.hidden],styles:t=>`visibility: ${t}`});Object.defineProperty(Node.prototype,"reifects",{get:function(){return this._reifects||(this._reifects=new Vt(this)),this._reifects},configurable:!1,enumerable:!0}),Object.defineProperty(Node.prototype,"showTransition",{value:t,writable:!0,configurable:!0,enumerable:!0}),Object.defineProperty(Node.prototype,"isShown",{get:function(){const t=this.showTransition.stateOf(this);return t==Pt.visible||t!=Pt.hidden&&("none"!=this.style.display&&"hidden"!=this.style.visibility&&"0"!=this.style.opacity)},configurable:!1,enumerable:!0}),Node.prototype.show=function(t,e={executeForAll:!1}){return this instanceof HTMLElement||this instanceof SVGElement?(this.showTransition.apply(t?Pt.visible:Pt.hidden,this,e),this):this}}function Kt(){mt(),ft(),yt(),gt(),bt(),pt(),Wt()}q([t()],Rt.prototype,"enabled",null),q([t()],Rt.prototype,"propertiesEnabled",null),q([t()],Rt.prototype,"stylesEnabled",null),q([t()],Rt.prototype,"classesEnabled",null),q([t()],Rt.prototype,"replaceWithEnabled",null),q([t()],Rt.prototype,"transitionEnabled",null),q([t()],Rt.prototype,"properties",null),q([t()],Rt.prototype,"styles",null),q([t()],Rt.prototype,"classes",null),q([t()],Rt.prototype,"replaceWith",null),q([t()],Rt.prototype,"transitionProperties",null),q([t()],Rt.prototype,"transitionDuration",null),q([t()],Rt.prototype,"transitionTimingFunction",null),q([t()],Rt.prototype,"transitionDelay",null),q([t()],Rt.prototype,"transition",null),function(t){t.target="target",t.position="position"}(Ot||(Ot={}));class Ut extends Event{eventName;clickMode;keys;position;authorizeScaling;scalePosition;constructor(t,e,i,s,n,r,o){super(s,{bubbles:!0,cancelable:!0,...o}),this.authorizeScaling=n??!0,this.scalePosition=r??(t=>t),this.eventName=s,this.clickMode=e,this.keys=i,this.position=t}closest(t,e=!0,i=Ot.target){const s=i==Ot.target?[this.target]:document.elementsFromPoint(this.position.x,this.position.y),n=e instanceof Element?e:null,r=!0===e||null!==n;for(let e of s){for(;e&&(!(e instanceof t)||r&&!this.isPositionInsideElement(this.position,n??e));)e=e.parentElement;if(e)return e}return null}isPositionInsideElement(t,e){const i=e.getBoundingClientRect();return t.x>=i.left&&t.x<=i.right&&t.y>=i.top&&t.y<=i.bottom}get target(){return super.target||document}get scaledPosition(){return this.scalingAuthorized?this.scalePosition(this.position):this.position}get scalingAuthorized(){return"function"==typeof this.authorizeScaling?this.authorizeScaling():this.authorizeScaling}scalePositionsMap(t){return t.mapValues(((t,e)=>this.scalePosition(e)))}}q([s()],Ut.prototype,"closest",null),q([s()],Ut.prototype,"scaledPosition",null);class $t{x;y;constructor(t=0,e=("number"==typeof t?t:0)){"number"==typeof t?(this.x=t,this.y=e):"clientX"in t?(this.x=t.clientX,this.y=t.clientY):"x"in t?(this.x=t.x,this.y=t.y):(this.x=t[0],this.y=t[1])}static dist(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static midPoint(...t){if(0==t.length)return null;const e=t.reduce(((t,e)=>t+e.x),0)/t.length,i=t.reduce(((t,e)=>t+e.y),0)/t.length;return new $t(e,i)}static max(...t){if(0==t.length)return null;const e=t.reduce(((t,e)=>Math.max(t,e.x)),-1/0),i=t.reduce(((t,e)=>Math.max(t,e.y)),-1/0);return new $t(e,i)}static min(...t){if(0==t.length)return null;const e=t.reduce(((t,e)=>Math.min(t,e.x)),1/0),i=t.reduce(((t,e)=>Math.min(t,e.y)),1/0);return new $t(e,i)}get object(){return{x:this.x,y:this.y}}equals(t,e=0){return"number"==typeof t?this.x==t&&this.y==e:this.x==t.x&&this.y==t.y}boundX(t,e){return this.x<t?t:this.x>e?e:this.x}boundY(t,e){return this.y<t?t:this.y>e?e:this.y}bound(t,e,i=t,s=e){return new $t(this.boundX(t,e),this.boundY(i,s))}add(t,e){return"number"==typeof t?new $t(this.x+t,this.y+(e||0==e?e:t)):new $t(this.x+t.x,this.y+t.y)}sub(t,e){return"number"==typeof t?new $t(this.x-t,this.y-(e||0==e?e:t)):new $t(this.x-t.x,this.y-t.y)}mul(t,e){return"number"==typeof t?new $t(this.x*t,this.y*(e||0==e?e:t)):new $t(this.x*t.x,this.y*t.y)}div(t,e){return"number"==typeof t?new $t(this.x/t,this.y/(e||0==e?e:t)):new $t(this.x/t.x,this.y/t.y)}mod(t,e){const i="number"==typeof t?{x:t,y:e||0==e?e:t}:{x:t.x,y:t.y},s=this.object;for(;s.x<0;)s.x+=i.x;for(;s.x>=i.x;)s.x-=i.x;for(;s.y<0;)s.y+=i.y;for(;s.y>=i.y;)s.y-=i.y;return new $t(s)}abs(){return new $t(Math.abs(this.x),Math.abs(this.y))}max(){return Math.max(this.x,this.y)}min(){return Math.min(this.x,this.y)}copy(){return new $t(this.x,this.y)}arr(){return[this.x,this.y]}}class Ht extends Ut{origins;previousPositions;positions;constructor(t,e,i,s,n,r=nt.drag,o,a,l){super(i.first,s,n,r,o,a,{bubbles:!0,cancelable:!0,...l}),this.origins=t,this.previousPositions=e,this.positions=i}get scaledOrigins(){return this.scalingAuthorized?this.scalePositionsMap(this.origins):this.origins}get scaledPreviousPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.previousPositions):this.previousPositions}get scaledPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.positions):this.positions}get deltaPositions(){return this.positions.mapValues(((t,e)=>{const i=this.previousPositions.get(t);if(i)return e.sub(i)}))}get deltaPosition(){return $t.midPoint(...this.deltaPositions.valuesArray())}get scaledDeltaPositions(){return this.scaledPositions.mapValues(((t,e)=>{const i=this.scaledPreviousPositions.get(t);if(i)return e.sub(i)}))}get scaledDeltaPosition(){return $t.midPoint(...this.scaledDeltaPositions.valuesArray())}}q([s()],Ht.prototype,"scaledOrigins",null),q([s()],Ht.prototype,"scaledPreviousPositions",null),q([s()],Ht.prototype,"scaledPositions",null),q([s()],Ht.prototype,"deltaPositions",null),q([s()],Ht.prototype,"deltaPosition",null),q([s()],Ht.prototype,"scaledDeltaPositions",null),q([s()],Ht.prototype,"scaledDeltaPosition",null);class qt extends Ut{keyPressed;keyReleased;constructor(t,e,i,s,n=nt.keyPressed,r,o,a){super(null,i,s,n,r,o,{bubbles:!0,cancelable:!0,...a}),this.keyPressed=t,this.keyReleased=e}}!function(t){t[t.none=0]="none",t[t.click=1]="click",t[t.longPress=2]="longPress",t[t.drag=3]="drag"}(Dt||(Dt={})),function(t){t[t.none=0]="none",t[t.left=1]="left",t[t.right=2]="right",t[t.middle=3]="middle",t[t.other=4]="other",t[t.key=5]="key"}(It||(It={})),function(t){t[t.unknown=0]="unknown",t[t.mouse=1]="mouse",t[t.trackpad=2]="trackpad",t[t.touch=3]="touch"}(Lt||(Lt={}));class Xt extends Ut{delta;constructor(t,e,i,s,n,r){super(null,It.none,e,i,s,n,{bubbles:!0,cancelable:!0,...r}),this.delta=t}}function Yt(t){HTMLElement.prototype.lockTurboEventManagerOn=t=>!1;const i=function(e){const i=this.lockTurboEventManagerOn(e);"boolean"==typeof i?t.setLockState(this,{enabled:i,preventDefaultWheel:i,preventDefaultMouse:i,preventDefaultTouch:i}):t.setLockState(this,{enabled:i.enabled||!1,preventDefaultWheel:i.preventDefaultWheel||!1,preventDefaultMouse:i.preventDefaultMouse||!1,preventDefaultTouch:i.preventDefaultTouch||!1})};HTMLElement.prototype.bypassTurboEventManager=function(){return this.addListener("mousedown",(t=>i.call(this,t))),this.addListener("touchstart",(t=>i.call(this,t))),this},e(HTMLElement.prototype,"bypassTurboEventManager")}class Jt extends Map{enforceImmutability=!0;set(t,e){return super.set(t,this.enforceImmutability?this.copy(e):e)}get(t){const e=super.get(t);return this.enforceImmutability?this.copy(e):e}get first(){if(0==this.size)return null;const t=this.values().next().value;return this.enforceImmutability?this.copy(t):t}get last(){if(0==this.size)return null;const t=this.valuesArray()[this.size-1];return this.enforceImmutability?this.copy(t):t}keysArray(){return Array.from(this.keys())}valuesArray(){return Array.from(this.values())}copy(t){if(t&&"object"==typeof t){if(t instanceof Array)return t.map((t=>this.copy(t)));if(t.constructor&&t.constructor!=Object){if("function"==typeof t.clone)return t.clone();if("function"==typeof t.copy)return t.copy()}return{...t}}return t}mapKeys(t){const e=new Jt;for(let[i,s]of this)e.set(t(i,s),s);return e}mapValues(t){const e=new Jt;for(let[i,s]of this)e.set(i,t(i,s));return e}filter(t){const e=new Jt;for(let[i,s]of this)t(i,s)&&e.set(i,s);return e}merge(t){for(let[e,i]of t)this.set(e,i);return this}}let Zt=class extends ht{_inputDevice=Lt.unknown;onInputDeviceChange;defaultState={};lockState={};disabledEventTypes={};currentKeys=[];currentAction=Dt.none;currentClick=It.none;wasRecentlyTrackpad=!1;origins;previousPositions;positions;lastTargetOrigin;timerMap;moveThreshold;longPressDuration;authorizeEventScaling;scaleEventPosition;constructor(t={}){super({parent:document.body}),this.onInputDeviceChange=new at,this.authorizeEventScaling=t.authorizeEventScaling,this.scaleEventPosition=t.scaleEventPosition,this.defaultState={enabled:t.enabled??!0,preventDefaultWheel:t.preventDefaultWheel??!0,preventDefaultMouse:t.preventDefaultMouse??!0,preventDefaultTouch:t.preventDefaultTouch??!0},this.resetLockState(),this.disabledEventTypes={...t},this.moveThreshold=t.moveThreshold||10,this.longPressDuration=t.longPressDuration||500,this.origins=new Jt,this.previousPositions=new Jt,this.timerMap=new Jt;for(let t in nt)rt[t]=nt[t];this.initEvents(),Yt(this)}initEvents(){try{this.disabledEventTypes.disableKeyEvents||(document.addListener("keydown",this.keyDown),document.addListener("keyup",this.keyUp),this.applyEventNames(Q)),this.disabledEventTypes.disableWheelEvents||(document.body.addListener("wheel",this.wheel,this,{passive:!1,propagate:!0}),this.applyEventNames(st)),this.disabledEventTypes.disableMoveEvent||this.applyEventNames(et),this.disabledEventTypes.disableMouseEvents||(document.addListener("mousedown",this.pointerDown,this,{propagate:!0}),document.addListener("mousemove",this.pointerMove,this,{propagate:!0}),document.addListener("mouseup",this.pointerUp,this,{propagate:!0}),document.addListener("mouseleave",this.pointerLeave,this,{propagate:!0})),this.disabledEventTypes.disableTouchEvents||(document.addListener("touchstart",this.pointerDown,this,{passive:!1,propagate:!0}),document.addListener("touchmove",this.pointerMove,this,{passive:!1,propagate:!0}),document.addListener("touchend",this.pointerUp,this,{passive:!1,propagate:!0}),document.addListener("touchcancel",this.pointerUp,this,{passive:!1,propagate:!0})),this.disabledEventTypes.disableMouseEvents&&this.disabledEventTypes.disableTouchEvents||(this.disabledEventTypes.disableClickEvents||this.applyEventNames(tt),this.disabledEventTypes.disableDragEvents||this.applyEventNames(it))}catch(t){console.error("Error initializing events: ",t)}}get inputDevice(){return this._inputDevice}set inputDevice(t){this.inputDevice!=t&&(t==Lt.trackpad&&(this.wasRecentlyTrackpad=!0),this._inputDevice=t,this.onInputDeviceChange.fire(t))}setLockState(t,e){this.lockState.lockOrigin=t;for(const t in e)this.lockState[t]=e[t]}resetLockState(){this.lockState.enabled=this.defaultState.enabled,this.lockState.preventDefaultWheel=this.defaultState.preventDefaultWheel,this.lockState.preventDefaultMouse=this.defaultState.preventDefaultMouse,this.lockState.preventDefaultTouch=this.defaultState.preventDefaultTouch,this.lockState.lockOrigin=document.body}get enabled(){return this.defaultState.enabled&&this.lockState.enabled}get preventDefaultWheel(){return this.defaultState.preventDefaultWheel&&this.lockState.preventDefaultWheel}get preventDefaultMouse(){return this.defaultState.preventDefaultMouse&&this.lockState.preventDefaultMouse}get preventDefaultTouch(){return this.defaultState.preventDefaultTouch&&this.lockState.preventDefaultTouch}keyDown=t=>{this.enabled&&(this.currentKeys.includes(t.key)||(this.currentKeys.push(t.key),document.dispatchEvent(new qt(t.key,null,this.currentClick,this.currentKeys,nt.keyPressed,this.authorizeEventScaling,this.scaleEventPosition))))};keyUp=t=>{this.enabled&&this.currentKeys.includes(t.key)&&(this.currentKeys.splice(this.currentKeys.indexOf(t.key),1),document.dispatchEvent(new qt(null,t.key,this.currentClick,this.currentKeys,nt.keyReleased,this.authorizeEventScaling,this.scaleEventPosition)))};wheel=t=>{if(!this.enabled)return;let e;this.preventDefaultWheel&&t.preventDefault(),(Math.abs(t.deltaY)<=40||0!=t.deltaX)&&(this.inputDevice=Lt.trackpad),this.wasRecentlyTrackpad||(this.inputDevice=Lt.mouse),this.clearTimer("recentlyTrackpadTimer"),this.setTimer("recentlyTrackpadTimer",(()=>{this.inputDevice==Lt.trackpad&&(this.wasRecentlyTrackpad=!1)}),800),e=this.inputDevice==Lt.trackpad&&t.ctrlKey?nt.trackpadPinch:this.inputDevice==Lt.trackpad?nt.trackpadScroll:nt.mouseWheel,document.dispatchEvent(new Xt(new $t(t.deltaX,t.deltaY),this.currentKeys,e,this.authorizeEventScaling,this.scaleEventPosition))};pointerDown=t=>{if(t.composedPath().includes(this.lockState.lockOrigin)||(document.activeElement?.blur(),this.resetLockState()),!this.enabled)return;const e=t instanceof TouchEvent;if(this.preventDefaultMouse&&!e&&t.preventDefault(),this.preventDefaultTouch&&e&&t.preventDefault(),e?this.inputDevice=Lt.touch:this.inputDevice!=Lt.unknown&&this.inputDevice!=Lt.touch||(this.inputDevice=Lt.mouse),e)Array.from(t.changedTouches).forEach((t=>{const e=new $t(t);this.origins.set(t.identifier,e),this.previousPositions.set(t.identifier,e)})),this.setClickMode(t.touches.length,!0);else{const e=new $t(t);this.origins.set(0,e),this.previousPositions.set(0,e),this.setClickMode(t.button)}this.disabledEventTypes.disableClickEvents||(this.fireClick(this.origins.first,nt.clickStart),this.currentAction=Dt.click,this.setTimer(nt.longPress,(()=>{this.currentAction==Dt.click&&(this.currentAction=Dt.longPress,this.fireClick(this.origins.first,nt.longPress))}),this.longPressDuration))};pointerMove=t=>{if(!this.enabled)return;if(this.disabledEventTypes.disableMoveEvent&&this.disabledEventTypes.disableDragEvents)return;const e=t instanceof TouchEvent;if(this.preventDefaultMouse&&!e&&t.preventDefault(),this.preventDefaultTouch&&e&&t.preventDefault(),this.positions=new Jt,e?Array.from(t.touches).forEach((t=>this.positions.set(t.identifier,new $t(t)))):this.positions.set(0,new $t(t.clientX,t.clientY)),this.currentAction!=Dt.drag&&(this.lastTargetOrigin=null),this.disabledEventTypes.disableMoveEvent||this.fireDrag(this.positions,nt.move),this.currentAction!=Dt.none&&!this.disabledEventTypes.disableDragEvents){if(this.currentAction!=Dt.drag){if(!Array.from(this.origins.entries()).some((([t,e])=>{const i=this.positions.get(t);return i&&$t.dist(i,e)>this.moveThreshold})))return;o(this),this.fireDrag(this.origins,nt.dragStart),this.currentAction=Dt.drag}this.fireDrag(this.positions)}this.positions.forEach(((t,e)=>this.previousPositions.set(e,t)))};pointerUp=t=>{if(!this.enabled)return;const e=t instanceof TouchEvent;this.preventDefaultMouse&&!e&&t.preventDefault(),this.preventDefaultTouch&&e&&t.preventDefault(),this.clearTimer(nt.longPress),this.positions=new Jt,e?Array.from(t.changedTouches).forEach((t=>{this.positions.set(t.identifier,new $t(t))})):this.positions.set(0,new $t(t)),this.currentAction!=Dt.drag||this.disabledEventTypes.disableDragEvents||this.fireDrag(this.positions,nt.dragEnd),this.disabledEventTypes.disableClickEvents||(this.currentAction==Dt.click&&this.fireClick(this.positions.first,nt.click),this.fireClick(this.origins.first,nt.clickEnd)),e?Array.from(t.changedTouches).forEach((t=>{this.origins.delete(t.identifier),this.previousPositions.delete(t.identifier)})):(this.origins.clear(),this.previousPositions.clear()),this.currentAction=Dt.none,this.currentClick=It.none};pointerLeave=()=>{this.enabled&&this.currentAction!=Dt.none&&(this.clearTimer(nt.longPress),this.currentAction!=Dt.drag&&(this.fireClick(this.origins.first,nt.clickEnd),this.currentAction=Dt.none))};getFireOrigin(t,e=!1){if(!this.lastTargetOrigin||e){const e=this.origins.first?this.origins.first:t.first;this.lastTargetOrigin=document.elementFromPoint(e.x,e.y)}return this.lastTargetOrigin}fireClick(t,e=nt.click){if(!t)return;(document.elementFromPoint(t.x,t.y)||document).dispatchEvent(new Ut(t,this.currentClick,this.currentKeys,e,this.authorizeEventScaling,this.scaleEventPosition))}fireDrag(t,e=nt.drag){t&&this.getFireOrigin(t).dispatchEvent(new Ht(this.origins,this.previousPositions,t,this.currentClick,this.currentKeys,e,this.authorizeEventScaling,this.scaleEventPosition))}setTimer(t,e,i){this.clearTimer(t),this.timerMap.set(t,setTimeout((()=>{e(),this.clearTimer(t)}),i))}clearTimer(t){const e=this.timerMap.get(t);e&&(clearTimeout(e),this.timerMap.delete(t))}setClickMode(t,e=!1){switch(e&&t--,t){case-1:return void(this.currentClick=It.none);case 0:return void(this.currentClick=It.left);case 1:return void(this.currentClick=It.middle);case 2:return void(this.currentClick=It.right);default:return void(this.currentClick=It.other)}}applyEventNames(t){for(const e in t)rt[e]=t[e]}};Zt=q([p()],Zt);class Qt extends lt{set selected(t){this.fireCallback("selected",t)}}q([t()],Qt.prototype,"selected",null);class te extends ct{textElement;setupUIElements(){super.setupUIElements(),this.textElement=I({text:this.element.name}),this.element.addClass("card clickable")}setupUILayout(){super.setupUILayout(),this.element.addChild(this.textElement)}setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("selected",(t=>this.element.toggleClass(ee.config.defaultSelectedClass,t)))}setupUIListeners(){super.setupUIListeners(),this.element.addEventListener(rt.click,(t=>{this.element.toolManager.setTool(this.element,It.left),t.stopImmediatePropagation()}))}}let ee=class extends ht{name;_toolManager;constructor(t){t.modelConstructor||(t.modelConstructor=Qt),t.viewConstructor||(t.viewConstructor=te),t.forceNewModel||t.model||(t.model=t.toolManager.getToolByName(t.name)?.model),super(t),this.name=t.name,this._toolManager=t.toolManager,void 0===t.generate&&this.mvc.generate(t),this.toolManager.addTool(this,t.key)}get toolManager(){return this._toolManager}activate(){}deactivate(){}get selected(){return this.model.selected}set selected(t){this.model.selected=t}};ee=q([p("turbo-tool")],ee);class ie{tools=new Map;mappedKeysToTool=new Map;currentTools=new Map;onToolChange=new at;constructor(){this.initEvents()}interactWithObject(t){const e=this.getFiredTool(t);if(!e)return;const i=[];let s=t.closest(Element,!0,Ot.position);for(;s;){if("function"==typeof s.interact&&"function"==typeof s.propagatesUp){i.push(s);if(!1===s.propagatesUp(t,e))break}s=s.parentElement}for(let s=i.length-1;s>=0;s--)i[s].interact(t,e)}initEvents(){document.addEventListener(nt.keyPressed,(t=>this.setToolByKey(t.keyPressed))),document.addEventListener(nt.keyReleased,(()=>this.setTool(null,It.key,{select:!1}))),document.addListener(nt.clickStart,(t=>this.interactWithObject(t)),document,{propagate:!0}),document.addListener(nt.click,(t=>this.interactWithObject(t)),document,{propagate:!0}),document.addListener(nt.clickEnd,(t=>this.interactWithObject(t)),document,{propagate:!0}),document.addListener(nt.move,(t=>this.interactWithObject(t)),document,{propagate:!0}),document.addListener(nt.dragStart,(t=>this.interactWithObject(t)),document,{propagate:!0}),document.addListener(nt.drag,(t=>this.interactWithObject(t)),document,{propagate:!0}),document.addListener(nt.dragEnd,(t=>this.interactWithObject(t)),document,{propagate:!0})}getToolsArray(){return[...this.tools.values()].flat()}getToolsByName(t){return this.tools.get(t)||[]}getToolByName(t,e){const i=this.getToolsByName(t);return e?i?.find(e):i?.[0]}getToolsByKey(t){const e=this.mappedKeysToTool.get(t);return e?this.tools.get(e)||[]:null}getToolByKey(t,e){const i=this.getToolsByKey(t);return e?i?.find(e):i?.[0]}addTool(t,e){this.tools.has(t.name)||this.tools.set(t.name,[]);const i=this.tools.get(t.name);i.includes(t)||i.push(t),e&&this.mappedKeysToTool.set(e,t.name)}createTool(t){return new ee({...t,toolManager:this})}getTool(t){return this.currentTools.get(t)}getFiredTool(t){let e;return t.keys.length>0&&(e=this.getTool(It.key)),e||(e=this.getTool(t.clickMode)),e}setTool(t,e,i={}){null==i.select&&(i.select=!0),null==i.activate&&(i.activate=!0),null==i.setAsNoAction&&(i.setAsNoAction=e==It.left);const s=this.currentTools.get(e);if(s){if(s==t)return;i.select&&(s.selected=!1),i.activate&&s.deactivate()}this.currentTools.set(e,t),i.setAsNoAction&&this.currentTools.set(It.none,t),i.select&&t&&(t.selected=!0),i.activate&&t&&t.activate(),this.onToolChange.fire(s,t,e)}setToolByKey(t){const e=this.getToolByKey(t);return!!e&&(this.setTool(e,It.key,{select:!1}),!0)}}function se(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var s=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===i&&s.firstChild?s.insertBefore(n,s.firstChild):s.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}var ne;function re(t){let e=document.createElement("div");return e.innerHTML=t,e.children[0]}function oe(t,e){return new Proxy(t,{get:(t,i,s)=>i in t?Reflect.get(t,i,s):i in e?Reflect.get(e,i,s):void 0,set:(t,i,s,n)=>i in t?Reflect.set(t,i,s,n):Reflect.set(e,i,s,n)})}function ae(t){return new Promise(((e,i)=>{t&&0!==t.length?fetch(t).then((t=>{if(!t.ok)throw new Error("Network response was not ok while loading your SVG");return t.text()})).then((t=>{const i=re(t);if(!i)throw new Error("Error parsing SVG text");e(i)})).catch((t=>{console.error("Error fetching SVG:",t),i(t)})):i(new Error("Invalid path"))}))}se("turbo-button{align-items:center;background-color:#dadada;border:1px solid #000;border-radius:.4em;color:#000;display:inline-flex;flex-direction:row;gap:.4em;padding:.5em .7em;text-decoration:none}turbo-button>h4{flex-grow:1}");let le=class extends ht{static{ne=this}_element;_type;_directory;onLoaded;static config={...ht.config,defaultType:"svg",defaultDirectory:"",customLoaders:{}};static imageTypes=["png","jpg","jpeg","gif","webp","PNG","JPG","JPEG","GIF","WEBP"];constructor(t){super(t),t.icon&&this.update(t)}update(t){t.unsetDefaultClasses?this.removeClass(ne.config.defaultClasses):this.addClass(ne.config.defaultClasses),this.type=t.type,this.directory=t.directory,t.iconColor&&(this.iconColor=t.iconColor),t.onLoaded&&(this.onLoaded=t.onLoaded),t.icon&&(this.icon=t.icon)}get type(){return this._type}set type(t){t&&0!=t.length||(t=this.type||ne.config.defaultType||"svg"),"."==t[0]&&(t=t.substring(1)),this._type=t}get directory(){return this._directory}set directory(t){t||(t=this.directory||ne.config.defaultDirectory||""),t.length>0&&!t.endsWith("/")&&(t+="/"),this._directory=t}get path(){let t=this.icon.endsWith("."+this.type)||0==this.type.length?"":"."+this.type;return this.directory+this.icon+t}set icon(t){const e=h(t).substring(1);e&&(this.type=e),this.generateIcon()}set iconColor(t){t&&this.element instanceof SVGElement&&(this.element.style.fill=t)}set element(t){this._element=t}get element(){return this._element}loadSvg(t){return ae(t)}loadImg(t){return A({src:t,alt:this.icon,parent:this})}generateIcon(){if(this.element instanceof HTMLImageElement&&Bt(this.type,...ne.imageTypes))return this.element.src=this.path,void(this.element.alt=this.icon);if(this.clear(),!this.icon)return;const t=this.getLoader()(this.path);t instanceof Element?this.setupLoadedElement(t):t.then((t=>this.setupLoadedElement(t))).catch((t=>console.error(`Failed to load icon: ${t}`)))}getLoader(){if(!this.type)return;const t=ne.config.customLoaders[this.type];if(t)return t;if(Bt(this.type,"svg","SVG"))return this.loadSvg;if(Bt(this.type,...ne.imageTypes))return this.loadImg;throw new Error(`Unsupported icon type: ${this.type}`)}setupLoadedElement(t){!this.element&&t&&(t.parentElement&&(t=t.cloneNode(!0)),this.addChild(t),this.iconColor&&t instanceof SVGElement&&(t.style.fill=this.iconColor),this.onLoaded&&this.onLoaded(t),this.element=t)}clear(){this.element?.destroy(),this.element=null}};function ce(t){return new le(t)}q([f,t()],le.prototype,"icon",null),q([f,t()],le.prototype,"iconColor",null),q([s()],le.prototype,"loadSvg",null),le=ne=q([p()],le);let he=class extends ht{elements;static config={...ht.config,defaultElementTag:"h4"};constructor(t){t.text&&!t.element&&(t.element=t.text),super({...t,text:null}),t.unsetDefaultClasses||this.addClass(this.constructor.config.defaultClasses),this.elementTag=t.elementTag,this.elements={leftCustomElements:null,leftIcon:null,prefixEntry:null,element:null,suffixEntry:null,rightIcon:null,rightCustomElements:null},this.leftCustomElements=t.leftCustomElements,this.leftIcon=t.leftIcon,this.prefixEntry=t.prefixEntry,this.element=t.element,this.suffixEntry=t.suffixEntry,this.rightIcon=t.rightIcon,this.rightCustomElements=t.rightCustomElements}addAtPosition(t,e){if(!t||!e)return;let i=0;for(let t in this.elements){if(t==e)break;this.elements[t]&&i++}this.addChild(t,i)}set elementTag(t){}get leftCustomElements(){return this.elements.leftCustomElements}set leftCustomElements(t){this.removeChild(this.leftCustomElements),t&&(this.addAtPosition(t,"leftCustomElements"),this.elements.leftCustomElements=t)}get leftIcon(){return this.elements.leftIcon}set leftIcon(t){if(t){if("string"==typeof t){if(this.leftIcon)return void(this.leftIcon.icon=t);t=new le({icon:t})}this.removeChild(this.leftIcon),this.addAtPosition(t,"leftIcon"),this.elements.leftIcon=t}else this.removeChild(this.leftIcon)}get prefixEntry(){return this.elements.prefixEntry}set prefixEntry(t){if(t){if("string"==typeof t){if(this.prefixEntry)return void(this.prefixEntry.innerText=t);t=S({text:t})}this.removeChild(this.prefixEntry),this.addAtPosition(t,"prefixEntry"),this.elements.prefixEntry=t}else this.removeChild(this.prefixEntry)}get element(){return this.elements.element}set element(t){if(t){if("string"==typeof t){if(this.element&&"innerText"in this.element)return void(this.element.innerText=t);t=S({tag:this.elementTag,text:t})}else"object"!=typeof t||t instanceof Element||(t=S(t));this.removeChild(this.element),this.addAtPosition(t,"element"),this.elements.element=t}else this.removeChild(this.element)}get text(){const t=this.elements.element;return t?"innerText"in t?t.innerText:t.innerHTML:""}set text(t){t&&(this.element=t)}get suffixEntry(){return this.elements.prefixEntry}set suffixEntry(t){if(t){if("string"==typeof t){if(this.suffixEntry)return void(this.suffixEntry.innerText=t);t=S({text:t})}this.removeChild(this.suffixEntry),this.addAtPosition(t,"suffixEntry"),this.elements.suffixEntry=t}else this.removeChild(this.suffixEntry)}get rightIcon(){return this.elements.rightIcon}set rightIcon(t){if(t){if("string"==typeof t){if(this.rightIcon)return void(this.rightIcon.icon=t);t=new le({icon:t})}this.removeChild(this.rightIcon),this.addAtPosition(t,"rightIcon"),this.elements.rightIcon=t}else this.removeChild(this.rightIcon)}get rightCustomElements(){return this.elements.rightCustomElements}set rightCustomElements(t){this.removeChild(this.rightCustomElements),t&&(this.addAtPosition(t,"rightCustomElements"),this.elements.rightCustomElements=t)}};var ue;q([t({callBefore:t=>he.config.defaultElementTag||"h4"})],he.prototype,"elementTag",null),he=q([p("turbo-rich-element")],he);let de=class extends he{static{ue=this}static config={...he.config,defaultElementTag:"h4"};constructor(t){super(t),t.unsetDefaultClasses||this.addClass(ue.config.defaultClasses)}set elementTag(t){}};function pe(t){return new de(t)}q([t({callBefore:t=>de.config.defaultElementTag||"h4"})],de.prototype,"elementTag",null),de=ue=q([p()],de);let fe=class extends le{switchReifect;constructor(t){super({...t}),t.switchReifect instanceof Rt?this.switchReifect=t.switchReifect:this.switchReifect=new Rt(t.switchReifect||{}),this.switchReifect.attach(this),this.appendStateToIconName=t.appendStateToIconName,t.defaultState&&this.switchReifect.apply(t.defaultState,this)}set appendStateToIconName(t){if(t){const t=this.switchReifect.properties;this.switchReifect.states.forEach((e=>{t[e]||(t[e]={}),t[e].icon=this.icon+"-"+e.toString()}))}}};q([t()],fe.prototype,"appendStateToIconName",null),fe=q([p()],fe);let me=class extends le{onToggle;constructor(t){super(t),this.toggled=t.toggled??!1,this.onToggle=t.onToggle,this.toggleOnClick=t.toggleOnClick??!1}set toggled(t){this.onToggle&&this.onToggle(t,this)}set toggleOnClick(t){t?this.addListener(rt.click,this.clickListener):this.removeListener(rt.click,this.clickListener)}toggle(){this.toggled=!this.toggled}clickListener=()=>this.toggle()};q([t({cancelIfUnchanged:!0})],me.prototype,"toggled",null),q([t({cancelIfUnchanged:!0})],me.prototype,"toggleOnClick",null),me=q([p()],me);let ge=class extends ht{labelElement;inputElement;locked;lastValueWithInputCheck;lastValueWithBlurCheck;constructor(t={}){super(t),this.locked=t.locked||!1,this.lastValueWithInputCheck="",this.lastValueWithBlurCheck="",t.label&&(this.labelElement=S({tag:"label",text:t.label,parent:this})),this.inputElement=new he({...t,elementTag:t.elementTag||"input",element:t.element||S({tag:t.elementTag||"input"}),parent:this}),this.setupEvents(t)}setupEvents(t){"bypassTurboEventManager"in this.inputElement.element&&this.inputElement.element.bypassTurboEventManager(),this.inputElement.element.addListener(rt.blur,(e=>{t.blurRegexCheck&&this.stringValue!=this.lastValueWithBlurCheck&&(this.stringValue=this.lastValueWithBlurCheck),this.dispatchEvent(new FocusEvent(rt.blur,e))})),this.inputElement.element.addListener(rt.focus,(e=>{this.locked&&this.inputElement.blur(),t.selectTextOnFocus&&this.inputElement.element.select(),this.dispatchEvent(new FocusEvent(rt.focus,e))})),this.inputElement.element.addListener(rt.input,(e=>{if(t.dynamicVerticalResize&&(this.inputElement.style.height="",this.inputElement.style.height=this.inputElement.scrollHeight+"px"),t.inputRegexCheck){new RegExp(t.inputRegexCheck,"g").test(this.stringValue)||(this.stringValue=this.lastValueWithInputCheck)}if(this.lastValueWithInputCheck=this.stringValue,t.blurRegexCheck){new RegExp(t.blurRegexCheck,"g").test(this.stringValue)&&(this.lastValueWithBlurCheck=this.stringValue)}0==this.stringValue.length&&(this.lastValueWithInputCheck="0",this.lastValueWithBlurCheck="0"),this.dispatchEvent(new InputEvent(rt.input,e))}))}set stringValue(t){this.inputElement.element.value=t}get stringValue(){return this.inputElement.element.value}get value(){return this.stringValue}set value(t){this.stringValue=t.toString()}};ge=q([p("turbo-input")],ge);let ye=class extends ge{multiplier;decimalPlaces;min;max;constructor(t={}){t.inputRegexCheck=t.inputRegexCheck||/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?\.?$|^-$|^$/,t.blurRegexCheck=t.blurRegexCheck||/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?(?<=\d)$/,super(t),this.multiplier=t.multiplier||1,this.decimalPlaces=t.decimalPlaces,this.min=t.min,this.max=t.max}get value(){return Number.parseFloat(this.stringValue)/this.multiplier}set value(t){t&&""!=t||(t=0),"string"==typeof t&&(t=Number.parseFloat(t)),t*=this.multiplier,null!=this.min&&t<this.min&&(t=this.min),null!=this.max&&t>this.max&&(t=this.max),null!=this.decimalPlaces&&(t=Math.round(t*Math.pow(10,this.decimalPlaces))/Math.pow(10,this.decimalPlaces)),super.value=t}};var be;ye=q([p("turbo-numerical-input")],ye);let Ee=be=class extends he{selectedClasses="";action;onSelected;onEnabled;reflectedElement;inputElement;config={};constructor(t){super(t),t.unsetDefaultClasses||this.addClass(be.config.defaultClasses),this.selectedClasses=t.selectedClasses,this.action=t.action||(()=>{}),this.onSelected=t.onSelected||(()=>{}),this.onEnabled=t.onEnabled||(()=>{}),this.reflectedElement=t.reflectValueOn?t.reflectValueOn:t.element?void 0:this,this.inputName=t.inputName,this.value=t.value,this.secondaryValue=t.secondaryValue,this.selected=t.selected||!1,this.enabled=t.enabled||!0}set secondaryValue(t){}set value(t){this.reflectedElement&&(this.reflectedElement instanceof he?this.reflectedElement.text=this.stringValue:this.reflectedElement.innerText=this.stringValue),this.inputElement&&(this.inputElement.value=this.stringValue)}get stringValue(){return l(this.value)}set selected(t){this.toggleClass(this.selectedClasses,t),t&&this.action(),this.onSelected(t)}set enabled(t){!t&&this.selected&&(this.selected=!1),this.reifects.enabled=t,this.setStyle("visibility",t?"":"hidden"),this.onEnabled(t)}get inputName(){return this.inputElement?.name||null}set inputName(t){t&&(this.inputElement?this.inputElement.name=t:this.inputElement=N({type:"hidden",name:t,parent:this,value:this.stringValue}))}toggle(){this.selected=!this.selected}};q([t()],Ee.prototype,"secondaryValue",null),q([t()],Ee.prototype,"value",null),q([t()],Ee.prototype,"selected",null),q([t()],Ee.prototype,"enabled",null),Ee=be=q([p()],Ee);class ve extends Ut{toggledEntry;values;constructor(t,e,i=It.left,s,n,r){super(null,i,null,nt.selectInput,s,n,r),this.toggledEntry=t,this.values=e}}var Se;let ke=class extends ht{static{Se=this}entries=[];entriesParent;enabled;inputName;multiSelection=!1;forceSelection=!1;onSelect;selectedEntryClasses;static config={};constructor(t){super(t),t.unsetDefaultClasses||this.addClass(Se.config.defaultClasses),t.selectedValues||(t.selectedValues=[]),this.entriesParent=t.entriesParent??this,this.multiSelection=t.multiSelection??!1,this.forceSelection=t.forceSelection??!this.multiSelection,this.inputName=t.inputName,this.onSelect=t.onSelect||(()=>{}),this.selectedEntryClasses=t.customSelectedEntryClasses||Se.config.defaultSelectedEntryClasses,(t.values??[]).forEach((t=>this.addEntry(t))),requestAnimationFrame((()=>{this.entries.forEach((e=>{t.selectedValues?.includes(e.value)&&this.select(e)}))}))}createEntry(t){return t instanceof Ee||("object"==typeof t&&"value"in t?(t.inputName||(t.inputName=this.inputName),t=new Ee(t)):t=new Ee({value:t,inputName:this.inputName})),t}addEntry(t,e=this.entries.length){return t=this.createEntry(t),(void 0===e||"number"!=typeof e||e>this.entries.length)&&(e=this.entries.length),e<0&&(e=0),t.selectedClasses||(t.selectedClasses=this.selectedEntryClasses),t.addListener(rt.click,(e=>this.onEntryClick(t,e))),t.onAttach.add((()=>{if(!this.entries.includes(t)){const e=this.entriesParent.indexOfChild(t),i=Math.max(0,Math.min(e,this.entries.length));this.entries.splice(i,0,t)}requestAnimationFrame((()=>this.select(this.selectedEntry)))})),t.onDetach.add((()=>{const e=this.entries.indexOf(t);-1!==e&&this.entries.splice(e,1),t.selected&&t.toggle()})),this.entries.splice(e,0,t),this.entriesParent.addChild(t,e),t}onEntryClick(t,e){this.select(t)}select(t,e=!0){if(null==t)return this;if(!(t instanceof Ee)){let e=this.enabledEntries.find((e=>e.value==t));if(!e)return this;t=e}return t.selected===e||(this.multiSelection||this.selectedEntries.forEach((t=>t.selected=!1)),t.selected=e,0===this.selectedEntries.length&&this.forceSelection&&this.select(this.enabledEntries[0]),this.onSelect(t.selected,t,this.getIndex(t)),this.dispatchEvent(new ve(t,this.selectedValues))),this}selectByIndex(t,e=_t){return t=e(t,this.entries.length-1,0),this.select(this.entries[t])}getIndex(t){return this.entries.indexOf(t)}deselectAll(){this.selectedEntries.forEach((t=>t.toggle()))}reset(){this.deselectAll(),this.onEntryClick(this.enabledEntries[0])}get enabledEntries(){return this.entries.filter((t=>t.enabled))}get enabledValues(){return this.enabledEntries.map((t=>t.value))}get enabledSecondaryValues(){return this.enabledEntries.map((t=>t.secondaryValue))}find(t){return this.entries.find((e=>e.value==t))}findBySecondaryValue(t){return this.entries.find((e=>e.secondaryValue==t))}findAll(...t){return this.entries.filter((e=>t.includes(e.value)))}findAllBySecondaryValue(...t){return this.entries.filter((e=>t.includes(e.secondaryValue)))}enable(t,...e){e.forEach((e=>{e instanceof Ee?e.enabled=t:this.find(e).enabled=t}))}get selectedEntries(){return this.entries.filter((t=>t.selected))}get selectedEntry(){return this.entries.find((t=>t.selected))}get selectedValues(){return this.selectedEntries.map((t=>t.value))}get selectedValue(){return this.selectedEntry?.value}get selectedSecondaryValues(){return this.selectedEntries.map((t=>t.secondaryValue))}get selectedSecondaryValue(){return this.selectedEntry?.secondaryValue}get stringSelectedValue(){return this.selectedEntries.map((t=>t.stringValue)).join(", ")}clear(){for(const t of this.entries)t.remove();this.entries.splice(0,this.entries.length)}get values(){return this.entries.map((t=>t.value))}set values(t){const e=[];this.entries.filter(((e,i)=>e.selected&&i<t.length)),this.clear();for(const e of t)this.addEntry(e);for(const t of e)this.select(this.entries[t]);!this.selectedEntry&&this.forceSelection&&this.select(this.entries[0]),this.select(this.selectedEntry)}};ke=Se=q([p()],ke);se(".turbo-drawer{align-items:center;display:inline-flex}.turbo-drawer.top-drawer,.turbo-drawer.top-drawer .turbo-drawer-panel-container{flex-direction:column}.turbo-drawer.bottom-drawer,.turbo-drawer.bottom-drawer .turbo-drawer-panel-container{flex-direction:column-reverse}.turbo-drawer.left-drawer,.turbo-drawer.left-drawer .turbo-drawer-panel-container{flex-direction:row}.turbo-drawer.right-drawer,.turbo-drawer.right-drawer .turbo-drawer-panel-container{flex-direction:row-reverse}.turbo-drawer>div:first-child{background-color:#fff;display:inline-block;position:relative}.turbo-drawer>div:nth-child(2){align-items:center;display:flex;position:relative}.turbo-drawer>div:nth-child(2)>:first-child{background-color:#fff;display:block}");class we extends Rt{constructor(t){t.states=[""],super(t)}get properties(){const t=super.properties;return"object"==typeof t&&""in t?t[""]:t}set properties(t){super.properties=t}get styles(){const t=super.styles;return"object"==typeof t&&""in t?t[""]:t}set styles(t){super.styles=t}get classes(){const t=super.classes;return"object"==typeof t&&""in t?t[""]:t}set classes(t){super.classes=t}get replaceWith(){const t=super.replaceWith;return"object"==typeof t&&""in t?t[""]:t}set replaceWith(t){super.replaceWith=t}set transition(t){super.transition=t}get transitionProperties(){const t=super.transitionProperties;return"object"==typeof t&&""in t?t[""]:t}set transitionProperties(t){super.transitionProperties=t}get transitionDuration(){const t=super.transitionDuration;return"object"==typeof t&&""in t?t[""]:t}set transitionDuration(t){super.transitionDuration=t}get transitionTimingFunction(){const t=super.transitionTimingFunction;return"object"==typeof t&&""in t?t[""]:t}set transitionTimingFunction(t){super.transitionTimingFunction=t}get transitionDelay(){const t=super.transitionDelay;return"object"==typeof t&&""in t?t[""]:t}set transitionDelay(t){super.transitionDelay=t}initialize(t,e){super.initialize("",t,e)}apply(t,e){super.apply("",t,e)}}function xe(t){return new we(t)}let Ce=class extends ht{thumb;panelContainer;panel;_icon;_offset;_translation=0;transition;dragging=!1;animationOn=!1;resizeObserver;constructor(t){super(t),this.addClass("turbo-drawer"),this.thumb=t.thumb instanceof HTMLElement?t.thumb:P(t.thumb),this.panelContainer=P(),this.panel=t.panel instanceof HTMLElement?t.panel:P(t.panel),this.thumb.addClass("turbo-drawer-thumb"),this.panelContainer.addClass("turbo-drawer-panel-container"),this.panel.addClass("turbo-drawer-panel"),this.addChild([this.thumb,this.panelContainer]),this.panelContainer.addChild(this.panel),this.hideOverflow=t.hideOverflow??!1,this.side=t.side||kt.bottom,this.offset={open:t.offset?.open||0,closed:t.offset?.closed||0},this.attachSideToIconName=t.attachSideToIconName,this.rotateIconBasedOnSide=t.rotateIconBasedOnSide,this.icon=t.icon,this.childHandler=this.panel,this.transition=t.transition??new we({transitionProperties:["transform",this.isVertical?"height":"width"],transitionDuration:.2,transitionTimingFunction:"ease-out",attachedObjects:[this,this.panelContainer]});let e=!1;this.resizeObserver=new ResizeObserver((t=>{this.open&&!this.dragging&&(e||(e=!0,requestAnimationFrame((()=>{const i=Array.isArray(t[0].borderBoxSize)?t[0].borderBoxSize[0]:t[0].borderBoxSize;this.translation=(this.open?this.offset.open:this.offset.closed)+(this.isVertical?i.blockSize:i.inlineSize),e=!1}))))})),this.open=t.initiallyOpen||!1,this.animationOn=!0,this.initEvents()}get icon(){return this._icon}set icon(t){if(this.icon?.parentElement===this.thumb&&this.thumb.removeChild(this.icon),t instanceof Element)return void(this._icon=t);let e=this.attachSideToIconName;"string"!=typeof t||e||this.rotateIconBasedOnSide||(e=!0),this._icon=new fe("object"==typeof t?t:{icon:t,switchReifect:{states:Object.values(kt)},defaultState:this.open?this.getOppositeSide():this.side,appendStateToIconName:e}),this.thumb.addChild(this.icon),this.attachSideToIconName=e}initEvents(){this.thumb.addEventListener(rt.click,(t=>{t.stopImmediatePropagation(),this.open=!this.open})),this.thumb.addEventListener(nt.dragStart,(t=>{t.stopImmediatePropagation(),this.dragging=!0,this.animationOn&&(this.transition.enabled=!1)})),this.thumb.addEventListener(nt.drag,(t=>{this.dragging&&(t.stopImmediatePropagation(),this.translation+=this.isVertical?t.scaledDeltaPosition.y:t.scaledDeltaPosition.x)})),this.thumb.addEventListener(nt.dragEnd,(t=>{if(!this.dragging)return;t.stopImmediatePropagation(),this.dragging=!1;const e=t.positions.first.sub(t.origins.first);switch(this.side){case kt.top:this.open&&e.y>100?this.open=!1:!this.open&&e.y<-100&&(this.open=!0);break;case kt.bottom:this.open&&e.y<-100?this.open=!1:!this.open&&e.y>100&&(this.open=!0);break;case kt.left:this.open&&e.x>100?this.open=!1:!this.open&&e.x<-100&&(this.open=!0);break;case kt.right:this.open&&e.x<-100?this.open=!1:!this.open&&e.x>100&&(this.open=!0)}this.refresh()}))}getOppositeSide(t=this.side){switch(t){case kt.top:return kt.bottom;case kt.bottom:return kt.top;case kt.left:return kt.right;case kt.right:return kt.left}}getAdjacentSide(t=this.side){switch(t){case kt.top:return kt.right;case kt.bottom:return kt.left;case kt.left:return kt.top;case kt.right:return kt.bottom}}set hideOverflow(t){this.panelContainer.setStyle("overflow",t?"hidden":"")}set attachSideToIconName(t){this.icon instanceof fe&&(this.icon.appendStateToIconName=t),t&&(this.rotateIconBasedOnSide=!1)}set rotateIconBasedOnSide(t){t&&(this.attachSideToIconName=!1),this.icon instanceof fe&&(this.icon.switchReifect.styles={top:"transform: rotate(180deg)",bottom:"transform: rotate(0deg)",left:"transform: rotate(90deg)",right:"transform: rotate(270deg)"})}set side(t){this.toggleClass("top-drawer",t==kt.top),this.toggleClass("bottom-drawer",t==kt.bottom),this.toggleClass("left-drawer",t==kt.left),this.toggleClass("right-drawer",t==kt.right),this.refresh()}get offset(){return this._offset}set offset(t){this._offset="number"==typeof t?{open:t,closed:t}:{open:t?.open||0,closed:t?.closed||0}}get isVertical(){return this.side==kt.top||this.side==kt.bottom}set open(t){t?this.resizeObserver.observe(this.panel,{box:"border-box"}):this.resizeObserver.unobserve(this.panel),this.refresh()}get translation(){return this._translation}set translation(t){switch(this._translation=t,this.side){case kt.top:case kt.bottom:this.hideOverflow?this.panelContainer.setStyle("height",t+"px"):this.setStyle("transform",`translateY(${-t}px)`);break;case kt.left:case kt.right:this.hideOverflow?this.panelContainer.setStyle("width",t+"px"):this.setStyle("transform",`translateX(${-t}px)`)}}refresh(){this.animationOn&&(this.transition.enabled=!0,this.transition.apply()),this.hideOverflow&&this.panel.setStyle("position","absolute",!0),this.icon instanceof fe&&this.icon.switchReifect.apply(this.open?this.getOppositeSide():this.side),requestAnimationFrame((()=>{this.translation=(this.open?this.offset.open:this.offset.closed)+(this.open?this.isVertical?this.panel.offsetHeight:this.panel.offsetWidth:0),this.hideOverflow&&this.panel.setStyle("position","relative",!0)}))}};var Pe;q([t()],Ce.prototype,"hideOverflow",null),q([t()],Ce.prototype,"attachSideToIconName",null),q([t()],Ce.prototype,"rotateIconBasedOnSide",null),q([t()],Ce.prototype,"side",null),q([t()],Ce.prototype,"open",null),Ce=q([p()],Ce),function(t){t.invert="invert",t.offset="offset",t.none="none"}(Pe||(Pe={}));var Te;se(".turbo-popup{display:block;position:fixed}");let Me=class extends ht{static{Te=this}_popupAnchor;_parentAnchor;_viewportMargin;_offsetFromParent;fallbackModes;static config={defaultPopupAnchor:{x:0,y:-100},defaultParentAnchor:{x:0,y:100},defaultViewportMargin:4,defaultOffsetFromParent:{x:0,y:4}};constructor(t={}){super(t),this.addClass("turbo-popup"),t.unsetDefaultClasses||this.addClass(Te.config.defaultClasses),this.popupAnchor=t.popupAnchor||Te.config.defaultPopupAnchor||{x:50,y:0},this.parentAnchor=t.parentAnchor||Te.config.defaultParentAnchor||{x:50,y:100},this.viewportMargin=t.viewportMargin||Te.config.defaultViewportMargin||0,this.offsetFromParent=t.offsetFromParent||Te.config.defaultOffsetFromParent||0,this.fallbackModes=t.fallbackModes||{x:Math.abs(this.parentAnchor.x-50)>25?Pe.invert:Pe.offset,y:Math.abs(this.parentAnchor.y-50)>25?Pe.invert:Pe.offset},this.addListeners(),this.show(!1)}addListeners(){window.addEventListener(rt.scroll,(()=>this.show(!1))),window.addEventListener(rt.resize,(()=>{this.isShown&&this.recomputePosition()})),document.addListener(rt.click,(t=>{this.isShown&&!this.contains(t.target)&&this.show(!1)}))}get popupAnchor(){return this._popupAnchor}set popupAnchor(t){this._popupAnchor=new $t(t).bound(0,100)}get parentAnchor(){return this._parentAnchor}set parentAnchor(t){this._parentAnchor=new $t(t).bound(0,100)}get viewportMargin(){return this._viewportMargin}set viewportMargin(t){this._viewportMargin=new $t(t)}get offsetFromParent(){return this._offsetFromParent}set offsetFromParent(t){this._offsetFromParent=new $t(t)}get rect(){return this.getBoundingClientRect()}get parentRect(){return this.parentElement.getBoundingClientRect()}get computedStyle(){return window.getComputedStyle(this)}get parentComputedStyle(){return window.getComputedStyle(this.parentElement)}recomputePosition(){if(!this.parentElement)return;this.clearMaxDimensions();const t=window.innerHeight-2*this.viewportMargin.y,e=window.innerWidth-2*this.viewportMargin.x;this.setStyle("maxHeight",`${t}px`),this.setStyle("maxWidth",`${e}px`);const i=this.recomputeSide(Et.vertical),s=this.recomputeSide(Et.horizontal);this.recomputeMaxSize(i,Et.vertical),this.recomputeMaxSize(s,Et.horizontal)}recomputeSide(t){const e=this.generateDimensionParameters(t),i=this.rect[e.size]+this.offsetFromParent[e.coordinate]+parseFloat(this.computedStyle[e.marginStart])+parseFloat(this.computedStyle[e.marginEnd]),s=this.parentRect[e.size]*this.parentAnchor[e.coordinate]/100,n=i*this.popupAnchor[e.coordinate]/100,r=s-n,o=r>0?1:-1,a=this.offsetFromParent[e.coordinate]*o,l=this.viewportMargin[e.coordinate]*o;let c=this.parentRect[e.side]+r+a;const h=window[e.innerSize]-i-l,u=l;if(this.fallbackModes[e.coordinate]===Pe.invert){const t=this.parentRect[e.size]-s+(i-n);if(c+i>h||c<u){const s=this.parentRect[e.side]-t*o;s>=u&&s+i<=h&&(c=s)}}return c=Math.min(Math.max(c,u),h),this.style[e.side]=`${c}px`,c}recomputeMaxSize(t,e){const i=this.generateDimensionParameters(e),s=parseFloat(this.computedStyle[i.marginStart])+parseFloat(this.computedStyle[i.marginEnd])+2*this.viewportMargin[i.coordinate],n=Math.min(window[i.innerSize]-s,window[i.innerSize]-t-this.viewportMargin[i.coordinate]),r=this.computedStyle[i.maxSize]?parseFloat(this.computedStyle[i.maxSize]):1/0;(!r||r>n)&&(this.style[i.maxSize]=`${n}px`)}clearMaxDimensions(){this.setStyle("maxHeight","",!0),this.setStyle("maxWidth","",!0)}show(t){return this.isShown==t||requestAnimationFrame((()=>{t?this.recomputePosition():this.clearMaxDimensions(),super.show(t)})),this}toggle(){return this.show(!this.isShown)}generateDimensionParameters(t){const e=t==Et.vertical;return{size:e?"height":"width",innerSize:e?"innerHeight":"innerWidth",maxSize:e?"maxHeight":"maxWidth",marginStart:e?"marginTop":"marginLeft",marginEnd:e?"marginBottom":"marginRight",side:e?"top":"left",coordinate:e?"y":"x"}}};q([s({clearOnNextFrame:!0})],Me.prototype,"rect",null),q([s({clearOnNextFrame:!0})],Me.prototype,"parentRect",null),q([s({clearOnNextFrame:!0})],Me.prototype,"computedStyle",null),q([s({clearOnNextFrame:!0})],Me.prototype,"parentComputedStyle",null),Me=Te=q([p()],Me);var Oe;se("turbo-dropdown{display:inline-block;position:relative}turbo-dropdown>.turbo-popup{background-color:#fff;border:.1em solid #5e5e5e;border-radius:.4em;display:flex;flex-direction:column;overflow:hidden}turbo-dropdown>.turbo-popup>turbo-select-entry{padding:.5em}turbo-dropdown>.turbo-popup>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}turbo-dropdown>turbo-select-entry{padding:.5em .7em;width:100%}turbo-dropdown>turbo-select-entry:hover{background-color:#d7d7d7}turbo-dropdown>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}");let De=class extends ke{static{Oe=this}selector;popup;popupOpen=!1;static config={defaultEntryTag:"h4",defaultSelectorTag:"h4"};constructor(t){t.entriesParent=t.popup||new Me,super(t),this.selector=t.selector instanceof HTMLElement?t.selector:pe({buttonText:"",customTextTag:t.customSelectorTag||Oe.config.defaultSelectorTag}),this.popup=t.entriesParent,this.initPopup(t),this.initSelector(t),requestAnimationFrame((()=>document.addListener(rt.click,(t=>{this.popupOpen&&!this.contains(t.target)&&this.openPopup(!1)}))))}initSelector(t){if(this.selector instanceof de)if("string"==typeof t.selector)this.selector.text=t.selector;else if(!t.selector){const t=this.entries[0]?.value;"string"!=typeof t||this.selector.text||(this.selector.text=t)}this.selector.addListener(rt.click,(t=>{this.openPopup(!this.popupOpen),t.stopImmediatePropagation()})),this.addChild(this.selector),this.selector.addClass(t.customSelectorClasses?t.customSelectorClasses:Oe.config.defaultSelectorClasses)}initPopup(t){this.addChild(this.popup),this.popup.show(!1),this.popup.addClass(t.customPopupClasses?t.customPopupClasses:Oe.config.defaultPopupClasses)}onEntryClick(t){super.onEntryClick(t),this.openPopup(!1)}select(t,e=!0){return super.select(t,e),this.selector instanceof de&&(this.selector.text=this.stringSelectedValue),this}openPopup(t){this.popupOpen!=t&&(this.popupOpen=t,this.popup,this.popup.show(t))}};function Ie(t){return t instanceof Ut?t.scaledPosition:t instanceof PointerEvent?new $t(t.clientX,t.clientY):void 0}De=Oe=q([p("turbo-dropdown")],De);let Le=class extends ke{transition;semiMajor;semiMinor;currentOrigin;minDragDistance;set startAngle(t){}set endAngle(t){}constructor(t={}){super(t),super.show(!1),this.startAngle=0,this.endAngle=t.endAngle??2*Math.PI,this.semiMajor=t.semiMajor??50,this.semiMinor=t.semiMinor??45,this.minDragDistance=t.minDragDistance??20,this.transition=t.transition instanceof Rt?t.transition:this.initializeTransition(t.transition??{}),this.transition.initialize(wt.out,this.entries),this.setStyles({position:"fixed",top:0,left:0}),this.showTransition=this.showTransition.clone(),this.showTransition.transitionDelay={hidden:(t,e)=>.13+.02*e,visible:0},this.initEvents()}get totalAngle(){let t=this.endAngle-this.startAngle;for(;t>2*Math.PI;)t-=2*Math.PI;return t}initEvents(){const t=t=>{t.target.findInParents(this)||this.isShown&&this.show(!1)};document.addListener(rt.scroll,t),document.addListener(rt.clickEnd,t),document.addListener(rt.dragStart,t)}initializeTransition(t){return t.states=[wt.in,wt.out],t.transitionProperties||(t.transitionProperties="opacity transform"),null==t.transitionDuration&&(t.transitionDuration=.1),t.transitionTimingFunction||(t.transitionTimingFunction={in:"ease-out",out:"ease-in"}),t.transitionDelay||(t.transitionDelay={in:t=>.01+.02*t,out:(t,e)=>.01+.02*(e-t)}),t.styles||(t.styles={in:(t,e)=>{const i=this.computeAngle(t,e),s=this.semiMajor*Math.cos(i),n=this.semiMinor*Math.sin(i);return{opacity:1,top:n+"px",left:s+"px",transform:`translate3d(${-50*(1-s/this.semiMajor)}%, ${-50*(1-n/this.semiMinor)}%, 0)`}},out:{opacity:0,transform:"translate3d(-50%, -50%, 0)"}}),Gt(t)}computeAngle(t,e){const i=e-(this.totalAngle<2*Math.PI?1:0);let s=this.totalAngle*t/i+this.startAngle;for(s+=.2*Math.sin(2*(s+Math.PI/2));s<0;)s+=2*Math.PI;for(;s>=2*Math.PI;)s-=2*Math.PI;return s}addEntry(t,e=this.entries.length){return t=super.addEntry(t,e),this.transition?.initialize(this.isShown?wt.in:wt.out,t),t.setStyles({position:"absolute"}),t}show(t=!this.isShown,e){return this.currentOrigin=e||new $t(this.offsetLeft,this.offsetTop),e&&t&&this.setStyle("transform",`translate3d(${e.x}px, ${e.y}px, 0)`),this.transition.apply(t?wt.in:wt.out,this.enabledEntries),super.show(t),this}getEntryInDirection(t){if(!this.currentOrigin)return null;if($t.dist(t,this.currentOrigin)<this.minDragDistance)return null;let e=Math.atan2(t.y-this.currentOrigin.y,t.x-this.currentOrigin.x);e<0&&(e+=2*Math.PI);let i=null,s=1/0;return this.enabledEntries.forEach(((t,n)=>{const r=this.computeAngle(n,this.enabledEntries.length),o=Math.abs(r-e);o<s&&(s=o,i=t)})),i}selectEntryInDirection(t){this.select(this.getEntryInDirection(t))}attachTo(t,e=(t=>this.show(!0,Ie(t))),i=(t=>this.show(!0,Ie(t))),s=(i?t=>this.selectEntryInDirection(Ie(t)):null)){t.addListener(rt.clickEnd,(t=>t.stopImmediatePropagation())),e&&t.addListener(rt.click,(t=>{t.stopImmediatePropagation(),e(t)}),this),t.addListener(rt.dragStart,(t=>{t.stopImmediatePropagation(),i&&i(t)}),this),s&&t.addListener(rt.dragEnd,(t=>{t.stopImmediatePropagation(),s(t)}),this)}};function Ve(t,e,i,s,n,r=!0){if(r){const s=Math.max(e,i),n=Math.min(e,i);t>s&&(t=s),t<n&&(t=n)}return s+(t-e)*(n-s)/(i-e)}q([t({callBefore:t=>t-Math.PI/2})],Le.prototype,"startAngle",null),q([t({callBefore:t=>t-Math.PI/2})],Le.prototype,"endAngle",null),Le=q([p("turbo-marking-menu")],Le);let Ae=class extends ke{_currentPosition=0;_reifect;_size={max:100,min:-100};sizePerEntry=[];positionPerEntry=[];totalSize=0;dragLimitOffset=30;openTimeout=3e3;direction=Et.horizontal;scale={max:1,min:.5};generateCustomStyling;dragging;openTimer;constructor(t){t.multiSelection=!1,t.forceSelection=!0,super(t),t.scale&&(this.scale=t.scale),t.direction&&(this.direction=t.direction),this.opacity=t.opacity??{max:1,min:0},this.size=t.size,this.generateCustomStyling=t.generateCustomStyling,this.reifect=t.styleReifect,this.setStyles({display:"block",position:"relative"}),this.alwaysOpen=t.alwaysOpen??!1,this.initializeUI(),t.selectedValues?.length>0&&this.select(t.selectedValues[0]),requestAnimationFrame((()=>this.refresh()))}connectedCallback(){super.connectedCallback(),requestAnimationFrame((()=>this.refresh()))}set opacity(t){}get size(){return this._size}set size(t){this._size="object"==typeof t?t:{max:t??100,min:-(t??100)}}get reifect(){return this._reifect}set reifect(t){t instanceof we?this._reifect=t:(t||(t={}),t.transitionProperties||(t.transitionProperties="opacity transform"),null==t.transitionDuration&&(t.transitionDuration=.2),t.transitionTimingFunction||(t.transitionTimingFunction="ease-in-out"),this._reifect=new we(t)),this._reifect.attachAll(...this.entries)}set alwaysOpen(t){t?document.removeListener(rt.click,this.closeOnClick):document.addListener(rt.click,this.closeOnClick),this.open=t}closeOnClick=()=>this.open=!1;get isVertical(){return this.direction==Et.vertical}set index(t){this.selectByIndex(this.trimmedIndex)}get trimmedIndex(){return _t(Math.round(this.index),this.entries.length-1)}get flooredTrimmedIndex(){return _t(Math.floor(this.index),this.entries.length-1)}set open(t){this.setStyle("overflow",t?"visible":"hidden")}get currentPosition(){return this._currentPosition}set currentPosition(t){const e=-this.dragLimitOffset-this.sizePerEntry[0]/2,i=this.totalSize+this.dragLimitOffset-this.sizePerEntry[this.sizePerEntry.length-1]/2;t<e&&(t=e),t>i&&(t=i),this._currentPosition=t;const s=this.reifect.getEnabledObjectsData();0!==s.length&&s.forEach(((e,i)=>this.computeAndApplyStyling(e.object.deref(),this.positionPerEntry[i]-t)))}setupUIListeners(){super.setupUIListeners(),document.body.addListener(rt.drag,(t=>{this.dragging&&(t.stopImmediatePropagation(),this.currentPosition+=this.computeDragValue(t.scaledDeltaPosition))})),document.body.addListener(rt.dragEnd,(t=>{this.dragging&&(t.stopImmediatePropagation(),this.dragging=!1,this.recomputeIndex(),this.alwaysOpen||this.setOpenTimer())}))}computeDragValue(t){return-t[this.isVertical?"y":"x"]}reloadEntrySizes(){if(!this.reifect)return;this.sizePerEntry.length=0,this.positionPerEntry.length=0,this.totalSize=0,this.reifect.getEnabledObjectsData().forEach((t=>{const e=t.object.deref(),i=e?e[this.isVertical?"offsetHeight":"offsetWidth"]:0;this.sizePerEntry.push(i),this.positionPerEntry.push(this.totalSize),this.totalSize+=i}));const t=Math.floor(this.index),e=this.index-Math.floor(this.index);this.currentPosition=0,this.index<0?this.currentPosition=-Math.abs(this.index)*this.sizePerEntry[0]:this.index>=this.sizePerEntry.length?this.currentPosition=(this.index-this.sizePerEntry.length+1)*this.sizePerEntry[this.sizePerEntry.length-1]:this.currentPosition=this.positionPerEntry[t]+this.sizePerEntry[t]*e}recomputeIndex(){let t=0;for(;t<this.positionPerEntry.length-1&&this.positionPerEntry[t+1]<this.currentPosition;)t++;this.currentPosition-this.positionPerEntry[t]>this.sizePerEntry[t+1]/2&&t++,this.index=t}computeAndApplyStyling(t,e,i=this.size){let s,n;const r=e>0?i.max:i.min;s=Ve(e,0,r,this.opacity.max,this.opacity.min),n=Ve(e,0,r,this.scale.max,this.scale.min);let o={left:"50%",top:"50%",opacity:s,transform:`translate3d(\n            calc(${this.isVertical?0:e}px - 50%), \n            calc(${this.isVertical?e:0}px - 50%),\n            0) scale3d(${n}, ${n}, 1)`};this.generateCustomStyling&&(o=this.generateCustomStyling({element:t,translationValue:e,opacityValue:s,scaleValue:n,size:i,defaultComputedStyles:o})),t.setStyles(o)}select(t,e=!0){if(super.select(t,e),null==t)return this;const i=this.getIndex(this.selectedEntry);i!=this.index&&(this.index=i),this.reifect&&(this.reifect.transitionEnabled=!0,this.reloadEntrySizes());const s=getComputedStyle(this.selectedEntry);return this.setStyles({minWidth:s.width,minHeight:s.height},!0),this}onEntryClick(t,e){super.onEntryClick(t,e),e.stopImmediatePropagation(),this.open=!0,this.alwaysOpen||this.setOpenTimer()}addEntry(t,e=this.entries.length){let i;return(t=this.createEntry(t)).onDetach.add((()=>this.reifect?.detach(t))),t.onAttach.add((()=>{this.reifect?.attach(t),this.reloadEntrySizes()})),(t=super.addEntry(t,e)).setStyles({position:"absolute"}),t.addListener(rt.dragStart,(t=>{t.stopImmediatePropagation(),this.clearOpenTimer(),this.open=!0,this.dragging=!0,this.reifect.transitionEnabled=!1,this.reloadEntrySizes()})),t.addListener("mouseover",(()=>{clearTimeout(i),i=setTimeout((()=>this.open=!0),1e3)})),t.addListener("mouseout",(()=>{i&&clearTimeout(i),i=null})),this.refresh(),t}clear(){this.reifect.detach(...this.entries),super.clear()}refresh(){this.selectedEntry?this.select(this.selectedEntry):this.reset()}reset(){this.select(this.entries[0])}clearOpenTimer(){this.openTimer&&clearTimeout(this.openTimer)}setOpenTimer(){this.clearOpenTimer(),"number"!=typeof this.openTimeout||this.openTimeout<0||(this.openTimer=setTimeout((()=>this.open=!1),this.openTimeout))}};q([t({callBefore:t=>_t(t,1)})],Ae.prototype,"opacity",null),q([t()],Ae.prototype,"alwaysOpen",null),q([t({cancelIfUnchanged:!1})],Ae.prototype,"index",null),q([t()],Ae.prototype,"open",null),Ae=q([p("turbo-select-wheel")],Ae);class Ne{_weakRefs;constructor(){this._weakRefs=new Set}add(t){return this.has(t)||this._weakRefs.add(new WeakRef(t)),this}has(t){for(const e of this._weakRefs)if(e.deref()===t)return!0;return!1}delete(t){for(const e of this._weakRefs)if(e.deref()===t)return this._weakRefs.delete(e),!0;return!1}cleanup(){for(const t of this._weakRefs)void 0===t.deref()&&this._weakRefs.delete(t)}toArray(){const t=[];for(const e of this._weakRefs){const i=e.deref();void 0!==i?t.push(i):this._weakRefs.delete(e)}return t}get size(){return this.cleanup(),this.toArray().length}clear(){this._weakRefs.clear()}}function je(t){if(!t)return NaN;const e=parseInt(t.substring(1),16);return.2126*((e>>16&255)/255)+.7152*((e>>8&255)/255)+.0722*((e>>0&255)/255)}function Be(t,e){if(!t||!e)return NaN;const i=je(t),s=je(e);return(Math.max(i,s)+.1)/(Math.min(i,s)+.1)}function Fe(t,e="#000000",i="#FFFFFF"){return Be(t,i)>Be(e,t)?i:e}function _e(t,...e){let i="";return t.forEach(((t,s)=>{i+=t+(e[s]||"")})),i}const ze={900:{Black:"normal",BlackItalic:"italic"},800:{ExtraBold:"normal",ExtraBoldItalic:"italic"},700:{Bold:"normal",BoldItalic:"italic"},600:{SemiBold:"normal",SemiBoldItalic:"italic"},500:{Medium:"normal",MediumItalic:"italic"},400:{Regular:"normal",Italic:"italic"},300:{Light:"normal",LightItalic:"italic"},200:{ExtraLight:"normal",ExtraLightItalic:"italic"},100:{Thin:"normal",ThinItalic:"italic"}};function Re(t,e,i,s,n){return _e`
        @font-face {
            font-family: "${t}";
            src: url("${e}") format("${i}"), 
            url("${e}") format("woff"),
            url("${e}") format("truetype");
            font-weight: ${"string"==typeof s?'"'+s+'"':s};
            font-style: "${n}";
        }`}function Ge(t){t.name&&t.pathOrDirectory||console.error("Please specify font name and path/directory");const e=0==h(t.pathOrDirectory).length;t.stylesPerWeights||(t.stylesPerWeights=e?ze:{normal:"normal"}),t.format||(t.format="woff2"),t.extension||(t.extension=".ttf"),"."!=t.extension[0]&&(t.extension="."+t.extension),H(Object.entries(t.stylesPerWeights).map((([e,i])=>{const s=Number.parseInt(e),n=s||e;return"string"==typeof i?Re(t.name,t.pathOrDirectory,t.format,n,i):Object.entries(i).map((([e,i])=>Re(t.name,`${t.pathOrDirectory}/${t.name}-${e}${t.extension}`,t.format,n,i))).join("\n")})).join("\n"))}export{Tt as AccessLevel,Dt as ActionMode,It as ClickMode,Ot as ClosestOrigin,rt as DefaultEventName,at as Delegate,Et as Direction,wt as InOut,Lt as InputDevice,g as MathMLNamespace,b as MathMLTagsDefinitions,Y as MvcHandler,xt as OnOff,Ct as Open,$t as Point,Pe as PopupFallbackMode,Mt as Range,we as Reifect,Vt as ReifectHandler,Pt as Shown,kt as Side,vt as SideH,St as SideV,Rt as StatefulReifect,m as SvgNamespace,y as SvgTagsDefinitions,ee as Tool,ie as ToolManager,Qt as ToolModel,te as ToolView,de as TurboButton,tt as TurboClickEventName,J as TurboController,Ht as TurboDragEvent,it as TurboDragEventName,Ce as TurboDrawer,De as TurboDropdown,ht as TurboElement,X as TurboEmitter,Ut as TurboEvent,Zt as TurboEventManager,nt as TurboEventName,Z as TurboHandler,ut as TurboHeadlessElement,le as TurboIcon,fe as TurboIconSwitch,me as TurboIconToggle,ge as TurboInput,ot as TurboInteractor,qt as TurboKeyEvent,Q as TurboKeyEventName,Jt as TurboMap,Le as TurboMarkingMenu,lt as TurboModel,et as TurboMoveName,ye as TurboNumericalInput,Me as TurboPopup,dt as TurboProxiedElement,he as TurboRichElement,ke as TurboSelect,Ee as TurboSelectEntry,ve as TurboSelectInputEvent,Ae as TurboSelectWheel,ct as TurboView,Ne as TurboWeakSet,Xt as TurboWheelEvent,st as TurboWheelEventName,x as a,ft as addChildManipulationToElementPrototype,mt as addClassManipulationToElementPrototype,gt as addElementManipulationToElementPrototype,yt as addListenerManipulationToElementPrototype,Wt as addReifectManagementToNodePrototype,bt as addStylesManipulationToElementPrototype,jt as areEqual,t as auto,Fe as bestOverlayColor,k as blindElement,pe as button,s as cache,e as callOnce,i as callOncePerInstance,u as camelToKebabCase,C as canvas,o as clearCache,a as clearCacheEntry,Be as contrast,oe as createProxy,_e as css,p as define,P as div,Ft as eachEqualToAny,S as element,Bt as equalToAny,ae as fetchSvg,G as flexCol,W as flexColCenter,K as flexRow,U as flexRowCenter,T as form,w as generateTagFunction,Ie as getEventPosition,h as getFileExtension,M as h1,O as h2,D as h3,I as h4,L as h5,V as h6,ce as icon,A as img,N as input,v as isMathMLTag,At as isNull,E as isSvgTag,Nt as isUndefined,d as kebabToCamelCase,Ve as linearInterpolation,j as link,Ge as loadLocalFont,je as luminance,zt as mod,f as observe,B as p,c as parse,xe as reifect,Yt as setupTurboEventManagerBypassing,$ as spacer,F as span,Gt as statefulReifier,l as stringify,_ as style,H as stylesheet,re as textToElement,z as textarea,_t as trim,Kt as turbofy,pt as updateChainingPropertiesInElementPrototype,R as video};
