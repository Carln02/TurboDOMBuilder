import{__esDecorate as t,__runInitializers as e}from"tslib";import{Map as s,Array as n,AbstractType as i,YMapEvent as a,YArrayEvent as r}from"yjs";export{AbstractType as YAbstractType,Array as YArray,YArrayEvent,Doc as YDoc,YEvent,Map as YMap,YMapEvent,Text as YText}from"yjs";function o(t){return null==t&&null!=t}function l(t){return void 0===t}function c(t,e){let s=t;for(;s&&s!==Object.prototype;){const t=Object.getOwnPropertyDescriptor(s,e);if(t)return t;s=Object.getPrototypeOf(s)}}function h(t,e){let s=t;for(;s&&s!==Object.prototype;){if(Object.prototype.hasOwnProperty.call(s,e))return!0;s=Object.getPrototypeOf(s)}return!1}function u(t,e){let s=Object.getPrototypeOf(t);for(;s&&s!==Object.prototype;){if(Object.getOwnPropertyDescriptor(s,e))return s;s=Object.getPrototypeOf(s)}}function d(t,e,s){let n=Object.getPrototypeOf(t);for(;n&&n!==Object.prototype;){const t=Object.getOwnPropertyDescriptor(n,e),i=t?.value??t?.get??t?.set;if("function"==typeof i&&i!==s)return i;n=Object.getPrototypeOf(n)}}function f(t,e){let s=Object.getPrototypeOf(t);for(s&&(s=Object.getPrototypeOf(s));s&&s!==Object.prototype;){const t=Object.getOwnPropertyDescriptor(s,e);if(t)return t;s=Object.getPrototypeOf(s)}}const p=new class{constructorMap=new WeakMap;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}};function m(t){return function(e,s){t||(t={});const{kind:n,name:i,static:a}=s,r=i,o=Symbol(`__auto_${r}`);s.addInitializer(function(){const s=a?this:u(this,r);let i,h;const d=function(){return i&&t?.returnDefinedGetterValue?i.call(this):this[o]},f=function(t){this[o]=t};let m=!1;const g=function(){let e=d.call(this);if(!m&&!t.returnDefinedGetterValue&&l(e)){if(m=!0,t.defaultValue)e=t.defaultValue;else if(t.defaultValueCallback)e=t.defaultValueCallback.call(this);else if(!t.setIfUndefined)return e;b.call(this,e),e=d.call(this),m=!1}return e},b=function(e){t.callBefore?.call(this,e);let s=t?.preprocessValue?t.preprocessValue.call(this,e):e;(t.cancelIfUnchanged??1)&&d.call(this)===s||(t.executeSetterBeforeStoring&&h&&h.call(this,s),f.call(this,s),!t.executeSetterBeforeStoring&&h&&h.call(this,s),t.callAfter?.call(this,s))};if(l(d.call(this))){let s="field"===n?e:void 0;l(s)&&(t.initialValue?s=t.initialValue:t.initialValueCallback&&(s=t.initialValueCallback.call(this))),!l(s)&&t.preprocessValue&&(s=t.preprocessValue.call(this,s)),this[o]=s}if("field"===n||"accessor"===n){const t=e;t?.get&&(i=t.get),t?.set&&(h=t.set);const s=c(this,r)??{enumerable:!0};Object.defineProperty(this,r,{configurable:!0,enumerable:s.enumerable??!0,get:()=>g.call(this),set:t=>b.call(this,t)})}else if("getter"===n||"setter"===n){const t=p.constructorData(s).installed;if(t.get(r))return;t.set(r,!0);const e=c(s,r)??{enumerable:!0};"function"==typeof e.get&&(i=e.get),"function"==typeof e.set&&(h=e.set),Object.defineProperty(s,r,{configurable:!0,enumerable:e.enumerable??!0,get:function(){return g.call(this)},set:function(t){b.call(this,t)}})}})}}class g{element;#t(){return new Proxy(this,{get(t,e,s){if(e in t)return Reflect.get(t,e,s);const n=t.element?.[e];return"function"==typeof n?n.bind(t.element):n},set:(t,e,s,n)=>e in t?Reflect.set(t,e,s,n):(t.element[e]=s,!0),has:(t,e)=>e in t||e in t.element,ownKeys:t=>Array.from([...Reflect.ownKeys(t),...Reflect.ownKeys(t.element)]),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t,e)||Object.getOwnPropertyDescriptor(t.element,e)||void 0})}constructor(){return this.#t()}}const b=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}};const y=["interactors","tools","substrates","controllers","handlers"];const v=new class{operateOnClasses(t,e,s=()=>{}){if(!t||!e||!t.element)return t;try{"string"==typeof e&&(e=e.split(" ")),e.filter(t=>t.trim().length>0).forEach(t=>s(t))}catch(t){console.error(t)}return t}};const k="http://www.w3.org/2000/svg",S=new Set(["a","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tspan","use","view"]),E="http://www.w3.org/1998/Math/MathML",w=new Set(["annotation","annotation-xml","maction","math","merror","mfrac","mi","mmultiscripts","mn","mo","mover","mpadded","mphantom","mprescripts","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]);function C(t){return(e={})=>(e.tag=t,O({...e,tag:t}))}function O(t={}){let e;return e=t.namespace?"svg"==t.namespace?document.createElementNS(k,t.tag||"svg"):"mathML"==t.namespace?document.createElementNS(E,t.tag||"math"):document.createElementNS(t.namespace,t.tag||"div"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),Ne(e).setProperties(t),e}function T(t={}){let e;var s;return s=t.tag,e=S.has(s)||s?.startsWith("svg")?document.createElementNS(k,t.tag||"svg"):function(t){return w.has(t)||t?.startsWith("math")}(t.tag)?document.createElementNS(E,t.tag||"math"):document.createElement(t.tag||"div"),t.shadowDOM&&e.attachShadow({mode:"open"}),Ne(e).setProperties(t),e}function P(t={}){return O({...t,tag:"a"})}function x(t={}){return O({...t,tag:"canvas"})}function D(t={}){return O({...t,tag:"div"})}function A(t={}){return O({...t,tag:"form"})}function M(t={}){return O({...t,tag:"h1"})}function j(t={}){return O({...t,tag:"h2"})}function I(t={}){return O({...t,tag:"h3"})}function B(t={}){return O({...t,tag:"h4"})}function N(t={}){return O({...t,tag:"h5"})}function V(t={}){return O({...t,tag:"h6"})}function _(t={}){return O({...t,tag:"img"})}function z(t={}){return O({...t,tag:"input"})}function F(t={}){return O({...t,tag:"link"})}function L(t={}){return O({...t,tag:"p"})}function R(t={}){return O({...t,tag:"span"})}function W(t={}){return O({...t,tag:"style"})}function K(t={}){return O({...t,tag:"textarea"})}function H(t={}){return O({...t,tag:"video"})}function U(t,e=document.head){if(!t)return;const s=W({innerHTML:t});Ne(e).addChild(s)}class ${callbacks=new Map;model;constructor(t){t&&(this.model=t)}get defaultBlockKey(){return this.model?this.model.defaultBlockKey:"__defaultBlockKey__"}getBlock(t){return this.callbacks.get(t?.toString())}getOrGenerateBlock(t){return this.callbacks.has(t.toString())||this.callbacks.set(t.toString(),new Map),this.callbacks.get(t.toString())}getKey(t,e){const s=this.getBlock(e);return s?s.get(t):[]}getOrGenerateKey(t,e){const s=this.getOrGenerateBlock(e);return s.has(t)||s.set(t,[]),s.get(t)}addWithBlock(t,e,s){this.getOrGenerateKey(t,e).push(s)}add(t,e){this.addWithBlock(t,this.defaultBlockKey,e)}removeWithBlock(t,e,s){if(null==s)this.getBlock(e)?.delete(t);else{const n=this.getKey(t,e),i=n.indexOf(s);i>=0&&n.splice(i,1)}}remove(t,e){this.removeWithBlock(t,this.defaultBlockKey,e)}fireWithBlock(t,e,...s){this.callbacks.get(e.toString())?.get(t)?.forEach(t=>{t&&"function"==typeof t&&t(...s)})}fire(t,...e){this.fireWithBlock(t,this.defaultBlockKey,...e)}}class G{element;_view;_model;_emitter;_controllers=new Map;_handlers=new Map;_interactors=new Map;_tools=new Map;_substrates=new Map;constructor(t){t.element&&(this.element=t.element),t.emitter||(this.emitter=new $),this.generate(t)}get view(){return this._view}set view(t){this._view=this.generateInstance(t,{element:this.element}),this.linkPieces()}get model(){return this._model}set model(t){this.model?.keyChangedCallback.remove(this.emitterFireCallback),this._model=this.generateInstance(t),this._model.handlers=this._handlers,this._model.addHandler=t=>this.addHandler(t),this.linkPieces()}get emitter(){return this._emitter}set emitter(t){this._emitter=this.generateInstance(t),this.linkPieces()}get controllers(){return Array.from(this._controllers.values())||[]}set controllers(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addController(t)),this.linkPieces()}get handlers(){return Array.from(this._handlers.values())||[]}set handlers(t){this.generateInstances(t).forEach(t=>this.addHandler(t)),this.linkPieces()}get interactors(){return Array.from(this._interactors.values())||[]}set interactors(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addInteractor(t)),this.linkPieces()}get tools(){return Array.from(this._tools.values())||[]}set tools(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addTool(t)),this.linkPieces()}get substrates(){return Array.from(this._substrates.values())||[]}set substrates(t){this.generateInstances(t,{element:this.element}).forEach(t=>this.addSubstrate(t)),this.linkPieces()}get data(){return this.model?.data}set data(t){this.model&&(this.model.data=t)}get dataId(){return this.model?.dataId}set dataId(t){this.model&&(this.model.dataId=t)}get dataIndex(){return Number.parseInt(this.dataId)}set dataIndex(t){this.model&&(this.model.dataId=t.toString())}get dataSize(){return this.model?.getSize?.()}getController(t){return this._controllers.get(t)}addController(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Controller")),this._controllers.set(t.keyName,t),this.updateController(t)}getHandler(t){return this._handlers.get(t)}addHandler(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Handler")),this._handlers.set(t.keyName,t),this.updateHandler(t)}getInteractor(t){return this._interactors.get(t)}addInteractor(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Interactor")),this._interactors.set(t.keyName,t),this.updateInteractor(t)}getTool(t){return this._tools.get(t)}addTool(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Tool")),this._tools.set(t.keyName,t),this.updateTool(t)}getSubstrate(t){return this._substrates.get(t)}addSubstrate(t){t.keyName||(t.keyName=this.extractClassEssenceName(t.constructor,"Substrate")),this._substrates.set(t.keyName,t),this.updateSubstrate(t)}generate(t={}){for(const e of Object.keys(t)){const s=t[e];void 0!==s&&"initialize"!==e&&"data"!==e&&(this[e]=s)}this._emitter||(this.emitter=new $),t.data&&this.model&&this.model.setBlock(t.data,void 0,void 0,!1),(void 0===t.initialize||t.initialize)&&this.initialize()}initialize(){this.view?.initialize(),this._controllers.forEach(t=>t.initialize()),this._interactors.forEach(t=>t.initialize()),this._tools.forEach(t=>t.initialize()),this._substrates.forEach(t=>t.initialize()),this.model?.initialize()}updateController(t){t.emitter=this.emitter,t.model=this.model,t.view=this.view}updateHandler(t){t.model=this.model}updateInteractor(t){t.model=this.model,t.view=this.view,t.emitter=this.emitter}updateTool(t){t.emitter=this.emitter,t.model=this.model,t.view=this.view}updateSubstrate(t){t.model=this.model,t.view=this.view,t.emitter=this.emitter}linkPieces(){this.model&&!this.model.keyChangedCallback.has(this.emitterFireCallback)&&this.model.keyChangedCallback.add(this.emitterFireCallback),this.emitter&&(this.emitter.model=this.model),this.view&&(this.view.emitter=this.emitter,this.view.model=this.model),this._controllers.forEach(t=>this.updateController(t)),this._handlers.forEach(t=>this.updateHandler(t)),this._interactors.forEach(t=>this.updateInteractor(t)),this._tools.forEach(t=>this.updateTool(t)),this._substrates.forEach(t=>this.updateSubstrate(t))}generateInstance(t,e,s=!0){if(t){if("function"==typeof t){return new t(s&&e&&"object"==typeof e?{...e}:e)}return t}}generateInstances(t,e,s=!0){if(!t)return[];"object"==typeof t&&Array.isArray(t)||(t=[t]);const n=[];return t.forEach(t=>{const i=this.generateInstance(t,e,s);i&&n.push(i)}),n}emitterFireCallback=(t,e,...s)=>this.emitter?.fireWithBlock(t,e,...s);extractClassEssenceName(t,e){let s=t.name,n=Object.getPrototypeOf(this.element);for(;n&&n.constructor!==Object;){const t=n.constructor.name.replaceAll("_","");if(s.startsWith(t)){s=s.slice(t.length);break}n=Object.getPrototypeOf(n)}return s.endsWith(e)&&(s=s.slice(0,-e.length)),s.charAt(0).toLowerCase()+s.slice(1)}}const q=new class{constructorMap=new WeakMap;dataMap=new WeakMap;activeEffect=null;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}data(t){let e=this.dataMap.get(t);return e||(e={propertyKeyMap:new Map,blockKeyMap:new Map},this.dataMap.set(t,e)),e}track(t){this.activeEffect&&this.activeEffect.dependencies.add(t)}createSignalEntry(t,e,s,n,i,a){const r=new Set,o=this;a||(a={diffOnWrite:!0}),i||(i=t=>Reflect.set(e,s,t,e)),n||(n=e&&!l(s)?()=>Reflect.get(e,s):()=>t);const c={get:()=>(o.track(c),n()),set(r){if(!e||l(s)){const e=t;t=r,Object.is(e,r)||c.emit()}else if(a.diffOnWrite){const t=n();i(r);const e=n();Object.is(t,e)||c.emit()}else i(r),c.emit()},update(t){c.set(t(n()))},sub:t=>(r.add(t),()=>r.delete(t)),emit(){for(const t of Array.from(r))queueMicrotask(t)}};return e&&!l(s)&&(this.getReactivityData(e,s).signal=c),c}getReactivityData(t,e){const s=this.data(t).propertyKeyMap;return s.has(e)||s.set(e,{}),s.get(e)}getSignal(t,e){return this.getReactivityData(t,e).signal}setSignal(t,e,s){const n=this.getSignal(t,e);n?n.set(s):Reflect.set(t,e,s,t)}getEffect(t,e){return this.getReactivityData(t,e).effect}setEffect(t,e,s){this.getReactivityData(t,e).effect=s}markDirty(t,e){this.getSignal(t,e)?.emit()}schedule(t){t.scheduled||(t.scheduled=!0,queueMicrotask(()=>{t.scheduled=!1,t.run()}))}bindBlockKey(t,e,s,n){n=n??t?.defaultBlockKey??"__default__";const i=this.data(t).blockKeyMap;i.has(n)||i.set(n,new Map),i.get(n).set(s,e)}getKeyFromBlockKey(t,e,s){return s=s??t?.defaultBlockKey??"__default__",this.data(t).blockKeyMap.get(s)?.get(e)}},Y=new class{utils;constructor(t){this.utils=t}createBoxFromEntry(t){return new Proxy({...t,toJSON:()=>t.get(),valueOf:()=>t.get(),[Symbol.toPrimitive]:e=>{const s=t.get();return"string"===e?String(s):"number"==typeof s?s:null!=s&&"function"==typeof s.valueOf?s.valueOf():s},get value(){return t.get()},set value(e){t.set(e)}},{get:(t,e,s)=>Reflect.get(t,e,s),set:(t,e,s,n)=>"value"===e?(t.value=s,!0):Reflect.set(t,e,s,n)})}signalDecorator(t,e,s,n){const{kind:i,name:a,static:r,private:o}=e;if(o)throw new Error("@signal does not support private class elements.");const l=a,h=Symbol(`[[signal:${String(l)}]]`),u=Symbol(`[[signal:${String(l)}:shadow]]`),d=this.utils;e.addInitializer(function(){const e=r?this:this.constructor.prototype;let a,o;const f=function(){return s&&!this[u]?s.call(this):a&&!this[u]?a.call(this):this[h]},p=function(t){o||n?(n&&n.call(this,t),o&&o.call(this,t),a||s||(this[h]=t,this[u]=!0)):(this[h]=t,this[u]=!0)},m=(t,e=!0)=>{let n=d.getSignal(t,l);return n||("field"!==i||a||s||(t[h]=t[l]),n=d.createSignalEntry(void 0,t,l,()=>f.call(t),e=>p.call(t,e),{diffOnWrite:e}),"field"===i&&delete t[l],n)};if("field"===i||"accessor"===i){const e=t;e?.get&&(a=e.get),e?.set&&(o=e.set);const n=m(this,!a&&!s),i=c(this,l);Object.defineProperty(this,l,{configurable:i?.configurable??!0,enumerable:i?.enumerable??!0,get:()=>(d.track(n),f.call(this)),set:t=>n.set(t)})}else if("getter"===i||"setter"===i){const t=d.constructorData(e).installed;if(t.get(l))return;t.set(l,!0);const n=c(e,l)??{};"function"==typeof n.get&&(a=n.get),"function"==typeof n.set&&(o=n.set),Object.defineProperty(e,l,{configurable:n?.configurable??!0,enumerable:!!n?.enumerable,get:function(){const t=m(this,!a&&!s);return d.track(t),f.call(this)},set:function(t){m(this,!a&&!s).set(t)}})}})}}(q),J=new class{utils;constructor(t){this.utils=t}makeEffect(t){const e=this.utils;return{callback:t,dependencies:new Set,cleanups:[],scheduled:!1,run(){for(const t of this.cleanups)t();this.cleanups=[],this.dependencies=new Set,e.activeEffect=this;try{this.callback()}finally{e.activeEffect=null}for(const t of this.dependencies){const s=t.sub(()=>e.schedule(this));this.cleanups.push(s)}},dispose(){for(const t of this.cleanups)t();this.cleanups=[],this.dependencies.clear()}}}}(q);function X(...t){return 2===t.length&&t[1]&&"object"==typeof t[1]&&"kind"in t[1]&&"name"in t[1]&&"static"in t[1]&&"private"in t[1]?Y.signalDecorator(t[0],t[1]):"function"==typeof t[0]&&"function"==typeof t[1]?Y.createBoxFromEntry(q.createSignalEntry(void 0,t[2],t[3],t[0],t[1])):Y.createBoxFromEntry(q.createSignalEntry(t[0],t[1],t[2]))}function Q(t,e){return function(s,n){const i=t??String(n.name);return n.addInitializer(function(){q.bindBlockKey(this,n.name,i,e)}),Y.signalDecorator(s,n,function(){return this.getData?.(i,e)},function(t){this.setData?.(i,t,e)})}}function Z(t,e){return function(s,n){const i=t??String(n.name);return Y.signalDecorator(s,n,function(){return this.getBlockData?.(i)},function(t){this.setBlock?.(t,e,i)})}}function tt(t){return function(e,s){const n=t??String(s.name);return Y.signalDecorator(e,s,function(){return this.getBlockId?.(n)},function(t){this.setBlockId?.(t,n)})}}function et(...t){const e=t[0],s=t[1];if(s&&"object"==typeof s&&"kind"in s&&"name"in s&&"static"in s&&"private"in s){const{kind:t,name:n,static:i}=s,a=String(n);if("method"!==t&&"getter"!==t&&("field"!==t||"function"!=typeof e))throw new Error("@effect can only decorate zero-arg instance methods or getters.");if(i)throw new Error("@effect does not support static methods/getters.");s.addInitializer?.(function(){const t=this,s=function(){e?.call(this)},n=J.makeEffect(()=>s.call(t));q.setEffect(t,a,n)})}else if("function"==typeof e){const t=J.makeEffect(e);return t.run(),()=>t.dispose()}}function st(t,e){return q.getSignal(t,e)}function nt(t,e,s){return q.setSignal(t,e,s)}function it(t,e,s){let n;return l(s)||(n=q.getKeyFromBlockKey(t,e,s)),l(n)&&(n=e),q.markDirty(t,n)}function at(t){for(const[,e]of q.data(t).propertyKeyMap)e.effect?.run()}function rt(t,e){const s=q.getReactivityData(t,e);s.effect?.dispose(),s.effect=void 0}function ot(t){for(const[,e]of q.data(t).propertyKeyMap)e.effect?.dispose(),e.effect=void 0}class lt{_weakRefs;constructor(){this._weakRefs=new Set}add(t){return this.has(t)||this._weakRefs.add(new WeakRef(t)),this}has(t){for(const e of this._weakRefs)if(e.deref()===t)return!0;return!1}delete(t){for(const e of this._weakRefs)if(e.deref()===t)return this._weakRefs.delete(e),!0;return!1}cleanup(){for(const t of this._weakRefs)void 0===t.deref()&&this._weakRefs.delete(t)}toArray(){const t=[];for(const e of this._weakRefs){const s=e.deref();void 0!==s?t.push(s):this._weakRefs.delete(e)}return t}get size(){return this.cleanup(),this.toArray().length}clear(){this._weakRefs.clear()}}class ct{callbacks=new Set;add(t){this.callbacks.add(t)}remove(t){return this.callbacks.delete(t)}has(t){return this.callbacks.has(t)}fire(...t){let e;for(const s of this.callbacks)try{const n=s(...t);l(n)||(e=n)}catch(t){console.error("Error invoking callback:",t)}return e}clear(){this.callbacks.clear()}}class ht extends ct{onAdded=new ct;add(t){super.add(t),this.onAdded.fire(t)}}let ut=(()=>{let s,n=[],i=[];return class{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[m({defaultValue:!0})],t(this,null,s,{kind:"accessor",name:"enabledCallbacks",static:!1,private:!1,access:{has:t=>"enabledCallbacks"in t,get:t=>t.enabledCallbacks,set:(t,e)=>{t.enabledCallbacks=e}},metadata:e},n,i),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}id;data;#e=e(this,n,void 0);get enabledCallbacks(){return this.#e}set enabledCallbacks(t){this.#e=t}isInitialized=(e(this,i),!1);host;signals=new Map;changeObservers=new lt;onKeyChanged=new ht;constructor(t={}){this.id=t.id,this.data=t.data}get(t){return this.data instanceof Map?this.data.get(t):this.data?.[t]}set(t,e){if(!this.data)return;const s=this.get(t);Object.is(s,e)||(this.data instanceof Map?this.data.set(t,e):this.data[t]=e,this.keyChanged(t,e))}has(t){return this.data instanceof Map?this.data.has(t):void 0!==this.data?.[t]}delete(t){this.data&&this.has(t)&&(this.data instanceof Map?this.data.delete(t):delete this.data[t],this.keyChanged(t,void 0,!0))}get keys(){return this.data&&"object"==typeof this.data?this.data instanceof Map?Array.from(this.data.keys()):[...Object.keys(this.data),...Object.getOwnPropertySymbols(this.data)]:[]}get values(){return this.keys.map(t=>this.get(t))}get size(){return this.keys.length}initialize(){if(this.data){for(const t of this.keys)this.keyChanged(t);this.isInitialized=!0,this.changeObservers.toArray().forEach(t=>t.initialize())}}clear(t=!0){t&&(this.data=void 0),this.changeObservers?.toArray().forEach(t=>t.clear())}toJSON(){if(this.data instanceof Map)return Object.fromEntries(this.data);if(this.data&&"object"==typeof this.data){const t={};for(const e of this.keys)t[e]=this.get(e);return t}return{}}link(t){this.host=t}unlink(){this.host=void 0}makeSignal(t){if(this.signals.has(t))return this.signals.get(t);const e=X(()=>this.get(t),e=>this.set(t,e),this,t);return this.signals.set(t,e),e}getSignal(t){return this.signals.get(t)}makeAllSignals(){this.keys.forEach(t=>this.makeSignal(t))}generateObserver(t={}){const e={onAdded:new ht,onUpdated:new ht,onDeleted:new ht,instances:new Map,getInstance:t=>e.instances.get(t),getAllInstances:()=>{const t=Array.from(e.instances.entries());return t.sort((t,e)=>this.sortingFunction(t[0],e[0])),t.map(t=>t[1])},initialize:()=>{if(this.isInitialized)for(const t of this.keys)this.observerKeyChanged(e,t)},clear:()=>{e.instances.forEach(t=>this.removeInstance(t)),e.instances.clear()},destroy:()=>{e.clear(),this.changeObservers?.delete(e)}};return e.onUpdated.add((t,e,s)=>{"object"==typeof e&&("data"in e&&(e.data=t),"dataId"in e&&(e.dataId=s.toString()))}),e.onDeleted.add((t,s,n)=>{this.removeInstance(s),e.instances.delete(n)}),t.onAdded&&e.onAdded.add((e,s)=>t.onAdded(e,s)),t.onUpdated&&e.onUpdated.add((e,s,n)=>t.onUpdated(e,s,n)),t.onDeleted&&e.onDeleted.add((e,s,n)=>t.onDeleted(e,s,n)),t.initialize&&e.initialize(),this.changeObservers?.add(e),e}observerKeyChanged(t,e,s=this.get(e),n=!1){const i=t.instances.get(e);if(i)return void(n?(t.onDeleted.fire(s,i,e),t.instances.delete(e),this.removeInstance(i)):t.onUpdated.fire(s,i,e));if(n)return;const a=t.onAdded.fire(s,e);a&&(t.instances.set(e,a),t.onUpdated.fire(s,a,e))}keyChanged(t,e=this.get(t),s=!1){this.signals.get(t)?.emit(),this.host?.onDirty?.(t,this),s&&this.signals.delete(t),this.enabledCallbacks&&(this.onKeyChanged.fire(t,e),this.host?.onChange?.(t,e,this),this.changeObservers?.toArray().forEach(n=>this.observerKeyChanged(n,t,e,s)))}sortingFunction(t,e){return"string"==typeof t&&"string"==typeof e?t.localeCompare(e):"number"==typeof t&&"number"==typeof e?t-e:0}removeInstance(t){t&&"object"==typeof t&&"remove"in t&&"function"==typeof t.remove&&t?.remove()}}})(),dt=(()=>{let s,n=[];return class{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[m()],t(this,null,s,{kind:"setter",name:"enabledCallbacks",static:!1,private:!1,access:{has:t=>"enabledCallbacks"in t,set:(t,e)=>{t.enabledCallbacks=e}},metadata:e},null,n),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}isDataBlocksArray=(e(this,n),!1);dataBlocks;handlers;keyChangedCallback;onDirty(t,e){it(this,t,this.getBlockKey(e))}onChange(t,e,s){this.keyChangedCallback.fire(t,this.getBlockKey(s),e)}constructor(t,e){this.keyChangedCallback=new ht,"array"===e?(this.isDataBlocksArray=!0,this.dataBlocks=[]):(this.isDataBlocksArray=!1,this.dataBlocks=new Map),this.enabledCallbacks=!0,this.setBlock(t,void 0,this.defaultBlockKey,!1)}get block(){return this.getBlock()}set block(t){this.setBlock(t)}get data(){return this.getBlockData()}set data(t){this.setBlock(t)}get dataId(){return this.getBlockId()}set dataId(t){this.setBlockId(t)}set enabledCallbacks(t){this.getAllBlocks().forEach(e=>e.enabledCallbacks=t)}getBlock(t=this.defaultBlockKey){if(this.isValidBlockKey(t)){if(!this.isDataBlocksArray)return this.dataBlocks.get(t.toString());{const e=Number(t);if(Number.isInteger(e)&&e>=0&&e<this.dataBlocks.length)return this.dataBlocks[e]}}}createBlock(t,e){const s=t instanceof ut?t:new ut({id:e,data:t});return s.link(this),s}setBlock(t,e,s=this.defaultBlockKey,n=!0){if(!this.isValidBlockKey(s)||null==t)return;const i=this.getBlock(s);i?.clear(),i?.unlink();const a=this.createBlock(t,e);if(this.isDataBlocksArray){const t=Number(s);Number.isInteger(t)&&t>=0&&(this.dataBlocks[t]=a)}else this.dataBlocks.set(s.toString(),a);n&&this.initialize(s)}hasBlock(t){if(this.isDataBlocksArray){const e=Number(t);return Number.isInteger(e)&&e>=0&&e<this.dataBlocks.length}return this.dataBlocks.has(t.toString())}deleteBlock(t){const e=this.getBlock(t);if(e)if(e.clear(),e.unlink(),this.isDataBlocksArray){const e=Number(t);Number.isInteger(e)&&e>=0&&e<this.dataBlocks.length&&this.dataBlocks.splice(e,1)}else this.dataBlocks.delete(t.toString())}addBlock(t,e,s,n=!0){if(!t)return;if(!this.isDataBlocksArray)return this.setBlock(t,e,s,n);const i=this.createBlock(t,e);let a=Number(s);(!Number.isInteger(a)||a<0)&&(a=this.dataBlocks.length),this.dataBlocks.splice(a,0,i),n&&this.initialize(a)}getData(t,e=this.defaultBlockKey){return this.getBlock(e)?.get(t)}setData(t,e,s=this.defaultBlockKey){return this.getBlock(s)?.set(t,e)}hasData(t,e=this.defaultBlockKey){return this.getBlock(e)?.has(t)}deleteData(t,e=this.defaultBlockKey){return this.getBlock(e)?.delete(t)}getSize(t=this.defaultBlockKey){return this.getBlock(t)?.size??0}toJSON(t=this.defaultBlockKey){return this.getBlock(t)?.toJSON()}getBlockData(t=this.defaultBlockKey){return this.getBlock(t)?.data}getBlockId(t=this.defaultBlockKey){return this.getBlock(t)?.id}setBlockId(t,e=this.defaultBlockKey){if(!t)return;const s=this.getBlock(e);s&&(s.id=t)}fireCallback(t,...e){this.keyChangedCallback.fire(t,this.defaultBlockKey,...e)}fireBlockCallback(t,e=this.defaultBlockKey,...s){this.isValidBlockKey(e)||(e=this.getAllBlockKeys()[0]),this.keyChangedCallback.fire(t,e,...s)}initialize(t=this.defaultBlockKey){this.getBlock(t)?.initialize()}clear(t=!0,e=this.defaultBlockKey){this.getBlock(e)?.clear(t)}get defaultBlockKey(){return this.isDataBlocksArray?0:"__turbo_default_block_key__"}get defaultComputationBlockKey(){return(this.isDataBlocksArray?this.dataBlocks.length:this.dataBlocks.size)>1?null:this.defaultBlockKey}isValidBlockKey(t){return null!=t&&("string"==typeof t&&0!==t.length||"number"==typeof t)}getAllBlockKeys(){return this.isDataBlocksArray?this.dataBlocks.map((t,e)=>e):Array.from(this.dataBlocks.keys())}getAllBlockIds(){return this.getAllBlocks().map(t=>t.id)}getAllBlocks(t=this.defaultComputationBlockKey){const e=[];if(null!==t){const s=this.getBlock(t);s&&e.push(s)}else for(const t of this.getAllBlockKeys()){const s=this.getBlock(t);s&&e.push(s)}return e}getBlockKey(t){for(const e of this.getAllBlockKeys())if(this.getBlock(e)===t)return e}getAllKeys(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap(t=>t.keys)}getAllValues(t=this.defaultComputationBlockKey){return this.getAllBlocks(t).flatMap(t=>t.values)}getHandler(t){return this.handlers?.get(t)}addHandler(t){t.keyName&&this.handlers?.set(t.keyName,t)}}})();const ft={keyPressed:"turbo-key-pressed",keyReleased:"turbo-key-released"},pt={keyPressed:"keydown",keyReleased:"keyup"},mt={click:"turbo-click",clickStart:"turbo-click-start",clickEnd:"turbo-click-end",longPress:"turbo-long-press"},gt={click:"click",clickStart:"mousedown",clickEnd:"mouseup",longPress:mt.longPress},bt={move:"turbo-move"},yt={move:"mousemove"},vt={drag:"turbo-drag",dragStart:"turbo-drag-start",dragEnd:"turbo-drag-end"},kt={drag:vt.drag,dragStart:vt.dragStart,dragEnd:vt.dragEnd},St={trackpadScroll:"turbo-trackpad-scroll",trackpadPinch:"turbo-trackpad-pinch",mouseWheel:"turbo-mouse-wheel"},Et={trackpadScroll:"wheel",trackpadPinch:"wheel",mouseWheel:"wheel"},wt={...mt,...ft,...bt,...vt,...St,selectInput:"turbo-select-input"},Ct={...pt,...gt,...yt,...kt,...Et,wheel:"wheel",scroll:"scroll",input:"input",change:"change",focus:"focus",focusIn:"focusin",focusOut:"focusout",blur:"blur",resize:"resize",compositionStart:"compositionstart",compositionEnd:"compositionend"};function Ot(t){if(null!=t)switch(typeof t){case"string":return t;case"number":case"boolean":case"bigint":case"symbol":case"function":return t.toString();case"object":if(Array.isArray(t))return JSON.stringify(t);if(t instanceof Date)return t.toISOString();try{return JSON.stringify(t)}catch{return"[object Object]"}default:return String(t)}}function Tt(t){if(!l(t)){switch(t){case"null":return null;case"true":return!0;case"false":return!1}if(!isNaN(Number(t)))return Number(t);if(/^\d+n$/.test(t))return BigInt(t.slice(0,-1));if(t.startsWith("function")||t.startsWith("("))try{const e=new Function(`return (${t})`)();if("function"==typeof e)return e}catch{}try{const e=JSON.parse(t);if("object"==typeof e&&null!=e)return e}catch{}return t}}function Pt(t){if(!t||0==t.length)return"";const e=t.match(/\.\S{1,4}$/);return e?e[0]:""}function xt(t){if(t&&0!=t.length)return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function Dt(t){if(t&&0!=t.length)return t.replace(/-([a-z])/g,t=>t[1].toUpperCase())}const At=["mousedown","mouseup","mousemove","click","dblclick","contextmenu","dragstart","selectstart","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","wheel"],Mt=["wheel","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointercancel"];var jt,It,Bt;function Nt(t,e,s){const n=Symbol(`__${e.toLowerCase()}_${String(t.name)}`),i=function(t,e,s){return t??(String(s.name).endsWith(e)?String(s.name).slice(0,-e.length):String(s.name))}(s,e,t);t.addInitializer(function(){Object.defineProperty(this,t.name,{configurable:!0,enumerable:!1,get:function(){if(this[n])return this[n];let t,s;switch(e){case"Controller":s="getController";break;case"Handler":s="getHandler";break;case"Interactor":s="getInteractor";break;case"Tool":s="getTool";break;case"Substrate":s="getSubstrate"}if(s){if(this.mvc&&this.mvc instanceof G?t=this.mvc[s](i):this[s]&&"function"==typeof this[s]&&(t=this[s](i)),!t)throw new Error(`${e} "${i}" not found on ${this?.constructor?.name}.`);return this[n]=t,t}},set:function(t){this[n]=t}})})}function Vt(t){return function(e,s){Nt(s,"Controller",t)}}function _t(t){return function(e,s){Nt(s,"Handler",t)}}function zt(t){return function(e,s){Nt(s,"Interactor",t)}}function Ft(t){return function(e,s){Nt(s,"Tool",t)}}function Lt(t){return function(e,s){Nt(s,"Substrate",t)}}!function(t){t[t.none=0]="none",t[t.click=1]="click",t[t.longPress=2]="longPress",t[t.drag=3]="drag"}(jt||(jt={})),function(t){t[t.none=0]="none",t[t.left=1]="left",t[t.right=2]="right",t[t.middle=3]="middle",t[t.other=4]="other",t[t.key=5]="key"}(It||(It={})),function(t){t[t.unknown=0]="unknown",t[t.mouse=1]="mouse",t[t.trackpad=2]="trackpad",t[t.touch=3]="touch"}(Bt||(Bt={}));class Rt extends Map{enforceImmutability=!0;set(t,e){return super.set(t,this.enforceImmutability?this.copy(e):e)}get(t){const e=super.get(t);return this.enforceImmutability?this.copy(e):e}get first(){if(0==this.size)return null;const t=this.values().next().value;return this.enforceImmutability?this.copy(t):t}get last(){if(0==this.size)return null;const t=this.valuesArray()[this.size-1];return this.enforceImmutability?this.copy(t):t}keysArray(){return Array.from(this.keys())}valuesArray(){return Array.from(this.values())}copy(t){if(t&&"object"==typeof t){if(t instanceof Array)return t.map(t=>this.copy(t));if(t.constructor&&t.constructor!=Object){if("function"==typeof t.clone)return t.clone();if("function"==typeof t.copy)return t.copy()}return{...t}}return t}mapKeys(t){const e=new Rt;for(let[s,n]of this)e.set(t(s,n),n);return e}mapValues(t){const e=new Rt;for(let[s,n]of this)e.set(s,t(s,n));return e}filter(t){const e=new Rt;for(let[s,n]of this)t(s,n)&&e.set(s,n);return e}merge(t){for(let[e,s]of t)this.set(e,s);return this}}let Wt=(()=>{let s,n,i=dt,a=[],r=[],o=[];return class extends i{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(i[Symbol.metadata]??null):void 0;s=[_t()],n=[m({callBefore:function(t){t==Bt.trackpad&&(this.wasRecentlyTrackpad=!0)}})],t(this,null,n,{kind:"setter",name:"inputDevice",static:!1,private:!1,access:{has:t=>"inputDevice"in t,set:(t,e)=>{t.inputDevice=e}},metadata:e},null,a),t(null,null,s,{kind:"field",name:"utils",static:!1,private:!1,access:{has:t=>"utils"in t,get:t=>t.utils,set:(t,e)=>{t.utils=e}},metadata:e},r,o),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}utils=(e(this,a),e(this,r,void 0));state=(e(this,o),{});lockState={};onInputDeviceChange=new ht;onToolChange=new ht;currentKeys=[];currentAction=jt.none;currentClick=It.none;wasRecentlyTrackpad=!1;moveThreshold;longPressDuration;authorizeEventScaling;scaleEventPosition;activePointers=new Set;origins=new Rt;previousPositions=new Rt;positions;lastTargetOrigin;timerMap=new Rt;tools=new Map;mappedKeysToTool=new Map;currentTools=new Map;set inputDevice(t){this.onInputDeviceChange.fire(t)}}})();var Kt;!function(t){t.target="target",t.position="position"}(Kt||(Kt={}));let Ht=(()=>{let s,n,i=Event,a=[];return class extends i{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(i[Symbol.metadata]??null):void 0;s=[_e()],n=[_e()],t(this,null,s,{kind:"method",name:"closest",static:!1,private:!1,access:{has:t=>"closest"in t,get:t=>t.closest},metadata:e},null,a),t(this,null,n,{kind:"getter",name:"scaledPosition",static:!1,private:!1,access:{has:t=>"scaledPosition"in t,get:t=>t.scaledPosition},metadata:e},null,a),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}eventManager=e(this,a);toolName;eventName;clickMode;keys;position;authorizeScaling;scalePosition;constructor(t){super(t.eventName,{bubbles:!0,cancelable:!0,...t.eventInitDict}),this.eventManager=t.eventManager??ae.instance,this.authorizeScaling=t.authorizeScaling??!0,this.scalePosition=t.scalePosition??(t=>t),this.clickMode=t.clickMode??ae.instance.currentClick,this.keys=t.keys??ae.instance.currentKeys,this.eventName=t.eventName,this.position=t.position,this.toolName=t.toolName}get tool(){return this.toolName&&this.eventManager instanceof ae?this.eventManager.getToolByName(this.toolName):null}closest(t,e=!0,s=Kt.target){const n=s==Kt.target?[this.target]:document.elementsFromPoint(this.position.x,this.position.y),i=e instanceof Element?e:null,a=!0===e||null!==i;for(let e of n){for(;e&&(!(e instanceof t)||a&&!this.isPositionInsideElement(this.position,i??e));)e=e.parentElement;if(e)return e}return null}isPositionInsideElement(t,e){const s=e.getBoundingClientRect();return t.x>=s.left&&t.x<=s.right&&t.y>=s.top&&t.y<=s.bottom}get target(){return super.target||document}get scaledPosition(){return this.scalingAuthorized?this.scalePosition(this.position):this.position}get scalingAuthorized(){return"function"==typeof this.authorizeScaling?this.authorizeScaling():this.authorizeScaling}scalePositionsMap(t){return t.mapValues((t,e)=>this.scalePosition(e))}}})();class Ut extends Ht{keyPressed;keyReleased;constructor(t){super({...t,position:null}),this.keyPressed=t.keyPressed,this.keyReleased=t.keyReleased}}class $t{keyName;element;view;model;emitter;constructor(t){this.element=t.element,t.model&&(this.model=t.model),t.emitter&&(this.emitter=t.emitter),t.view&&(this.view=t.view)}initialize(){this.setupChangedCallbacks()}setupChangedCallbacks(){at(this)}}class Gt extends $t{keyName="key";keyDown=t=>this.keyDownFn(t);keyDownFn(t){this.element.enabled&&(this.model.currentKeys.includes(t.key)||(this.model.currentKeys.push(t.key),this.emitter.fire("dispatchEvent",document,Ut,{eventName:ft.keyPressed,keyPressed:t.key})))}keyUp=t=>this.keyUpFn(t);keyUpFn(t){this.element.enabled&&this.model.currentKeys.includes(t.key)&&(this.model.currentKeys.splice(this.model.currentKeys.indexOf(t.key),1),this.emitter.fire("dispatchEvent",document,Ut,{eventName:ft.keyReleased,keyReleased:t.key}))}}class qt extends Ht{delta;constructor(t){super({...t,position:null}),this.delta=t.delta}}class Yt{x;y;constructor(t=0,e=("number"==typeof t?t:0)){"number"==typeof t?(this.x=t,this.y=e):"clientX"in t?(this.x=t.clientX,this.y=t.clientY):"x"in t?(this.x=t.x,this.y=t.y):(this.x=t[0],this.y=t[1])}static dist(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static midPoint(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>t+e.x,0)/t.length,s=t.reduce((t,e)=>t+e.y,0)/t.length;return new Yt(e,s)}static max(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>Math.max(t,e.x),-1/0),s=t.reduce((t,e)=>Math.max(t,e.y),-1/0);return new Yt(e,s)}static min(...t){if(0==t.length)return null;const e=t.reduce((t,e)=>Math.min(t,e.x),1/0),s=t.reduce((t,e)=>Math.min(t,e.y),1/0);return new Yt(e,s)}get object(){return{x:this.x,y:this.y}}equals(t,e=0){return"number"==typeof t?this.x==t&&this.y==e:this.x==t.x&&this.y==t.y}boundX(t,e){return this.x<t?t:this.x>e?e:this.x}boundY(t,e){return this.y<t?t:this.y>e?e:this.y}bound(t,e,s=t,n=e){return new Yt(this.boundX(t,e),this.boundY(s,n))}add(t,e){return"number"==typeof t?new Yt(this.x+t,this.y+(e||0==e?e:t)):new Yt(this.x+t.x,this.y+t.y)}sub(t,e){return"number"==typeof t?new Yt(this.x-t,this.y-(e||0==e?e:t)):new Yt(this.x-t.x,this.y-t.y)}mul(t,e){return"number"==typeof t?new Yt(this.x*t,this.y*(e||0==e?e:t)):new Yt(this.x*t.x,this.y*t.y)}div(t,e){return"number"==typeof t?new Yt(this.x/t,this.y/(e||0==e?e:t)):new Yt(this.x/t.x,this.y/t.y)}mod(t,e){const s="number"==typeof t?{x:t,y:e||0==e?e:t}:{x:t.x,y:t.y},n=this.object;for(;n.x<0;)n.x+=s.x;for(;n.x>=s.x;)n.x-=s.x;for(;n.y<0;)n.y+=s.y;for(;n.y>=s.y;)n.y-=s.y;return new Yt(n)}get abs(){return new Yt(Math.abs(this.x),Math.abs(this.y))}get max(){return Math.max(this.x,this.y)}get min(){return Math.min(this.x,this.y)}get length2(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length2)}dot(t){return this.x*t.x+this.y*t.y}copy(){return new Yt(this.x,this.y)}arr(){return[this.x,this.y]}}class Jt extends $t{keyName="wheel";wheel=t=>{if(!this.element.enabled)return;let e;this.element.preventDefaultWheel&&t.preventDefault(),(Math.abs(t.deltaY)<=40||0!=t.deltaX)&&(this.model.inputDevice=Bt.trackpad),this.model.wasRecentlyTrackpad||(this.model.inputDevice=Bt.mouse),this.model.utils.clearTimer("recentlyTrackpadTimer"),this.model.utils.setTimer("recentlyTrackpadTimer",()=>{this.model.inputDevice==Bt.trackpad&&(this.model.wasRecentlyTrackpad=!1)},800),e=this.model.inputDevice==Bt.trackpad&&t.ctrlKey?wt.trackpadPinch:this.model.inputDevice==Bt.trackpad?wt.trackpadScroll:wt.mouseWheel,this.emitter.fire("dispatchEvent",document,qt,{delta:new Yt(t.deltaX,t.deltaY),eventName:e})}}let Xt=(()=>{let s,n,i,a,r,o,l,c=Ht,h=[];return class extends c{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;s=[_e()],n=[_e()],i=[_e()],a=[_e()],r=[_e()],o=[_e()],l=[_e()],t(this,null,s,{kind:"getter",name:"scaledOrigins",static:!1,private:!1,access:{has:t=>"scaledOrigins"in t,get:t=>t.scaledOrigins},metadata:e},null,h),t(this,null,n,{kind:"getter",name:"scaledPreviousPositions",static:!1,private:!1,access:{has:t=>"scaledPreviousPositions"in t,get:t=>t.scaledPreviousPositions},metadata:e},null,h),t(this,null,i,{kind:"getter",name:"scaledPositions",static:!1,private:!1,access:{has:t=>"scaledPositions"in t,get:t=>t.scaledPositions},metadata:e},null,h),t(this,null,a,{kind:"getter",name:"deltaPositions",static:!1,private:!1,access:{has:t=>"deltaPositions"in t,get:t=>t.deltaPositions},metadata:e},null,h),t(this,null,r,{kind:"getter",name:"deltaPosition",static:!1,private:!1,access:{has:t=>"deltaPosition"in t,get:t=>t.deltaPosition},metadata:e},null,h),t(this,null,o,{kind:"getter",name:"scaledDeltaPositions",static:!1,private:!1,access:{has:t=>"scaledDeltaPositions"in t,get:t=>t.scaledDeltaPositions},metadata:e},null,h),t(this,null,l,{kind:"getter",name:"scaledDeltaPosition",static:!1,private:!1,access:{has:t=>"scaledDeltaPosition"in t,get:t=>t.scaledDeltaPosition},metadata:e},null,h),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}origins=e(this,h);previousPositions;positions;constructor(t){super({...t,position:t.positions.first}),this.origins=t.origins,this.previousPositions=t.previousPositions,this.positions=t.positions}get scaledOrigins(){return this.scalingAuthorized?this.scalePositionsMap(this.origins):this.origins}get scaledPreviousPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.previousPositions):this.previousPositions}get scaledPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.positions):this.positions}get deltaPositions(){return this.positions.mapValues((t,e)=>{const s=this.previousPositions.get(t);if(s)return e.sub(s)})}get deltaPosition(){return Yt.midPoint(...this.deltaPositions.valuesArray())}get scaledDeltaPositions(){return this.scaledPositions.mapValues((t,e)=>{const s=this.scaledPreviousPositions.get(t);if(s)return e.sub(s)})}get scaledDeltaPosition(){return Yt.midPoint(...this.scaledDeltaPositions.valuesArray())}}})();class Qt extends $t{keyName="pointer";pointerDown=t=>this.pointerDownFn(t);pointerMove=t=>this.pointerMoveFn(t);pointerUp=t=>this.pointerUpFn(t);pointerCancel=t=>this.pointerCancelFn(t);lostPointerCapture=t=>this.lostPointerCaptureFn(t);pointerDownFn(t){if(t.composedPath().includes(this.model.lockState.lockOrigin)||(document.activeElement?.blur?.(),this.element.unlock()),!this.element.enabled)return;const e="touch"===t.pointerType;this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),e?this.model.inputDevice=Bt.touch:this.model.inputDevice!==Bt.unknown&&this.model.inputDevice!==Bt.touch||(this.model.inputDevice=Bt.mouse);const s=t.pointerId,n=new Yt(t.clientX,t.clientY);this.model.origins.set(s,n),this.model.previousPositions.set(s,n);const i=document.elementFromPoint(n.x,n.y);i&&i.setPointerCapture?.(t.pointerId),this.model.activePointers.add(s),this.model.utils.setClickMode(e?this.model.activePointers.size:t.button,e),this.element.clickEventEnabled&&(this.fireClick(this.model.origins.first,wt.clickStart),this.model.currentAction=jt.click,this.model.utils.setTimer(wt.longPress,()=>{this.model.currentAction===jt.click&&(this.model.currentAction=jt.longPress,this.fireClick(this.model.origins.first,wt.longPress))},this.model.longPressDuration))}pointerMoveFn(t){if(!this.element.enabled)return;if(!this.element.moveEventsEnabled&&!this.element.dragEventEnabled)return;const e="touch"===t.pointerType;if(this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),this.model.positions=new Rt,this.model.positions.set(t.pointerId,new Yt(t.clientX,t.clientY)),this.model.currentAction!==jt.drag&&(this.model.lastTargetOrigin=null),this.element.moveEventsEnabled&&this.fireDrag(this.model.positions,wt.move),this.model.currentAction!==jt.none&&this.element.dragEventEnabled){if(this.model.currentAction!==jt.drag){if(!Array.from(this.model.origins.entries()).some(([e,s])=>{const n=e===t.pointerId?this.model.positions.get(e):this.model.previousPositions.get(e);return n&&Yt.dist(n,s)>this.model.moveThreshold}))return;ze(this),this.fireDrag(this.model.origins,wt.dragStart),this.model.currentAction=jt.drag}this.fireDrag(this.model.positions)}this.model.previousPositions.set(t.pointerId,this.model.positions.get(t.pointerId))}pointerUpFn(t){if(!this.element.enabled)return;const e="touch"===t.pointerType;this.element.preventDefaultMouse&&!e&&t.preventDefault(),this.element.preventDefaultTouch&&e&&t.preventDefault(),this.model.utils.clearTimer(wt.longPress),this.model.positions=new Rt,this.model.positions.set(t.pointerId,new Yt(t.clientX,t.clientY)),this.model.currentAction===jt.drag&&this.element.dragEventEnabled&&this.fireDrag(this.model.positions,wt.dragEnd),this.element.clickEventEnabled&&(this.model.currentAction===jt.click&&this.fireClick(this.model.positions.first,wt.click),this.fireClick(this.model.origins.first,wt.clickEnd)),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=jt.none,this.model.currentClick=It.none)}pointerCancelFn(t){this.model.utils.clearTimer(wt.longPress),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=jt.none,this.model.currentClick=It.none)}lostPointerCaptureFn(t){}fireClick(t,e=wt.click){if(!t)return;const s=document.elementFromPoint(t.x,t.y)||document;this.emitter.fire("dispatchEvent",s,Ht,{position:t,eventName:e})}fireDrag(t,e=wt.drag){t&&this.emitter.fire("dispatchEvent",this.getFireOrigin(t),Xt,{positions:t,previousPositions:this.model.previousPositions,origins:this.model.origins,eventName:e})}getFireOrigin(t,e=!1){if(!this.model.lastTargetOrigin||e){const e=this.model.origins.first?this.model.origins.first:t.first;this.model.lastTargetOrigin=document.elementFromPoint(e.x,e.y)}return this.model.lastTargetOrigin}}class Zt extends $t{keyName="dispatch";boundHooks=new Map;setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("dispatchEvent",this.dispatchEvent)}dispatchEvent=(t,e,s)=>{t&&(s.keys=this.model.currentKeys,s.toolName=this.element.getCurrentToolName(this.model.currentClick),s.clickMode=this.model.currentClick,s.eventManager=this.element,s.eventInitDict={bubbles:!0,cancelable:!0,composed:!0},s.authorizeScaling=this.element.authorizeEventScaling,s.scalePosition=this.element.scaleEventPosition,s.eventName===ft.keyPressed?this.element.setToolByKey(s.keyPressed):s.eventName===ft.keyReleased&&this.element.setTool(void 0,It.key,{select:!1}),t.dispatchEvent(new e(s)))};getToolHandlingCallback(t,e){const s=this.element.getCurrentToolName(this.model.currentClick),n=e.composedPath?.()||[];for(let i=n.length-1;i>=0;i--)if(n[i]instanceof Node&&Ne(n[i]).executeAction(t,s,e,{capture:!0},this.element)){e.stopPropagation();break}for(let i=0;i<n.length;i++)if(n[i]instanceof Node&&Ne(n[i]).executeAction(t,s,e,void 0,this.element)){e.stopPropagation();break}}setupCustomDispatcher(t){if(this.boundHooks.has(t))return;const e=e=>this.getToolHandlingCallback(t,e);this.boundHooks.set(t,e),document.addEventListener(t,e,{capture:!0})}removeCustomDispatcher(t){const e=this.boundHooks.get(t);e&&(document.removeEventListener(t,e,{capture:!0}),this.boundHooks.delete(t))}}class te{keyName;model;constructor(t){this.model&&(this.model=t)}}class ee extends te{keyName="utils";setClickMode(t,e=!1){switch(e&&t--,t){case-1:return void(this.model.currentClick=It.none);case 0:return void(this.model.currentClick=It.left);case 1:return void(this.model.currentClick=It.middle);case 2:return void(this.model.currentClick=It.right);default:return void(this.model.currentClick=It.other)}}applyEventNames(t){for(const e in t)Ct[e]=t[e]}setTimer(t,e,s){this.clearTimer(t),this.model.timerMap.set(t,setTimeout(()=>{e(),this.clearTimer(t)},s))}clearTimer(t){const e=this.model.timerMap.get(t);e&&(clearTimeout(e),this.model.timerMap.delete(t))}selectTool(t,e){"selected"in t&&"boolean"==typeof t.selected&&(t.selected=e)}activateTool(t,e,s){s?Ne(t).onToolActivate(e).fire():Ne(t).onToolDeactivate(e).fire()}}function se(t){const e=t.prototype;Object.defineProperty(e,"view",{get(){return this.mvc?.view},set(t){if(!this.mvc)throw new Error("view: missing this.mvc");this.mvc.view=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"model",{get(){return this.mvc?.model},set(t){if(!this.mvc)throw new Error("model: missing this.mvc");this.mvc.model=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"data",{get(){return this.mvc?.data},set(t){if(!this.mvc)throw new Error("data: missing this.mvc");this.mvc.data=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataId",{get(){return this.mvc?.dataId},set(t){if(!this.mvc)throw new Error("dataId: missing this.mvc");this.mvc.dataId=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataIndex",{get(){return this.mvc?.dataIndex},set(t){if(!this.mvc)throw new Error("dataIndex: missing this.mvc");this.mvc.dataIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"dataSize",{get(){return this.mvc?.dataSize},enumerable:!0,configurable:!0})}function ne(t){const e=t.prototype,s=Symbol("__selected__"),n=Symbol("__selectedClass__"),i=Symbol("__initialized__");Object.defineProperty(e,"selected",{get(){return!!this[s]},set(t){const e=this instanceof Element?this:this.element instanceof Element?this.element:void 0;if(!e)return void(this[s]=t);const i=this[n],a=this.getPropertiesValue?.(null,"defaultSelectedClass","selected")??"selected";this[s]=t,this[n]=a,i&&i!==a&&Ne(e).toggleClass(i,!1),Ne(e).toggleClass(a,!!t)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"getPropertiesValue",{value:function(t,e,s){if(null!=t)return t;let n=this.constructor;for(;n;){const t=n.config?.[e];if(null!=t)return t;n=Object.getPrototypeOf(n)}return s},configurable:!0,enumerable:!1}),Object.defineProperty(e,"destroy",{value:function(){},configurable:!0,enumerable:!1}),Object.defineProperty(e,"initialized",{get:function(){return this[i]??!1},configurable:!0,enumerable:!1}),Object.defineProperty(e,"initialize",{value:function(){this[i]||(this.setupUIElements?.(),this.setupUILayout?.(),this.setupUIListeners?.(),this.setupChangedCallbacks?.(),this.mvc&&this.mvc instanceof G&&this.mvc.initialize(),at(this),this[i]=!0)},configurable:!0,enumerable:!1})}class ie{static config={};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}mvc;constructor(t={}){this.mvc=new G({...t,element:this})}}ne(ie),se(ie);let ae=(()=>{let s,n,i,a,r,o,c,h,u,d,f,p=ie,g=[],b=[],y=[],v=[],k=[],S=[],E=[],w=[],C=[];return class O extends p{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;s=[Vt()],n=[Vt()],i=[Vt()],a=[Vt()],r=[m()],o=[m()],c=[m()],h=[m()],u=[m()],d=[m()],f=[m()],t(this,null,r,{kind:"setter",name:"keyEventsEnabled",static:!1,private:!1,access:{has:t=>"keyEventsEnabled"in t,set:(t,e)=>{t.keyEventsEnabled=e}},metadata:e},null,g),t(this,null,o,{kind:"setter",name:"wheelEventsEnabled",static:!1,private:!1,access:{has:t=>"wheelEventsEnabled"in t,set:(t,e)=>{t.wheelEventsEnabled=e}},metadata:e},null,g),t(this,null,c,{kind:"setter",name:"moveEventsEnabled",static:!1,private:!1,access:{has:t=>"moveEventsEnabled"in t,set:(t,e)=>{t.moveEventsEnabled=e}},metadata:e},null,g),t(this,null,h,{kind:"setter",name:"mouseEventsEnabled",static:!1,private:!1,access:{has:t=>"mouseEventsEnabled"in t,set:(t,e)=>{t.mouseEventsEnabled=e}},metadata:e},null,g),t(this,null,u,{kind:"setter",name:"touchEventsEnabled",static:!1,private:!1,access:{has:t=>"touchEventsEnabled"in t,set:(t,e)=>{t.touchEventsEnabled=e}},metadata:e},null,g),t(this,null,d,{kind:"setter",name:"clickEventEnabled",static:!1,private:!1,access:{has:t=>"clickEventEnabled"in t,set:(t,e)=>{t.clickEventEnabled=e}},metadata:e},null,g),t(this,null,f,{kind:"setter",name:"dragEventEnabled",static:!1,private:!1,access:{has:t=>"dragEventEnabled"in t,set:(t,e)=>{t.dragEventEnabled=e}},metadata:e},null,g),t(null,null,s,{kind:"field",name:"keyController",static:!1,private:!1,access:{has:t=>"keyController"in t,get:t=>t.keyController,set:(t,e)=>{t.keyController=e}},metadata:e},b,y),t(null,null,n,{kind:"field",name:"wheelController",static:!1,private:!1,access:{has:t=>"wheelController"in t,get:t=>t.wheelController,set:(t,e)=>{t.wheelController=e}},metadata:e},v,k),t(null,null,i,{kind:"field",name:"pointerController",static:!1,private:!1,access:{has:t=>"pointerController"in t,get:t=>t.pointerController,set:(t,e)=>{t.pointerController=e}},metadata:e},S,E),t(null,null,a,{kind:"field",name:"dispatchController",static:!1,private:!1,access:{has:t=>"dispatchController"in t,get:t=>t.dispatchController,set:(t,e)=>{t.dispatchController=e}},metadata:e},w,C),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static managers=[];static get instance(){return O.managers.length>0?O.managers[0]:new O}static get allManagers(){return[...this.managers]}static set allManagers(t){this.managers=t}keyController=(e(this,g),e(this,b,void 0));wheelController=(e(this,y),e(this,v,void 0));pointerController=(e(this,k),e(this,S,void 0));dispatchController=(e(this,E),e(this,w,void 0));constructor(t={}){super(),e(this,C),this.mvc.generate({model:Wt,controllers:[Gt,Jt,Qt,Zt],handlers:[ee]}),O.managers.push(this),this.model.authorizeEventScaling=t.authorizeEventScaling,this.model.scaleEventPosition=t.scaleEventPosition,this.model.state.enabled=t.enabled??!0,this.model.state.preventDefaultMouse=t.preventDefaultMouse??!0,this.model.state.preventDefaultTouch=t.preventDefaultTouch??!0,this.model.state.preventDefaultWheel=t.preventDefaultWheel??!0,this.unlock(),this.model.moveThreshold=t.moveThreshold||10,this.model.longPressDuration=t.longPressDuration||500,t.disableKeyEvents||(this.keyEventsEnabled=!0),t.disableWheelEvents||(this.wheelEventsEnabled=!0),t.disableMouseEvents||(this.mouseEventsEnabled=!0),t.disableTouchEvents||(this.touchEventsEnabled=!0),t.disableDragEvents||(this.dragEventEnabled=!0),t.disableClickEvents||(this.clickEventEnabled=!0),t.disableMoveEvent||(this.moveEventsEnabled=!0),document.addEventListener("pointerdown",this.pointerController.pointerDown,{passive:!1}),document.addEventListener("pointermove",this.pointerController.pointerMove,{passive:!1}),document.addEventListener("pointerup",this.pointerController.pointerUp,{passive:!1}),document.addEventListener("pointercancel",this.pointerController.pointerCancel,{passive:!1}),this.dispatchController.setupCustomDispatcher("pointerdown")}get inputDevice(){return this.model.inputDevice}get onInputDeviceChange(){return this.model.onInputDeviceChange}get currentClick(){return this.model.currentClick}get currentKeys(){return this.model.currentKeys}get onToolChange(){return this.model.onToolChange}get authorizeEventScaling(){return this.model.authorizeEventScaling}set authorizeEventScaling(t){this.model.authorizeEventScaling=t}get scaleEventPosition(){return this.model.scaleEventPosition}set scaleEventPosition(t){this.model.scaleEventPosition=t}get moveThreshold(){return this.model.moveThreshold}set moveThreshold(t){this.model.moveThreshold=t}get longPressDuration(){return this.model.longPressDuration}set longPressDuration(t){this.model.longPressDuration=t}set keyEventsEnabled(t){t?(document.addEventListener("keydown",this.keyController.keyDown),document.addEventListener("keyup",this.keyController.keyUp)):(document.removeEventListener("keydown",this.keyController.keyDown),document.removeEventListener("keyup",this.keyController.keyUp)),this.applyAndHookEvents(ft,pt,t)}set wheelEventsEnabled(t){t?document.body.addEventListener("wheel",this.wheelController.wheel,{passive:!1}):document.body.removeEventListener("wheel",this.wheelController.wheel),this.applyAndHookEvents(St,Et,t)}set moveEventsEnabled(t){this.applyAndHookEvents(bt,yt,t)}set mouseEventsEnabled(t){}set touchEventsEnabled(t){}set clickEventEnabled(t){this.applyAndHookEvents(mt,gt,t)}set dragEventEnabled(t){this.applyAndHookEvents(vt,kt,t)}lock(t,e){this.unlock(),this.model.lockState.lockOrigin=t;for(const t in e)this.model.lockState[t]=e[t]}unlock(){const t=this.model.state,e=this.model.lockState;e.enabled=t.enabled,e.preventDefaultMouse=t.preventDefaultMouse,e.preventDefaultTouch=t.preventDefaultTouch,e.preventDefaultWheel=t.preventDefaultWheel,e.lockOrigin=document.body}get enabled(){return this.model.state.enabled&&this.model.lockState.enabled}set enabled(t){this.model.state.enabled=t}get preventDefaultWheel(){return this.model.state.preventDefaultWheel&&this.model.lockState.preventDefaultWheel}set preventDefaultWheel(t){this.model.state.preventDefaultWheel=t}get preventDefaultMouse(){return this.model.state.preventDefaultMouse&&this.model.lockState.preventDefaultMouse}set preventDefaultMouse(t){this.model.state.preventDefaultMouse=t}get preventDefaultTouch(){return this.model.state.preventDefaultTouch&&this.model.lockState.preventDefaultTouch}set preventDefaultTouch(t){this.model.state.preventDefaultTouch=t}get toolsArray(){const t=[];for(const e of this.model.tools.values())t.push(...e.toArray());return t}getCurrentTool(t=this.model.currentClick){return this.model.currentTools.get(t)}getCurrentTools(t=this.model.currentClick){return this.getToolsByName(this.getCurrentToolName(t))}getCurrentToolName(t=this.model.currentClick){return this.getToolName(this.getCurrentTool(t))}getToolName(t){for(const[e,s]of this.model.tools.entries())if(s.has(t))return e}getSimilarTools(t){for(const[e,s]of this.model.tools.entries())if(s.has(t))return s.toArray();return[]}getToolsByName(t){return this.model.tools.get(t)?.toArray()||[]}getToolByName(t,e){const s=this.getToolsByName(t);return e?s?.find(e):s?.[0]}getToolsByKey(t){const e=this.model.mappedKeysToTool.get(t);return e?this.getToolsByName(e):[]}getToolByKey(t,e){const s=this.getToolsByKey(t);return e?s?.find(e):s?.[0]}addTool(t,e,s){this.model.tools.has(t)||this.model.tools.set(t,new lt);const n=this.model.tools.get(t);n.has(e)||n.add(e),s&&this.model.mappedKeysToTool.set(s,t)}setTool(t,e,s={}){if(!l(t)&&!Ne(t).isTool(this))return;null==s.select&&(s.select=!0),null==s.activate&&(s.activate=!0),null==s.setAsNoAction&&(s.setAsNoAction=e==It.left);const n=this.model.currentTools.get(e);if(n){if(n===t)return;this.getSimilarTools(n).forEach(t=>{s.select&&this.model.utils.selectTool(t,!1),s.activate&&this.model.utils.activateTool(t,this.getToolName(n),!1)})}this.model.currentTools.set(e,t),s.setAsNoAction&&this.model.currentTools.set(It.none,t),this.getSimilarTools(t).forEach(e=>{s.activate&&this.model.utils.activateTool(e,this.getToolName(t),!0),s.select&&this.model.utils.selectTool(e,!0)}),this.onToolChange.fire(n,t,e)}setToolByKey(t){const e=this.model.mappedKeysToTool.get(t);return!!e&&(this.setTool(this.getToolByName(e),It.key,{select:!1}),!0)}setupCustomDispatcher(t){return this.dispatchController.setupCustomDispatcher(t)}applyAndHookEvents(t,e,s){this.model.utils.applyEventNames(s?t:e);for(const e in t)s?this.dispatchController.setupCustomDispatcher(e):this.dispatchController.removeCustomDispatcher(e)}destroy(){return this.keyEventsEnabled=!1,this.wheelEventsEnabled=!1,this.mouseEventsEnabled=!1,this.touchEventsEnabled=!1,this.dragEventEnabled=!1,this.clickEventEnabled=!1,this.onToolChange.clear(),this}}})();const re=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}getBoundListenersSet(t){let e=this.data(t).boundListeners;return e||(e=new Set,this.data(t).boundListeners=e),e}getPreventDefaultListeners(t){let e=this.data(t).preventDefaultListeners;return e||(e={},this.data(t).preventDefaultListeners=e),e}bypassManager(t,e,s){t instanceof g&&(t=t.element),t&&("boolean"==typeof s?e.lock(t,{enabled:s,preventDefaultWheel:s,preventDefaultMouse:s,preventDefaultTouch:s}):e.lock(t,{enabled:s.enabled??!1,preventDefaultWheel:s.preventDefaultWheel??!1,preventDefaultMouse:s.preventDefaultMouse??!1,preventDefaultTouch:s.preventDefaultTouch??!1}))}getBoundListeners(t,e,s,n,i=ae.instance){return t instanceof g&&(t=t.element),t?(n||(n={}),[...this.getBoundListenersSet(t)].filter(t=>t.type===e&&t.manager===i&&t.toolName===s).filter(t=>{if(!n)return!0;for(const[e,s]of Object.entries(n))if(t.options?.[e]!==s)return!1;return!0})):[]}};const oe=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}setStyle(t,e,s,n=!1,i=!0){if(n)return void(t.element.style[e]=s.toString());let a=this.data(t.element).pendingStyles;a&&"object"==typeof a||(a={},this.data(t.element).pendingStyles=a),a[e]=s,i&&this.applyStyles(t)}applyStyles(t){const e=this.data(t.element).pendingStyles;e&&"object"==typeof e&&requestAnimationFrame(()=>{for(const s in e)"cssText"==s?t.element.style.cssText+=";"+e.cssText:t.element.style[s]=e[s];this.data(t.element).pendingStyles={}})}};const le=new class{elements=new WeakMap;tools=new WeakMap;getOrCreate(t,e,s){let n=t.get(e);return n||(n=s(),t.set(e,n)),n}getElementData(t,e){t instanceof g&&(t=t.element);const s=this.getOrCreate(this.elements,t,()=>new WeakMap);return this.getOrCreate(s,e,()=>({tools:new Set,ignoreAllTools:!1,ignoredTools:new Map,activationDelegates:new Map,deactivationDelegates:new Map}))}getToolsData(t,e){const s=this.getOrCreate(this.tools,t,()=>new Map);return this.getOrCreate(s,e,()=>({behaviors:new Map}))}getActivationDelegate(t,e,s){const n=this.getElementData(t,s).activationDelegates;return n.get(e)||n.set(e,new ht),n.get(e)}getDeactivationDelegate(t,e,s){const n=this.getElementData(t,s).deactivationDelegates;return n.get(e)||n.set(e,new ht),n.get(e)}saveTool(t,e,s){t instanceof g&&(t=t.element),t&&this.getElementData(t,s).tools.add(e)}getToolNames(t,e){return t instanceof g&&(t=t.element),t?[...this.getElementData(t,e).tools]:[]}setEmbeddedToolTarget(t,e,s){e instanceof g&&(e=e.element),e&&(t instanceof g&&(t=t.element),t&&(this.getElementData(t,s).embeddedTarget=e))}getEmbeddedToolTarget(t,e){if(t instanceof g&&(t=t.element),t)return this.getElementData(t,e).embeddedTarget}addToolBehavior(t,e,s,n){const i=this.getToolsData(n,t).behaviors;this.getOrCreate(i,e,()=>new Set).add(s)}getToolBehaviors(t,e,s){const n=this.getToolsData(s,t).behaviors;return[...this.getOrCreate(n,e,()=>new Set)]}removeToolBehaviors(t,e,s){const n=this.getToolsData(s,t).behaviors;this.getOrCreate(n,e,()=>new Set).clear()}clearToolBehaviors(t){this.getOrCreate(this.tools,t,()=>new Map).clear()}ignoreTool(t,e,s,n,i){const a=this.getElementData(t,i).ignoredTools;if(s){const t=a.get(e);if(!n)return void(t instanceof Set&&t.delete(s));t instanceof Set||a.set(e,new Set),a.get(e).add(s)}else n?a.set(e,"all"):a.delete(e)}isToolIgnored(t,e,s,n){const i=this.getElementData(t,n).ignoredTools?.get(e);return!!i&&("all"===i||!s||i.has(s))}};const ce=new class{dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{substrates:new Map,onChange:new ht}),this.dataMap.get(t)):{}}createSubstrate(t,e){const s={objects:t instanceof Element?t.children:t.childNodes,temporaryMetadata:new WeakMap,persistentMetadata:new WeakMap,onActivate:new ht,onDeactivate:new ht,solvers:new Set};return this.data(t).substrates.set(e,s),s}setCurrent(t,e){return!!this.getSubstrates(t).includes(e)&&(this.data(t).current=e,!0)}getSubstrateData(t,e){return this.data(t).substrates.get(e)}getSubstrates(t){return[...this.data(t).substrates.keys()]}getPersistentMetadata(t,e,s){const n=this.getSubstrateData(t,e);if(!n||!n.persistentMetadata)return{};let i=n.persistentMetadata.get(s);return i||(i={},n.persistentMetadata.set(s,i)),i}setPersistentMetadata(t,e,s,n){const i=this.getSubstrateData(t,e);i&&i.persistentMetadata&&i.persistentMetadata.set(s,n)}getTemporaryMetadata(t,e,s){const n=this.getSubstrateData(t,e);if(!n||!n.temporaryMetadata)return;let i=n.temporaryMetadata.get(s);return i||(i={},n.temporaryMetadata.set(s,i)),i}setTemporaryMetadata(t,e,s,n){const i=this.getSubstrateData(t,e);i&&i.temporaryMetadata&&i.temporaryMetadata.set(s,n)}};const he=new WeakMap;function ue(t){if(he.has(t))return he.get(t);let e,s,n=!1;const i=function(...i){if(n)return e;if(s)return s;try{const a=t.apply(this,i);return a instanceof Promise?(s=a.then(t=>(e=t,n=!0,s=null,t)).catch(t=>{throw s=null,t}),s):(e=a,n=!0,a)}catch(t){throw t}};return he.set(t,i),i}function de(t,e){if("method"!==e.kind)throw new Error(`@callOnce can only be used on methods (got: ${e.kind}).`);const s=String(e.name),n=Symbol(`__callOnce__${s}`);return function(...e){if(!this[n])return this[n]=!0,t.apply(this,e);console.warn(`Function ${s} has already been called once on this instance and will not be called again.`)}}function fe(t,e,s=0){return t<s&&(t=s),t>e&&(t=e),t}function pe(t,e=0){for(;t<0;)t+=e;for(;t>=e;)t-=e;return t}let me=(()=>{let s,n,i,a,r,c,h,u,d,f,p=[],g=[],b=[];return class y{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;s=[m({defaultValueCallback:function(){return this.getAllStates()}})],n=[m({defaultValueCallback:()=>({global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0}),preprocessValue:function(t){return"boolean"==typeof t?{...this.enabled,global:t}:t}})],i=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.properties,t)}})],a=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.styles,t)}})],r=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.classes,t)}})],c=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.replaceWith,t)}})],h=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.transitionProperties,t)}})],u=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.transitionDuration,t)}})],d=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.transitionTimingFunction,t)}})],f=[m({setIfUndefined:!0,preprocessValue:function(t){return this.normalizePropertyConfig(this.transitionDelay,t)}})],t(this,null,n,{kind:"getter",name:"enabled",static:!1,private:!1,access:{has:t=>"enabled"in t,get:t=>t.enabled},metadata:e},null,p),t(this,null,i,{kind:"setter",name:"properties",static:!1,private:!1,access:{has:t=>"properties"in t,set:(t,e)=>{t.properties=e}},metadata:e},null,p),t(this,null,a,{kind:"setter",name:"styles",static:!1,private:!1,access:{has:t=>"styles"in t,set:(t,e)=>{t.styles=e}},metadata:e},null,p),t(this,null,r,{kind:"setter",name:"classes",static:!1,private:!1,access:{has:t=>"classes"in t,set:(t,e)=>{t.classes=e}},metadata:e},null,p),t(this,null,c,{kind:"setter",name:"replaceWith",static:!1,private:!1,access:{has:t=>"replaceWith"in t,set:(t,e)=>{t.replaceWith=e}},metadata:e},null,p),t(this,null,h,{kind:"setter",name:"transitionProperties",static:!1,private:!1,access:{has:t=>"transitionProperties"in t,set:(t,e)=>{t.transitionProperties=e}},metadata:e},null,p),t(this,null,u,{kind:"setter",name:"transitionDuration",static:!1,private:!1,access:{has:t=>"transitionDuration"in t,set:(t,e)=>{t.transitionDuration=e}},metadata:e},null,p),t(this,null,d,{kind:"setter",name:"transitionTimingFunction",static:!1,private:!1,access:{has:t=>"transitionTimingFunction"in t,set:(t,e)=>{t.transitionTimingFunction=e}},metadata:e},null,p),t(this,null,f,{kind:"setter",name:"transitionDelay",static:!1,private:!1,access:{has:t=>"transitionDelay"in t,set:(t,e)=>{t.transitionDelay=e}},metadata:e},null,p),t(null,null,s,{kind:"field",name:"states",static:!1,private:!1,access:{has:t=>"states"in t,get:t=>t.states,set:(t,e)=>{t.states=e}},metadata:e},g,b),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static fields=["properties","classes","styles","replaceWith","transitionProperties","transitionDuration","transitionTimingFunction","transitionDelay"];timeRegex=(e(this,p),/^(\d+(?:\.\d+)?)(ms|s)?$/i);attachedObjects=[];states=e(this,g,void 0);get enabled(){}set enabled(t){const e=t;l(e.global)?(l(e.properties)||this.refreshProperties(),l(e.styles)||this.refreshStyles(),l(e.classes)||this.refreshClasses(),l(e.replaceWith)||this.refreshReplaceWith(),l(e.transition)||this.refreshTransition()):this.refreshResolvedValues()}set properties(t){}get properties(){}set styles(t){}get styles(){}set classes(t){}get classes(){}set replaceWith(t){}get replaceWith(){}set transitionProperties(t){}get transitionProperties(){}set transitionDuration(t){}get transitionDuration(){}set transitionTimingFunction(t){}get transitionTimingFunction(){}set transitionDelay(t){}get transitionDelay(){}constructor(t){e(this,b),t.states&&(this.states=t.states),Object.entries(t).forEach(([t,e])=>{"attachedObjects"!==t&&"states"!==t&&(this[t]=e)}),t.transition||t.transitionProperties||t.transitionDuration||t.transitionTimingFunction||t.transitionDelay||(this.enabled.transition=!1),t.attachedObjects&&this.attachAll(...t.attachedObjects)}attach(t,e,s){const n=this.getData(t);return n&&e&&(n.onSwitch=e),n||this.attachObject(t,s,e),this}attachAll(...t){return t.forEach(t=>{this.getData(t)||this.attachObject(t)}),this}attachAllAt(t,...e){return e.forEach((e,s)=>{this.getData(e)||this.attachObject(e,t+s)}),this}detach(...t){return t.forEach(t=>{const e=this.getData(t);e&&this.detachObject(e)}),this}attachObject(t,e,s){(null==e||isNaN(e))&&(e=this.attachedObjects.length),e<0&&(e=0);const n=this.generateNewData(t,s);return this.attachedObjects.splice(e,0,n),je(t).attachReifect(this),n.lastState=this.stateOf(t),this.applyResolvedValues(n,!1,!0),n}detachObject(t){if(!this.attachedObjects.includes(t))return;const e=t.object.deref();this.attachedObjects.splice(this.attachedObjects.indexOf(t),1),e&&je(e).detachReifect(this)}getData(t){if(t)for(const e of this.attachedObjects){const s=this.getObject(e);if(s&&s==t)return e}}getObject(t){if(t)return t.object.deref()}stateOf(t){if(!t)return;const e=this.getData(t);if(e){if(e.lastState)return e.lastState;if(!(t instanceof HTMLElement))return this.states[0];e.resolvedValues||this.processRawProperties(e);for(const s of this.states){if(!e.resolvedValues?.styles?.[s])continue;let n=!0;for(const[i,a]of Object.entries(e.resolvedValues.styles[s]))if(t.style[i]!=a){n=!1;break}if(n)return e.lastState=s,s}return this.states[0]}}getAllStates(){const t=new Set;for(const e of y.fields){const s=this[e];if(s&&"object"==typeof s)for(const e of Object.keys(s))t.add(e)}return Array.from(t)}parseState(t){if("boolean"!=typeof t)return this.states.includes(t)?t:this.states[0];for(const e of t?["true","on","in","enabled","shown"]:["false","off","out","disabled","hidden"])if(this.states.includes(e))return e;return this.states[0]}enable(t,e){const s=this.getData(e);if(!s)return this.enabled=t;"boolean"==typeof t?s.enabled.global=t:"object"==typeof t&&Object.entries(t).forEach(([t,e])=>s.enabled[t]=e)}getObjectEnabledState(t){return this.getData(t)?.enabled}set transition(t){if(!t)return;const e="string"==typeof t?this.processTransitionString(t):this.processTransitionObject(t);Object.entries(e).forEach(([t,e])=>this[t]=e)}processTransitionObject(t){const e={};for(const[s,n]of Object.entries(t))this.states.includes(s)&&"string"==typeof n&&Object.entries(this.processTransitionString(n)).forEach(([t,n])=>{e[t]||(e[t]={}),e[t][s]=n});return e}processTransitionString(t){const e=t.trim().replace(/,/g," ").split(/\s+/).filter(t=>t.length>0),s={transitionProperties:[]};let n=0;for(;n<e.length&&!this.timeRegex.test(e[n]);)s.transitionProperties.push(e[n]),n++;if(n<e.length){const t=this.parseTime(e[n]);isNaN(t)||(s.transitionDuration=t),n++}if(n<e.length&&(s.transitionTimingFunction=e[n],n++),n<e.length){const t=this.parseTime(e[n]);isNaN(t)||(s.transitionDelay=t),n++}return s}getTransitionString(t,e=t.lastState){if(!t.resolvedValues)return"";const s=this.cleanTransitionProperties(t.resolvedValues.transitionProperties[e]),n=t.resolvedValues.transitionDuration[e]??0,i=t.resolvedValues.transitionTimingFunction[e]??"linear",a=t.resolvedValues.transitionDelay[e]??0;return s.map(t=>`${t} ${n}s ${i} ${a}s`).join(", ")}initialize(t,e,s){this.enabled&&(t=this.parseState(t),s=this.initializeOptions(s,e),this.getEnabledObjectsData(e,s).forEach(e=>{!s.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,s.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!0,s?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))}))}apply(t,e,s){this.enabled&&(t=this.parseState(t),s=this.initializeOptions(s,e),this.getEnabledObjectsData(e,s).forEach(e=>{!s.recomputeProperties&&e.resolvedValues||this.processRawProperties(e,s.propertiesOverride),e.lastState=t,this.applyResolvedValues(e,!1,s?.applyStylesInstantly),e.onSwitch&&e.onSwitch(t,e.objectIndex,e.totalObjectCount,this.getObject(e))}))}toggle(t,e){if(!this.enabled)return;t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[];const s=this.getData(t[0])?.lastState,n=pe(s?this.states.indexOf(s)+1:0,this.states.length);this.apply(this.states[n],t,e)}reloadFor(t){if(!this.enabled.global)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global?(this.applyResolvedValues(e),this):this}reloadTransitionFor(t){if(!this.enabled.global||!this.enabled.transition)return this;const e=this.getData(t);return e&&e.enabled&&e.enabled.global&&e.enabled.transition?(this.applyTransition(e,e.lastState),this):this}getEnabledObjectsData(t,e){if(!this.enabled)return console.warn("The reifier object you are trying to access is disabled."),[];t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[],(e=this.initializeOptions(e,t)).attachObjects&&t.forEach(t=>this.attach(t)),e.executeForAll&&(t=[],this.attachedObjects.forEach(e=>{const s=e.object.deref();s&&t.push(s)}));const s=[];return t.forEach(t=>{const n=this.getData(t)||this.generateNewData(t);this.filterEnabledObjects(n)&&((e.recomputeIndices||null==n.objectIndex)&&(n.objectIndex=s.length),s.push(n))}),s.forEach(t=>{(e.recomputeIndices||null==t.totalObjectCount)&&(t.totalObjectCount=s.length)}),s}applyResolvedValues(t,e=!1,s=!1){this.applyStyles(t,t.lastState,s),e||(this.attachedObjects.includes(t)?je(t.object.deref()).reloadTransitions():this.applyTransition(t,t.lastState)),this.applyReplaceWith(t,t.lastState),this.applyProperties(t,t.lastState),this.applyClasses(t,t.lastState)}refreshResolvedValues(){this.refreshProperties(),this.refreshStyles(),this.refreshClasses(),this.refreshReplaceWith(),this.refreshTransition()}applyProperties(t,e=t.lastState){if(!this.enabled||!this.enabled.properties)return;if(!t.enabled.global||!t.enabled.properties)return;const s=t.resolvedValues?.properties?.[e];if(!s)return;const n=t.object.deref();if(n)for(const[t,e]of Object.entries(s))if(t&&null!=e)try{n[t]=e}catch(s){console.error(`Unable to set property ${t} to ${e}: ${s.message}`)}}refreshProperties(){this.enabled&&this.enabled.properties&&this.attachedObjects.forEach(t=>this.applyProperties(t))}applyReplaceWith(t,e=t.lastState){if(!this.enabled||!this.enabled.replaceWith)return;if(!t.enabled.global||!t.enabled.replaceWith)return;const s=t.resolvedValues?.replaceWith?.[e];if(s)try{const e=t.object.deref();e&&e instanceof Node&&s instanceof Node&&e.parentNode?.replaceChild(s,e),t.object=new WeakRef(s)}catch(t){console.error(`Unable to replace object: ${t.message}`)}}refreshReplaceWith(){this.enabled&&this.enabled.replaceWith&&this.attachedObjects.forEach(t=>this.applyReplaceWith(t))}applyClasses(t,e=t.lastState){if(!this.enabled||!this.enabled.classes)return;if(!t.enabled.global||!t.enabled.classes)return;const s=t.resolvedValues?.classes;if(!s)return;const n=t.object.deref();if(n&&n instanceof Element)for(const[t,i]of Object.entries(s))je(n).toggleClass(i,e==t)}refreshClasses(){this.enabled&&this.enabled.classes&&this.attachedObjects.forEach(t=>this.applyClasses(t))}applyStyles(t,e=t.lastState,s=!1){if(!this.enabled||!this.enabled.styles)return;if(!t.enabled.global||!t.enabled.styles)return;if(!t.resolvedValues?.styles)return;const n=t.object.deref();n&&n instanceof Element&&je(n).setStyles(t.resolvedValues.styles[e],s)}refreshStyles(){this.enabled&&this.enabled.styles&&this.attachedObjects.forEach(t=>this.applyStyles(t))}applyTransition(t,e=t.lastState){if(!this.enabled||!this.enabled.transition)return;if(!t.enabled.global||!t.enabled.transition)return;const s=t.object.deref();s&&s instanceof Element&&t.resolvedValues&&je(s).appendStyle("transition",this.getTransitionString(t,e),", ",!0)}refreshTransition(){for(const t of this.attachedObjects)je(t.object?.deref()).reloadTransitions()}filterEnabledObjects(t){return!(!t.enabled||!t.enabled.global)||(console.warn("The reified properties instance you are trying to set on an object is disabled for this particular object."),!1)}processRawProperties(t,e){if(t.resolvedValues||(t.resolvedValues={}),o(e))return;const s=t.object.deref();if(!s)return;const n=t.objectIndex??0,i=t.totalObjectCount??1;for(const a of y.fields){const r=this.normalizePropertyConfig(this[a],e?.[a]);t.resolvedValues[a]||(t.resolvedValues[a]={});for(const e of this.states)t.resolvedValues[a][e]=r[e]?.(n,i,s)}}generateNewData(t,e){return{object:new WeakRef(t),enabled:{global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0},lastState:this.stateOf(t),onSwitch:e}}initializeOptions(t,e){return e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[],(t=t||{}).attachObjects=t.attachObjects??!0,t.executeForAll=t.executeForAll??0===e.length,t.recomputeIndices=t.recomputeIndices??0!==e.length,t.recomputeProperties=t.recomputeProperties??0!==e.length,t}clone(){return new y({states:this.states,properties:this.properties,classes:this.classes,styles:this.styles,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay})}normalizePropertyConfig(t,e){const s=t?{...t}:{};if(l(e))return s;const n="object"==typeof e&&null!==e&&!Array.isArray(e),i=n?Reflect.ownKeys(e):[],a=n&&i.length>0&&i.every(t=>this.states.includes(t));if(n&&0===i.length)return s;if("function"==typeof e)this.states.forEach(t=>{s[t]=(s,n,i)=>e(t,s,n,i)});else if(a)this.states.forEach(t=>{const n=e[t];l(n)||(s[t]="function"==typeof n?n:()=>n)});else{const t=()=>e;this.states.forEach(e=>s[e]=t)}return s}cleanTransitionProperties(t){if(!t)return["all"];if(Array.isArray(t))return t.length?t:["all"];const e=t.split(/\s+/).map(t=>t.trim()).filter(Boolean);return e.length?e:["all"]}parseTime(t){const e=t.match(this.timeRegex);if(!e)return NaN;const s=parseFloat(e[1]);return"ms"===(e[2]?.toLowerCase()??"s")?s/1e3:s}}})();function ge(t){return new me(t)}class be extends me{constructor(t){t.states=["default"],super(t)}get properties(){return super.properties?.default}set properties(t){super.properties=t}get styles(){return super.styles?.default}set styles(t){super.styles=t}get classes(){return super.classes?.default}set classes(t){super.classes=t}get replaceWith(){return super.replaceWith?.default}set replaceWith(t){super.replaceWith=t}get transitionProperties(){return super.transitionProperties?.default}set transitionProperties(t){super.transitionProperties=t}get transitionDuration(){return super.transitionDuration?.default}set transitionDuration(t){super.transitionDuration=t}get transitionTimingFunction(){return super.transitionTimingFunction?.default}set transitionTimingFunction(t){super.transitionTimingFunction=t}get transitionDelay(){return super.transitionDelay?.default}set transitionDelay(t){super.transitionDelay=t}initialize(t,e){super.initialize("default",t,e)}apply(t,e){super.apply("default",t,e)}}function ye(t){return new be(t)}var ve,ke,Se,Ee,we,Ce,Oe,Te,Pe,xe;!function(t){t.vertical="vertical",t.horizontal="horizontal"}(ve||(ve={})),function(t){t.left="left",t.right="right"}(ke||(ke={})),function(t){t.top="top",t.bottom="bottom"}(Se||(Se={})),function(t){t.top="top",t.bottom="bottom",t.left="left",t.right="right"}(Ee||(Ee={})),function(t){t.in="in",t.out="out"}(we||(we={})),function(t){t.on="on",t.off="off"}(Ce||(Ce={})),function(t){t.open="open",t.closed="closed"}(Oe||(Oe={})),function(t){t.visible="visible",t.hidden="hidden"}(Te||(Te={})),function(t){t.public="public",t.protected="protected",t.private="private"}(Pe||(Pe={})),function(t){t.min="min",t.max="max"}(xe||(xe={}));const De=new class{dataMap=new WeakMap;data(t){if(t instanceof g&&(t=t.element),this.dataMap.has(t))return this.dataMap.get(t);const e={reifects:new lt,enabled:{},onTransitionStart:new ht,onTransitionEnd:new ht};return t&&this.dataMap.set(t,e),e}attachReifect(t,e){const s=this.data(t).reifects;s.has(e)||s.add(e)}detachReifect(t,e){const s=this.data(t).reifects;s.has(e)&&s.delete(e)}},Ae=new me({states:[Te.visible,Te.hidden],styles:t=>`visibility: ${t}`});const Me=new WeakMap;function je(t){let e;if(Ve(),t||(t="div"),"string"==typeof t)e=O({tag:t});else if("object"==typeof t){if(t instanceof g)return t;e=t instanceof Node?t:t.element&&"object"==typeof t.element?t.element:t}const s=Me.get(e);if(s)return s;const n=new g;return n.element=e,Me.set(e,n),n}function Ie(t){return je(t)}function Be(t){return je(t)}function Ne(t){return je(t)}const Ve=ue(function(t={}){t.excludeHierarchyFunctions||(Object.defineProperty(g.prototype,"childHandler",{set:function(t){t instanceof g&&(t=t.element),b.data(this).childHandler=t},get:function(){return b.data(this).childHandler||(this.element instanceof Element&&this.element.shadowRoot?this.element.shadowRoot:this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"childNodesArray",{get:function(){return this.element&&Array.from(this.childHandler?.childNodes)||[]},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"childrenArray",{get:function(){return this.childNodesArray.filter(t=>1===t.nodeType)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"siblingNodes",{get:function(){const t=this.element?.parentNode;return t&&Ne(t).childNodesArray||[]},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"siblings",{get:function(){const t=this.element?.parentElement;return t&&Ne(t).childrenArray||[]},configurable:!1,enumerable:!0}),g.prototype.bringToFront=function(){const t=this.element?.parentNode;return t?(Ne(t).addChild(this.element),this):this},g.prototype.sendToBack=function(){const t=this.element?.parentNode;return t?(Ne(t).addChild(this.element,0),this):this},g.prototype.remove=function(){return this.element?.parentNode?.removeChild(this.element),this},g.prototype.addChild=function(t,e,s=this.childrenArray){if(!this.element||!t)return this;if(void 0!==e&&(e<0||e>s.length)&&(e=void 0),null!=e)this.addChildBefore(t,s[e]);else try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof g&&(t=t.element),this.childHandler.appendChild(t))})}catch(t){console.error(t)}return this},g.prototype.remChild=function(t){if(!this.element||!t)return this;try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof g&&(t=t.element),this.childHandler.removeChild(t))})}catch(t){console.error(t)}return this},g.prototype.addChildBefore=function(t,e){if(!this.element||!t)return this;if(!e)return this.addChild(t);try{Array.isArray(t)||(t=[t]),t.forEach(t=>{t&&(t instanceof g&&(t=t.element),this.childHandler.insertBefore(t,e))})}catch(t){console.error(t)}return this},g.prototype.removeChildAt=function(t,e=1,s=this.childrenArray){if(!this.element||void 0===t||t<0)return this;if(t>=s.length)return this;try{for(let n=t+e-1;n>=t;n--)n>=s.length||this.removeChild(s[n])}catch(t){console.error(t)}return this},g.prototype.removeAllChildren=function(t=this.childrenArray){if(!this.element)return this;try{for(let e=0;e<t.length;e++)this.removeChild(t[e])}catch(t){console.error(t)}return this},g.prototype.childAt=function(t,e=this.childrenArray){if(!this.element||void 0===t)return null;for(t>=e.length&&(t=e.length-1);t<0;)t+=e.length;return e[t]},g.prototype.indexOfChild=function(t,e=this.childrenArray){return this.element&&t?(e instanceof Array||(e=Array.from(e)),e.indexOf(t)):-1},g.prototype.hasChild=function(t){if(!this.element||!t)return!1;const e=Array.from(this.element?.childNodes);if(t instanceof Node)return e.includes(t);for(const s of t)if(!e.includes(s))return!1;return!0},g.prototype.closest=function(t){if(!(this.element&&t&&this.element instanceof Element))return null;if("string"==typeof t)return this.element.closest(t);if("function"==typeof t){let e=this.element;for(;e&&!(e instanceof t);)e=e.parentElement;return e||null}return null},g.prototype.findInParents=function(t){if(!t||!this.element)return!1;t instanceof Node&&(t=[t]);let e=this.element,s=0;for(;e&&s<t.length;)t.includes(e)&&s++,e=e.parentNode;return s===t.length},g.prototype.findInSubTree=function(t){if(!t||!this.element)return!1;t instanceof Node&&(t=[t]);let e=0;const s=n=>{t.includes(n)&&e++,e>=t.length||n.childNodes.forEach(t=>s(t))};return s(this.element),e>=t.length},g.prototype.indexInParent=function(t=this.siblings){return t&&this.element?t.indexOf(this.element):-1},g.prototype.addToParent=function(t,e,s){return this.element&&t?(Ne(t).addChild(this.element,e,s),this):this}),t.excludeMiscFunctions||(g.prototype.execute=function(t){return t(this),this},g.prototype.applyDefaults=function(t,e={}){if(!this.element||"object"!=typeof this.element)return this;const{mergeProperties:s=y,removeDuplicates:n=!0}=e;for(const[e,i]of Object.entries(t)){const t=s?.includes(e);if(t){const t=Array.isArray(i)?i:[i];let s=(l(this.element[e])?[]:Array.isArray(this.element[e])?this.element[e].slice():[this.element[e]]).concat(t);n&&(s=Array.from(new Set(s))),this.element[e]=s}else l(this.element[e])&&(this.element[e]=i)}return this}),t.excludeClassFunctions||(g.prototype.addClass=function(t){return this.element instanceof Element?v.operateOnClasses(this,t,t=>this.element.classList.add(t)):this},g.prototype.removeClass=function(t){return this.element instanceof Element?v.operateOnClasses(this,t,t=>this.element.classList.remove(t)):this},g.prototype.toggleClass=function(t,e){return this.element instanceof Element?v.operateOnClasses(this,t,t=>this.element.classList.toggle(t,e)):this},g.prototype.hasClass=function(t){if(!(t&&this.element instanceof Element))return!1;if("string"==typeof t)return this.element.classList.contains(t);for(let e of t)if(!this.element.classList.contains(e))return!1;return!0}),t.excludeElementFunctions||(g.prototype.setProperties=function(t={},e=!1){if(!this)return this;if(t.out&&("string"==typeof t.out?this.__outName=t.out:Object.assign(t.out,this)),!this.element.shadowRoot){let e=!!t.shadowDOM;if("getPropertiesValue"in this.element&&"function"==typeof this.element.getPropertiesValue&&(e=this.element.getPropertiesValue(t.shadowDOM,"shadowDOM")),e)try{this.element.attachShadow({mode:"open"})}catch{}}const s=this.element?.mvc instanceof G?this.element.mvc:"model"in this.element&&"view"in this.element?this.element:void 0;for(const n of Object.keys(t)){const i=t[n];if(void 0!==i)switch(n){case"tag":case"namespace":case"shadowDOM":break;case"text":this.element instanceof HTMLElement&&(this.element.innerText=i);break;case"style":if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))break;this.setStyles(i,!0);break;case"stylesheet":U(i,this.closestRoot);break;case"id":this.element.id=i;break;case"classes":this.addClass(i);break;case"listeners":Object.entries(i).forEach(([t,e])=>this.on(t,e));break;case"onClick":this.on(Ct.click,i);break;case"onDrag":this.on(Ct.drag,i);break;case"children":this.addChild(i);break;case"parent":Ne(i).addChild(this.element);break;case"data":case"initialize":if(s)break;case"model":case"view":case"emitter":case"controllers":case"handlers":case"interactors":case"tools":case"substrates":if(e)break;if(s){try{s[n]=i,"model"===n&&t.data&&s.model instanceof dt&&s.model.setBlock(t.data,void 0,void 0,!1)}catch{}break}default:if(e)break;try{this.element[n]=i}catch(t){try{this.setAttribute(n,Ot(i))}catch(t){console.error(t)}}}}return(void 0===t.initialize||t.initialize)&&(this.element&&"initialize"in this.element&&"function"==typeof this.element.initialize?this.element.initialize():s&&"initialize"in s&&"function"==typeof s.initialize&&s.initialize()),this},g.prototype.setMvc=function(t){if(this.element)return"mvc"in this.element&&this.element.mvc instanceof G?(this.element.mvc.generate(t),this.element.mvc):new G({...t,element:this.element})},g.prototype.destroy=function(){return this.removeAllListeners(),this.remove(),this.element&&"destroy"in this.element&&"function"==typeof this.element.destroy&&this.element.destroy(),this},g.prototype.setAttribute=function(t,e){return this.element instanceof Element&&this.element.setAttribute(t,e?.toString()||"true"),this},g.prototype.removeAttribute=function(t){return this.element instanceof Element&&this.element.removeAttribute(t),this},g.prototype.blur=function(){return this.element instanceof HTMLElement&&this.element.blur(),this},g.prototype.focus=function(){return this.element instanceof HTMLElement&&this.element.focus(),this}),t.excludeEventFunctions||(Object.defineProperty(g.prototype,"boundListeners",{get:function(){return re.getBoundListenersSet(this)},configurable:!0,enumerable:!0}),Object.defineProperty(g.prototype,"bypassManagerOn",{get:function(){return re.data(this).bypassCallback},set:function(t){re.data(this).bypassCallback=t},configurable:!0,enumerable:!0}),g.prototype.onTool=function(t,e,s,n,i=ae.instance){return this.hasToolListener(t,e,s,i)||(i.setupCustomDispatcher?.(t),re.getBoundListenersSet(this).add({target:this,type:t,toolName:e,listener:s,bundledListener:t=>s(t,this),options:n,manager:i})),this},g.prototype.on=function(t,e,s,n=ae.instance){return this.onTool(t,void 0,e,s,n)},g.prototype.executeAction=function(t,e,s,n,i=ae.instance){if(!t)return!1;n||(n={});const a=e??i.getCurrentToolName();this.bypassManagerOn&&re.bypassManager(this,i,this.bypassManagerOn(s));const r=new Set,o=(e,a)=>{const o=e instanceof g?e:Ne(e),l=re.getBoundListenersSet(e),c=[...re.getBoundListeners(e,t,a,n,i)];if(0===c.length)return!1;let h=!1;for(const t of c)if(!r.has(t))try{t.listener(s,o)&&(h=!0)}finally{r.add(t),t.options?.once&&l.delete(t)}return h};if(a&&o(this,a))return!0;if(!n.capture&&a&&!this.isToolIgnored(a,t,i)&&this.applyTool(a,t,s,i))return!0;const l=this.getEmbeddedToolTarget(i),c=this.getToolNames(i);if(l&&c.length>0){let e=!1;for(const t of c)o(l,t)&&(e=!0);if(e)return!0;const a=Ne(l);if(!n.capture)for(const n of c)!a.isToolIgnored(n,t,i)&&Ne(l).applyTool(n,t,s,i)&&(e=!0);if(e)return!0}return o(this,void 0)},g.prototype.hasListener=function(t,e,s=ae.instance){return this.hasToolListener(t,void 0,e,s)},g.prototype.hasToolListener=function(t,e,s,n=ae.instance){return re.getBoundListeners(this,t,e,void 0,n).filter(t=>t.listener===s).length>0},g.prototype.hasListenersByType=function(t,e,s=ae.instance){return re.getBoundListeners(this,t,e,void 0,s).length>0},g.prototype.removeListener=function(t,e,s=ae.instance){return this.removeToolListener(t,void 0,e,s)},g.prototype.removeToolListener=function(t,e,s,n=ae.instance){const i=re.getBoundListenersSet(this);return re.getBoundListeners(this,t,e,void 0,n).filter(t=>t.listener===s).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),i.delete(t)}),this},g.prototype.removeListenersByType=function(t,e,s=ae.instance){const n=re.getBoundListenersSet(this);return re.getBoundListeners(this,t,e,void 0,s).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),n.delete(t)}),this},g.prototype.removeAllListeners=function(t=ae.instance){const e=this.boundListeners;return[...e].filter(e=>e.manager===t).forEach(t=>{t.target.removeEventListener(t.type,t.bundledListener,t.options),e.delete(t)}),this},g.prototype.preventDefault=function(t){t||(t={});const e=t.manager??ae.instance,s=t.types??At,n=t.phase??"capture",i=t.stop??!1;re.data(this.element).preventDefaultOn=t.preventDefaultOn??re.data(this.element).preventDefaultOn??(()=>!0);const a=re.getPreventDefaultListeners(this);if(t.clearPreviousListeners)for(const[t,e]of Object.entries(a))this.removeListener(t,e),delete a[t];const r=new Set(Mt);for(const t of new Set(s)){const s=e=>!!re.data(this.element).preventDefaultOn(t,e)&&(e.preventDefault?.(),"immediate"===i?e.stopImmediatePropagation?.():"stop"===i&&e.stopPropagation?.(),!0);a[t]=s;const o={};"capture"===n&&(o.capture=!0),r.has(t)&&(o.passive=!1),this.on(t,s,o,e)}return this}),t.excludeStyleFunctions||(Object.defineProperty(g.prototype,"closestRoot",{get:function(){let t=this.element;for(;t;){if(t instanceof Element&&t.shadowRoot)return t.shadowRoot;t=t.parentElement}return document.head},configurable:!1,enumerable:!0}),g.prototype.setStyle=function(t,e,s=!1){return t&&null!=e&&(this.element instanceof HTMLElement||this.element instanceof SVGElement)?(oe.setStyle(this,t,e,s),this):this},g.prototype.appendStyle=function(t,e,s=", ",n=!1){if(!t||null==e)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;const i=this.element.style[t]||"";return s=i.length>0?s:"",oe.setStyle(this,t,i+s+e,n),this},g.prototype.setStyles=function(t,e=!1){if(!t||"number"==typeof t)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;let s={};return"object"==typeof t?s=t:"string"==typeof t&&t.split(";").forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());e&&n&&(s[e]=n)}),Object.entries(s).forEach(([t,s])=>oe.setStyle(this,t,s,e,!1)),e||oe.applyStyles(this),this}),t.excludeToolFunctions||(g.prototype.makeTool=function(t,e){return t?(e||(e={}),e.manager||(e.manager=ae.instance),e.manager.addTool(t,this.element,e.key),e.customActivation&&"function"==typeof e.customActivation?e.customActivation(this,e.manager):(e.activationEvent??=Ct.click,e.clickMode??=It.left,this.on(e.activationEvent,()=>(e.manager.setTool(this.element,e.clickMode),!0),void 0,e.manager)),le.saveTool(this,t,e.manager),e.onActivate&&le.getActivationDelegate(this,t,e.manager).add(e.onActivate),e.onDeactivate&&le.getDeactivationDelegate(this,t,e.manager).add(e.onDeactivate),this):this},g.prototype.isTool=function(t=ae.instance){return le.getToolNames(this.element,t).length>0},g.prototype.getToolNames=function(t=ae.instance){return le.getToolNames(this.element,t)},g.prototype.getToolName=function(t=ae.instance){const e=le.getToolNames(this.element,t);if(e.length>0)return e[0]},g.prototype.onToolActivate=function(t,e=ae.instance){return t||(t=this.getToolName(e)),le.getActivationDelegate(this,t,e)},g.prototype.onToolDeactivate=function(t,e=ae.instance){return t||(t=this.getToolName(e)),le.getDeactivationDelegate(this,t,e)},g.prototype.addToolBehavior=function(t,e,s=this.getToolName(),n=ae.instance){return t&&s&&(n.setupCustomDispatcher?.(t),le.addToolBehavior(s,t,e,n)),this},g.prototype.hasToolBehavior=function(t,e=this.getToolName(),s=ae.instance){return!(!t||!e)&&le.getToolBehaviors(e,t,s).length>0},g.prototype.removeToolBehaviors=function(t,e=this.getToolName(),s=ae.instance){return t&&e&&le.removeToolBehaviors(e,t,s),this},g.prototype.clearToolBehaviors=function(t=ae.instance){return le.clearToolBehaviors(t),this},g.prototype.embedTool=function(t,e=ae.instance){return this.isTool(e)&&le.setEmbeddedToolTarget(this.element,t,e),this},g.prototype.isEmbeddedTool=function(t=ae.instance){return!!le.getEmbeddedToolTarget(this.element,t)},g.prototype.getEmbeddedToolTarget=function(t=ae.instance){return le.getEmbeddedToolTarget(this.element,t)},g.prototype.applyTool=function(t,e,s,n=ae.instance){let i=!1;const a=le.getToolBehaviors(t,e,n),r={};return r.embeddedTarget=le.getEmbeddedToolTarget(this.element,n),r.isEmbedded=!!r.embeddedTarget,a.forEach(t=>{t(s,this.element,r)&&(i=!0)}),i},g.prototype.ignoreTool=function(t,e,s=!0,n=ae.instance){return le.ignoreTool(this.element,t,e,s,n),this},g.prototype.ignoreAllTools=function(t=!0,e=ae.instance){return le.getElementData(this.element,e).ignoreAllTools=t,this},g.prototype.isToolIgnored=function(t,e,s=ae.instance){return!!le.getElementData(this.element,s).ignoreAllTools||le.isToolIgnored(this.element,t,e,s)}),t.excludeSubstrateFunctions||(g.prototype.makeSubstrate=function(t,e){return ce.createSubstrate(this,t),e?.onActivate&&this.onSubstrateActivate(t).add(e.onActivate),e?.onDeactivate&&this.onSubstrateDeactivate(t).add(e.onDeactivate),this.currentSubstrate||(this.currentSubstrate=t),this},Object.defineProperty(g.prototype,"substrates",{get:function(){return ce.getSubstrates(this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"currentSubstrate",{get:function(){return ce.data(this).current},set:function(t){if(!t)return;const e=this.currentSubstrate;ce.setCurrent(this,t)&&this.onSubstrateChange.fire(e,t)},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"onSubstrateChange",{get:function(){return ce.data(this).onChange},configurable:!1,enumerable:!0}),g.prototype.onSubstrateActivate=function(t=this.currentSubstrate){return ce.getSubstrateData(this,t)?.onActivate??new ht},g.prototype.onSubstrateDeactivate=function(t=this.currentSubstrate){return ce.getSubstrateData(this,t)?.onDeactivate??new ht},g.prototype.getSubstrateObjectList=function(t=this.currentSubstrate){const e=new Set;return t?(Array.from(ce.getSubstrateData(this,t).objects).forEach(s=>{ce.getPersistentMetadata(this,t,s).ignored||e.add(s)}),e):e},g.prototype.setSubstrateObjectList=function(t,e=this.currentSubstrate){return t&&e?(ce.getSubstrateData(this,e).objects=t,this):this},g.prototype.addObjectToSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return this;ce.getPersistentMetadata(this,e,t).ignored=!1;const s=ce.getSubstrateData(this,e).objects;if(s instanceof HTMLCollection||s instanceof NodeList)return this;try{s.has(t)||s.add(t)}catch{}return this},g.prototype.removeObjectFromSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return this;ce.getPersistentMetadata(this,e,t).ignored=!0;const s=ce.getSubstrateData(this,e).objects;return s instanceof Set&&s.delete(t),this},g.prototype.hasObjectInSubstrate=function(t,e=this.currentSubstrate){if(!t||!e)return!1;const s=this.getSubstrateObjectList(e);for(const e of s)if(e===t)return!0;return!1},g.prototype.wasObjectProcessedBySubstrate=function(t,e=this.currentSubstrate){return!(!t||!e||!ce.getTemporaryMetadata(this,e,t)?.processed)},g.prototype.addSolver=function(t,e=this.currentSubstrate){return ce.getSubstrateData(this,e).solvers?.add(t),this},g.prototype.removeSolver=function(t,e=this.currentSubstrate){return ce.getSubstrateData(this,e).solvers?.delete(t),this},g.prototype.clearSolvers=function(t=this.currentSubstrate){return ce.getSubstrateData(this,t).solvers?.clear(),this},g.prototype.resolveSubstrate=function(t={},e=this.currentSubstrate){if(t||(t={}),t.substrate=t.substrate??e,!t.substrate)return this;t.manager||(t.manager=ae.instance),t.eventOptions||(t.eventOptions={});const s=ce.getSubstrateData(this,t.substrate);return s?(s.solvers?.forEach(e=>{let n;s.temporaryMetadata=new WeakMap,t.eventTarget&&(s.temporaryMetadata.set(t.eventTarget,{processed:!0,isMainTarget:!0}),e({...t,target:t.eventTarget}));do{n=Array.from(this.getSubstrateObjectList(t.substrate)).find(t=>!s.temporaryMetadata.get(t)?.processed),n&&(s.temporaryMetadata.set(n,{processed:!0}),e({...t,target:n}))}while(n)}),this):this}),t.excludeReifectFunctions||(Object.defineProperty(g.prototype,"reifects",{get:function(){return this.element?new Set(De.data(this.element).reifects?.toArray()):new Set},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"onTransitionStart",{get:function(){return De.data(this.element).onTransitionStart},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"onTransitionEnd",{get:function(){return De.data(this.element).onTransitionEnd},configurable:!1,enumerable:!0}),Object.defineProperty(g.prototype,"showTransition",{get:function(){if(!this.element)return;const t=De.data(this.element);return t.showTransition||(t.showTransition=Ae),t.showTransition},set:function(t){this.element&&(De.data(this.element).showTransition=t)},configurable:!0,enumerable:!0}),Object.defineProperty(g.prototype,"isShown",{get:function(){if(!this.element)return;const t=this.showTransition.stateOf(this.element);return t==Te.visible||t!=Te.hidden&&"none"!=this.element.style.display&&"hidden"!=this.element.style.visibility&&"0"!=this.element.style.opacity},configurable:!1,enumerable:!0}),g.prototype.show=function(t,e={}){return this.element?(e.executeForAll||(e.executeForAll=!1),this.showTransition.apply(t?Te.visible:Te.hidden,this.element,e),this):this},g.prototype.attachReifect=function(...t){return this.element&&"object"==typeof this.element?(t.forEach(t=>{this.reifects.has(t)||(De.attachReifect(this.element,t),t.attach(this.element))}),this):this},g.prototype.detachReifect=function(...t){return this.element&&"object"==typeof this.element?(t.forEach(t=>{this.reifects.has(t)&&(De.detachReifect(this.element,t),t.detach(this.element))}),this):this},g.prototype.initializeReifect=function(t,e,s){return this.element?(t instanceof be?t.initialize(this.element,s):t.initialize(this.element,e,s),this):this},g.prototype.applyReifect=function(t,e,s){return this.element?(t instanceof be?t.apply(this.element,s):t.apply(this.element,e,s),this):this},g.prototype.toggleReifect=function(t,e){return this.element?(t instanceof be||t.toggle(this.element,e),this):this},g.prototype.reloadReifects=function(){return this.element?(this.setStyle("transition","",!0),this.reifects.forEach(t=>t.reloadFor(this.element)),this):this},g.prototype.reloadTransitions=function(){return this.element?(this.setStyle("transition","",!0),this.reifects.forEach(t=>t.reloadTransitionFor(this.element)),this):this},g.prototype.reifectEnabledState=function(t){return this.element?t?t.getObjectEnabledState(this.element):De.data(this.element).enabled:{}},g.prototype.enableReifect=function(t,e){if(!this.element)return this;if(e)return e.enable(t,this.element),this;const s=De.data(this.element).enabled;return"boolean"==typeof t?s.global=t:"object"==typeof t&&Object.entries(t).forEach(([t,e])=>s[t]=e),this})});function _e(t={}){return function(e,s){const{kind:n,name:i,static:a}=s,r=i,o=function(t){return Symbol(`__cache__${t}`)}(r),l=Symbol(`__cache__setup__${r}`),h=[],u=function(t=!0){if(!t)return;const e=this[o];if(e){e instanceof Map?e.clear():delete this[o];for(const t of h)clearTimeout(t);h.length=0}},d=function(){this[l]||(this[l]=!0,function(t,e,s,n,i,a,r){if(a.onEvent){const e="function"==typeof t?.addEventListener?t:document,s=Array.isArray(a.onEvent)?a.onEvent:String(a.onEvent).split(/\s+/).filter(Boolean);for(const t of s)Ne(e).on(t,()=>r())}if(a.onFieldChange){const e=Array.isArray(a.onFieldChange)?a.onFieldChange:[a.onFieldChange];for(const s of e){const e="string"==typeof s?s:s.name;if(!e)continue;const n=c(t,e),i=t[e];if("function"==typeof i){const s=i;Object.defineProperty(t,e,{configurable:!0,enumerable:n?.enumerable??!0,writable:!0,value:function(...t){return r(),s.apply(this,t)}})}else{const s=()=>n?.get?n.get.call(t):i,a=s=>{n?.set?n.set.call(t,s):Object.defineProperty(t,e,{configurable:!0,enumerable:!0,writable:!0,value:s})};Object.defineProperty(t,e,{configurable:!0,enumerable:n?.enumerable??!0,get:()=>s(),set(t){r(),a(t)}})}}}if(a.onCallback){const e=setInterval(()=>{const e=a.onCallback.call(t);e instanceof Promise?e.then(t=>r(Boolean(t))):r(Boolean(e))},a.onCallbackFrequency??50);"function"==typeof t?.addEventListener&&t.addEventListener("destroy",()=>clearInterval(e),{once:!0})}}(this,0,0,0,0,t,u.bind(this)))};if("method"===n){const n=e;return s.addInitializer(function(){this[o]||(this[o]=new Map)}),function(...e){d.call(this);const s=this[o]??(this[o]=new Map),i=function(t){return t&&0!==t.length?JSON.stringify(t.map(t=>{if("function"==typeof t)return`function:${t.name}`;if(t&&"object"==typeof t)try{return JSON.stringify(Object.entries(t).sort())}catch{return"[[unserializable-object]]"}return void 0===t?"undefined":t})):"__no_args__"}(e);if(s.has(i))return s.get(i);const a=n.apply(this,e);if(s.set(i,a),t.timeout){const e=setTimeout(()=>s.delete(i),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}return a}}if("getter"===n){const s=e;return function(){if(d.call(this),void 0===this[o]){if(this[o]=s.call(this),t.timeout){const e=setTimeout(()=>u.call(this),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}}return this[o]}}if("accessor"===n){const s=e;return{get(){if(d.call(this),void 0===this[o]){const e=s.get?s.get.call(this):void 0;if(this[o]=e,t.timeout){const e=setTimeout(()=>u.call(this),t.timeout);h.push(e)}if(t.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:t=>setTimeout(t,0))(()=>u.call(this))}}return this[o]},set(t){u.call(this),s.set&&s.set.call(this,t)},init:t=>t}}}}function ze(t){for(const e of Object.getOwnPropertySymbols(t))String(e).startsWith("Symbol(__cache__")&&delete t[e]}function Fe(t,e){const s="function"==typeof e?e.name:e,n=Object.getOwnPropertySymbols(t).find(t=>String(t)===`Symbol(__cache__${s})`);n&&delete t[n]}const Le=new class{prototypeMap=new WeakMap;dataMap=new WeakMap;data(t){return t instanceof g&&(t=t.element),t?(this.dataMap.has(t)||this.dataMap.set(t,{}),this.dataMap.get(t)):{}}prototype(t){return t?(this.prototypeMap.has(t)||this.prototypeMap.set(t,{}),this.prototypeMap.get(t)):{}}fieldSetInPrototype(t,e){for(;t&&t!==HTMLElement.prototype;){if(this.prototype(t)[e])return!0;t=Object.getPrototypeOf(t)}return!1}skipAttributeChangedCallback(t){return this.fieldSetInPrototype(t,"setupAttributeChangedCallback")}skipConnectedCallback(t){return this.fieldSetInPrototype(t,"setupConnectedCallback")}getNamesOfPrototypeChain(t){const e=[];for(;t&&t!==HTMLElement.prototype;){const s=this.prototype(t).name;s&&e.push(s),t=Object.getPrototypeOf(t)}return e}};function Re(t,e={injectAttributeBridge:!0}){return function(s,n){const i=t??xt(n.name),a=s.prototype;if(i&&(Le.prototype(a).name=i),Object.defineProperty(s,"observedAttributes",{configurable:!0,enumerable:!1,get:function(){const t=new Set;let e=this;for(;e&&e!==Function.prototype;){const s=e[Symbol.metadata]?.observedAttributes;if(s)for(const e of s)t.add(e);e=Object.getPrototypeOf(e)}return Array.from(t)}}),!1!==e.injectAttributeBridge&&!Le.skipAttributeChangedCallback(a)){Le.prototype(a).setupAttributeChangedCallback=!0;const t=function(e,s,n){if(d(this,"attributeChangedCallback",t)?.call(this,e,s,n),n===s)return;if(Le.data(this).attributeBridgePass)return;const i=Dt(e);if(i in this)try{Le.data(this).attributeBridgePass=!0,this[i]=null===n?void 0:Tt(n)}finally{Le.data(this).attributeBridgePass=!1}};Object.defineProperty(a,"attributeChangedCallback",{configurable:!0,enumerable:!1,writable:!0,value:t})}if(!Le.skipConnectedCallback(a)){Le.prototype(a).setupConnectedCallback=!0;const t=function(){if(d(this,"connectedCallback",t)?.call(this),this instanceof HTMLElement){for(const t of this.constructor.observedAttributes??[]){const e=this[Dt(t)];if(void 0===e)continue;const s=Ot(e);this.getAttribute(t)!==s&&this.setAttribute(t,s)}Le.getNamesOfPrototypeChain(Object.getPrototypeOf(this)).forEach(t=>this.classList?.add(t))}};Object.defineProperty(a,"connectedCallback",{configurable:!0,enumerable:!1,writable:!0,value:t})}return n.addInitializer(function(){i&&!customElements.get(i)&&customElements.define(i,s)}),s}}function We(t,e=!0){return function(s,n){if(!t)return s;const{kind:i,name:a}=n,r=String(a),o=t.split(".").filter(Boolean),l=function(t){if(!t)return;let e=t;for(const t of o)if(e=e[t],!e)return;return e};if("method"===i)return function(...t){const e=l(this),s=e?.[r];if("function"==typeof s)return s.apply(e,t)};n.addInitializer(function(){const t=function(){return l(this)?.[r]},s=function(t){const e=l(this);e&&(e[r]=t)};if("field"===i||"accessor"===i){const n=c(this,r);Object.defineProperty(this,r,{configurable:!0,enumerable:n?.enumerable??!0,get:()=>t.call(this),set:t=>{e&&s.call(this,t)}})}})}}"metadata"in Symbol||Object.defineProperty(Symbol,"metadata",{value:Symbol.for("Symbol.metadata"),writable:!1,enumerable:!1,configurable:!0});const Ke=new class{constructorMap=new WeakMap;constructorData(t){let e=this.constructorMap.get(t);return e||(e={installed:new Map},this.constructorMap.set(t,e)),e}};function He(t,e){const{kind:s,name:n,static:i}=e,a=String(n),r=xt(a),o=Symbol(`__observed_${a}`);if(e.metadata){const t=e.metadata.observedAttributes;Object.prototype.hasOwnProperty.call(e.metadata,"observedAttributes")?t||(e.metadata.observedAttributes=new Set):e.metadata.observedAttributes=new Set(t),e.metadata.observedAttributes.add(r)}e.addInitializer(function(){const e=i?this:u(this,a);let l,h;if("field"===s||"accessor"===s)try{this[o]=this[n]}catch{}const d=function(){return l?l.call(this):this[o]},f=function(t){this[a]!==t&&(h?h.call(this,t):this[o]=t,this.setAttribute?.(r,Ot(this[a])))};if("field"===s||"accessor"===s){const e=t;e?.get&&(l=e.get),e?.set&&(h=e.set);const s=c(this,a);s?.get&&(l=s.get),s?.set&&(h=s.set),Object.defineProperty(this,a,{configurable:!0,enumerable:s?.enumerable??!0,get:()=>d.call(this),set:t=>f.call(this,t)})}else if("getter"===s||"setter"===s){const t=Ke.constructorData(e).installed;if(t.get(a))return;t.set(a,!0);const s=c(e,a)??{};"function"==typeof s.get&&(l=s.get),"function"==typeof s.set&&(h=s.set),Object.defineProperty(e,a,{configurable:!0,enumerable:!!s?.enumerable,get:function(){return d.call(this)},set:function(t){f.call(this,t)}})}})}function Ue(t,e){const{name:s}=e;return e.addInitializer(function(){this.solverKeys?.push(s)}),t}function $e(t){const e=O(t);return Ne(e).setStyles({display:"flex",flexDirection:"column"},!0),e}function Ge(t){const e=$e(t);return Ne(e).setStyles({justifyContent:"center",alignItems:"center"},!0),e}function qe(t){const e=O(t);return Ne(e).setStyles({display:"flex",flexDirection:"row"},!0),e}function Ye(t){const e=qe(t);return Ne(e).setStyles({justifyContent:"center",alignItems:"center"},!0),e}function Je(t){const e=O(t);return Ne(e).setStyle("flexGrow",1,!0),e}class Xe{element;model;emitter;constructor(t){this.element=t.element,t.model&&(this.model=t.model),t.emitter&&(this.emitter=t.emitter)}initialize(){this.setupUIElements(),this.setupUILayout(),this.setupUIListeners(),this.setupChangedCallbacks()}setupChangedCallbacks(){at(this)}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}class Qe extends $t{#s;get target(){return this.#s}set target(t){this.#s=t}toolName;manager;options;constructor(t){super(t),this.manager=t.manager??this.manager??ae.instance,this.toolName=t.toolName??this.toolName??void 0,this.options=t.listenerOptions??{};const e=this.element;this.target=t.target??this.target??e instanceof Node?e:e?.element instanceof Node?e.element:void 0}initialize(){super.initialize();const t=this.target??this;for(const[e,s]of Object.entries(Ct)){const n=this[e];if("function"!=typeof n)continue;const i=this.options?.[e];this.toolName?Ne(t).onTool(s,this.toolName,t=>n.call(this,t),i,this.manager):Ne(t).on(s,t=>n.call(this,t),i,this.manager)}}}class Ze extends $t{substrateName;solverKeys=[];get objectList(){return Ne(this).getSubstrateObjectList(this.substrateName)}set objectList(t){Ne(this).setSubstrateObjectList(t,this.substrateName)}constructor(t){super(t),this.substrateName=t.substrateName??this.substrateName??void 0,t.onActivate&&(this.onActivate=t.onActivate),t.onDeactivate&&(this.onDeactivate=t.onDeactivate)}initialize(){super.initialize(),this.substrateName&&(Ne(this).makeSubstrate(this.substrateName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0}),this.solverKeys.forEach(t=>{Ne(this).addSolver(e=>this[t]?.(e))}))}addObject(t){Ne(this).addObjectToSubstrate(t,this.substrateName)}removeObject(t){Ne(this).removeObjectFromSubstrate(t,this.substrateName)}hasObject(t){return Ne(this).hasObjectInSubstrate(t,this.substrateName)}isProcessed(t){return Ne(this).wasObjectProcessedBySubstrate(t,this.substrateName)}addSolver(t){Ne(this).addSolver(t,this.substrateName)}removeSolver(t){Ne(this).removeSolver(t,this.substrateName)}clearSolvers(){Ne(this).clearSolvers(this.substrateName)}resolve(t={}){Ne(this).resolveSubstrate({...t,substrate:this.substrateName})}}class ts extends $t{toolName;embeddedTarget;manager;activationEvent=Ct.click;clickMode=It.left;key;constructor(t){super(t),this.toolName=t.toolName??this.toolName??void 0,t.embeddedTarget&&(this.embeddedTarget=t.embeddedTarget),t.onActivate&&(this.onActivate=t.onActivate),t.onDeactivate&&(this.onDeactivate=t.onDeactivate),t.activationEvent&&(this.activationEvent=t.activationEvent),t.clickMode&&(this.clickMode=t.clickMode),t.customActivation&&(this.customActivation=t.customActivation),t.key&&(this.key=t.key),this.manager=t.manager??this.manager??ae.instance}initialize(){if(super.initialize(),this.toolName){Ne(this).makeTool(this.toolName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0,activationEvent:this.activationEvent,clickMode:this.clickMode,customActivation:"function"==typeof this.customActivation?this.customActivation.bind(this):void 0,key:this.key,manager:this.manager}),this.embeddedTarget&&Ne(this).embedTool(this.embeddedTarget,this.manager);for(const[t,e]of Object.entries(Ct)){const s=this[t];"function"==typeof s&&Ne(this).addToolBehavior(e,(t,e)=>s.call(this,t,e),this.toolName,this.manager)}}}}function es(t,e){void 0===e&&(e={});var s=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===s&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}function ss(t){const e=t.prototype,s=Symbol("__unset_default_classes__");Object.defineProperty(e,"unsetDefaultClasses",{get:function(){return this[s]??!1},set:function(t){this[s]=t;const e=this.constructor?.config?.defaultClasses;e&&Ne(this).toggleClass(e,t)},enumerable:!0,configurable:!0})}es("turbo-button{align-items:center;background-color:#dadada;border:1px solid #000;border-radius:.4em;color:#000;display:inline-flex;flex-direction:row;gap:.4em;padding:.5em .7em;text-decoration:none}turbo-button>h4{flex-grow:1}");class ns extends HTMLElement{static config={shadowDOM:!1,defaultSelectedClass:"selected"};mvc=new G({element:this});onAttach=new ht;onDetach=new ht;onAdopt=new ht;static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}connectedCallback(){this.onAttach.fire()}disconnectedCallback(){this.onDetach.fire()}adoptedCallback(){this.onAdopt.fire()}}function is(...t){if(t.length<2)return!0;for(let e=0;e<t.length-1;e++)if(t[e]!=t[e+1])return!1;return!0}function as(t,...e){if(e.length<1)return!0;for(const s of e)if(t==s)return!0;return!1}function rs(t,...e){if(e.length<1)return!0;for(const s of e){let e=!1;for(const n of t)s==n&&(e=!0);if(!e)return!1}return!0}function os(t){let e=document.createElement("div");return e.innerHTML=t,e.children[0]}function ls(t,e){return new Proxy(t,{get:(t,s,n)=>s in t?Reflect.get(t,s,n):s in e?Reflect.get(e,s,n):void 0,set:(t,s,n,i)=>s in t?Reflect.set(t,s,n,i):Reflect.set(e,s,n,i)})}function cs(t,e=!0){return new Promise((s,n)=>{t&&0!==t.length?fetch(t).then(t=>{if(!t.ok)throw new Error("Network response was not ok while loading your SVG");return t.text()}).then(t=>{const e=os(t);if(!e)throw new Error("Error parsing SVG text");s(e)}).catch(t=>{e||n(t),console.error("Error fetching SVG:",t),n(t)}):n(new Error("Invalid path"))})}ne(ns),se(ns),ss(ns);let hs=(()=>{let s,n,i,a,r,o,c,h=[Re("turbo-icon")],u=[],d=ns,f=[],p=[],g=[],b=[],y=[];return class extends d{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(d[Symbol.metadata]??null):void 0;i=[He,m({initialValueCallback:function(){return this.getPropertiesValue(this.type,"defaultType","svg")},preprocessValue:function(t){return t&&0!=t.length?("."==t[0]&&(t=t.substring(1)),t):this.type},callAfter:function(){this.generateIcon()}})],a=[He,m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultDirectory","")},preprocessValue:function(t){return l(t)?this.directory:(t.length>0&&!t.endsWith("/")&&(t+="/"),t)},callAfter:function(){this.generateIcon()}})],r=[He,m()],o=[He,m()],c=[_e()],t(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:t=>"icon"in t,set:(t,e)=>{t.icon=e}},metadata:e},null,f),t(this,null,o,{kind:"setter",name:"iconColor",static:!1,private:!1,access:{has:t=>"iconColor"in t,set:(t,e)=>{t.iconColor=e}},metadata:e},null,f),t(this,null,c,{kind:"method",name:"loadSvg",static:!1,private:!1,access:{has:t=>"loadSvg"in t,get:t=>t.loadSvg},metadata:e},null,f),t(null,null,i,{kind:"field",name:"type",static:!1,private:!1,access:{has:t=>"type"in t,get:t=>t.type,set:(t,e)=>{t.type=e}},metadata:e},p,g),t(null,null,a,{kind:"field",name:"directory",static:!1,private:!1,access:{has:t=>"directory"in t,get:t=>t.directory,set:(t,e)=>{t.directory=e}},metadata:e},b,y),t(null,s={value:n},h,{kind:"class",name:n.name,metadata:e},null,u),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ns.config,defaultType:"svg",customLoaders:{}};static imageTypes=["png","jpg","jpeg","gif","webp","PNG","JPG","JPEG","GIF","WEBP"];_element=e(this,f);_loadToken=0;onLoaded;type=e(this,p,void 0);directory=(e(this,g),e(this,b,void 0));get path(){let t=Pt(this.icon);const e=this.icon?.replace(t,"");return 0===t.length&&this.type?.length>0&&(t="."+this.type),this.directory+e+t}set icon(t){const e=Pt(t).substring(1);e&&(this.type=e),this.generateIcon()}set iconColor(t){this.updateColor(t)}set element(t){this._element=t}get element(){return this._element}loadSvg(t){return cs(t)}loadImg(t){return _({src:t,alt:this.icon})}updateColor(t=this.iconColor){t&&this.element instanceof SVGElement&&(this.element.style.fill=t)}generateIcon(){const t=this.path,e=Pt(t)?.substring(1);if(this.element instanceof HTMLImageElement&&as(e,...this.constructor.imageTypes))return this.element.src=this.path,void(this.element.alt=this.icon);if(this.clear(),!this.icon||0===this.icon.length)return;const s=++this._loadToken,n=this.getLoader(e)(t);n instanceof Element?this.setupLoadedElement(n):n.then(t=>{s===this._loadToken&&this.setupLoadedElement(t)}).catch(t=>console.error(`Failed to load icon: ${t}`))}getLoader(t){if(!t)return;const e=this.constructor.config.customLoaders[t];if(e)return e;if(as(t,"svg","SVG"))return this.loadSvg.bind(this);if(as(t,...this.constructor.imageTypes))return this.loadImg.bind(this);throw new Error(`Unsupported icon type: ${t}`)}setupLoadedElement(t){!this.element&&t&&(t.parentElement&&(t=t.cloneNode(!0)),Ne(this).addChild(t),this.updateColor(),this.onLoaded?.(t),this.element=t)}clear(){Ne(this.element).destroy(),this.element=null}constructor(){super(...arguments),e(this,y)}static{e(n,u)}},n})();function us(t){return t.tag||(t.tag="turbo-icon"),O({...t})}let ds=(()=>{let s,n,i,a,r,o,l,c,h,u,d=[Re("turbo-rich-element")],f=[],p=ns,g=[],b=[],y=[];return class extends p{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;i=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultElementTag","h4")}})],a=[m({executeSetterBeforeStoring:!0})],r=[m({preprocessValue:function(t){if("string"==typeof t){if(this.leftIcon)return this.leftIcon.icon=t,this.leftIcon;t=us({icon:t})}return Ne(this).remChild(this.leftIcon),this.addAtPosition(t,"leftIcon"),t}})],o=[m({preprocessValue:function(t){if("string"==typeof t){if(this.prefixEntry)return this.prefixEntry.textContent=t,this.prefixEntry;t=O({text:t})}return Ne(this).remChild(this.prefixEntry),this.addAtPosition(t,"prefixEntry"),t}})],l=[m({preprocessValue:function(t){if("string"==typeof t){if(this.element&&"textContent"in this.element)return this.element.textContent=t,this.element;t=O({tag:this.elementTag,text:t})}else"object"!=typeof t||t instanceof Element||(t.tag||(t.tag=this.elementTag),t=O(t));return Ne(this).remChild(this.element),this.addAtPosition(t,"element"),t}})],c=[m({preprocessValue:function(t){if("string"==typeof t){if(this.suffixEntry)return this.suffixEntry.textContent=t,this.suffixEntry;t=O({text:t})}return Ne(this).remChild(this.suffixEntry),this.addAtPosition(t,"suffixEntry"),t}})],h=[m({preprocessValue:function(t){if("string"==typeof t){if(this.rightIcon)return this.rightIcon.icon=t,this.rightIcon;t=us({icon:t})}return Ne(this).remChild(this.rightIcon),this.addAtPosition(t,"rightIcon"),t}})],u=[m({executeSetterBeforeStoring:!0})],t(this,null,a,{kind:"setter",name:"leftCustomElements",static:!1,private:!1,access:{has:t=>"leftCustomElements"in t,set:(t,e)=>{t.leftCustomElements=e}},metadata:e},null,g),t(this,null,r,{kind:"setter",name:"leftIcon",static:!1,private:!1,access:{has:t=>"leftIcon"in t,set:(t,e)=>{t.leftIcon=e}},metadata:e},null,g),t(this,null,o,{kind:"setter",name:"prefixEntry",static:!1,private:!1,access:{has:t=>"prefixEntry"in t,set:(t,e)=>{t.prefixEntry=e}},metadata:e},null,g),t(this,null,l,{kind:"setter",name:"element",static:!1,private:!1,access:{has:t=>"element"in t,set:(t,e)=>{t.element=e}},metadata:e},null,g),t(this,null,c,{kind:"setter",name:"suffixEntry",static:!1,private:!1,access:{has:t=>"suffixEntry"in t,set:(t,e)=>{t.suffixEntry=e}},metadata:e},null,g),t(this,null,h,{kind:"setter",name:"rightIcon",static:!1,private:!1,access:{has:t=>"rightIcon"in t,set:(t,e)=>{t.rightIcon=e}},metadata:e},null,g),t(this,null,u,{kind:"setter",name:"rightCustomElements",static:!1,private:!1,access:{has:t=>"rightCustomElements"in t,set:(t,e)=>{t.rightCustomElements=e}},metadata:e},null,g),t(null,null,i,{kind:"field",name:"elementTag",static:!1,private:!1,access:{has:t=>"elementTag"in t,get:t=>t.elementTag,set:(t,e)=>{t.elementTag=e}},metadata:e},b,y),t(null,s={value:n},d,{kind:"class",name:n.name,metadata:e},null,f),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ns.config,defaultElementTag:"h4"};childrenOrder=(e(this,g),["leftCustomElements","leftIcon","prefixEntry","element","suffixEntry","rightIcon","rightCustomElements"]);addAtPosition(t,e){if(!t||!e)return;let s=0;for(let t=0;t<this.childrenOrder.length;t++){const n=this.childrenOrder[t];if(n===e)break;const i=this[n];i&&i instanceof Element?s++:i&&Array.isArray(i)&&(s+=i.length)}Ne(this).addChild(t,s)}elementTag=e(this,b,void 0);set leftCustomElements(t){Ne(this).remChild(this.leftCustomElements),this.addAtPosition(t,"leftCustomElements")}set leftIcon(t){}get leftIcon(){}set prefixEntry(t){}get prefixEntry(){}set element(t){}get element(){}get text(){const t=this.element;return t?t.textContent:""}set text(t){t||(t=""),this.element=t}set suffixEntry(t){}get suffixEntry(){}set rightIcon(t){}get rightIcon(){}set rightCustomElements(t){Ne(this).remChild(this.rightCustomElements),this.addAtPosition(t,"rightCustomElements")}constructor(){super(...arguments),e(this,y)}static{e(n,f)}},n})();function fs(t){return t.text&&!t.element&&(t.element=t.text),!t.elementTag||"object"!=typeof t.element||t.element instanceof Element||(t.element.tag=t.elementTag),t.tag||(t.tag="turbo-rich-element"),O({...t,text:void 0})}let ps=(()=>{let s,n,i=[Re("turbo-button")],a=[],r=ds;return class extends r{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t(null,s={value:n},i,{kind:"class",name:n.name,metadata:e},null,a),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ds.config,defaultElementTag:"h4"};static{e(n,a)}},n})();function ms(t){return t.tag||(t.tag="turbo-button"),fs({...t})}let gs=(()=>{let s,n,i,a,r,o=[Re("turbo-icon-switch")],l=[],c=hs,h=[];return class extends c{static{n=this}static{const u="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;i=[m({preprocessValue:function(t){return t instanceof me?t:new me(t||{})}})],a=[m()],r=[m()],t(this,null,i,{kind:"setter",name:"switchReifect",static:!1,private:!1,access:{has:t=>"switchReifect"in t,set:(t,e)=>{t.switchReifect=e}},metadata:u},null,h),t(this,null,a,{kind:"setter",name:"defaultState",static:!1,private:!1,access:{has:t=>"defaultState"in t,set:(t,e)=>{t.defaultState=e}},metadata:u},null,h),t(this,null,r,{kind:"setter",name:"appendStateToIconName",static:!1,private:!1,access:{has:t=>"appendStateToIconName"in t,set:(t,e)=>{t.appendStateToIconName=e}},metadata:u},null,h),t(null,s={value:n},o,{kind:"class",name:n.name,metadata:u},null,l),n=s.value,u&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),e(n,l)}config=(e(this,h),{...hs.config});get switchReifect(){}set switchReifect(t){this.switchReifect.attach(this),this.defaultState&&this.switchReifect.apply(this.defaultState,this)}set defaultState(t){this.switchReifect?.apply(t,this)}set appendStateToIconName(t){if(t){const t=this.switchReifect.properties;this.switchReifect.states.forEach(e=>{t[e]={...t[e],icon:this.icon+"-"+e.toString()}}),this.switchReifect.properties=t}}initialize(){super.initialize(),this.defaultState&&this.switchReifect?.apply(this.defaultState,this)}},n})();function bs(t){return t.tag||(t.tag="turbo-icon-switch"),us({...t})}let ys=(()=>{let s,n,i,a,r=[Re("turbo-icon-toggle")],o=[],l=hs,c=[];return class extends l{static{n=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;i=[m({initialValue:!1})],a=[m({initialValue:!1})],t(this,null,i,{kind:"setter",name:"toggled",static:!1,private:!1,access:{has:t=>"toggled"in t,set:(t,e)=>{t.toggled=e}},metadata:h},null,c),t(this,null,a,{kind:"setter",name:"toggleOnClick",static:!1,private:!1,access:{has:t=>"toggleOnClick"in t,set:(t,e)=>{t.toggleOnClick=e}},metadata:h},null,c),t(null,s={value:n},r,{kind:"class",name:n.name,metadata:h},null,o),n=s.value,h&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),e(n,o)}config=(e(this,c),{...hs.config});stopPropagationOnClick=!0;onToggle;clickListener=()=>(this.toggle(),this.stopPropagationOnClick);set toggled(t){this.onToggle&&this.onToggle(t,this)}set toggleOnClick(t){t?Ne(this).on(Ct.click,this.clickListener):Ne(this).removeListener(Ct.click,this.clickListener)}toggle(){this.toggled=!this.toggled}},n})();function vs(t){return t.tag||(t.tag="turbo-icon-toggle"),us({...t})}function ks(t=8){const e=new Uint8Array(t);return crypto.getRandomValues(e),Array.from(e).map(t=>t.toString(36).padStart(2,"0")).join("").slice(0,t)}function Ss(t,e){if("number"!=typeof t||"number"!=typeof e)return 0;const s=Math.min(t,e),n=Math.max(t,e);return Math.random()*(n-s)+s}function Es(t=[50,70],e=[70,85]){return"number"!=typeof t&&t.length>=2&&(t=Ss(t[0],t[1])),"number"!=typeof e&&e.length>=2&&(e=Ss(e[0],e[1])),"hsl("+360*Math.random()+" "+t+" "+e+")"}function ws(t=12){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let n=0;n<t;n++)s+=e.charAt(Math.floor(62*Math.random()));return s}class Cs extends Qe{keyName="__input__interactor__";_composing=!1;_resizeQueued=!1;options={compositionStart:{capture:!0},compositionEnd:{capture:!0},input:{capture:!0}};get inputElement(){return this.element.element}initialize(){super.initialize(),Ne(this.target).bypassManagerOn=()=>!0}setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("valueSet",()=>this.handleInput())}click(){return this.element.locked||this.inputElement?.focus(),!1}focusIn(t){if(t.target===this.inputElement){if(!this.element.locked)return this.element.selectTextOnFocus&&requestAnimationFrame(()=>{try{this.inputElement.select?.()}catch{}}),this.element.onFocus.fire(),!0;this.inputElement.blur()}}focusOut(t){t.target===this.inputElement&&(this.element.value=this.element.element?.value,this.element.onBlur.fire())}compositionStart(t){t.target===this.inputElement&&(this._composing=!0)}compositionEnd(t){if(t.target===this.inputElement)return this._composing=!1,this.handleInput(),!0}input(t){if(t.target===this.inputElement)return this.handleInput(),!0}handleInput(){this._composing||this.inputElement&&(this.element.dynamicVerticalResize&&this.inputElement instanceof HTMLTextAreaElement&&(this._resizeQueued||(this._resizeQueued=!0,queueMicrotask(()=>{this._resizeQueued=!1,Ne(this.inputElement).setStyle("height","auto",!0).setStyle("height",this.inputElement.scrollHeight+"px",!0)}))),this.emitter.fire("processValue"))}}let Os=(()=>{let s,n,i,a=[Re("turbo-input")],r=[],o=ds,l=[];return class extends o{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(o[Symbol.metadata]??null):void 0;i=[m()],t(this,null,i,{kind:"setter",name:"label",static:!1,private:!1,access:{has:t=>"label"in t,set:(t,e)=>{t.label=e}},metadata:e},null,l),t(null,s={value:n},a,{kind:"class",name:n.name,metadata:e},null,r),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ds.config,defaultElementTag:"input"};labelElement=e(this,l);_content;get content(){return this._content}set content(t){this._content=t}defaultId="turbo-input-"+ks();locked=!1;selectTextOnFocus=!1;dynamicVerticalResize=!1;inputRegexCheck;blurRegexCheck;lastValidForInput="";lastValidForBlur="";onFocus=new ht;onBlur=new ht;onInput=new ht;set label(t){t&&0!==t.length?(this.labelElement||(this.labelElement=O({tag:"label",htmlFor:this.element?.id??this.defaultId}),Ne(this).childHandler=this,Ne(this).addChild(this.labelElement,0),this.content&&(Ne(this).childHandler=this.content)),this.labelElement.textContent=t):this.labelElement&&this.labelElement.remove()}set element(t){t instanceof Node||"object"!=typeof t||(t.name||(t.name=ks()),"input"!==this.elementTag||t.type||(t.type="text")),super.element=t,this.element&&(this.element.id?this.labelElement&&(this.labelElement.htmlFor=this.element.id):this.element.id=this.defaultId)}get element(){return super.element}initialize(){super.initialize(),this.mvc.generate({interactors:[Cs]}),this.mvc.getInteractor("__input__interactor__").target=this.content}setupUIElements(){super.setupUIElements(),this.content=D()}setupUILayout(){super.setupUILayout(),Ne(this.content).addChild(Ne(this).childrenArray),Ne(this).addChild([this.labelElement,this.content]),Ne(this).childHandler=this.content}setupChangedCallbacks(){super.setupChangedCallbacks(),this.mvc.emitter.add("processValue",()=>this.processInputValue())}get value(){const t=this.element?.value;try{const e=parseFloat(t);if(!isNaN(e))return e}catch{}return t}set value(t){if(!(this.element instanceof HTMLInputElement||this.element instanceof HTMLTextAreaElement))return;let e=t.toString();if(this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(e)||(e=this.lastValidForBlur)}this.element.value=e,this.mvc.emitter.fire("valueSet")}processInputValue(t=this.element.value){if(this.inputRegexCheck){const e=new RegExp(this.inputRegexCheck);if(!e.test(t)){const s=this.sanitizeByRegex(t,this.inputRegexCheck);t=e.test(s)?s:this.lastValidForInput}}if(this.lastValidForInput=t.toString(),this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(t.toString())&&(this.lastValidForBlur=t)}else this.lastValidForBlur=t;this.element.value=t,this.onInput.fire()}sanitizeByRegex(t,e){const s="string"==typeof e?e:e.source,n="string"==typeof e?"":e.flags.replace("g",""),i=new RegExp(s,n);let a="";for(const e of t){const t=a+e;i.lastIndex=0,i.test(t)&&(a=t)}return a}static{e(n,r)}},n})();function Ts(t){return t.element=t.input,t.elementTag=t.inputTag,t.elementTag||(t.elementTag="input"),t.element||(t.element={}),t.tag||(t.tag="turbo-input"),fs({...t,input:void 0,inputTag:void 0})}let Ps=(()=>{let s,n,i=[Re("turbo-numerical-input")],a=[],r=Os;return class extends r{static{n=this}static{const o="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;t(null,s={value:n},i,{kind:"class",name:n.name,metadata:o},null,a),n=s.value,o&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),e(n,a)}multiplier=1;decimalPlaces;min;max;get value(){return Number.parseFloat(this.element.value)/this.multiplier}set value(t){t&&""!=t||(t=0),"string"==typeof t&&(t=Number.parseFloat(t)),t*=this.multiplier,null!=this.min&&t<this.min&&(t=this.min),null!=this.max&&t>this.max&&(t=this.max),null!=this.decimalPlaces&&(t=Math.round(t*Math.pow(10,this.decimalPlaces))/Math.pow(10,this.decimalPlaces)),super.value=t}},n})();function xs(t){return t.inputRegexCheck||(t.inputRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?\.?$|^-$|^$/),t.blurRegexCheck||(t.blurRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?(?<=\d)$/),t.tag||(t.tag="turbo-numerical-input"),Ts({...t})}class Ds extends Ht{toggledEntry;values;constructor(t){super(t),this.toggledEntry=t.toggledEntry,this.values=t.values}}class As{static config={};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}}ne(As);let Ms=(()=>{let s,n,i,a,r,c,h,u,d,f=As,p=[],g=[],b=[],y=[],v=[],k=[],S=[],E=[],w=[],C=[],O=[],T=[],P=[],x=[],D=[];return class extends f{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(f[Symbol.metadata]??null):void 0;s=[m()],n=[m({defaultValue:t=>t instanceof ds?t.text:t instanceof HTMLElement?t.textContent:t instanceof Element?t.innerHTML:void 0})],i=[m({defaultValue:()=>""})],a=[m({defaultValue:t=>fs({text:Ot(t)})})],r=[m({defaultValue:function(t){this.initializeSelection(),Ne(t).on(Ct.click,()=>(this.select(t,!this.isSelected(t)),!0))}})],c=[m({defaultValue:function(t){}})],h=[m({defaultValue:!1})],u=[m({defaultValueCallback:function(){return!this.multiSelection}})],d=[m({callBefore:function(){this.selectedEntries?.forEach(t=>je(t).removeClass(this.selectedEntryClasses))},callAfter:function(){this.selectedEntries?.forEach(t=>je(t).addClass(this.selectedEntryClasses))},initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectedEntryClasses")}})],t(this,null,s,{kind:"setter",name:"parent",static:!1,private:!1,access:{has:t=>"parent"in t,set:(t,e)=>{t.parent=e}},metadata:e},null,p),t(this,null,h,{kind:"setter",name:"multiSelection",static:!1,private:!1,access:{has:t=>"multiSelection"in t,set:(t,e)=>{t.multiSelection=e}},metadata:e},null,p),t(null,null,n,{kind:"field",name:"getValue",static:!1,private:!1,access:{has:t=>"getValue"in t,get:t=>t.getValue,set:(t,e)=>{t.getValue=e}},metadata:e},g,b),t(null,null,i,{kind:"field",name:"getSecondaryValue",static:!1,private:!1,access:{has:t=>"getSecondaryValue"in t,get:t=>t.getSecondaryValue,set:(t,e)=>{t.getSecondaryValue=e}},metadata:e},y,v),t(null,null,a,{kind:"field",name:"createEntry",static:!1,private:!1,access:{has:t=>"createEntry"in t,get:t=>t.createEntry,set:(t,e)=>{t.createEntry=e}},metadata:e},k,S),t(null,null,r,{kind:"field",name:"onEntryAdded",static:!1,private:!1,access:{has:t=>"onEntryAdded"in t,get:t=>t.onEntryAdded,set:(t,e)=>{t.onEntryAdded=e}},metadata:e},E,w),t(null,null,c,{kind:"field",name:"onEntryRemoved",static:!1,private:!1,access:{has:t=>"onEntryRemoved"in t,get:t=>t.onEntryRemoved,set:(t,e)=>{t.onEntryRemoved=e}},metadata:e},C,O),t(null,null,u,{kind:"field",name:"forceSelection",static:!1,private:!1,access:{has:t=>"forceSelection"in t,get:t=>t.forceSelection,set:(t,e)=>{t.forceSelection=e}},metadata:e},T,P),t(null,null,d,{kind:"field",name:"selectedEntryClasses",static:!1,private:!1,access:{has:t=>"selectedEntryClasses"in t,get:t=>t.selectedEntryClasses,set:(t,e)=>{t.selectedEntryClasses=e}},metadata:e},x,D),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={defaultSelectedEntryClasses:"selected"};_inputField=e(this,p);_entries=[];_entriesData=new WeakMap;parentObserver;onSelectDelegate=new ht;onEnabledDelegate=new ht;get entries(){return this._entries}set entries(t){this.enableObserver(!1);const e=this.selectedValues;this.clear(),this._entries=(Array.isArray(t)?t:Array.from(t)).filter(t=>t!==this.inputField),t instanceof HTMLCollection&&t.item(0)&&(this.parent=t.item(0).parentElement);const s=this.entries;for(let t=0;t<s.length;t++)this.onEntryAdded?.call(this,s[t],t);this.deselectAll();for(let t=0;t<s.length;t++)e.includes(this.getValue(s[t]))&&this.select(s[t]);0===this.selectedEntries.length&&this.initializeSelection(),this.refreshInputField(),this.enableObserver(!0)}get values(){return this.entries.map(t=>this.getValue(t))}set values(t){const e=[];t.forEach(t=>{const s=this.createEntry(t);s instanceof Node&&this.parent&&Ne(this.parent).addChild(s),e.push(s)}),this.entries=e}get selectedEntries(){return this.entries.filter(t=>this.getEntryData(t).selected)}set selectedEntries(t){this.deselectAll(),t&&t.forEach(t=>this.select(t))}set parent(t){t instanceof Element&&(Ne(t).addChild(this.entries.filter(t=>t instanceof Node)),this.inputField&&t.appendChild(this.inputField),this.setupParentObserver())}getValue=e(this,g,void 0);getSecondaryValue=(e(this,b),e(this,y,void 0));createEntry=(e(this,v),e(this,k,void 0));onEntryAdded=(e(this,S),e(this,E,void 0));onEntryRemoved=(e(this,w),e(this,C,void 0));get inputName(){return this.inputField?.name}set inputName(t){this._inputField||(this._inputField=z({value:this.stringSelectedValue,type:"hidden",parent:this.parent??document.body})),this.inputField.name=t}get inputField(){return this._inputField}set multiSelection(t){this.forceSelection=!t}forceSelection=(e(this,O),e(this,T,void 0));set onSelect(t){t&&this.onSelectDelegate.add(t)}set onEnabled(t){t&&this.onEnabledDelegate.add(t)}selectedEntryClasses=(e(this,P),e(this,x,void 0));constructor(t={}){super(),e(this,D);const s=t.selectedValues||[];t.selectedValues=void 0,t.onEnabled||(t.onEnabled=(t,e)=>{e instanceof HTMLElement&&Ne(e).setStyle("visibility",t?"":"hidden")});for(const e of Object.keys(t))try{this[e]=t[e]}catch{}this.forceSelection||this.deselectAll(),this.entries.forEach(t=>{s.includes(this.getValue(t))&&this.select(t)})}getEntryData(t){if(!t)return{};let e=this._entriesData.get(t);return e||(e={selected:!1,enabled:!0},this._entriesData.set(t,e)),e}clearEntryData(t){this._entriesData.delete(t);const e=this.entries.indexOf(t);e>=0&&this.entries.splice(e,1)}addEntry(t,e=this.entries.length){(void 0===e||"number"!=typeof e||e>this.entries.length)&&(e=this.entries.length),e<0&&(e=0),this.enableObserver(!1),this.onEntryAdded?.call(this,t,e),Array.isArray(this.entries)&&!this.entries.includes(t)&&this.entries.splice(e,0,t),t instanceof Node&&!t.parentElement&&this.parent&&Ne(this.parent).addChild(t,e),this.enableObserver(!0),requestAnimationFrame(()=>this.select(this.selectedEntry))}getEntryFromSecondaryValue(t){return this.entries.find(e=>this.getSecondaryValue(e)===t)}isSelected(t){return this.selectedEntries.includes(t)}getEntry(t){let e;try{const s=this.find(t);if(s)e=s;else{const s=this.entries.find(e=>e===t);s&&(e=s)}}catch{}return e}select(t,e=!0){if(o(t)||l(t))return this;let s;try{const e=this.getEntry(t);if(e)s=e;else{const e=this.entries.find(e=>e===t);e&&(s=e)}}catch{}if(!s)return this;const n=this.isSelected(s);return e===n||!e&&n&&this.selectedEntries.length<=1&&this.forceSelection||(this.multiSelection||this.deselectAll(),this.getEntryData(s).selected=e,s instanceof HTMLElement&&Ne(s).toggleClass(this.selectedEntryClasses,e),this.initializeSelection(),this.refreshInputField(),this.onSelectDelegate.fire(e,s,this.getIndex(s)),(this.parent??document).dispatchEvent(new Ds({toggledEntry:s,values:this.selectedValues}))),this}selectByIndex(t,e=fe){return t=e(t,this.entries.length-1,0),this.select(this.entries[t])}getIndex(t){return this.entries.indexOf(t)}deselectAll(){this.selectedEntries.forEach(t=>{t instanceof HTMLElement&&Ne(t).toggleClass(this.selectedEntryClasses,!1),this.getEntryData(t).selected=!1}),this.refreshInputField()}reset(){this.deselectAll()}get enabledEntries(){return this.entries.filter(t=>this.getEntryData(t).enabled)}get enabledValues(){return this.enabledEntries.map(t=>this.getValue(t))}get enabledSecondaryValues(){return this.enabledEntries.map(t=>this.getSecondaryValue(t))}find(t){return this.entries.find(e=>this.getValue(e)===t)}findBySecondaryValue(t){return this.entries.find(e=>this.getSecondaryValue(e)===t)}findAll(...t){return this.entries.filter(e=>t.includes(this.getValue(e)))}findAllBySecondaryValue(...t){return this.entries.filter(e=>t.includes(this.getSecondaryValue(e)))}enable(t,...e){e&&0!==e.length||(e=this.entries),e.forEach(e=>{const s=this.getEntry(e);s&&(this.getEntryData(s).enabled=t,this.onEnabledDelegate.fire(t,s,this.getIndex(s)))})}get selectedEntry(){return this.selectedEntries[0]}get selectedValues(){return this.selectedEntries.map(t=>this.getValue(t))}get selectedValue(){const t=this.selectedEntry;if(t)return this.getValue(t)}get selectedSecondaryValues(){return this.selectedEntries.map(t=>this.getSecondaryValue(t))}get selectedSecondaryValue(){const t=this.selectedEntry;if(t)return this.getSecondaryValue(t)}get stringSelectedValue(){return this.selectedEntries.map(t=>Ot(this.getValue(t))).join(", ")}clear(){this.enableObserver(!1);for(const t of this.entries)this.clearEntryData(t),this.onEntryRemoved(t),this.parent&&t instanceof HTMLElement&&t.remove();this._entries=[],this.refreshInputField(),this.enableObserver(!0)}refreshInputField(){this.inputField&&(this.inputField.value=this.stringSelectedValue)}destroy(){return this.enableObserver(!1),this.parentObserver=null,this}enableObserver(t){if(!t)return this.parentObserver?.disconnect();this.parent instanceof Element&&this.parentObserver&&this.parentObserver.observe(this.parent,{childList:!0})}initializeSelection(){if(this.forceSelection&&this.enabledEntries.length&&0===this.selectedEntries.length){const t=this.enabledEntries[0];t&&this.select(t)}}setupParentObserver(){this.enableObserver(!1),this.parentObserver=new MutationObserver(t=>{for(const e of t){for(const t of e.addedNodes){if(!(t instanceof Element)||t.parentElement!==this.parent)continue;if(t===this.inputField)continue;const e=t,s=Array.from(this.parent.children).filter(t=>t!==this.inputField).filter(t=>this.entries.includes(t)||t===e),n=s.indexOf(e);if(!(n<0)){if(0===n)this.entries.splice(n,0,e);else{const t=this.entries.indexOf(s[n-1]);this.entries.splice(t+1,0,e)}this.getEntryData(e),this.onEntryAdded?.call(this,e,this.getIndex(e))}}for(const t of e.removedNodes)t instanceof Element&&t!==this.inputField&&queueMicrotask(()=>{if(t.isConnected)return;const e=this.getEntryData(t);if(e.selected&&this.forceSelection&&this.enabledEntries.length){const t=this.enabledEntries[0];t&&this.select(t)}e.selected=!1,this.onEntryRemoved?.call(this,t),this.clearEntryData(t)})}}),this.enableObserver(!0)}}})(),js=(()=>{let o,l=ut,c=[];return class extends l{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;o=[m({})],t(this,null,o,{kind:"setter",name:"enabledCallbacks",static:!1,private:!1,access:{has:t=>"enabledCallbacks"in t,set:(t,e)=>{t.enabledCallbacks=e}},metadata:e},null,c),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}observer=(e(this,c),(t,e)=>this.observeChanges(t,e));set enabledCallbacks(t){this.data&&(t?this.data.observe(this.observer):this.data.unobserve(this.observer))}get(t){if(this.data&&"object"==typeof this.data)return this.data instanceof s?this.data.get(t.toString()):this.data instanceof n?this.data.get(fe(Number(t),this.data.length)):super.get(t)}set(t,e){if(this.data&&"object"==typeof this.data)if(this.data instanceof s)this.data.set(t.toString(),e);else if(this.data instanceof n){const s=fe(Number(t),this.data.length+1);s<this.data.length&&this.data.delete(s,1),this.data.insert(s,[e])}else super.set(t,e)}has(t){return!(!this.data||"object"!=typeof this.data)&&(this.data instanceof s?this.data.has(t.toString()):this.data instanceof n?"number"==typeof t&&t>=0&&t<this.size:super.has(t))}delete(t){this.data&&"object"==typeof this.data&&(this.data instanceof s?this.data.delete(t.toString()):this.data instanceof n&&"number"==typeof t&&t>=0&&t<this.size?this.data.delete(t,1):super.delete(t))}get keys(){if(this.data instanceof s)return Array.from(this.data.keys());if(this.data instanceof n){const t=[];for(let e=0;e<this.data.length;e++)t.push(e);return t}return super.keys}get size(){return this.data instanceof s?this.data.size:this.data instanceof n?this.data.length:0}initialize(){super.initialize(),this.enabledCallbacks&&this.data instanceof i&&this.data?.observe(this.observer)}clear(t=!0){t&&this.data?.unobserve(this.observer),super.clear(t)}observeChanges(t,e){if(t instanceof a)t.keysChanged.forEach(e=>{const s=t.changes.keys.get(e);s&&("delete"===s.action?this.keyChanged(e,void 0,!0):this.keyChanged(e))});else if(t instanceof r){let e=0;for(const s of t.delta)if(void 0!==s.retain)e+=s.retain;else if(s.insert){const t=(Array.isArray(s.insert)?s.insert:[s.insert]).length;this.shiftIndices(e,t);for(let s=0;s<t;s++)this.keyChanged(e+s);e+=t}else if(s.delete){const t=s.delete;for(let s=0;s<t;s++)this.keyChanged(e+s,void 0,!0);this.shiftIndices(e+t,-t)}}}shiftIndices(t,e){this.changeObservers?.toArray().forEach(s=>{const n=[];for(const[e,i]of s.instances.entries()){const s=Number(e);s>=t&&n.push([s,i])}n.sort((t,e)=>t[0]-e[0]);for(const[t]of n)s.instances.delete(t);for(const[t,i]of n){const n=t+e;"object"==typeof i&&"dataId"in i&&(i.dataId=n),s.instances.set(t+e,i)}})}}})();es(".turbo-drawer{align-items:center;direction:ltr;display:inline-flex}.turbo-drawer-panel-container{align-items:center;display:flex;overflow:hidden;position:relative}.turbo-drawer-thumb{display:inline-block;position:relative}.top-drawer .turbo-drawer-panel-container,.turbo-drawer.top-drawer{flex-direction:column}.bottom-drawer .turbo-drawer-panel-container,.turbo-drawer.bottom-drawer{flex-direction:column-reverse}.left-drawer .turbo-drawer-panel-container,.turbo-drawer.left-drawer{flex-direction:row}.right-drawer .turbo-drawer-panel-container,.turbo-drawer.right-drawer{flex-direction:row-reverse}");let Is=(()=>{let s,n,i,a,r,o,l,c,h,u,d,f,p,g=[Re("turbo-drawer")],b=[],y=ns,v=[],k=[],S=[];return class extends y{static{n=this}static{const E="function"==typeof Symbol&&Symbol.metadata?Object.create(y[Symbol.metadata]??null):void 0;i=[m({setIfUndefined:!0,callBefore:function(){this.thumb&&je(this).remChild(this.thumb)},preprocessValue:t=>t instanceof HTMLElement?t:D(t)})],a=[m({setIfUndefined:!0,callBefore:function(){this.panel&&je(this).remChild(this.panel)},preprocessValue:t=>t instanceof HTMLElement?t:D(t)})],r=[m({callBefore:function(){this.icon?.parentElement===this.thumb&&this.thumb.removeChild(this.icon)},preprocessValue:function(t){return t instanceof Element?t:("string"!=typeof t||this.attachSideToIconName||this.rotateIconBasedOnSide||(this.attachSideToIconName=!0),bs("object"==typeof t?t:{icon:t,switchReifect:{states:Object.values(Ee)},defaultState:this.open?this.getOppositeSide():this.side,appendStateToIconName:this.attachSideToIconName}))}})],o=[m({defaultValue:!1})],l=[m({defaultValue:!1})],c=[m({defaultValue:!1})],h=[m({defaultValue:Ee.bottom,cancelIfUnchanged:!1})],u=[m({defaultValue:{open:0,closed:0},preprocessValue:t=>"number"==typeof t?{open:t,closed:t}:{open:t?.open||0,closed:t?.closed||0}})],d=[m({defaultValue:!1})],f=[m()],p=[m({defaultValueCallback:function(){return new be({transitionProperties:["transform",this.isVertical?"height":"width"],transitionDuration:.2,transitionTimingFunction:"ease-out"})},callAfter:function(){this.transition.attachAll(this,this.panelContainer)}})],t(this,null,i,{kind:"setter",name:"thumb",static:!1,private:!1,access:{has:t=>"thumb"in t,set:(t,e)=>{t.thumb=e}},metadata:E},null,v),t(this,null,a,{kind:"setter",name:"panel",static:!1,private:!1,access:{has:t=>"panel"in t,set:(t,e)=>{t.panel=e}},metadata:E},null,v),t(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:t=>"icon"in t,set:(t,e)=>{t.icon=e}},metadata:E},null,v),t(this,null,o,{kind:"setter",name:"hideOverflow",static:!1,private:!1,access:{has:t=>"hideOverflow"in t,set:(t,e)=>{t.hideOverflow=e}},metadata:E},null,v),t(this,null,l,{kind:"setter",name:"attachSideToIconName",static:!1,private:!1,access:{has:t=>"attachSideToIconName"in t,set:(t,e)=>{t.attachSideToIconName=e}},metadata:E},null,v),t(this,null,c,{kind:"setter",name:"rotateIconBasedOnSide",static:!1,private:!1,access:{has:t=>"rotateIconBasedOnSide"in t,set:(t,e)=>{t.rotateIconBasedOnSide=e}},metadata:E},null,v),t(this,null,h,{kind:"setter",name:"side",static:!1,private:!1,access:{has:t=>"side"in t,set:(t,e)=>{t.side=e}},metadata:E},null,v),t(this,null,u,{kind:"setter",name:"offset",static:!1,private:!1,access:{has:t=>"offset"in t,set:(t,e)=>{t.offset=e}},metadata:E},null,v),t(this,null,d,{kind:"setter",name:"open",static:!1,private:!1,access:{has:t=>"open"in t,set:(t,e)=>{t.open=e}},metadata:E},null,v),t(this,null,f,{kind:"setter",name:"translation",static:!1,private:!1,access:{has:t=>"translation"in t,set:(t,e)=>{t.translation=e}},metadata:E},null,v),t(null,null,p,{kind:"field",name:"transition",static:!1,private:!1,access:{has:t=>"transition"in t,get:t=>t.transition,set:(t,e)=>{t.transition=e}},metadata:E},k,S),t(null,s={value:n},g,{kind:"class",name:n.name,metadata:E},null,b),n=s.value,E&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:E}),e(n,b)}_panelContainer=e(this,v);get panelContainer(){return this._panelContainer}dragging=!1;resizeObserver;set thumb(t){je(t).addClass("turbo-drawer-thumb"),this.initialized&&this.setupUILayout()}get thumb(){}set panel(t){je(t).addClass("turbo-drawer-panel"),this.initialized&&this.setupUILayout()}get panel(){}set icon(t){this.initialized&&this.setupUILayout()}get icon(){}set hideOverflow(t){je(this.panelContainer).setStyle("overflow",t?"hidden":"")}set attachSideToIconName(t){this.icon instanceof gs&&(this.icon.appendStateToIconName=t),t&&(this.rotateIconBasedOnSide=!1)}set rotateIconBasedOnSide(t){t&&(this.attachSideToIconName=!1),this.icon instanceof gs&&(this.icon.switchReifect.styles={top:"transform: rotate(180deg)",bottom:"transform: rotate(0deg)",left:"transform: rotate(90deg)",right:"transform: rotate(270deg)"})}set side(t){je(this).toggleClass("top-drawer",t==Ee.top).toggleClass("bottom-drawer",t==Ee.bottom).toggleClass("left-drawer",t==Ee.left).toggleClass("right-drawer",t==Ee.right),this.refresh()}set offset(t){}get offset(){}get isVertical(){return this.side==Ee.top||this.side==Ee.bottom}set open(t){t?this.resizeObserver?.observe(this.panel,{box:"border-box"}):this.resizeObserver?.unobserve(this.panel),this.refresh()}set translation(t){switch(this.side){case Ee.top:case Ee.bottom:this.hideOverflow?je(this.panelContainer).setStyle("height",t+"px"):je(this).setStyle("transform",`translateY(${-t}px)`);break;case Ee.left:case Ee.right:this.hideOverflow?je(this.panelContainer).setStyle("width",t+"px"):je(this).setStyle("transform",`translateX(${-t}px)`)}}transition=e(this,k,void 0);get translation(){}initialize(){super.initialize(),je(this).show(!1),this.enableTransition(!1),this.setupResizeObserver(),this.open=!1,requestAnimationFrame(()=>{je(this).show(!0),this.enableTransition(!0)})}setupUIElements(){super.setupUIElements(),this._panelContainer=D({classes:"turbo-drawer-panel-container"})}setupUILayout(){super.setupUILayout(),je(this).childHandler=this,je(this.panel).addChild(je(this).childrenArray.filter(t=>t!==this.panelContainer)),je(this).addChild([this.thumb,this.panelContainer]),je(this.panelContainer).addChild(this.panel),je(this.thumb).addChild(this.icon),je(this).childHandler=this.panel}setupUIListeners(){je(this.thumb).on(Ct.click,t=>(this.open=!this.open,!0)).on(wt.dragStart,t=>(this.dragging=!0,this.enableTransition(!1),!0)).on(wt.drag,t=>{if(this.dragging)return this.translation+=this.isVertical?t.scaledDeltaPosition.y:t.scaledDeltaPosition.x,!0}).on(wt.dragEnd,t=>{if(!this.dragging)return;this.dragging=!1;const e=t.positions.first.sub(t.origins.first);switch(this.side){case Ee.top:this.open&&e.y>100?this.open=!1:!this.open&&e.y<-100&&(this.open=!0);break;case Ee.bottom:this.open&&e.y<-100?this.open=!1:!this.open&&e.y>100&&(this.open=!0);break;case Ee.left:this.open&&e.x>100?this.open=!1:!this.open&&e.x<-100&&(this.open=!0);break;case Ee.right:this.open&&e.x<-100?this.open=!1:!this.open&&e.x>100&&(this.open=!0)}return this.enableTransition(!0),this.refresh(),!0})}getOppositeSide(t=this.side){switch(t){case Ee.top:return Ee.bottom;case Ee.bottom:return Ee.top;case Ee.left:return Ee.right;case Ee.right:return Ee.left}}getAdjacentSide(t=this.side){switch(t){case Ee.top:return Ee.right;case Ee.bottom:return Ee.left;case Ee.left:return Ee.top;case Ee.right:return Ee.bottom}}refresh(){this.hideOverflow&&je(this.panel).setStyle("position","absolute",!0),this.icon instanceof gs&&this.icon.switchReifect.apply(this.open?this.getOppositeSide():this.side),requestAnimationFrame(()=>{this.translation=(this.open?this.offset.open:this.offset.closed)+(this.open?this.isVertical?this.panel.offsetHeight:this.panel.offsetWidth:0),this.hideOverflow&&je(this.panel).setStyle("position","relative",!0)})}enableTransition(t){this.transition.enabled=t,this.transition.apply()}setupResizeObserver(){let t=0,e=!0;je(this).on("transitionstart",()=>t++).on("transitionend",()=>{t--,e=!1}),je(this.panelContainer).on("transitionstart",()=>t++).on("transitionend",()=>t--),this.resizeObserver=new ResizeObserver(s=>{if(!this.open||this.dragging||t>0||e)return;const n=(Array.isArray(s[0].borderBoxSize)?s[0].borderBoxSize[0]:s[0].borderBoxSize)[this.isVertical?"blockSize":"inlineSize"];this.translation=(this.open?this.offset.open:this.offset.closed)+n})}constructor(){super(...arguments),e(this,S)}},n})();function Bs(t){return t.tag||(t.tag="turbo-drawer"),O({...t,text:void 0})}var Ns;!function(t){t.invert="invert",t.offset="offset",t.none="none"}(Ns||(Ns={}));es("#turbo-popup-parent-element{display:block;left:0;position:fixed;top:0;z-index:1000}.turbo-popup{display:block;inset:auto;overflow:auto;position:fixed}");let Vs=(()=>{let s,n,i,a,r,o,l,c,h,u,d,f,p,g,b=[Re("turbo-popup")],y=[],v=ns,k=[],S=[],E=[],w=[],C=[];var O=class extends v{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(v[Symbol.metadata]??null):void 0;i=[m({defaultValue:D({parent:document.body,id:"turbo-popup-parent-element"})})],a=[m({defaultValue:document.body})],r=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupAnchor",{x:50,y:0})},preprocessValue:t=>new Yt(t).bound(0,100)})],o=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultAnchorPosition",{x:50,y:100})},preprocessValue:t=>new Yt(t).bound(0,100)})],l=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultViewportMargin",0)},preprocessValue:t=>new Yt(t)})],c=[m({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultOffsetFromAnchor",0)},preprocessValue:t=>new Yt(t)})],h=[m({preprocessValue:t=>"object"!=typeof t?{x:t,y:t}:t,initialValueCallback:function(){return{x:Math.abs(this.anchorPosition.x-50)>25?Ns.invert:Ns.offset,y:Math.abs(this.anchorPosition.y-50)>25?Ns.invert:Ns.offset}}})],u=[_e({clearOnNextFrame:!0})],d=[_e({clearOnNextFrame:!0})],f=[_e({clearOnNextFrame:!0})],p=[_e({clearOnNextFrame:!0})],g=[_e({clearOnNextFrame:!0})],t(this,null,r,{kind:"setter",name:"popupPosition",static:!1,private:!1,access:{has:t=>"popupPosition"in t,set:(t,e)=>{t.popupPosition=e}},metadata:e},null,k),t(this,null,o,{kind:"setter",name:"anchorPosition",static:!1,private:!1,access:{has:t=>"anchorPosition"in t,set:(t,e)=>{t.anchorPosition=e}},metadata:e},null,k),t(this,null,l,{kind:"setter",name:"viewportMargin",static:!1,private:!1,access:{has:t=>"viewportMargin"in t,set:(t,e)=>{t.viewportMargin=e}},metadata:e},null,k),t(this,null,c,{kind:"setter",name:"offsetFromAnchor",static:!1,private:!1,access:{has:t=>"offsetFromAnchor"in t,set:(t,e)=>{t.offsetFromAnchor=e}},metadata:e},null,k),t(this,null,h,{kind:"setter",name:"fallbackModes",static:!1,private:!1,access:{has:t=>"fallbackModes"in t,set:(t,e)=>{t.fallbackModes=e}},metadata:e},null,k),t(this,null,u,{kind:"getter",name:"rect",static:!1,private:!1,access:{has:t=>"rect"in t,get:t=>t.rect},metadata:e},null,k),t(this,null,d,{kind:"getter",name:"anchorRect",static:!1,private:!1,access:{has:t=>"anchorRect"in t,get:t=>t.anchorRect},metadata:e},null,k),t(this,null,f,{kind:"getter",name:"computedStyle",static:!1,private:!1,access:{has:t=>"computedStyle"in t,get:t=>t.computedStyle},metadata:e},null,k),t(this,null,p,{kind:"getter",name:"anchorComputedStyle",static:!1,private:!1,access:{has:t=>"anchorComputedStyle"in t,get:t=>t.anchorComputedStyle},metadata:e},null,k),t(this,null,g,{kind:"getter",name:"computedMargins",static:!1,private:!1,access:{has:t=>"computedMargins"in t,get:t=>t.computedMargins},metadata:e},null,k),t(null,null,i,{kind:"field",name:"parentElement",static:!0,private:!1,access:{has:t=>"parentElement"in t,get:t=>t.parentElement,set:(t,e)=>{t.parentElement=e}},metadata:e},S,E),t(null,null,a,{kind:"field",name:"anchor",static:!1,private:!1,access:{has:t=>"anchor"in t,get:t=>t.anchor,set:(t,e)=>{t.anchor=e}},metadata:e},w,C),t(null,s={value:n},b,{kind:"class",name:n.name,metadata:e},null,y),O=n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ns.config,defaultPopupPosition:{x:0,y:-100},defaultAnchorPosition:{x:0,y:100},defaultViewportMargin:4,defaultOffsetFromAnchor:{x:0,y:4}};static parentElement=e(n,S,void 0);anchor=(e(this,k),e(this,w,void 0));set popupPosition(t){}get popupPosition(){}set anchorPosition(t){}get anchorPosition(){}set viewportMargin(t){}get viewportMargin(){}set offsetFromAnchor(t){}get offsetFromAnchor(){}set fallbackModes(t){}get fallbackModes(){}get rect(){return this.getBoundingClientRect()}get anchorRect(){return this.anchor.getBoundingClientRect()}get computedStyle(){return window.getComputedStyle(this)}get anchorComputedStyle(){return window.getComputedStyle(this.anchor)}get computedMargins(){return{x:parseFloat(this.computedStyle.marginLeft)+parseFloat(this.computedStyle.marginRight),y:parseFloat(this.computedStyle.marginTop)+parseFloat(this.computedStyle.marginBottom)}}initialize(){super.initialize(),this.show(!1),this.parentElement||je(this).addToParent(O.parentElement)}setupUIListeners(){super.setupUIListeners(),document.addEventListener(Ct.scroll,()=>this.show(!1),{capture:!0,passive:!0}),window.addEventListener(Ct.resize,()=>{je(this).isShown&&this.recomputePosition()},{passive:!0}),je(document.body).on(Ct.click,t=>{if(!je(this).isShown)return;const e=t.target;this.contains(e)||this.anchor instanceof Node&&this.anchor.contains(e)||this.show(!1)},{capture:!0})}recomputePosition(){if(!this.anchor)return;je(this).setStyles({maxHeight:"",maxWidth:""},!0);const t=this.computeAxis(ve.horizontal),e=this.computeAxis(ve.vertical);je(this).setStyles({left:`${t}px`,top:`${e}px`});const s=Math.max(0,Math.min(window.innerWidth-2*this.viewportMargin.x,window.innerWidth-2*this.viewportMargin.x-this.computedMargins.x)),n=Math.max(0,Math.min(window.innerHeight-2*this.viewportMargin.y,window.innerHeight-2*this.viewportMargin.y-this.computedMargins.y));je(this).setStyle("maxWidth",`${s}px`),je(this).setStyle("maxHeight",`${n}px`)}computeAxis(t){const e=t===ve.horizontal?"x":"y",s=t===ve.horizontal?"width":"height",n=t===ve.horizontal?window.innerWidth:window.innerHeight,i=this.anchorRect[t===ve.horizontal?"left":"top"],a=this.rect[s]+this.computedMargins[e],r=this.viewportMargin[e],o=n-this.viewportMargin[e]-a,l=i+this.anchorRect[s]*this.anchorPosition[e]/100-a*this.popupPosition[e]/100+this.offsetFromAnchor[e],c=l>=r&&l<=o;if(c||this.fallbackModes[e]===Ns.offset)return Math.min(Math.max(l,r),o);const h=i+this.anchorRect[s]*(1-this.anchorPosition[e]/100)-a*(1-this.popupPosition[e]/100)-this.offsetFromAnchor[e];let u;if(h>=r&&h<=o)u=h;else if(c)u=l;else{const t=Math.abs(l-Math.min(Math.max(l,r),o))<=Math.abs(h-Math.min(Math.max(h,r),o))?l:h;u=Math.min(Math.max(t,r),o)}return u}show(t){return t?(this.style.visibility="hidden",this.style.display="",this.recomputePosition(),this.style.visibility="",je(this).show(!0)):je(this).setStyles({maxHeight:"",maxWidth:""},!0).show(!1),this}constructor(){super(...arguments),e(this,C)}static{e(n,E),e(n,y)}};return O=n})();function _s(t={}){return O({...t,text:void 0,tag:"turbo-popup"})}es("turbo-dropdown{display:inline-block;position:relative}turbo-dropdown>.turbo-popup{background-color:#fff;border:.1em solid #5e5e5e;border-radius:.4em;display:flex;flex-direction:column;overflow:hidden}turbo-dropdown>.turbo-popup>turbo-select-entry{padding:.5em}turbo-dropdown>.turbo-popup>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}turbo-dropdown>turbo-select-entry{padding:.5em .7em;width:100%}turbo-dropdown>turbo-select-entry:hover{background-color:#d7d7d7}turbo-dropdown>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}");let zs=(()=>{let s,n,i,a,r,o,l,c,h,u=[Re("turbo-dropdown")],d=[],f=ns,p=[],g=[],b=[],y=[],v=[],k=[],S=[],E=[],w=[],C=[],O=[];return class extends f{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(f[Symbol.metadata]??null):void 0;i=[m({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorTag")}})],a=[m({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorClasses")},callBefore:function(){je(this.selector).removeClass(this.selectorClasses)},callAfter:function(){je(this.selector).addClass(this.selectorClasses)}})],r=[m({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupClasses")},callBefore:function(){je(this.popup).removeClass(this.popupClasses)},callAfter:function(){je(this.popup).addClass(this.popupClasses)}})],o=[We("select")],l=[We("select")],c=[m({setIfUndefined:!0,preprocessValue:function(t){if(t instanceof HTMLElement)return t;const e="string"==typeof t?t:Ot(this.select.getValue(this.entries[0]));if(!(this.selector instanceof ps))return ms({text:e,elementTag:this.selectorTag});this.selector.text=e}})],h=[m({defaultValueCallback:()=>_s()})],t(this,null,c,{kind:"setter",name:"selector",static:!1,private:!1,access:{has:t=>"selector"in t,set:(t,e)=>{t.selector=e}},metadata:e},null,p),t(this,null,h,{kind:"setter",name:"popup",static:!1,private:!1,access:{has:t=>"popup"in t,set:(t,e)=>{t.popup=e}},metadata:e},null,p),t(null,null,i,{kind:"field",name:"selectorTag",static:!1,private:!1,access:{has:t=>"selectorTag"in t,get:t=>t.selectorTag,set:(t,e)=>{t.selectorTag=e}},metadata:e},g,b),t(null,null,a,{kind:"field",name:"selectorClasses",static:!1,private:!1,access:{has:t=>"selectorClasses"in t,get:t=>t.selectorClasses,set:(t,e)=>{t.selectorClasses=e}},metadata:e},y,v),t(null,null,r,{kind:"field",name:"popupClasses",static:!1,private:!1,access:{has:t=>"popupClasses"in t,get:t=>t.popupClasses,set:(t,e)=>{t.popupClasses=e}},metadata:e},k,S),t(null,null,o,{kind:"field",name:"entries",static:!1,private:!1,access:{has:t=>"entries"in t,get:t=>t.entries,set:(t,e)=>{t.entries=e}},metadata:e},E,w),t(null,null,l,{kind:"field",name:"values",static:!1,private:!1,access:{has:t=>"values"in t,get:t=>t.values,set:(t,e)=>{t.values=e}},metadata:e},C,O),t(null,s={value:n},u,{kind:"class",name:n.name,metadata:e},null,d),n=s.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static config={...ns.config,defaultSelectorTag:"h4"};select=(e(this,p),new Ms({onEntryAdded:t=>this.onEntryAdded(t)}));popupOpen=!1;selectorTag=e(this,g,void 0);selectorClasses=(e(this,b),e(this,y,void 0));popupClasses=(e(this,v),e(this,k,void 0));entries=(e(this,S),e(this,E,void 0));values=(e(this,w),e(this,C,void 0));onEntryAdded(t){this.select.initializeSelection(),je(t).on(Ct.click,()=>(this.select.select(t,!this.select.isSelected(t)),this.openPopup(!1),!0))}set selector(t){t instanceof HTMLElement&&(je(t).addClass(this.selectorClasses).on(Ct.click,t=>(this.openPopup(!this.popupOpen),!0)),this.popup instanceof Vs&&(this.popup.anchor=t),je(this).addChild(t),t instanceof ps&&(this.select.onSelect=()=>t.text=this.stringSelectedValue))}get selector(){}set popup(t){t instanceof Vs&&(t.anchor=this.selector),je(t).addClass(this.popupClasses),this.select.parent=t}initialize(){super.initialize(),this.selector,je(document.body).on(Ct.click,()=>t=>{this.popupOpen&&!this.contains(t.target)&&this.openPopup(!1)},{capture:!0})}openPopup(t){this.popupOpen!=t&&(this.popupOpen=t,"show"in this.popup&&"function"==typeof this.popup.show?this.popup.show(t):je(this.popup).show(t))}get selectedValues(){return this.select.selectedValues}get selectedValue(){return this.select.selectedValue}get selectedSecondaryValues(){return this.select.selectedSecondaryValues}get selectedSecondaryValue(){return this.select.selectedSecondaryValue}get stringSelectedValue(){return this.select.stringSelectedValue}constructor(){super(...arguments),e(this,O)}static{e(n,d)}},n})();function Fs(t={}){return t.tag||(t.tag="turbo-dropdown"),O({...t,text:void 0})}let Ls=(()=>{let s,n,i,a,r=[Re("turbo-marking-menu")],o=[],l=ns,c=[],h=[],u=[],d=[];return class extends l{static{n=this}static{const f="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;i=[m({initialValue:0,preprocessValue:t=>t-Math.PI/2})],a=[m({initialValue:2*Math.PI,preprocessValue:t=>t-Math.PI/2})],t(null,null,i,{kind:"field",name:"startAngle",static:!1,private:!1,access:{has:t=>"startAngle"in t,get:t=>t.startAngle,set:(t,e)=>{t.startAngle=e}},metadata:f},c,h),t(null,null,a,{kind:"field",name:"endAngle",static:!1,private:!1,access:{has:t=>"endAngle"in t,get:t=>t.endAngle,set:(t,e)=>{t.endAngle=e}},metadata:f},u,d),t(null,s={value:n},r,{kind:"class",name:n.name,metadata:f},null,o),n=s.value,f&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f}),e(n,o)}transition;currentOrigin;minDragDistance=20;semiMajor=50;semiMinor=45;startAngle=e(this,c,void 0);endAngle=(e(this,h),e(this,u,void 0));constructor(){super(...arguments),e(this,d)}},n})(),Rs=(()=>{let s,n,i,a,r=[Re("turbo-select-wheel")],o=[],l=ns,c=[];return class extends l{static{n=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;i=[m()],a=[m()],t(this,null,i,{kind:"setter",name:"alwaysOpen",static:!1,private:!1,access:{has:t=>"alwaysOpen"in t,set:(t,e)=>{t.alwaysOpen=e}},metadata:h},null,c),t(this,null,a,{kind:"setter",name:"open",static:!1,private:!1,access:{has:t=>"open"in t,set:(t,e)=>{t.open=e}},metadata:h},null,c),t(null,s={value:n},r,{kind:"class",name:n.name,metadata:h},null,o),n=s.value,h&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),e(n,o)}_currentPosition=(e(this,c),0);_reifect;_size={max:100,min:-100};sizePerEntry=[];positionPerEntry=[];totalSize=0;dragLimitOffset=30;openTimeout=3e3;direction=ve.horizontal;scale={max:1,min:.5};generateCustomStyling;dragging;openTimer;set alwaysOpen(t){t?Ne(document).removeListener(Ct.click,this.closeOnClick):Ne(document).on(Ct.click,this.closeOnClick),this.open=t}closeOnClick=()=>this.open=!1;get isVertical(){return this.direction==ve.vertical}set open(t){Ne(this).setStyle("overflow",t?"visible":"hidden")}get currentPosition(){return this._currentPosition}computeDragValue(t){return-t[this.isVertical?"y":"x"]}clearOpenTimer(){this.openTimer&&clearTimeout(this.openTimer)}setOpenTimer(){this.clearOpenTimer(),"number"!=typeof this.openTimeout||this.openTimeout<0||(this.openTimer=setTimeout(()=>this.open=!1,this.openTimeout))}},n})();class Ws{static config={shadowDOM:!1,defaultSelectedClass:"selected"};static configure(t){Object.entries(t).forEach(([t,e])=>{void 0!==e&&(this.config[t]=e)})}element;mvc=new G({element:this});constructor(t={}){this.element=T(t)}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}async function Ks(t){const e=(new TextEncoder).encode(t),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map(t=>t.toString(16).padStart(2,"0")).join("")}async function Hs(t,e=12){const s=Math.ceil(6*e/8),n=new TextEncoder,i=await crypto.subtle.digest("SHA-256",n.encode(t)),a=new Uint8Array(i).slice(0,s);return("function"==typeof btoa?btoa(String.fromCharCode(...a)):Buffer.from(a).toString("base64")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"").slice(0,e)}function Us(t,e,s,n,i,a=!0){if(a){const n=Math.max(e,s),i=Math.min(e,s);t>n&&(t=n),t<i&&(t=i)}return n+(t-e)*(i-n)/(s-e)}function $s(t){const e=new s;for(const[s,n]of Object.entries(t))e.set(s,n);return e}function Gs(t){const e=new n;return e.push(t),e}async function qs(t,e,s){const n=async()=>await Hs(e?.doc?.clientID?.toString(32)+ks());if(!s)for(s=await n();void 0!==e?.get(s);)s=await n();return e.set(s,t),s}function Ys(t,e,s){return null==s||s>e.length?(s=e.length,e.push([t])):(s<0&&(s=0),e.insert(s,[t])),s}function Js(t,e){for(const[s,n]of e.toArray())if(t==n)return e.delete(s),!0;return!1}function Xs(t,e,...n){if(!t)return;const i=new Set(n);t.observeDeep(t=>{for(const n of t){const t=n.target,o=t._item?.parent,l=t._item?.parentSub;for(const c of i)if(n instanceof a&&n.changes.keys.has(c)||n instanceof r&&o instanceof s&&l===c||n.path?.some(t=>t===c))return void e(c,n,t)}})}function Qs(t,e,...n){if(!t)return;const i=new Set(n);t.observeDeep(t=>{const n=new Set;for(const o of t){const t=o.target,l=t._item?.parent,c=t._item?.parentSub;for(const t of i)(o instanceof a&&o.changes.keys.has(t)||o instanceof r&&l instanceof s&&c===t||o.path?.some(e=>e===t))&&n.add(t);if(n.size===i.size)return void e(o,t)}})}function Zs(t){return t instanceof Ht?t.scaledPosition:t instanceof PointerEvent?new Yt(t.clientX,t.clientY):void 0}function tn(t){if(!t)return NaN;const e=parseInt(t.substring(1),16);return.2126*((e>>16&255)/255)+.7152*((e>>8&255)/255)+.0722*((255&e)/255)}function en(t,e){if(!t||!e)return NaN;const s=tn(t),n=tn(e);return(Math.max(s,n)+.1)/(Math.min(s,n)+.1)}function sn(t,e="#000000",s="#FFFFFF"){return en(t,s)>en(e,t)?s:e}function nn(t,...e){let s="";return t.forEach((t,n)=>{s+=t+(e[n]||"")}),s}ne(Ws),se(Ws),ss(Ws);const an={900:{Black:"normal",BlackItalic:"italic"},800:{ExtraBold:"normal",ExtraBoldItalic:"italic"},700:{Bold:"normal",BoldItalic:"italic"},600:{SemiBold:"normal",SemiBoldItalic:"italic"},500:{Medium:"normal",MediumItalic:"italic"},400:{Regular:"normal",Italic:"italic"},300:{Light:"normal",LightItalic:"italic"},200:{ExtraLight:"normal",ExtraLightItalic:"italic"},100:{Thin:"normal",ThinItalic:"italic"}};function rn(t,e,s,n,i){return nn`
        @font-face {
            font-family: "${t}";
            src: url("${e}") format("${s}"), 
            url("${e}") format("woff"),
            url("${e}") format("truetype");
            font-weight: ${"string"==typeof n?'"'+n+'"':n};
            font-style: "${i}";
        }`}function on(t){t.name&&t.pathOrDirectory||console.error("Please specify font name and path/directory");const e=0==Pt(t.pathOrDirectory).length;t.stylesPerWeights||(t.stylesPerWeights=e?an:{normal:"normal"}),t.format||(t.format="woff2"),t.extension||(t.extension=".ttf"),"."!=t.extension[0]&&(t.extension="."+t.extension),U(Object.entries(t.stylesPerWeights).map(([e,s])=>{const n=Number.parseInt(e),i=n||e;return"string"==typeof s?rn(t.name,t.pathOrDirectory,t.format,i,s):Object.entries(s).map(([e,s])=>rn(t.name,`${t.pathOrDirectory}/${t.name}-${e}${t.extension}`,t.format,i,s)).join("\n")}).join("\n"))}export{Ne as $,Pe as AccessLevel,jt as ActionMode,y as ApplyDefaultsMergeProperties,At as BasicInputEvents,It as ClickMode,Kt as ClosestOrigin,gt as DefaultClickEventName,kt as DefaultDragEventName,Ct as DefaultEventName,pt as DefaultKeyEventName,yt as DefaultMoveEventName,Et as DefaultWheelEventName,ht as Delegate,ve as Direction,we as InOut,Bt as InputDevice,E as MathMLNamespace,w as MathMLTags,G as Mvc,Mt as NonPassiveEvents,Ce as OnOff,Oe as Open,Yt as Point,Ns as PopupFallbackMode,xe as Range,be as Reifect,Te as Shown,Ee as Side,ke as SideH,Se as SideV,me as StatefulReifect,k as SvgNamespace,S as SvgTags,As as TurboBaseElement,ps as TurboButton,mt as TurboClickEventName,$t as TurboController,ut as TurboDataBlock,Xt as TurboDragEvent,vt as TurboDragEventName,Is as TurboDrawer,zs as TurboDropdown,ns as TurboElement,$ as TurboEmitter,Ht as TurboEvent,ae as TurboEventManager,wt as TurboEventName,te as TurboHandler,ie as TurboHeadlessElement,hs as TurboIcon,gs as TurboIconSwitch,ys as TurboIconToggle,Os as TurboInput,Qe as TurboInteractor,Ut as TurboKeyEvent,ft as TurboKeyEventName,Rt as TurboMap,Ls as TurboMarkingMenu,dt as TurboModel,bt as TurboMoveEventName,Ps as TurboNumericalInput,Vs as TurboPopup,Ws as TurboProxiedElement,ds as TurboRichElement,Ms as TurboSelect,Ds as TurboSelectInputEvent,Rs as TurboSelectWheel,g as TurboSelector,Ze as TurboSubstrate,ts as TurboTool,Xe as TurboView,lt as TurboWeakSet,qt as TurboWheelEvent,St as TurboWheelEventName,js as TurboYBlock,P as a,Ys as addInYArray,qs as addInYMap,is as areEqual,m as auto,sn as bestOverlayColor,T as blindElement,tt as blockIdSignal,Z as blockSignal,ms as button,_e as cache,ue as callOnce,de as callOncePerInstance,xt as camelToKebabCase,x as canvas,ze as clearCache,Fe as clearCacheEntry,en as contrast,Vt as controller,ls as createProxy,Gs as createYArray,$s as createYMap,nn as css,Qs as deepObserveAll,Xs as deepObserveAny,Re as define,rt as disposeEffect,ot as disposeEffects,D as div,Bs as drawer,Fs as dropdown,rs as eachEqualToAny,et as effect,O as element,as as equalToAny,We as expose,cs as fetchSvg,$e as flexCol,Ge as flexColCenter,qe as flexRow,Ye as flexRowCenter,A as form,C as generateTagFunction,Zs as getEventPosition,Pt as getFileExtension,c as getFirstDescriptorInChain,u as getFirstPrototypeInChainWith,st as getSignal,f as getSuperDescriptor,d as getSuperMethod,M as h1,j as h2,I as h3,B as h4,N as h5,V as h6,_t as handler,h as hasPropertyInChain,Hs as hashBySize,Ks as hashString,us as icon,bs as iconSwitch,vs as iconToggle,_ as img,at as initializeEffects,z as input,zt as interactor,o as isNull,l as isUndefined,Dt as kebabToCamelCase,Us as linearInterpolation,F as link,on as loadLocalFont,tn as luminance,it as markDirty,pe as mod,Q as modelSignal,xs as numericalInput,He as observe,L as p,Tt as parse,_s as popup,Es as randomColor,Ss as randomFromRange,ks as randomId,ws as randomString,ye as reifect,Js as removeFromYArray,fs as richElement,nt as setSignal,X as signal,Ue as solver,Je as spacer,R as span,ge as statefulReifier,Ot as stringify,W as style,U as stylesheet,Lt as substrate,Be as t,os as textToElement,K as textarea,Ft as tool,fe as trim,Ie as tu,je as turbo,Ts as turboInput,Ve as turbofy,H as video};
