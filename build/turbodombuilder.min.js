var Turbo=function(e,t,i){"use strict";function n(e,t){let i=e;for(;i&&i!==HTMLElement.prototype;){const e=Object.getOwnPropertyDescriptor(i,t);if(e)return e;i=Object.getPrototypeOf(i)}}function s(e,t){let i=Object.getPrototypeOf(e);for(;i&&i!==HTMLElement.prototype;){if(Object.getOwnPropertyDescriptor(i,t))return i;i=Object.getPrototypeOf(i)}}function a(e,t,i){let n=Object.getPrototypeOf(e);for(;n&&n!==HTMLElement.prototype;){const e=Object.getOwnPropertyDescriptor(n,t),s=e?.value??e?.get??e?.set;if("function"==typeof s&&s!==i)return s;n=Object.getPrototypeOf(n)}}function r(e){return null==e&&null!=e}function o(e){return void 0===e}const l=new class{constructorMap=new WeakMap;constructorData(e){let t=this.constructorMap.get(e);return t||(t={installed:new Map},this.constructorMap.set(e,t)),t}};function c(e){return function(t,i){e||(e={});const{kind:a,name:r,static:c}=i,h=r,u=Symbol(`__auto_${h}`);i.addInitializer(function(){const i=c?this:s(this,h);let r,d;const p=function(t){e.callBefore?.call(this,t);let i=e?.preprocessValue?e.preprocessValue.call(this,t):t;(e.cancelIfUnchanged??1)&&this[u]===i||(e.executeSetterBeforeStoring&&d&&d.call(this,i),this[u]=i,!e.executeSetterBeforeStoring&&d&&d.call(this,i),e.callAfter?.call(this,i))};let f=!1;const m=function(){return r&&e?.returnDefinedGetterValue?r.call(this):this[u]},g=function(){let t=m.call(this);if(!f&&!e.returnDefinedGetterValue&&o(t)){if(f=!0,e.defaultValue)t=e.defaultValue;else if(e.defaultValueCallback)t=e.defaultValueCallback.call(this);else if(!e.setIfUndefined)return t;p.call(this,t),t=m.call(this),f=!1}return t};if(o(this[u])){let i="field"===a?t:void 0;o(i)&&(e.initialValue?i=e.initialValue:e.initialValueCallback&&(i=e.initialValueCallback.call(this))),!o(i)&&e.preprocessValue&&(i=e.preprocessValue.call(this,i)),this[u]=i}if("field"===a||"accessor"===a){const e=t;e?.get&&(r=e.get),e?.set&&(d=e.set);const i=n(this,h);Object.defineProperty(this,h,{configurable:!0,enumerable:i?.enumerable??!0,get:()=>g.call(this),set:e=>p.call(this,e)})}else if("getter"===a||"setter"===a){const e=l.constructorData(i).installed;if(e.get(h))return;e.set(h,!0);const t=n(i,h)??{};"function"==typeof t.get&&(r=t.get),"function"==typeof t.set&&(d=t.set),Object.defineProperty(i,h,{configurable:!0,enumerable:!!t?.enumerable,get:function(){return g.call(this)},set:function(e){p.call(this,e)}})}})}}class h{element;#e(){return new Proxy(this,{get(e,t,i){if(t in e)return Reflect.get(e,t,i);const n=e.element?.[t];return"function"==typeof n?n.bind(e.element):n},set:(e,t,i,n)=>t in e?Reflect.set(e,t,i,n):(e.element[t]=i,!0),has:(e,t)=>t in e||t in e.element,ownKeys:e=>Array.from([...Reflect.ownKeys(e),...Reflect.ownKeys(e.element)]),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e,t)||Object.getOwnPropertyDescriptor(e.element,t)||void 0})}constructor(){return this.#e()}}const u=new class{dataMap=new WeakMap;data(e){return e instanceof h&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}};function d(){Object.defineProperty(h.prototype,"childHandler",{set:function(e){e instanceof h&&(e=e.element),u.data(this).childHandler=e},get:function(){const e=u.data(this).childHandler;return e||(this.element instanceof Element&&this.element.shadowRoot?this.element.shadowRoot:this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(h.prototype,"childNodesArray",{get:function(){return this.element&&Array.from(this.childHandler?.childNodes)||[]},configurable:!1,enumerable:!0}),Object.defineProperty(h.prototype,"childrenArray",{get:function(){return this.childNodesArray.filter(e=>1===e.nodeType)},configurable:!1,enumerable:!0}),Object.defineProperty(h.prototype,"siblingNodes",{get:function(){const e=this.element?.parentNode;return e&&ct(e).childNodesArray||[]},configurable:!1,enumerable:!0}),Object.defineProperty(h.prototype,"siblings",{get:function(){const e=this.element?.parentElement;return e&&ct(e).childrenArray||[]},configurable:!1,enumerable:!0}),h.prototype.bringToFront=function(){const e=this.element?.parentNode;return e?(ct(e).addChild(this.element),this):this},h.prototype.sendToBack=function(){const e=this.element?.parentNode;return e?(ct(e).addChild(this.element,0),this):this},h.prototype.remove=function(){return this.element?.parentNode?.removeChild(this.element),this},h.prototype.addChild=function(e,t,i=this.childrenArray){if(!this.element||!e)return this;if(void 0!==t&&(t<0||t>i.length)&&(t=void 0),null!=t)this.addChildBefore(e,i[t]);else try{Array.isArray(e)||(e=[e]),e.forEach(e=>{e&&(e instanceof h&&(e=e.element),this.childHandler.appendChild(e))})}catch(e){console.error(e)}return this},h.prototype.remChild=function(e){if(!this.element||!e)return this;try{Array.isArray(e)||(e=[e]),e.forEach(e=>{e&&(e instanceof h&&(e=e.element),this.childHandler.removeChild(e))})}catch(e){console.error(e)}return this},h.prototype.addChildBefore=function(e,t){if(!this.element||!e)return this;if(!t)return this.addChild(e);try{Array.isArray(e)||(e=[e]),e.forEach(e=>{e&&(e instanceof h&&(e=e.element),this.childHandler.insertBefore(e,t))})}catch(e){console.error(e)}return this},h.prototype.removeChildAt=function(e,t=1,i=this.childrenArray){if(!this.element||void 0===e||e<0)return this;if(e>=i.length)return this;try{for(let n=e+t-1;n>=e;n--)n>=i.length||this.removeChild(i[n])}catch(e){console.error(e)}return this},h.prototype.removeAllChildren=function(e=this.childrenArray){if(!this.element)return this;try{for(let t=0;t<e.length;t++)this.removeChild(e[t])}catch(e){console.error(e)}return this},h.prototype.childAt=function(e,t=this.childrenArray){if(!this.element||void 0===e)return null;for(e>=t.length&&(e=t.length-1);e<0;)e+=t.length;return t[e]},h.prototype.indexOfChild=function(e,t=this.childrenArray){return this.element&&e?(t instanceof Array||(t=Array.from(t)),t.indexOf(e)):-1},h.prototype.hasChild=function(e){if(!this.element||!e)return!1;const t=Array.from(this.element?.childNodes);if(e instanceof Node)return t.includes(e);for(const i of e)if(!t.includes(i))return!1;return!0},h.prototype.closest=function(e){if(!(this.element&&e&&this.element instanceof Element))return null;if("string"==typeof e)return this.element.closest(e);if("function"==typeof e){let t=this.element;for(;t&&!(t instanceof e);)t=t.parentElement;return t||null}return null},h.prototype.findInParents=function(e){if(!e||!this.element)return!1;e instanceof Node&&(e=[e]);let t=this.element,i=0;for(;t&&i<e.length;)e.includes(t)&&i++,t=t.parentNode;return i===e.length},h.prototype.findInSubTree=function(e){if(!e||!this.element)return!1;e instanceof Node&&(e=[e]);let t=0;const i=n=>{e.includes(n)&&t++,t>=e.length||n.childNodes.forEach(e=>i(e))};return i(this.element),t>=e.length},h.prototype.indexInParent=function(e=this.siblings){return e&&this.element?e.indexOf(this.element):-1},h.prototype.addToParent=function(e,t,i){return this.element&&e?(ct(e).addChild(this.element,t,i),this):this}}const p=["interactors","tools","substrates","controllers","handlers"];function f(){h.prototype.execute=function(e){return e(this),this},h.prototype.applyDefaults=function(e,t={}){if(!this.element||"object"!=typeof this.element)return this;const{mergeProperties:i=p,removeDuplicates:n=!0}=t;for(const[t,s]of Object.entries(e)){const e=i?.includes(t);if(e){const e=Array.isArray(s)?s:[s];let i=(o(this.element[t])?[]:Array.isArray(this.element[t])?this.element[t].slice():[this.element[t]]).concat(e);n&&(i=Array.from(new Set(i))),this.element[t]=i}else o(this.element[t])&&(this.element[t]=s)}return this}}const m=new class{operateOnClasses(e,t,i=()=>{}){if(!e||!t||!e.element)return e;try{"string"==typeof t&&(t=t.split(" ")),t.filter(e=>e.trim().length>0).forEach(e=>i(e))}catch(e){console.error(e)}return e}};function g(){h.prototype.addClass=function(e){return this.element instanceof Element?m.operateOnClasses(this,e,e=>this.element.classList.add(e)):this},h.prototype.removeClass=function(e){return this.element instanceof Element?m.operateOnClasses(this,e,e=>this.element.classList.remove(e)):this},h.prototype.toggleClass=function(e,t){return this.element instanceof Element?m.operateOnClasses(this,e,e=>this.element.classList.toggle(e,t)):this},h.prototype.hasClass=function(e){if(!(e&&this.element instanceof Element))return!1;if("string"==typeof e)return this.element.classList.contains(e);for(let t of e)if(!this.element.classList.contains(t))return!1;return!0}}const b="http://www.w3.org/2000/svg",y="http://www.w3.org/1998/Math/MathML",v=new Set(["a","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tspan","use","view"]),k=new Set(["annotation","annotation-xml","maction","math","merror","mfrac","mi","mmultiscripts","mn","mo","mover","mpadded","mphantom","mprescripts","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]);function E(e){return v.has(e)||e?.startsWith("svg")}function S(e){return k.has(e)||e?.startsWith("math")}function _(e={}){let t;return t=e.namespace?"svg"==e.namespace?document.createElementNS(b,e.tag||"svg"):"mathML"==e.namespace?document.createElementNS(y,e.tag||"math"):document.createElementNS(e.namespace,e.tag||"div"):document.createElement(e.tag||"div"),e.shadowDOM&&t.attachShadow({mode:"open"}),ct(t).setProperties(e),t}function w(e={}){let t;return t=E(e.tag)?document.createElementNS(b,e.tag||"svg"):S(e.tag)?document.createElementNS(y,e.tag||"math"):document.createElement(e.tag||"div"),e.shadowDOM&&t.attachShadow({mode:"open"}),ct(t).setProperties(e),t}function C(e={}){return _({...e,tag:"div"})}function D(e={}){return _({...e,tag:"img"})}function T(e={}){return _({...e,tag:"input"})}function O(e={}){return _({...e,tag:"style"})}function P(e,t=document.head){if(!e)return;const i=O({innerHTML:e});ct(t).addChild(i)}class M{callbacks=new Map;model;constructor(e){e&&(this.model=e)}get defaultBlockKey(){return this.model?this.model.defaultBlockKey:"__defaultBlockKey__"}getBlock(e){return this.callbacks.get(e?.toString())}getOrGenerateBlock(e){return this.callbacks.has(e.toString())||this.callbacks.set(e.toString(),new Map),this.callbacks.get(e.toString())}getKey(e,t){const i=this.getBlock(t);return i?i.get(e):[]}getOrGenerateKey(e,t){const i=this.getOrGenerateBlock(t);return i.has(e)||i.set(e,[]),i.get(e)}addWithBlock(e,t,i){this.getOrGenerateKey(e,t).push(i)}add(e,t){this.addWithBlock(e,this.defaultBlockKey,t)}removeWithBlock(e,t,i){if(null==i)this.getBlock(t)?.delete(e);else{const n=this.getKey(e,t),s=n.indexOf(i);s>=0&&n.splice(s,1)}}remove(e,t){this.removeWithBlock(e,this.defaultBlockKey,t)}fireWithBlock(e,t,...i){this.callbacks.get(t.toString())?.get(e)?.forEach(e=>{e&&"function"==typeof e&&e(...i)})}fire(e,...t){this.fireWithBlock(e,this.defaultBlockKey,...t)}}class I{element;_view;_model;_emitter;_controllers=new Map;_handlers=new Map;_interactors=new Map;_tools=new Map;_substrates=new Map;constructor(e){e.element&&(this.element=e.element),e.emitter||(this.emitter=new M),this.generate(e)}get view(){return this._view}set view(e){this._view=this.generateInstance(e,{element:this.element}),this.linkPieces()}get model(){return this._model}set model(e){this.model?.keyChangedCallback.remove(this.emitterFireCallback),this._model=this.generateInstance(e),this._model.handlers=this._handlers,this._model.addHandler=e=>this.addHandler(e),this.linkPieces()}get emitter(){return this._emitter}set emitter(e){this._emitter=this.generateInstance(e),this.linkPieces()}get controllers(){return Array.from(this._controllers.values())||[]}set controllers(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addController(e)),this.linkPieces()}get handlers(){return Array.from(this._handlers.values())||[]}set handlers(e){this.generateInstances(e).forEach(e=>this.addHandler(e)),this.linkPieces()}get interactors(){return Array.from(this._interactors.values())||[]}set interactors(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addInteractor(e)),this.linkPieces()}get tools(){return Array.from(this._tools.values())||[]}set tools(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addTool(e)),this.linkPieces()}get substrates(){return Array.from(this._substrates.values())||[]}set substrates(e){this.generateInstances(e,{element:this.element}).forEach(e=>this.addSubstrate(e)),this.linkPieces()}get data(){return this.model?.data}set data(e){this.model&&(this.model.data=e)}get dataId(){return this.model?.dataId}set dataId(e){this.model&&(this.model.dataId=e)}get dataIndex(){return Number.parseInt(this.dataId)}set dataIndex(e){this.model&&(this.model.dataId=e.toString())}get dataSize(){return this.model?.getSize?.()}getController(e){return this._controllers.get(e)}addController(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Controller")),this._controllers.set(e.keyName,e),this.updateController(e)}getHandler(e){return this._handlers.get(e)}addHandler(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Handler")),this._handlers.set(e.keyName,e),this.updateHandler(e)}getInteractor(e){return this._interactors.get(e)}addInteractor(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Interactor")),this._interactors.set(e.keyName,e),this.updateInteractor(e)}getTool(e){return this._tools.get(e)}addTool(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Tool")),this._tools.set(e.keyName,e),this.updateTool(e)}getSubstrate(e){return this._substrates.get(e)}addSubstrate(e){e.keyName||(e.keyName=this.extractClassEssenceName(e.constructor,"Substrate")),this._substrates.set(e.keyName,e),this.updateSubstrate(e)}generate(e={}){for(const t of Object.keys(e)){const i=e[t];void 0!==i&&"initialize"!==t&&"data"!==t&&(this[t]=i)}this._emitter||(this.emitter=new M),e.data&&this.model&&this.model.setBlock(e.data,void 0,void 0,!1),(void 0===e.initialize||e.initialize)&&this.initialize()}initialize(){this.view?.initialize(),this._controllers.forEach(e=>e.initialize()),this._interactors.forEach(e=>e.initialize()),this._tools.forEach(e=>e.initialize()),this._substrates.forEach(e=>e.initialize()),this.model?.initialize()}updateController(e){e.emitter=this.emitter,e.model=this.model,e.view=this.view}updateHandler(e){e.model=this.model}updateInteractor(e){e.model=this.model,e.view=this.view,e.emitter=this.emitter}updateTool(e){e.emitter=this.emitter,e.model=this.model,e.view=this.view}updateSubstrate(e){e.model=this.model,e.view=this.view,e.emitter=this.emitter}linkPieces(){this.model&&!this.model.keyChangedCallback.has(this.emitterFireCallback)&&this.model.keyChangedCallback.add(this.emitterFireCallback),this.emitter&&(this.emitter.model=this.model),this.view&&(this.view.emitter=this.emitter,this.view.model=this.model),this._controllers.forEach(e=>this.updateController(e)),this._handlers.forEach(e=>this.updateHandler(e)),this._interactors.forEach(e=>this.updateInteractor(e)),this._tools.forEach(e=>this.updateTool(e)),this._substrates.forEach(e=>this.updateSubstrate(e))}generateInstance(e,t,i=!0){if(e){if("function"==typeof e){return new e(i&&t&&"object"==typeof t?{...t}:t)}return e}}generateInstances(e,t,i=!0){if(!e)return[];"object"==typeof e&&Array.isArray(e)||(e=[e]);const n=[];return e.forEach(e=>{const s=this.generateInstance(e,t,i);s&&n.push(s)}),n}emitterFireCallback=(e,t,...i)=>this.emitter?.fireWithBlock(e,t,...i);extractClassEssenceName(e,t){let i=e.name,n=Object.getPrototypeOf(this.element);for(;n&&n.constructor!==Object;){const e=n.constructor.name.replaceAll("_","");if(i.startsWith(e)){i=i.slice(e.length);break}n=Object.getPrototypeOf(n)}return i.endsWith(t)&&(i=i.slice(0,-t.length)),i.charAt(0).toLowerCase()+i.slice(1)}}class x{callbacks=new Set;add(e){this.callbacks.add(e)}remove(e){return this.callbacks.delete(e)}has(e){return this.callbacks.has(e)}fire(...e){let t;for(const i of this.callbacks)try{const n=i(...e);o(n)||(t=n)}catch(e){console.error("Error invoking callback:",e)}return t}clear(){this.callbacks.clear()}}class A extends x{onAdded=new x;add(e){super.add(e),this.onAdded.fire(e)}}const j=new class{constructorMap=new WeakMap;dataMap=new WeakMap;activeEffect=null;constructorData(e){let t=this.constructorMap.get(e);return t||(t={installed:new Map},this.constructorMap.set(e,t)),t}data(e){let t=this.dataMap.get(e);return t||(t=new Map,this.dataMap.set(e,t)),t}track(e){this.activeEffect&&this.activeEffect.dependencies.add(e)}createSignalEntry(e,t,i,n,s){const a=new Set,r=this,o=void 0!==t||void 0!==i;let l=e;s||(s={diffOnWrite:!0});const c={get:()=>(r.track(c),o?i():l),set(a){if(o)if(n&&!s.diffOnWrite)n(a),c.emit();else if(n){const e=i();n(a);const t=i();Object.is(e,t)||c.emit()}else Reflect.set(e,t,a,e);else{const e=l;l=a,Object.is(e,a)||c.emit()}},update(e){c.set(e(o?i():l))},sub:e=>(a.add(e),()=>a.delete(e)),emit(){for(const e of Array.from(a))queueMicrotask(e)}};return c}getReactivityData(e,t){const i=this.data(e);return i.has(t)||i.set(t,{}),i.get(t)}getSignal(e,t){return this.getReactivityData(e,t).signal}setSignal(e,t,i){const n=this.getSignal(e,t);n?n.set(i):Reflect.set(e,t,i,e)}getEffect(e,t){return this.getReactivityData(e,t).effect}setEffect(e,t,i){this.getReactivityData(e,t).effect=i}markDirty(e,t){this.getSignal(e,t)?.emit()}schedule(e){e.scheduled||(e.scheduled=!0,queueMicrotask(()=>{e.scheduled=!1,e.run()}))}},B=new class{utils;constructor(e){this.utils=e}createBoxFromEntry(e){return new Proxy({...e,toJSON:()=>e.get(),valueOf:()=>e.get(),[Symbol.toPrimitive]:t=>{const i=e.get();return"string"===t?String(i):"number"==typeof i?i:null!=i&&"function"==typeof i.valueOf?i.valueOf():i},get value(){return e.get()},set value(t){e.set(t)}},{get:(e,t,i)=>Reflect.get(e,t,i),set:(e,t,i,n)=>"value"===t?(e.value=i,!0):Reflect.set(e,t,i,n)})}signalDecorator(e,t,i,s){const{kind:a,name:r,static:o,private:l}=t;if(l)throw new Error("@signal does not support private class elements.");const c=r,h=Symbol(`[[signal:${String(c)}]]`),u=Symbol(`[[signal:${String(c)}:shadow]]`),d=this.utils;t.addInitializer(function(){const t=o?this:this.constructor.prototype;let r,l;const p=function(){return i&&!this[u]?i.call(this):r&&!this[u]?r.call(this):this[h]},f=function(e){l||s?(s&&s.call(this,e),l&&l.call(this,e),r||i||(this[h]=e,this[u]=!0)):(this[h]=e,this[u]=!0)},m=(e,t=!0)=>{let n=d.getSignal(e,c);return n||("field"!==a||r||i||(e[h]=e[c]),n=d.createSignalEntry(e,c,()=>p.call(e),t=>f.call(e,t),{diffOnWrite:t}),d.getReactivityData(e,c).signal=n,"field"===a&&delete e[c],n)};if("field"===a||"accessor"===a){const t=e;t?.get&&(r=t.get),t?.set&&(l=t.set);const s=m(this,!r&&!i),a=n(this,c);Object.defineProperty(this,c,{configurable:a?.configurable??!0,enumerable:a?.enumerable??!0,get:()=>(d.track(s),p.call(this)),set:e=>s.set(e)})}else if("getter"===a||"setter"===a){const e=d.constructorData(t).installed;if(e.get(c))return;e.set(c,!0);const s=n(t,c)??{};"function"==typeof s.get&&(r=s.get),"function"==typeof s.set&&(l=s.set),Object.defineProperty(t,c,{configurable:s?.configurable??!0,enumerable:!!s?.enumerable,get:function(){const e=m(this,!r&&!i);return d.track(e),p.call(this)},set:function(e){m(this,!r&&!i).set(e)}})}})}}(j),N=new class{utils;constructor(e){this.utils=e}makeEffect(e){const t=this.utils;return{callback:e,dependencies:new Set,cleanups:[],scheduled:!1,run(){for(const e of this.cleanups)e();this.cleanups=[],this.dependencies=new Set,t.activeEffect=this;try{this.callback()}finally{t.activeEffect=null}for(const e of this.dependencies){const i=e.sub(()=>t.schedule(this));this.cleanups.push(i)}},dispose(){for(const e of this.cleanups)e();this.cleanups=[],this.dependencies.clear()}}}}(j);function z(e,t){return j.markDirty(e,t)}function V(e){for(const[,t]of j.data(e))t.effect?.run()}let F=(()=>{let e,i=[],n=[];return class{static{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[c()],t.__esDecorate(this,null,e,{kind:"accessor",name:"enabledCallbacks",static:!1,private:!1,access:{has:e=>"enabledCallbacks"in e,get:e=>e.enabledCallbacks,set:(e,t)=>{e.enabledCallbacks=t}},metadata:s},i,n),s&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s})}isInitialized=new Map;isDataBlocksArray=!1;dataBlocks;handlers;keyChangedCallback;constructor(e,i){t.__runInitializers(this,n),this.keyChangedCallback=new A,"array"===i?(this.isDataBlocksArray=!0,this.dataBlocks=[]):(this.isDataBlocksArray=!1,this.dataBlocks=new Map),this.enabledCallbacks=!0,this.setBlock(e,void 0,this.defaultBlockKey,!1)}get data(){return this.getBlockData()}set data(e){this.setBlock(e)}get dataId(){return this.getBlockId()}set dataId(e){this.setBlockId(e)}#t=t.__runInitializers(this,i,void 0);get enabledCallbacks(){return this.#t}set enabledCallbacks(e){this.#t=e}getData(e,t=this.defaultBlockKey){return this.isValidBlockKey(t)?this.getBlockData(t)?.[e]:null}setData(e,t,i=this.defaultBlockKey){if(!this.isValidBlockKey(i))return;const n=this.getBlockData(i);n&&(n[e]=t),this.enabledCallbacks&&this.fireKeyChangedCallback(e,i)}getSize(e=this.defaultBlockKey){return this.getAllKeys(e)?.length??0}getBlock(e=this.defaultBlockKey){if(!this.isValidBlockKey(e))return null;if(this.isDataBlocksArray){const t=Number(e);return Number.isInteger(t)&&t>=0?this.dataBlocks[t]??null:null}return this.dataBlocks.get(e.toString())??null}createBlock(e,t,i=this.defaultBlockKey){return{id:t??null,data:e}}setBlock(e,t,i=this.defaultBlockKey,n=!0){if(!this.isValidBlockKey(i)||null==e)return;const s=this.createBlock(e,t,i);if(this.isDataBlocksArray){const e=Number(i);Number.isInteger(e)&&e>=0&&(this.dataBlocks[e]=s)}else this.dataBlocks.set(i.toString(),s);n?this.initialize(i):this.isInitialized.set(i,!1)}hasBlock(e){if(this.isDataBlocksArray){const t=Number(e);return Number.isInteger(t)&&t>=0&&t<this.dataBlocks.length}return this.dataBlocks.has(e.toString())}addBlock(e,t,i,n=!0){if(!e)return;if(!this.isDataBlocksArray)return this.setBlock(e,t,i,n);const s=this.createBlock(e,t,i);let a=Number(i);(!Number.isInteger(a)||a<0)&&(a=this.dataBlocks.length),this.dataBlocks.splice(a,0,s),n&&this.initialize(a)}getBlockData(e=this.defaultBlockKey){const t=this.getBlock(e);return t?t.data:null}getBlockId(e=this.defaultBlockKey){const t=this.getBlock(e);return t?t.id:null}setBlockId(e,t=this.defaultBlockKey){if(!e)return;const i=this.getBlock(t);i&&(i.id=e)}fireKeyChangedCallback(e,t=this.defaultBlockKey,i=!1){this.isValidBlockKey(t)||(t=this.getAllBlockKeys()[0]),z(this,e),this.keyChangedCallback.fire(e,t,i?void 0:this.getData(e,t))}fireCallback(e,...t){this.keyChangedCallback.fire(e,this.defaultBlockKey,...t)}fireBlockCallback(e,t=this.defaultBlockKey,...i){this.isValidBlockKey(t)||(t=this.getAllBlockKeys()[0]),this.keyChangedCallback.fire(e,t,...i)}initialize(e=this.defaultBlockKey){const t=this.getAllKeys(e);t&&this.enabledCallbacks&&(t.forEach(t=>this.fireKeyChangedCallback(t,e)),this.isInitialized.set(e,!0))}clear(e=this.defaultBlockKey){}get defaultBlockKey(){return this.isDataBlocksArray?0:"__turbo_default_block_key__"}get defaultComputationBlockKey(){return(this.isDataBlocksArray?this.dataBlocks.length:this.dataBlocks.size)>1?null:this.defaultBlockKey}isValidBlockKey(e){return null!=e&&("string"==typeof e&&0!==e.length||"number"==typeof e)}getAllBlockKeys(){return this.isDataBlocksArray?this.dataBlocks.map((e,t)=>t):Array.from(this.dataBlocks.keys())}getAllIds(){return this.isDataBlocksArray?this.dataBlocks.map(e=>e.id):Array.from(this.dataBlocks.values()).map(e=>e.id)}getAllBlocks(e=this.defaultComputationBlockKey){const t=[];if(null!==e){const i=this.getBlock(e);i&&t.push(i)}else for(const e of this.getAllBlockKeys()){const i=this.getBlock(e);i&&t.push(i)}return t}getAllKeys(e=this.defaultComputationBlockKey){return this.getAllBlocks(e).flatMap(e=>Object.keys(e.data))}getAllData(e=this.defaultComputationBlockKey){return this.getAllBlocks(e).flatMap(e=>Object.values(e.data))}getHandler(e){return this.handlers.get(e)}addHandler(e){e.keyName&&this.handlers.set(e.keyName,e)}}})();const L={keyPressed:"turbo-key-pressed",keyReleased:"turbo-key-released"},R={keyPressed:"keydown",keyReleased:"keyup"},W={click:"turbo-click",clickStart:"turbo-click-start",clickEnd:"turbo-click-end",longPress:"turbo-long-press"},K={click:"click",clickStart:"mousedown",clickEnd:"mouseup",longPress:W.longPress},H={move:"turbo-move"},U={move:"mousemove"},$={drag:"turbo-drag",dragStart:"turbo-drag-start",dragEnd:"turbo-drag-end"},Y={drag:$.drag,dragStart:$.dragStart,dragEnd:$.dragEnd},G={trackpadScroll:"turbo-trackpad-scroll",trackpadPinch:"turbo-trackpad-pinch",mouseWheel:"turbo-mouse-wheel"},q={trackpadScroll:"wheel",trackpadPinch:"wheel",mouseWheel:"wheel"},X={...W,...L,...H,...$,...G,selectInput:"turbo-select-input"},J={...R,...K,...U,...Y,...q,wheel:"wheel",scroll:"scroll",input:"input",change:"change",focus:"focus",focusIn:"focusin",focusOut:"focusout",blur:"blur",resize:"resize",compositionStart:"compositionstart",compositionEnd:"compositionend"};function Q(e){if(null!=e)switch(typeof e){case"string":return e;case"number":case"boolean":case"bigint":case"symbol":case"function":return e.toString();case"object":if(Array.isArray(e))return JSON.stringify(e);if(e instanceof Date)return e.toISOString();try{return JSON.stringify(e)}catch{return"[object Object]"}default:return String(e)}}function Z(e){if(!o(e)){switch(e){case"null":return null;case"true":return!0;case"false":return!1}if(!isNaN(Number(e)))return Number(e);if(/^\d+n$/.test(e))return BigInt(e.slice(0,-1));if(e.startsWith("function")||e.startsWith("("))try{const t=new Function(`return (${e})`)();if("function"==typeof t)return t}catch{}try{const t=JSON.parse(e);if("object"==typeof t&&null!=t)return t}catch{}return e}}function ee(e){if(!e||0==e.length)return"";const t=e.match(/\.\S{1,4}$/);return t?t[0]:""}function te(e){if(e&&0!=e.length)return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function ie(e){if(e&&0!=e.length)return e.replace(/-([a-z])/g,e=>e[1].toUpperCase())}function ne(){h.prototype.setProperties=function(e={},t=!1){if(!this)return this;if(e.out&&("string"==typeof e.out?this.__outName=e.out:Object.assign(e.out,this)),!this.element.shadowRoot){let t=!!e.shadowDOM;if("getPropertiesValue"in this.element&&"function"==typeof this.element.getPropertiesValue&&(t=this.element.getPropertiesValue(e.shadowDOM,"shadowDOM")),t)try{this.element.attachShadow({mode:"open"})}catch{}}const i=this.element?.mvc instanceof I?this.element.mvc:"model"in this.element&&"view"in this.element?this.element:void 0;for(const n of Object.keys(e)){const s=e[n];if(void 0!==s)switch(n){case"tag":case"namespace":case"shadowDOM":break;case"text":this.element instanceof HTMLElement&&(this.element.innerText=s);break;case"style":if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))break;this.setStyles(s,!0);break;case"stylesheet":P(s,this.closestRoot);break;case"id":this.element.id=s;break;case"classes":this.addClass(s);break;case"listeners":Object.entries(s).forEach(([e,t])=>this.on(e,t));break;case"onClick":this.on(J.click,s);break;case"onDrag":this.on(J.drag,s);break;case"children":this.addChild(s);break;case"parent":ct(s).addChild(this.element);break;case"data":case"initialize":if(i)break;case"model":case"view":case"emitter":case"controllers":case"handlers":case"interactors":case"tools":case"substrates":if(t)break;if(i){try{i[n]=s,"model"===n&&e.data&&i.model instanceof F&&i.model.setBlock(e.data,void 0,void 0,!1)}catch{}break}default:if(t)break;try{this.element[n]=s}catch(e){try{this.setAttribute(n,Q(s))}catch(e){console.error(e)}}}}return(void 0===e.initialize||e.initialize)&&(this.element&&"initialize"in this.element&&"function"==typeof this.element.initialize?this.element.initialize():i&&"initialize"in i&&"function"==typeof i.initialize&&i.initialize()),this},h.prototype.setMvc=function(e){if(this.element)return"mvc"in this.element&&this.element.mvc instanceof I?(this.element.mvc.generate(e),this.element.mvc):new I({...e,element:this.element})},h.prototype.destroy=function(){return this.removeAllListeners(),this.remove(),this.element&&"destroy"in this.element&&"function"==typeof this.element.destroy&&this.element.destroy(),this},h.prototype.setAttribute=function(e,t){return this.element instanceof Element&&this.element.setAttribute(e,t?.toString()||"true"),this},h.prototype.removeAttribute=function(e){return this.element instanceof Element&&this.element.removeAttribute(e),this},h.prototype.blur=function(){return this.element instanceof HTMLElement&&this.element.blur(),this},h.prototype.focus=function(){return this.element instanceof HTMLElement&&this.element.focus(),this}}const se=["mousedown","mouseup","mousemove","click","dblclick","contextmenu","dragstart","selectstart","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","wheel"],ae=["wheel","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointercancel"];var re,oe,le;e.ActionMode=void 0,(re=e.ActionMode||(e.ActionMode={}))[re.none=0]="none",re[re.click=1]="click",re[re.longPress=2]="longPress",re[re.drag=3]="drag",e.ClickMode=void 0,(oe=e.ClickMode||(e.ClickMode={}))[oe.none=0]="none",oe[oe.left=1]="left",oe[oe.right=2]="right",oe[oe.middle=3]="middle",oe[oe.other=4]="other",oe[oe.key=5]="key",e.InputDevice=void 0,(le=e.InputDevice||(e.InputDevice={}))[le.unknown=0]="unknown",le[le.mouse=1]="mouse",le[le.trackpad=2]="trackpad",le[le.touch=3]="touch";class ce extends Map{enforceImmutability=!0;set(e,t){return super.set(e,this.enforceImmutability?this.copy(t):t)}get(e){const t=super.get(e);return this.enforceImmutability?this.copy(t):t}get first(){if(0==this.size)return null;const e=this.values().next().value;return this.enforceImmutability?this.copy(e):e}get last(){if(0==this.size)return null;const e=this.valuesArray()[this.size-1];return this.enforceImmutability?this.copy(e):e}keysArray(){return Array.from(this.keys())}valuesArray(){return Array.from(this.values())}copy(e){if(e&&"object"==typeof e){if(e instanceof Array)return e.map(e=>this.copy(e));if(e.constructor&&e.constructor!=Object){if("function"==typeof e.clone)return e.clone();if("function"==typeof e.copy)return e.copy()}return{...e}}return e}mapKeys(e){const t=new ce;for(let[i,n]of this)t.set(e(i,n),n);return t}mapValues(e){const t=new ce;for(let[i,n]of this)t.set(i,e(i,n));return t}filter(e){const t=new ce;for(let[i,n]of this)e(i,n)&&t.set(i,n);return t}merge(e){for(let[t,i]of e)this.set(t,i);return this}}function he(e,t,i){const n=Symbol(`__${t.toLowerCase()}_${String(e.name)}`),s=function(e,t,i){return e??(String(i.name).endsWith(t)?String(i.name).slice(0,-t.length):String(i.name))}(i,t,e);e.addInitializer(function(){Object.defineProperty(this,e.name,{configurable:!0,enumerable:!1,get:function(){if(this[n])return this[n];let e,i;switch(t){case"Controller":i="getController";break;case"Handler":i="getHandler";break;case"Interactor":i="getInteractor";break;case"Tool":i="getTool";break;case"Substrate":i="getSubstrate"}if(i){if(this.mvc&&this.mvc instanceof I?e=this.mvc[i](s):this[i]&&"function"==typeof this[i]&&(e=this[i](s)),!e)throw new Error(`${t} "${s}" not found on ${this?.constructor?.name}.`);return this[n]=e,e}},set:function(e){this[n]=e}})})}function ue(e){return function(t,i){he(i,"Controller",e)}}function de(e){return function(t,i){he(i,"Handler",e)}}let pe=(()=>{let i,n,s=F,a=[],r=[],o=[];return class extends s{static{const l="function"==typeof Symbol&&Symbol.metadata?Object.create(s[Symbol.metadata]??null):void 0;i=[de()],n=[c({callBefore:function(t){t==e.InputDevice.trackpad&&(this.wasRecentlyTrackpad=!0)}})],t.__esDecorate(this,null,n,{kind:"setter",name:"inputDevice",static:!1,private:!1,access:{has:e=>"inputDevice"in e,set:(e,t)=>{e.inputDevice=t}},metadata:l},null,a),t.__esDecorate(null,null,i,{kind:"field",name:"utils",static:!1,private:!1,access:{has:e=>"utils"in e,get:e=>e.utils,set:(e,t)=>{e.utils=t}},metadata:l},r,o),l&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})}utils=(t.__runInitializers(this,a),t.__runInitializers(this,r,void 0));state=(t.__runInitializers(this,o),{});lockState={};onInputDeviceChange=new A;onToolChange=new A;currentKeys=[];currentAction=e.ActionMode.none;currentClick=e.ClickMode.none;wasRecentlyTrackpad=!1;moveThreshold;longPressDuration;authorizeEventScaling;scaleEventPosition;activePointers=new Set;origins=new ce;previousPositions=new ce;positions;lastTargetOrigin;timerMap=new ce;tools=new Map;mappedKeysToTool=new Map;currentTools=new Map;set inputDevice(e){this.onInputDeviceChange.fire(e)}}})();var fe;e.ClosestOrigin=void 0,(fe=e.ClosestOrigin||(e.ClosestOrigin={})).target="target",fe.position="position";let me=(()=>{let i,n,s=Event,a=[];return class extends s{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(s[Symbol.metadata]??null):void 0;i=[ut()],n=[ut()],t.__esDecorate(this,null,i,{kind:"method",name:"closest",static:!1,private:!1,access:{has:e=>"closest"in e,get:e=>e.closest},metadata:e},null,a),t.__esDecorate(this,null,n,{kind:"getter",name:"scaledPosition",static:!1,private:!1,access:{has:e=>"scaledPosition"in e,get:e=>e.scaledPosition},metadata:e},null,a),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}eventManager=t.__runInitializers(this,a);toolName;eventName;clickMode;keys;position;authorizeScaling;scalePosition;constructor(e){super(e.eventName,{bubbles:!0,cancelable:!0,...e.eventInitDict}),this.eventManager=e.eventManager??Ie.instance,this.authorizeScaling=e.authorizeScaling??!0,this.scalePosition=e.scalePosition??(e=>e),this.clickMode=e.clickMode??Ie.instance.currentClick,this.keys=e.keys??Ie.instance.currentKeys,this.eventName=e.eventName,this.position=e.position,this.toolName=e.toolName}get tool(){return this.toolName&&this.eventManager instanceof Ie?this.eventManager.getToolByName(this.toolName):null}closest(t,i=!0,n=e.ClosestOrigin.target){const s=n==e.ClosestOrigin.target?[this.target]:document.elementsFromPoint(this.position.x,this.position.y),a=i instanceof Element?i:null,r=!0===i||null!==a;for(let e of s){for(;e&&(!(e instanceof t)||r&&!this.isPositionInsideElement(this.position,a??e));)e=e.parentElement;if(e)return e}return null}isPositionInsideElement(e,t){const i=t.getBoundingClientRect();return e.x>=i.left&&e.x<=i.right&&e.y>=i.top&&e.y<=i.bottom}get target(){return super.target||document}get scaledPosition(){return this.scalingAuthorized?this.scalePosition(this.position):this.position}get scalingAuthorized(){return"function"==typeof this.authorizeScaling?this.authorizeScaling():this.authorizeScaling}scalePositionsMap(e){return e.mapValues((e,t)=>this.scalePosition(t))}}})();class ge extends me{keyPressed;keyReleased;constructor(e){super({...e,position:null}),this.keyPressed=e.keyPressed,this.keyReleased=e.keyReleased}}class be{keyName;element;view;model;emitter;constructor(e){this.element=e.element,e.model&&(this.model=e.model),e.emitter&&(this.emitter=e.emitter),e.view&&(this.view=e.view)}initialize(){this.setupChangedCallbacks()}setupChangedCallbacks(){V(this)}}class ye extends be{keyName="key";keyDown=e=>this.keyDownFn(e);keyDownFn(e){this.element.enabled&&(this.model.currentKeys.includes(e.key)||(this.model.currentKeys.push(e.key),this.emitter.fire("dispatchEvent",document,ge,{eventName:L.keyPressed,keyPressed:e.key})))}keyUp=e=>this.keyUpFn(e);keyUpFn(e){this.element.enabled&&this.model.currentKeys.includes(e.key)&&(this.model.currentKeys.splice(this.model.currentKeys.indexOf(e.key),1),this.emitter.fire("dispatchEvent",document,ge,{eventName:L.keyReleased,keyReleased:e.key}))}}class ve extends me{delta;constructor(e){super({...e,position:null}),this.delta=e.delta}}class ke{x;y;constructor(e=0,t=("number"==typeof e?e:0)){"number"==typeof e?(this.x=e,this.y=t):"clientX"in e?(this.x=e.clientX,this.y=e.clientY):"x"in e?(this.x=e.x,this.y=e.y):(this.x=e[0],this.y=e[1])}static dist(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static midPoint(...e){if(0==e.length)return null;const t=e.reduce((e,t)=>e+t.x,0)/e.length,i=e.reduce((e,t)=>e+t.y,0)/e.length;return new ke(t,i)}static max(...e){if(0==e.length)return null;const t=e.reduce((e,t)=>Math.max(e,t.x),-1/0),i=e.reduce((e,t)=>Math.max(e,t.y),-1/0);return new ke(t,i)}static min(...e){if(0==e.length)return null;const t=e.reduce((e,t)=>Math.min(e,t.x),1/0),i=e.reduce((e,t)=>Math.min(e,t.y),1/0);return new ke(t,i)}get object(){return{x:this.x,y:this.y}}equals(e,t=0){return"number"==typeof e?this.x==e&&this.y==t:this.x==e.x&&this.y==e.y}boundX(e,t){return this.x<e?e:this.x>t?t:this.x}boundY(e,t){return this.y<e?e:this.y>t?t:this.y}bound(e,t,i=e,n=t){return new ke(this.boundX(e,t),this.boundY(i,n))}add(e,t){return"number"==typeof e?new ke(this.x+e,this.y+(t||0==t?t:e)):new ke(this.x+e.x,this.y+e.y)}sub(e,t){return"number"==typeof e?new ke(this.x-e,this.y-(t||0==t?t:e)):new ke(this.x-e.x,this.y-e.y)}mul(e,t){return"number"==typeof e?new ke(this.x*e,this.y*(t||0==t?t:e)):new ke(this.x*e.x,this.y*e.y)}div(e,t){return"number"==typeof e?new ke(this.x/e,this.y/(t||0==t?t:e)):new ke(this.x/e.x,this.y/e.y)}mod(e,t){const i="number"==typeof e?{x:e,y:t||0==t?t:e}:{x:e.x,y:e.y},n=this.object;for(;n.x<0;)n.x+=i.x;for(;n.x>=i.x;)n.x-=i.x;for(;n.y<0;)n.y+=i.y;for(;n.y>=i.y;)n.y-=i.y;return new ke(n)}get abs(){return new ke(Math.abs(this.x),Math.abs(this.y))}get max(){return Math.max(this.x,this.y)}get min(){return Math.min(this.x,this.y)}get length2(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length2)}dot(e){return this.x*e.x+this.y*e.y}copy(){return new ke(this.x,this.y)}arr(){return[this.x,this.y]}}class Ee extends be{keyName="wheel";wheel=t=>{if(!this.element.enabled)return;let i;this.element.preventDefaultWheel&&t.preventDefault(),(Math.abs(t.deltaY)<=40||0!=t.deltaX)&&(this.model.inputDevice=e.InputDevice.trackpad),this.model.wasRecentlyTrackpad||(this.model.inputDevice=e.InputDevice.mouse),this.model.utils.clearTimer("recentlyTrackpadTimer"),this.model.utils.setTimer("recentlyTrackpadTimer",()=>{this.model.inputDevice==e.InputDevice.trackpad&&(this.model.wasRecentlyTrackpad=!1)},800),i=this.model.inputDevice==e.InputDevice.trackpad&&t.ctrlKey?X.trackpadPinch:this.model.inputDevice==e.InputDevice.trackpad?X.trackpadScroll:X.mouseWheel,this.emitter.fire("dispatchEvent",document,ve,{delta:new ke(t.deltaX,t.deltaY),eventName:i})}}let Se=(()=>{let e,i,n,s,a,r,o,l=me,c=[];return class extends l{static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;e=[ut()],i=[ut()],n=[ut()],s=[ut()],a=[ut()],r=[ut()],o=[ut()],t.__esDecorate(this,null,e,{kind:"getter",name:"scaledOrigins",static:!1,private:!1,access:{has:e=>"scaledOrigins"in e,get:e=>e.scaledOrigins},metadata:h},null,c),t.__esDecorate(this,null,i,{kind:"getter",name:"scaledPreviousPositions",static:!1,private:!1,access:{has:e=>"scaledPreviousPositions"in e,get:e=>e.scaledPreviousPositions},metadata:h},null,c),t.__esDecorate(this,null,n,{kind:"getter",name:"scaledPositions",static:!1,private:!1,access:{has:e=>"scaledPositions"in e,get:e=>e.scaledPositions},metadata:h},null,c),t.__esDecorate(this,null,s,{kind:"getter",name:"deltaPositions",static:!1,private:!1,access:{has:e=>"deltaPositions"in e,get:e=>e.deltaPositions},metadata:h},null,c),t.__esDecorate(this,null,a,{kind:"getter",name:"deltaPosition",static:!1,private:!1,access:{has:e=>"deltaPosition"in e,get:e=>e.deltaPosition},metadata:h},null,c),t.__esDecorate(this,null,r,{kind:"getter",name:"scaledDeltaPositions",static:!1,private:!1,access:{has:e=>"scaledDeltaPositions"in e,get:e=>e.scaledDeltaPositions},metadata:h},null,c),t.__esDecorate(this,null,o,{kind:"getter",name:"scaledDeltaPosition",static:!1,private:!1,access:{has:e=>"scaledDeltaPosition"in e,get:e=>e.scaledDeltaPosition},metadata:h},null,c),h&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h})}origins=t.__runInitializers(this,c);previousPositions;positions;constructor(e){super({...e,position:e.positions.first}),this.origins=e.origins,this.previousPositions=e.previousPositions,this.positions=e.positions}get scaledOrigins(){return this.scalingAuthorized?this.scalePositionsMap(this.origins):this.origins}get scaledPreviousPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.previousPositions):this.previousPositions}get scaledPositions(){return this.scalingAuthorized?this.scalePositionsMap(this.positions):this.positions}get deltaPositions(){return this.positions.mapValues((e,t)=>{const i=this.previousPositions.get(e);if(i)return t.sub(i)})}get deltaPosition(){return ke.midPoint(...this.deltaPositions.valuesArray())}get scaledDeltaPositions(){return this.scaledPositions.mapValues((e,t)=>{const i=this.scaledPreviousPositions.get(e);if(i)return t.sub(i)})}get scaledDeltaPosition(){return ke.midPoint(...this.scaledDeltaPositions.valuesArray())}}})();class _e extends be{keyName="pointer";pointerDown=e=>this.pointerDownFn(e);pointerMove=e=>this.pointerMoveFn(e);pointerUp=e=>this.pointerUpFn(e);pointerCancel=e=>this.pointerCancelFn(e);lostPointerCapture=e=>this.lostPointerCaptureFn(e);pointerDownFn(t){if(t.composedPath().includes(this.model.lockState.lockOrigin)||(document.activeElement?.blur?.(),this.element.unlock()),!this.element.enabled)return;const i="touch"===t.pointerType;this.element.preventDefaultMouse&&!i&&t.preventDefault(),this.element.preventDefaultTouch&&i&&t.preventDefault(),i?this.model.inputDevice=e.InputDevice.touch:this.model.inputDevice!==e.InputDevice.unknown&&this.model.inputDevice!==e.InputDevice.touch||(this.model.inputDevice=e.InputDevice.mouse);const n=t.pointerId,s=new ke(t.clientX,t.clientY);this.model.origins.set(n,s),this.model.previousPositions.set(n,s);const a=document.elementFromPoint(s.x,s.y);a&&a.setPointerCapture?.(t.pointerId),this.model.activePointers.add(n),this.model.utils.setClickMode(i?this.model.activePointers.size:t.button,i),this.element.clickEventEnabled&&(this.fireClick(this.model.origins.first,X.clickStart),this.model.currentAction=e.ActionMode.click,this.model.utils.setTimer(X.longPress,()=>{this.model.currentAction===e.ActionMode.click&&(this.model.currentAction=e.ActionMode.longPress,this.fireClick(this.model.origins.first,X.longPress))},this.model.longPressDuration))}pointerMoveFn(t){if(!this.element.enabled)return;if(!this.element.moveEventsEnabled&&!this.element.dragEventEnabled)return;const i="touch"===t.pointerType;if(this.element.preventDefaultMouse&&!i&&t.preventDefault(),this.element.preventDefaultTouch&&i&&t.preventDefault(),this.model.positions=new ce,this.model.positions.set(t.pointerId,new ke(t.clientX,t.clientY)),this.model.currentAction!==e.ActionMode.drag&&(this.model.lastTargetOrigin=null),this.element.moveEventsEnabled&&this.fireDrag(this.model.positions,X.move),this.model.currentAction!==e.ActionMode.none&&this.element.dragEventEnabled){if(this.model.currentAction!==e.ActionMode.drag){if(!Array.from(this.model.origins.entries()).some(([e,i])=>{const n=e===t.pointerId?this.model.positions.get(e):this.model.previousPositions.get(e);return n&&ke.dist(n,i)>this.model.moveThreshold}))return;dt(this),this.fireDrag(this.model.origins,X.dragStart),this.model.currentAction=e.ActionMode.drag}this.fireDrag(this.model.positions)}this.model.previousPositions.set(t.pointerId,this.model.positions.get(t.pointerId))}pointerUpFn(t){if(!this.element.enabled)return;const i="touch"===t.pointerType;this.element.preventDefaultMouse&&!i&&t.preventDefault(),this.element.preventDefaultTouch&&i&&t.preventDefault(),this.model.utils.clearTimer(X.longPress),this.model.positions=new ce,this.model.positions.set(t.pointerId,new ke(t.clientX,t.clientY)),this.model.currentAction===e.ActionMode.drag&&this.element.dragEventEnabled&&this.fireDrag(this.model.positions,X.dragEnd),this.element.clickEventEnabled&&(this.model.currentAction===e.ActionMode.click&&this.fireClick(this.model.positions.first,X.click),this.fireClick(this.model.origins.first,X.clickEnd)),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=e.ActionMode.none,this.model.currentClick=e.ClickMode.none)}pointerCancelFn(t){this.model.utils.clearTimer(X.longPress),this.model.origins.delete(t.pointerId),this.model.previousPositions.delete(t.pointerId),this.model.activePointers.delete(t.pointerId),0===this.model.activePointers.size&&(this.model.currentAction=e.ActionMode.none,this.model.currentClick=e.ClickMode.none)}lostPointerCaptureFn(e){}fireClick(e,t=X.click){if(!e)return;const i=document.elementFromPoint(e.x,e.y)||document;this.emitter.fire("dispatchEvent",i,me,{position:e,eventName:t})}fireDrag(e,t=X.drag){e&&this.emitter.fire("dispatchEvent",this.getFireOrigin(e),Se,{positions:e,previousPositions:this.model.previousPositions,origins:this.model.origins,eventName:t})}getFireOrigin(e,t=!1){if(!this.model.lastTargetOrigin||t){const t=this.model.origins.first?this.model.origins.first:e.first;this.model.lastTargetOrigin=document.elementFromPoint(t.x,t.y)}return this.model.lastTargetOrigin}}class we{_weakRefs;constructor(){this._weakRefs=new Set}add(e){return this.has(e)||this._weakRefs.add(new WeakRef(e)),this}has(e){for(const t of this._weakRefs)if(t.deref()===e)return!0;return!1}delete(e){for(const t of this._weakRefs)if(t.deref()===e)return this._weakRefs.delete(t),!0;return!1}cleanup(){for(const e of this._weakRefs)void 0===e.deref()&&this._weakRefs.delete(e)}toArray(){const e=[];for(const t of this._weakRefs){const i=t.deref();void 0!==i?e.push(i):this._weakRefs.delete(t)}return e}get size(){return this.cleanup(),this.toArray().length}clear(){this._weakRefs.clear()}}class Ce extends be{keyName="dispatch";boundHooks=new Map;setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("dispatchEvent",this.dispatchEvent)}dispatchEvent=(t,i,n)=>{t&&(n.keys=this.model.currentKeys,n.toolName=this.element.getCurrentToolName(this.model.currentClick),n.clickMode=this.model.currentClick,n.eventManager=this.element,n.eventInitDict={bubbles:!0,cancelable:!0,composed:!0},n.authorizeScaling=this.element.authorizeEventScaling,n.scalePosition=this.element.scaleEventPosition,n.eventName===L.keyPressed?this.element.setToolByKey(n.keyPressed):n.eventName===L.keyReleased&&this.element.setTool(void 0,e.ClickMode.key,{select:!1}),t.dispatchEvent(new i(n)))};getToolHandlingCallback(e,t){const i=this.element.getCurrentToolName(this.model.currentClick),n=t.composedPath?.()||[];for(let s=n.length-1;s>=0;s--)if(n[s]instanceof Node&&ct(n[s]).executeAction(e,i,t,{capture:!0},this.element)){t.stopPropagation();break}for(let s=0;s<n.length;s++)if(n[s]instanceof Node&&ct(n[s]).executeAction(e,i,t,void 0,this.element)){t.stopPropagation();break}}setupCustomDispatcher(e){if(this.boundHooks.has(e))return;const t=t=>this.getToolHandlingCallback(e,t);this.boundHooks.set(e,t),document.addEventListener(e,t,{capture:!0})}removeCustomDispatcher(e){const t=this.boundHooks.get(e);t&&(document.removeEventListener(e,t,{capture:!0}),this.boundHooks.delete(e))}}class De{keyName;model;constructor(e){this.model&&(this.model=e)}}class Te extends De{keyName="utils";setClickMode(t,i=!1){switch(i&&t--,t){case-1:return void(this.model.currentClick=e.ClickMode.none);case 0:return void(this.model.currentClick=e.ClickMode.left);case 1:return void(this.model.currentClick=e.ClickMode.middle);case 2:return void(this.model.currentClick=e.ClickMode.right);default:return void(this.model.currentClick=e.ClickMode.other)}}applyEventNames(e){for(const t in e)J[t]=e[t]}setTimer(e,t,i){this.clearTimer(e),this.model.timerMap.set(e,setTimeout(()=>{t(),this.clearTimer(e)},i))}clearTimer(e){const t=this.model.timerMap.get(e);t&&(clearTimeout(t),this.model.timerMap.delete(e))}selectTool(e,t){"selected"in e&&"boolean"==typeof e.selected&&(e.selected=t)}activateTool(e,t,i){i?ct(e).onToolActivate(t).fire():ct(e).onToolDeactivate(t).fire()}}function Oe(e){const t=e.prototype;Object.defineProperty(t,"view",{get(){return this.mvc?.view},set(e){if(!this.mvc)throw new Error("view: missing this.mvc");this.mvc.view=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"model",{get(){return this.mvc?.model},set(e){if(!this.mvc)throw new Error("model: missing this.mvc");this.mvc.model=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"data",{get(){return this.mvc?.data},set(e){if(!this.mvc)throw new Error("data: missing this.mvc");this.mvc.data=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"dataId",{get(){return this.mvc?.dataId},set(e){if(!this.mvc)throw new Error("dataId: missing this.mvc");this.mvc.dataId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"dataIndex",{get(){return this.mvc?.dataIndex},set(e){if(!this.mvc)throw new Error("dataIndex: missing this.mvc");this.mvc.dataIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"dataSize",{get(){return this.mvc?.dataSize},enumerable:!0,configurable:!0})}function Pe(e){const t=e.prototype,i=Symbol("__selected__"),n=Symbol("__selectedClass__"),s=Symbol("__initialized__");Object.defineProperty(t,"selected",{get(){return!!this[i]},set(e){const t=this instanceof Element?this:this.element instanceof Element?this.element:void 0;if(!t)return void(this[i]=e);const s=this[n],a=this.getPropertiesValue?.(null,"defaultSelectedClass","selected")??"selected";this[i]=e,this[n]=a,s&&s!==a&&ct(t).toggleClass(s,!1),ct(t).toggleClass(a,!!e)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"getPropertiesValue",{value:function(e,t,i){if(null!=e)return e;let n=this.constructor;for(;n;){const e=n.config?.[t];if(null!=e)return e;n=Object.getPrototypeOf(n)}return i},configurable:!0,enumerable:!1}),Object.defineProperty(t,"destroy",{value:function(){},configurable:!0,enumerable:!1}),Object.defineProperty(t,"initialized",{get:function(){return this[s]??!1},configurable:!0,enumerable:!1}),Object.defineProperty(t,"initialize",{value:function(){this[s]||(this.setupUIElements?.(),this.setupUILayout?.(),this.setupUIListeners?.(),this.setupChangedCallbacks?.(),this.mvc&&this.mvc instanceof I&&this.mvc.initialize(),V(this),this[s]=!0)},configurable:!0,enumerable:!1})}class Me{static config={};static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}mvc;constructor(e={}){this.mvc=new I({...e,element:this})}}Pe(Me),Oe(Me);let Ie=(()=>{let i,n,s,a,r,l,h,u,d,p,f,m=Me,g=[],b=[],y=[],v=[],k=[],E=[],S=[],_=[],w=[];return class C extends m{static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(m[Symbol.metadata]??null):void 0;i=[ue()],n=[ue()],s=[ue()],a=[ue()],r=[c()],l=[c()],h=[c()],u=[c()],d=[c()],p=[c()],f=[c()],t.__esDecorate(this,null,r,{kind:"setter",name:"keyEventsEnabled",static:!1,private:!1,access:{has:e=>"keyEventsEnabled"in e,set:(e,t)=>{e.keyEventsEnabled=t}},metadata:e},null,g),t.__esDecorate(this,null,l,{kind:"setter",name:"wheelEventsEnabled",static:!1,private:!1,access:{has:e=>"wheelEventsEnabled"in e,set:(e,t)=>{e.wheelEventsEnabled=t}},metadata:e},null,g),t.__esDecorate(this,null,h,{kind:"setter",name:"moveEventsEnabled",static:!1,private:!1,access:{has:e=>"moveEventsEnabled"in e,set:(e,t)=>{e.moveEventsEnabled=t}},metadata:e},null,g),t.__esDecorate(this,null,u,{kind:"setter",name:"mouseEventsEnabled",static:!1,private:!1,access:{has:e=>"mouseEventsEnabled"in e,set:(e,t)=>{e.mouseEventsEnabled=t}},metadata:e},null,g),t.__esDecorate(this,null,d,{kind:"setter",name:"touchEventsEnabled",static:!1,private:!1,access:{has:e=>"touchEventsEnabled"in e,set:(e,t)=>{e.touchEventsEnabled=t}},metadata:e},null,g),t.__esDecorate(this,null,p,{kind:"setter",name:"clickEventEnabled",static:!1,private:!1,access:{has:e=>"clickEventEnabled"in e,set:(e,t)=>{e.clickEventEnabled=t}},metadata:e},null,g),t.__esDecorate(this,null,f,{kind:"setter",name:"dragEventEnabled",static:!1,private:!1,access:{has:e=>"dragEventEnabled"in e,set:(e,t)=>{e.dragEventEnabled=t}},metadata:e},null,g),t.__esDecorate(null,null,i,{kind:"field",name:"keyController",static:!1,private:!1,access:{has:e=>"keyController"in e,get:e=>e.keyController,set:(e,t)=>{e.keyController=t}},metadata:e},b,y),t.__esDecorate(null,null,n,{kind:"field",name:"wheelController",static:!1,private:!1,access:{has:e=>"wheelController"in e,get:e=>e.wheelController,set:(e,t)=>{e.wheelController=t}},metadata:e},v,k),t.__esDecorate(null,null,s,{kind:"field",name:"pointerController",static:!1,private:!1,access:{has:e=>"pointerController"in e,get:e=>e.pointerController,set:(e,t)=>{e.pointerController=t}},metadata:e},E,S),t.__esDecorate(null,null,a,{kind:"field",name:"dispatchController",static:!1,private:!1,access:{has:e=>"dispatchController"in e,get:e=>e.dispatchController,set:(e,t)=>{e.dispatchController=t}},metadata:e},_,w),e&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e})}static managers=[];static get instance(){return C.managers.length>0?C.managers[0]:new C}static get allManagers(){return[...this.managers]}static set allManagers(e){this.managers=e}keyController=(t.__runInitializers(this,g),t.__runInitializers(this,b,void 0));wheelController=(t.__runInitializers(this,y),t.__runInitializers(this,v,void 0));pointerController=(t.__runInitializers(this,k),t.__runInitializers(this,E,void 0));dispatchController=(t.__runInitializers(this,S),t.__runInitializers(this,_,void 0));constructor(e={}){super(),t.__runInitializers(this,w),this.mvc.generate({model:pe,controllers:[ye,Ee,_e,Ce],handlers:[Te]}),C.managers.push(this),this.model.authorizeEventScaling=e.authorizeEventScaling,this.model.scaleEventPosition=e.scaleEventPosition,this.model.state.enabled=e.enabled??!0,this.model.state.preventDefaultMouse=e.preventDefaultMouse??!0,this.model.state.preventDefaultTouch=e.preventDefaultTouch??!0,this.model.state.preventDefaultWheel=e.preventDefaultWheel??!0,this.unlock(),this.model.moveThreshold=e.moveThreshold||10,this.model.longPressDuration=e.longPressDuration||500,e.disableKeyEvents||(this.keyEventsEnabled=!0),e.disableWheelEvents||(this.wheelEventsEnabled=!0),e.disableMouseEvents||(this.mouseEventsEnabled=!0),e.disableTouchEvents||(this.touchEventsEnabled=!0),e.disableDragEvents||(this.dragEventEnabled=!0),e.disableClickEvents||(this.clickEventEnabled=!0),e.disableMoveEvent||(this.moveEventsEnabled=!0),document.addEventListener("pointerdown",this.pointerController.pointerDown,{passive:!1}),document.addEventListener("pointermove",this.pointerController.pointerMove,{passive:!1}),document.addEventListener("pointerup",this.pointerController.pointerUp,{passive:!1}),document.addEventListener("pointercancel",this.pointerController.pointerCancel,{passive:!1}),this.dispatchController.setupCustomDispatcher("pointerdown")}get inputDevice(){return this.model.inputDevice}get onInputDeviceChange(){return this.model.onInputDeviceChange}get currentClick(){return this.model.currentClick}get currentKeys(){return this.model.currentKeys}get onToolChange(){return this.model.onToolChange}get authorizeEventScaling(){return this.model.authorizeEventScaling}set authorizeEventScaling(e){this.model.authorizeEventScaling=e}get scaleEventPosition(){return this.model.scaleEventPosition}set scaleEventPosition(e){this.model.scaleEventPosition=e}get moveThreshold(){return this.model.moveThreshold}set moveThreshold(e){this.model.moveThreshold=e}get longPressDuration(){return this.model.longPressDuration}set longPressDuration(e){this.model.longPressDuration=e}set keyEventsEnabled(e){e?(document.addEventListener("keydown",this.keyController.keyDown),document.addEventListener("keyup",this.keyController.keyUp)):(document.removeEventListener("keydown",this.keyController.keyDown),document.removeEventListener("keyup",this.keyController.keyUp)),this.applyAndHookEvents(L,R,e)}set wheelEventsEnabled(e){e?document.body.addEventListener("wheel",this.wheelController.wheel,{passive:!1}):document.body.removeEventListener("wheel",this.wheelController.wheel),this.applyAndHookEvents(G,q,e)}set moveEventsEnabled(e){this.applyAndHookEvents(H,U,e)}set mouseEventsEnabled(e){}set touchEventsEnabled(e){}set clickEventEnabled(e){this.applyAndHookEvents(W,K,e)}set dragEventEnabled(e){this.applyAndHookEvents($,Y,e)}lock(e,t){this.unlock(),this.model.lockState.lockOrigin=e;for(const e in t)this.model.lockState[e]=t[e]}unlock(){const e=this.model.state,t=this.model.lockState;t.enabled=e.enabled,t.preventDefaultMouse=e.preventDefaultMouse,t.preventDefaultTouch=e.preventDefaultTouch,t.preventDefaultWheel=e.preventDefaultWheel,t.lockOrigin=document.body}get enabled(){return this.model.state.enabled&&this.model.lockState.enabled}set enabled(e){this.model.state.enabled=e}get preventDefaultWheel(){return this.model.state.preventDefaultWheel&&this.model.lockState.preventDefaultWheel}set preventDefaultWheel(e){this.model.state.preventDefaultWheel=e}get preventDefaultMouse(){return this.model.state.preventDefaultMouse&&this.model.lockState.preventDefaultMouse}set preventDefaultMouse(e){this.model.state.preventDefaultMouse=e}get preventDefaultTouch(){return this.model.state.preventDefaultTouch&&this.model.lockState.preventDefaultTouch}set preventDefaultTouch(e){this.model.state.preventDefaultTouch=e}get toolsArray(){const e=[];for(const t of this.model.tools.values())e.push(...t.toArray());return e}getCurrentTool(e=this.model.currentClick){return this.model.currentTools.get(e)}getCurrentTools(e=this.model.currentClick){return this.getToolsByName(this.getCurrentToolName(e))}getCurrentToolName(e=this.model.currentClick){return this.getToolName(this.getCurrentTool(e))}getToolName(e){for(const[t,i]of this.model.tools.entries())if(i.has(e))return t}getSimilarTools(e){for(const[t,i]of this.model.tools.entries())if(i.has(e))return i.toArray();return[]}getToolsByName(e){return this.model.tools.get(e)?.toArray()||[]}getToolByName(e,t){const i=this.getToolsByName(e);return t?i?.find(t):i?.[0]}getToolsByKey(e){const t=this.model.mappedKeysToTool.get(e);return t?this.getToolsByName(t):[]}getToolByKey(e,t){const i=this.getToolsByKey(e);return t?i?.find(t):i?.[0]}addTool(e,t,i){this.model.tools.has(e)||this.model.tools.set(e,new we);const n=this.model.tools.get(e);n.has(t)||n.add(t),i&&this.model.mappedKeysToTool.set(i,e)}setTool(t,i,n={}){if(!o(t)&&!ct(t).isTool(this))return;null==n.select&&(n.select=!0),null==n.activate&&(n.activate=!0),null==n.setAsNoAction&&(n.setAsNoAction=i==e.ClickMode.left);const s=this.model.currentTools.get(i);if(s){if(s===t)return;this.getSimilarTools(s).forEach(e=>{n.select&&this.model.utils.selectTool(e,!1),n.activate&&this.model.utils.activateTool(e,this.getToolName(s),!1)})}this.model.currentTools.set(i,t),n.setAsNoAction&&this.model.currentTools.set(e.ClickMode.none,t),this.getSimilarTools(t).forEach(e=>{n.activate&&this.model.utils.activateTool(e,this.getToolName(t),!0),n.select&&this.model.utils.selectTool(e,!0)}),this.onToolChange.fire(s,t,i)}setToolByKey(t){const i=this.model.mappedKeysToTool.get(t);return!!i&&(this.setTool(this.getToolByName(i),e.ClickMode.key,{select:!1}),!0)}setupCustomDispatcher(e){return this.dispatchController.setupCustomDispatcher(e)}applyAndHookEvents(e,t,i){this.model.utils.applyEventNames(i?e:t);for(const t in e)i?this.dispatchController.setupCustomDispatcher(t):this.dispatchController.removeCustomDispatcher(t)}destroy(){return this.keyEventsEnabled=!1,this.wheelEventsEnabled=!1,this.mouseEventsEnabled=!1,this.touchEventsEnabled=!1,this.dragEventEnabled=!1,this.clickEventEnabled=!1,this.onToolChange.clear(),this}}})();const xe=new class{dataMap=new WeakMap;data(e){return e instanceof h&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}getBoundListenersSet(e){let t=this.data(e).boundListeners;return t||(t=new Set,this.data(e).boundListeners=t),t}getPreventDefaultListeners(e){let t=this.data(e).preventDefaultListeners;return t||(t={},this.data(e).preventDefaultListeners=t),t}bypassManager(e,t,i){e instanceof h&&(e=e.element),e&&("boolean"==typeof i?t.lock(e,{enabled:i,preventDefaultWheel:i,preventDefaultMouse:i,preventDefaultTouch:i}):t.lock(e,{enabled:i.enabled??!1,preventDefaultWheel:i.preventDefaultWheel??!1,preventDefaultMouse:i.preventDefaultMouse??!1,preventDefaultTouch:i.preventDefaultTouch??!1}))}getBoundListeners(e,t,i,n,s=Ie.instance){return e instanceof h&&(e=e.element),e?(n||(n={}),[...this.getBoundListenersSet(e)].filter(e=>e.type===t&&e.manager===s&&e.toolName===i).filter(e=>{if(!n)return!0;for(const[t,i]of Object.entries(n))if(e.options?.[t]!==i)return!1;return!0})):[]}};function Ae(){Object.defineProperty(h.prototype,"boundListeners",{get:function(){return xe.getBoundListenersSet(this)},configurable:!0,enumerable:!0}),Object.defineProperty(h.prototype,"bypassManagerOn",{get:function(){return xe.data(this).bypassCallback},set:function(e){xe.data(this).bypassCallback=e},configurable:!0,enumerable:!0}),h.prototype.onTool=function(e,t,i,n,s=Ie.instance){if(this.hasToolListener(e,t,i,s))return this;return s.setupCustomDispatcher?.(e),xe.getBoundListenersSet(this).add({target:this,type:e,toolName:t,listener:i,bundledListener:e=>i(e,this),options:n,manager:s}),this},h.prototype.on=function(e,t,i,n=Ie.instance){return this.onTool(e,void 0,t,i,n)},h.prototype.executeAction=function(e,t,i,n,s=Ie.instance){if(!e)return!1;n||(n={});const a=t??s.getCurrentToolName();this.bypassManagerOn&&xe.bypassManager(this,s,this.bypassManagerOn(i));const r=new Set,o=(t,a)=>{const o=t instanceof h?t:ct(t),l=xe.getBoundListenersSet(t),c=[...xe.getBoundListeners(t,e,a,n,s)];if(0===c.length)return!1;let u=!1;for(const e of c)if(!r.has(e))try{e.listener(i,o)&&(u=!0)}finally{r.add(e),e.options?.once&&l.delete(e)}return u};if(a&&o(this,a))return!0;if(!n.capture&&a&&!this.isToolIgnored(a,e,s)&&this.applyTool(a,e,i,s))return!0;const l=this.getEmbeddedToolTarget(s),c=this.getToolNames(s);if(l&&c.length>0){let t=!1;for(const e of c)o(l,e)&&(t=!0);if(t)return!0;const a=ct(l);if(!n.capture)for(const n of c)!a.isToolIgnored(n,e,s)&&ct(l).applyTool(n,e,i,s)&&(t=!0);if(t)return!0}return o(this,void 0)},h.prototype.hasListener=function(e,t,i=Ie.instance){return this.hasToolListener(e,void 0,t,i)},h.prototype.hasToolListener=function(e,t,i,n=Ie.instance){return xe.getBoundListeners(this,e,t,void 0,n).filter(e=>e.listener===i).length>0},h.prototype.hasListenersByType=function(e,t,i=Ie.instance){return xe.getBoundListeners(this,e,t,void 0,i).length>0},h.prototype.removeListener=function(e,t,i=Ie.instance){return this.removeToolListener(e,void 0,t,i)},h.prototype.removeToolListener=function(e,t,i,n=Ie.instance){const s=xe.getBoundListenersSet(this);return xe.getBoundListeners(this,e,t,void 0,n).filter(e=>e.listener===i).forEach(e=>{e.target.removeEventListener(e.type,e.bundledListener,e.options),s.delete(e)}),this},h.prototype.removeListenersByType=function(e,t,i=Ie.instance){const n=xe.getBoundListenersSet(this);return xe.getBoundListeners(this,e,t,void 0,i).forEach(e=>{e.target.removeEventListener(e.type,e.bundledListener,e.options),n.delete(e)}),this},h.prototype.removeAllListeners=function(e=Ie.instance){const t=this.boundListeners;return[...t].filter(t=>t.manager===e).forEach(e=>{e.target.removeEventListener(e.type,e.bundledListener,e.options),t.delete(e)}),this},h.prototype.preventDefault=function(e){e||(e={});const t=e.manager??Ie.instance,i=e.types??se,n=e.phase??"capture",s=e.stop??!1;xe.data(this.element).preventDefaultOn=e.preventDefaultOn??xe.data(this.element).preventDefaultOn??(()=>!0);const a=xe.getPreventDefaultListeners(this);if(e.clearPreviousListeners)for(const[e,t]of Object.entries(a))this.removeListener(e,t),delete a[e];const r=new Set(ae);for(const e of new Set(i)){const i=t=>!!xe.data(this.element).preventDefaultOn(e,t)&&(t.preventDefault?.(),"immediate"===s?t.stopImmediatePropagation?.():"stop"===s&&t.stopPropagation?.(),!0);a[e]=i;const o={};"capture"===n&&(o.capture=!0),r.has(e)&&(o.passive=!1),this.on(e,i,o,t)}return this}}const je=new class{dataMap=new WeakMap;data(e){return e instanceof h&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}setStyle(e,t,i,n=!1,s=!0){if(n)return void(e.element.style[t]=i.toString());let a=this.data(e.element).pendingStyles;a&&"object"==typeof a||(a={},this.data(e.element).pendingStyles=a),a[t]=i,s&&this.applyStyles(e)}applyStyles(e){const t=this.data(e.element).pendingStyles;t&&"object"==typeof t&&requestAnimationFrame(()=>{for(const i in t)"cssText"==i?e.element.style.cssText+=";"+t.cssText:e.element.style[i]=t[i];this.data(e.element).pendingStyles={}})}};function Be(){Object.defineProperty(h.prototype,"closestRoot",{get:function(){let e=this.element;for(;e;){if(e instanceof Element&&e.shadowRoot)return e.shadowRoot;e=e.parentElement}return document.head},configurable:!1,enumerable:!0}),h.prototype.setStyle=function(e,t,i=!1){return e&&null!=t&&(this.element instanceof HTMLElement||this.element instanceof SVGElement)?(je.setStyle(this,e,t,i),this):this},h.prototype.appendStyle=function(e,t,i=", ",n=!1){if(!e||null==t)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;const s=this.element.style[e]||"";return i=s.length>0?i:"",je.setStyle(this,e,s+i+t,n),this},h.prototype.setStyles=function(e,t=!1){if(!e||"number"==typeof e)return this;if(!(this.element instanceof HTMLElement||this.element instanceof SVGElement))return this;let i={};return"object"==typeof e?i=e:"string"==typeof e&&e.split(";").forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());t&&n&&(i[t]=n)}),Object.entries(i).forEach(([e,i])=>je.setStyle(this,e,i,t,!1)),t||je.applyStyles(this),this}}const Ne=new class{elements=new WeakMap;tools=new WeakMap;getOrCreate(e,t,i){let n=e.get(t);return n||(n=i(),e.set(t,n)),n}getElementData(e,t){e instanceof h&&(e=e.element);const i=this.getOrCreate(this.elements,e,()=>new WeakMap);return this.getOrCreate(i,t,()=>({tools:new Set,ignoreAllTools:!1,ignoredTools:new Map,activationDelegates:new Map,deactivationDelegates:new Map}))}getToolsData(e,t){const i=this.getOrCreate(this.tools,e,()=>new Map);return this.getOrCreate(i,t,()=>({behaviors:new Map}))}getActivationDelegate(e,t,i){const n=this.getElementData(e,i).activationDelegates;return n.get(t)||n.set(t,new A),n.get(t)}getDeactivationDelegate(e,t,i){const n=this.getElementData(e,i).deactivationDelegates;return n.get(t)||n.set(t,new A),n.get(t)}saveTool(e,t,i){e instanceof h&&(e=e.element),e&&this.getElementData(e,i).tools.add(t)}getToolNames(e,t){return e instanceof h&&(e=e.element),e?[...this.getElementData(e,t).tools]:[]}setEmbeddedToolTarget(e,t,i){t instanceof h&&(t=t.element),t&&(e instanceof h&&(e=e.element),e&&(this.getElementData(e,i).embeddedTarget=t))}getEmbeddedToolTarget(e,t){if(e instanceof h&&(e=e.element),e)return this.getElementData(e,t).embeddedTarget}addToolBehavior(e,t,i,n){const s=this.getToolsData(n,e).behaviors;this.getOrCreate(s,t,()=>new Set).add(i)}getToolBehaviors(e,t,i){const n=this.getToolsData(i,e).behaviors;return[...this.getOrCreate(n,t,()=>new Set)]}removeToolBehaviors(e,t,i){const n=this.getToolsData(i,e).behaviors;this.getOrCreate(n,t,()=>new Set).clear()}clearToolBehaviors(e){this.getOrCreate(this.tools,e,()=>new Map).clear()}ignoreTool(e,t,i,n,s){const a=this.getElementData(e,s).ignoredTools;if(i){const e=a.get(t);if(!n)return void(e instanceof Set&&e.delete(i));e instanceof Set||a.set(t,new Set),a.get(t).add(i)}else n?a.set(t,"all"):a.delete(t)}isToolIgnored(e,t,i,n){const s=this.getElementData(e,n).ignoredTools?.get(t);return!!s&&("all"===s||!i||s.has(i))}};function ze(){h.prototype.makeTool=function(t,i){return t?(i||(i={}),i.manager||(i.manager=Ie.instance),i.manager.addTool(t,this.element,i.key),i.customActivation&&"function"==typeof i.customActivation?i.customActivation(this,i.manager):(i.activationEvent??=J.click,i.clickMode??=e.ClickMode.left,this.on(i.activationEvent,()=>(i.manager.setTool(this.element,i.clickMode),!0),void 0,i.manager)),Ne.saveTool(this,t,i.manager),i.onActivate&&Ne.getActivationDelegate(this,t,i.manager).add(i.onActivate),i.onDeactivate&&Ne.getDeactivationDelegate(this,t,i.manager).add(i.onDeactivate),this):this},h.prototype.isTool=function(e=Ie.instance){return Ne.getToolNames(this.element,e).length>0},h.prototype.getToolNames=function(e=Ie.instance){return Ne.getToolNames(this.element,e)},h.prototype.getToolName=function(e=Ie.instance){const t=Ne.getToolNames(this.element,e);if(t.length>0)return t[0]},h.prototype.onToolActivate=function(e,t=Ie.instance){return e||(e=this.getToolName(t)),Ne.getActivationDelegate(this,e,t)},h.prototype.onToolDeactivate=function(e,t=Ie.instance){return e||(e=this.getToolName(t)),Ne.getDeactivationDelegate(this,e,t)},h.prototype.addToolBehavior=function(e,t,i=this.getToolName(),n=Ie.instance){return e&&i&&(n.setupCustomDispatcher?.(e),Ne.addToolBehavior(i,e,t,n)),this},h.prototype.hasToolBehavior=function(e,t=this.getToolName(),i=Ie.instance){return!(!e||!t)&&Ne.getToolBehaviors(t,e,i).length>0},h.prototype.removeToolBehaviors=function(e,t=this.getToolName(),i=Ie.instance){return e&&t&&Ne.removeToolBehaviors(t,e,i),this},h.prototype.clearToolBehaviors=function(e=Ie.instance){return Ne.clearToolBehaviors(e),this},h.prototype.embedTool=function(e,t=Ie.instance){return this.isTool(t)&&Ne.setEmbeddedToolTarget(this.element,e,t),this},h.prototype.isEmbeddedTool=function(e=Ie.instance){return!!Ne.getEmbeddedToolTarget(this.element,e)},h.prototype.getEmbeddedToolTarget=function(e=Ie.instance){return Ne.getEmbeddedToolTarget(this.element,e)},h.prototype.applyTool=function(e,t,i,n=Ie.instance){let s=!1;const a=Ne.getToolBehaviors(e,t,n),r={};return r.embeddedTarget=Ne.getEmbeddedToolTarget(this.element,n),r.isEmbedded=!!r.embeddedTarget,a.forEach(e=>{e(i,this.element,r)&&(s=!0)}),s},h.prototype.ignoreTool=function(e,t,i=!0,n=Ie.instance){return Ne.ignoreTool(this.element,e,t,i,n),this},h.prototype.ignoreAllTools=function(e=!0,t=Ie.instance){return Ne.getElementData(this.element,t).ignoreAllTools=e,this},h.prototype.isToolIgnored=function(e,t,i=Ie.instance){return!!Ne.getElementData(this.element,i).ignoreAllTools||Ne.isToolIgnored(this.element,e,t,i)}}const Ve=new class{dataMap=new WeakMap;data(e){return e instanceof h&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{substrates:new Map,onChange:new A}),this.dataMap.get(e)):{}}createSubstrate(e,t){const i={objects:e instanceof Element?e.children:e.childNodes,temporaryMetadata:new WeakMap,persistentMetadata:new WeakMap,onActivate:new A,onDeactivate:new A,solvers:new Set};return this.data(e).substrates.set(t,i),i}setCurrent(e,t){return!!this.getSubstrates(e).includes(t)&&(this.data(e).current=t,!0)}getSubstrateData(e,t){return this.data(e).substrates.get(t)}getSubstrates(e){return[...this.data(e).substrates.keys()]}getPersistentMetadata(e,t,i){const n=this.getSubstrateData(e,t);if(!n||!n.persistentMetadata)return{};let s=n.persistentMetadata.get(i);return s||(s={},n.persistentMetadata.set(i,s)),s}setPersistentMetadata(e,t,i,n){const s=this.getSubstrateData(e,t);s&&s.persistentMetadata&&s.persistentMetadata.set(i,n)}getTemporaryMetadata(e,t,i){const n=this.getSubstrateData(e,t);if(!n||!n.temporaryMetadata)return;let s=n.temporaryMetadata.get(i);return s||(s={},n.temporaryMetadata.set(i,s)),s}setTemporaryMetadata(e,t,i,n){const s=this.getSubstrateData(e,t);s&&s.temporaryMetadata&&s.temporaryMetadata.set(i,n)}};function Fe(){h.prototype.makeSubstrate=function(e,t){return Ve.createSubstrate(this,e),t?.onActivate&&this.onSubstrateActivate(e).add(t.onActivate),t?.onDeactivate&&this.onSubstrateDeactivate(e).add(t.onDeactivate),this.currentSubstrate||(this.currentSubstrate=e),this},Object.defineProperty(h.prototype,"substrates",{get:function(){return Ve.getSubstrates(this.element)},configurable:!1,enumerable:!0}),Object.defineProperty(h.prototype,"currentSubstrate",{get:function(){return Ve.data(this).current},set:function(e){if(!e)return;const t=this.currentSubstrate;Ve.setCurrent(this,e)&&this.onSubstrateChange.fire(t,e)},configurable:!1,enumerable:!0}),Object.defineProperty(h.prototype,"onSubstrateChange",{get:function(){return Ve.data(this).onChange},configurable:!1,enumerable:!0}),h.prototype.onSubstrateActivate=function(e=this.currentSubstrate){return Ve.getSubstrateData(this,e)?.onActivate??new A},h.prototype.onSubstrateDeactivate=function(e=this.currentSubstrate){return Ve.getSubstrateData(this,e)?.onDeactivate??new A},h.prototype.getSubstrateObjectList=function(e=this.currentSubstrate){const t=new Set;return e?(Array.from(Ve.getSubstrateData(this,e).objects).forEach(i=>{Ve.getPersistentMetadata(this,e,i).ignored||t.add(i)}),t):t},h.prototype.setSubstrateObjectList=function(e,t=this.currentSubstrate){return e&&t?(Ve.getSubstrateData(this,t).objects=e,this):this},h.prototype.addObjectToSubstrate=function(e,t=this.currentSubstrate){if(!e||!t)return this;Ve.getPersistentMetadata(this,t,e).ignored=!1;const i=Ve.getSubstrateData(this,t).objects;if(i instanceof HTMLCollection||i instanceof NodeList)return this;try{i.has(e)||i.add(e)}catch{}return this},h.prototype.removeObjectFromSubstrate=function(e,t=this.currentSubstrate){if(!e||!t)return this;Ve.getPersistentMetadata(this,t,e).ignored=!0;const i=Ve.getSubstrateData(this,t).objects;return i instanceof Set&&i.delete(e),this},h.prototype.hasObjectInSubstrate=function(e,t=this.currentSubstrate){if(!e||!t)return!1;const i=this.getSubstrateObjectList(t);for(const t of i)if(t===e)return!0;return!1},h.prototype.wasObjectProcessedBySubstrate=function(e,t=this.currentSubstrate){return!(!e||!t)&&!!Ve.getTemporaryMetadata(this,t,e)?.processed},h.prototype.addSolver=function(e,t=this.currentSubstrate){return Ve.getSubstrateData(this,t).solvers?.add(e),this},h.prototype.removeSolver=function(e,t=this.currentSubstrate){return Ve.getSubstrateData(this,t).solvers?.delete(e),this},h.prototype.clearSolvers=function(e=this.currentSubstrate){return Ve.getSubstrateData(this,e).solvers?.clear(),this},h.prototype.resolveSubstrate=function(e={},t=this.currentSubstrate){if(e||(e={}),e.substrate=e.substrate??t,!e.substrate)return this;e.manager||(e.manager=Ie.instance),e.eventOptions||(e.eventOptions={});const i=Ve.getSubstrateData(this,e.substrate);return i?(i.solvers?.forEach(t=>{let n;i.temporaryMetadata=new WeakMap,e.eventTarget&&(i.temporaryMetadata.set(e.eventTarget,{processed:!0,isMainTarget:!0}),t({...e,target:e.eventTarget}));do{n=Array.from(this.getSubstrateObjectList(e.substrate)).find(e=>!i.temporaryMetadata.get(e)?.processed),n&&(i.temporaryMetadata.set(n,{processed:!0}),t({...e,target:n}))}while(n)}),this):this}}const Le=new WeakMap;function Re(e){if(Le.has(e))return Le.get(e);let t,i,n=!1;const s=function(...s){if(n)return t;if(i)return i;try{const a=e.apply(this,s);return a instanceof Promise?(i=a.then(e=>(t=e,n=!0,i=null,e)).catch(e=>{throw i=null,e}),i):(t=a,n=!0,a)}catch(e){throw e}};return Le.set(e,s),s}function We(e,...t){if(t.length<1)return!0;for(const i of t)if(e==i)return!0;return!1}function Ke(e,...t){if(t.length<1)return!0;for(const i of t){let t=!1;for(const n of e)i==n&&(t=!0);if(!t)return!1}return!0}function He(e,t,i=0){return e<i&&(e=i),e>t&&(e=t),e}function Ue(e,t=0){for(;e<0;)e+=t;for(;e>=t;)e-=t;return e}let $e=(()=>{let e,i,n,s,a,o,l,h,u,d,p,f,m,g,b,y=[];return class v{static{const r="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[c()],i=[c()],n=[c()],s=[c()],a=[c()],o=[c()],l=[c()],h=[c()],u=[c()],d=[c()],p=[c()],f=[c()],m=[c()],g=[c()],b=[c()],t.__esDecorate(this,null,e,{kind:"setter",name:"enabled",static:!1,private:!1,access:{has:e=>"enabled"in e,set:(e,t)=>{e.enabled=t}},metadata:r},null,y),t.__esDecorate(this,null,i,{kind:"setter",name:"propertiesEnabled",static:!1,private:!1,access:{has:e=>"propertiesEnabled"in e,set:(e,t)=>{e.propertiesEnabled=t}},metadata:r},null,y),t.__esDecorate(this,null,n,{kind:"setter",name:"stylesEnabled",static:!1,private:!1,access:{has:e=>"stylesEnabled"in e,set:(e,t)=>{e.stylesEnabled=t}},metadata:r},null,y),t.__esDecorate(this,null,s,{kind:"setter",name:"classesEnabled",static:!1,private:!1,access:{has:e=>"classesEnabled"in e,set:(e,t)=>{e.classesEnabled=t}},metadata:r},null,y),t.__esDecorate(this,null,a,{kind:"setter",name:"replaceWithEnabled",static:!1,private:!1,access:{has:e=>"replaceWithEnabled"in e,set:(e,t)=>{e.replaceWithEnabled=t}},metadata:r},null,y),t.__esDecorate(this,null,o,{kind:"setter",name:"transitionEnabled",static:!1,private:!1,access:{has:e=>"transitionEnabled"in e,set:(e,t)=>{e.transitionEnabled=t}},metadata:r},null,y),t.__esDecorate(this,null,l,{kind:"setter",name:"properties",static:!1,private:!1,access:{has:e=>"properties"in e,set:(e,t)=>{e.properties=t}},metadata:r},null,y),t.__esDecorate(this,null,h,{kind:"setter",name:"styles",static:!1,private:!1,access:{has:e=>"styles"in e,set:(e,t)=>{e.styles=t}},metadata:r},null,y),t.__esDecorate(this,null,u,{kind:"setter",name:"classes",static:!1,private:!1,access:{has:e=>"classes"in e,set:(e,t)=>{e.classes=t}},metadata:r},null,y),t.__esDecorate(this,null,d,{kind:"setter",name:"replaceWith",static:!1,private:!1,access:{has:e=>"replaceWith"in e,set:(e,t)=>{e.replaceWith=t}},metadata:r},null,y),t.__esDecorate(this,null,p,{kind:"setter",name:"transitionProperties",static:!1,private:!1,access:{has:e=>"transitionProperties"in e,set:(e,t)=>{e.transitionProperties=t}},metadata:r},null,y),t.__esDecorate(this,null,f,{kind:"setter",name:"transitionDuration",static:!1,private:!1,access:{has:e=>"transitionDuration"in e,set:(e,t)=>{e.transitionDuration=t}},metadata:r},null,y),t.__esDecorate(this,null,m,{kind:"setter",name:"transitionTimingFunction",static:!1,private:!1,access:{has:e=>"transitionTimingFunction"in e,set:(e,t)=>{e.transitionTimingFunction=t}},metadata:r},null,y),t.__esDecorate(this,null,g,{kind:"setter",name:"transitionDelay",static:!1,private:!1,access:{has:e=>"transitionDelay"in e,set:(e,t)=>{e.transitionDelay=t}},metadata:r},null,y),t.__esDecorate(this,null,b,{kind:"setter",name:"transition",static:!1,private:!1,access:{has:e=>"transition"in e,set:(e,t)=>{e.transition=t}},metadata:r},null,y),r&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})}timeRegex=(t.__runInitializers(this,y),/^(\d+(?:\.\d+)?)(ms|s)?$/i);attachedObjects=[];_states;values;constructor(e){this.enable({global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0}),this.properties=e.properties||{},this.classes=e.classes||{},this.styles=e.styles||{},this.replaceWith=e.replaceWith||{},this.transition=e.transition??"all 0s linear 0s",e.transitionProperties&&(this.transitionProperties=e.transitionProperties),void 0!==e.transitionDuration&&(this.transitionDuration=e.transitionDuration),e.transitionTimingFunction&&(this.transitionTimingFunction=e.transitionTimingFunction),void 0!==e.transitionDelay&&(this.transitionDelay=e.transitionDelay),e.transition||e.transitionProperties||e.transitionDuration||e.transitionTimingFunction||e.transitionDelay||(this.transitionEnabled=!1),e.states&&(this.states=e.states),e.attachedObjects&&this.attachAll(...e.attachedObjects)}attach(e,t,i){const n=this.getData(e);if(n&&t&&(n.onSwitch=t),!n)return this.attachObject(e,i,t),this}attachAll(...e){return e.forEach(e=>{this.getData(e)||this.attachObject(e)}),this}attachAllAt(e,...t){return t.forEach((t,i)=>{this.getData(t)||this.attachObject(t,e+i)}),this}detach(...e){return e.forEach(e=>{const t=this.getData(e);t&&this.detachObject(t)}),this}attachObject(e,t,i){(null==t||isNaN(t))&&(t=this.attachedObjects.length),t<0&&(t=0);const n=this.generateNewData(e,i);return this.attachedObjects.splice(t,0,n),ct(e).reifects?.attach(this),n.lastState=this.stateOf(e),this.applyResolvedValues(n,!1,!0),n}detachObject(e){this.attachedObjects.splice(this.attachedObjects.indexOf(e),1)}getData(e){if(!e)return null;for(const t of this.attachedObjects){const i=this.getObject(t);if(i&&i==e)return t}return null}getObject(e){if(!e)return null;return e.object.deref()||null}get states(){return this._states}set states(e){this._states=e||this.getAllStates()}stateOf(e){if(!e)return;const t=this.getData(e);if(t){if(t.lastState)return t.lastState;if(!(e instanceof HTMLElement))return this.states[0];t.resolvedValues||this.processRawProperties(t);for(const i of this.states){if(!t.resolvedValues?.styles?.[i])continue;let n=!0;for(const[s,a]of Object.entries(t.resolvedValues.styles[i]))if(e.style[s]!=a){n=!1;break}if(n)return t.lastState=i,i}return this.states[0]}}getAllStates(){const e=[...this.states];for(const t of[this.properties,this.classes,this.styles,this.replaceWith])if("object"==typeof t)for(const i of Object.keys(t))e.includes(i)||e.push(i);return 0==e.length&&console.warn("No states found for this particular reifect:",this),e}parseState(e){if("boolean"!=typeof e)return this.states.includes(e)?e:this.states[0];for(const t of e?["true","on","in","enabled","shown"]:["false","off","out","disabled","hidden"])if(this.states.includes(t))return t;return this.states[0]}set enabled(e){this.refreshResolvedValues()}set propertiesEnabled(e){this.refreshProperties()}set stylesEnabled(e){this.refreshStyles()}set classesEnabled(e){this.refreshClasses()}set replaceWithEnabled(e){this.refreshReplaceWith()}set transitionEnabled(e){this.refreshTransition()}enable(e,t){if("boolean"==typeof e)this.enabled=e;else{if(!e)return;Object.entries(e).forEach(([e,t])=>{"global"==e?this.enabled=t:this[e+"Enabled"]=t})}}enableObject(e,t){const i=this.getData(e);if(i)if("boolean"==typeof t)i.enabled.global=t;else{if(!t)return;Object.entries(t).forEach(([e,t])=>i.enabled[e]=t)}}getObjectEnabledState(e){return this.getData(e)?.enabled}set properties(e){}set styles(e){}set classes(e){}set replaceWith(e){}set transitionProperties(e){}set transitionDuration(e){}set transitionTimingFunction(e){}set transitionDelay(e){}set transition(e){if(!e)return;const t="string"==typeof e?this.processTransitionString(e):this.processTransitionObject(e);void 0!==t.transitionProperties&&(this.transitionProperties=t.transitionProperties),void 0!==t.transitionDuration&&(this.transitionDuration=t.transitionDuration),void 0!==t.transitionDelay&&(this.transitionDelay=t.transitionDelay),void 0!==t.transitionTimingFunction&&(this.transitionTimingFunction=t.transitionTimingFunction)}processTransitionObject(e){const t={};for(const[i,n]of Object.entries(e)){if(!this.states.includes(i))continue;if("string"!=typeof n)continue;const e=this.processTransitionString(n);void 0!==e.transitionProperties&&(t.transitionProperties[i]=e.transitionProperties),void 0!==e.transitionDuration&&(t.transitionDuration[i]=e.transitionDuration),void 0!==e.transitionDelay&&(t.transitionDelay[i]=e.transitionDelay),void 0!==e.transitionTimingFunction&&(t.transitionTimingFunction[i]=e.transitionTimingFunction)}return t}processTransitionString(e){const t=e.trim().replace(/,/g," ").split(/\s+/).filter(e=>e.length>0),i={transitionProperties:[]};let n=0;for(;n<t.length&&!this.timeRegex.test(t[n]);)i.transitionProperties.push(t[n]),n++;if(n<t.length){const e=this.parseTime(t[n]);isNaN(e)||(i.transitionDuration=e),n++}if(n<t.length&&(i.transitionTimingFunction=t[n],n++),n<t.length){const e=this.parseTime(t[n]);isNaN(e)||(i.transitionDelay=e),n++}return i}getTransitionString(e,t=e.lastState){let i="";return e.resolvedValues.transitionProperties[t].forEach(n=>i+=", "+n+" "+(e.resolvedValues.transitionDuration[t]||0)+"s "+(e.resolvedValues.transitionTimingFunction[t]||"linear")+" "+(e.resolvedValues.transitionDelay[t]||0)+"s"),i.substring(2)}initialize(e,t,i){this.enabled&&(e=this.parseState(e),i=this.initializeOptions(i,t),this.getEnabledObjectsData(t,i).forEach(t=>{!i.recomputeProperties&&t.resolvedValues||this.processRawProperties(t,i.propertiesOverride),t.lastState=e,this.applyResolvedValues(t,!0,i?.applyStylesInstantly),t.onSwitch&&t.onSwitch(e,t.objectIndex,t.totalObjectCount,this.getObject(t))}))}apply(e,t,i){this.enabled&&(e=this.parseState(e),i=this.initializeOptions(i,t),this.getEnabledObjectsData(t,i).forEach(t=>{!i.recomputeProperties&&t.resolvedValues||this.processRawProperties(t,i.propertiesOverride),t.lastState=e,this.applyResolvedValues(t,!1,i?.applyStylesInstantly),t.onSwitch&&t.onSwitch(e,t.objectIndex,t.totalObjectCount,this.getObject(t))}))}toggle(e,t){if(!this.enabled)return;e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[];const i=this.getData(e[0])?.lastState,n=Ue(i?this.states.indexOf(i)+1:0,this.states.length);this.apply(this.states[n],e,t)}reloadFor(e){if(!this.enabled)return this;const t=this.getData(e);return t&&t.enabled&&t.enabled.global?(this.applyResolvedValues(t),this):this}reloadTransitionFor(e){if(!this.enabled||!this.transitionEnabled)return this;const t=this.getData(e);return t&&t.enabled&&t.enabled.global&&t.enabled.transition?(this.applyTransition(t,t.lastState),this):this}getEnabledObjectsData(e,t){if(!this.enabled)return console.warn("The reifier object you are trying to access is disabled."),[];e?e instanceof HTMLCollection?e=[...e]:Array.isArray(e)||(e=[e]):e=[],(t=this.initializeOptions(t,e)).attachObjects&&e.forEach(e=>this.attach(e)),t.executeForAll&&(e=[],this.attachedObjects.forEach(t=>{const i=t.object.deref();i&&e.push(i)}));const i=[];return e.forEach(e=>{const n=this.getData(e)||this.generateNewData(e);this.filterEnabledObjects(n)&&((t.recomputeIndices||null==n.objectIndex)&&(n.objectIndex=i.length),i.push(n))}),i.forEach(e=>{(t.recomputeIndices||null==e.totalObjectCount)&&(e.totalObjectCount=i.length)}),i}applyResolvedValues(e,t=!1,i=!1){if(this.applyStyles(e,e.lastState,i),!t){const t=ct(e.object.deref()).reifects;this.attachedObjects.includes(e)&&t?t.reloadTransitions():this.applyTransition(e,e.lastState)}this.applyReplaceWith(e,e.lastState),this.applyProperties(e,e.lastState),this.applyClasses(e,e.lastState)}refreshResolvedValues(){this.refreshProperties(),this.refreshStyles(),this.refreshClasses(),this.refreshReplaceWith(),this.refreshTransition()}applyProperties(e,t=e.lastState){if(!this.enabled||!this.propertiesEnabled)return;if(!e.enabled.global||!e.enabled.properties)return;const i=e.resolvedValues?.properties?.[t];if(!i)return;const n=e.object.deref();if(n)for(const[e,t]of Object.entries(i))if(e&&null!=t)try{n[e]=t}catch(i){console.error(`Unable to set property ${e} to ${t}: ${i.message}`)}}refreshProperties(){this.enabled&&this.propertiesEnabled&&this.attachedObjects.forEach(e=>this.applyProperties(e))}applyReplaceWith(e,t=e.lastState){if(!this.enabled||!this.replaceWithEnabled)return;if(!e.enabled.global||!e.enabled.replaceWith)return;const i=e.resolvedValues?.replaceWith?.[t];if(i)try{const t=e.object.deref();t&&t instanceof Node&&i instanceof Node&&t.parentNode?.replaceChild(i,t),e.object=new WeakRef(i)}catch(e){console.error(`Unable to replace object: ${e.message}`)}}refreshReplaceWith(){this.enabled&&this.replaceWithEnabled&&this.attachedObjects.forEach(e=>this.applyReplaceWith(e))}applyClasses(e,t=e.lastState){if(!this.enabled||!this.classesEnabled)return;if(!e.enabled.global||!e.enabled.classes)return;const i=e.resolvedValues?.classes;if(!i)return;const n=e.object.deref();if(n&&n instanceof Element)for(const[e,s]of Object.entries(i))ct(n).toggleClass(s,t==e)}refreshClasses(){this.enabled&&this.classesEnabled&&this.attachedObjects.forEach(e=>this.applyClasses(e))}applyStyles(e,t=e.lastState,i=!1){if(!this.enabled||!this.stylesEnabled)return;if(!e.enabled.global||!e.enabled.styles)return;if(!e.resolvedValues?.styles)return;const n=e.object.deref();n&&n instanceof Element&&ct(n).setStyles(e.resolvedValues.styles[t],i)}refreshStyles(){this.enabled&&this.stylesEnabled&&this.attachedObjects.forEach(e=>this.applyStyles(e))}applyTransition(e,t=e.lastState){if(!this.enabled||!this.transitionEnabled)return;if(!e.enabled.global||!e.enabled.transition)return;const i=e.object.deref();i&&i instanceof Element&&e.resolvedValues&&ct(i).appendStyle("transition",this.getTransitionString(e,t),", ",!0)}refreshTransition(){for(const e of this.attachedObjects){const t=ct(e.object?.deref()).reifects;t&&t.reloadTransitions()}}filterEnabledObjects(e){return!(!e.enabled||!e.enabled.global)||(console.warn("The reified properties instance you are trying to set on an object is disabled for this particular object."),!1)}processRawProperties(e,t){if(e.resolvedValues||(e.resolvedValues={properties:void 0,styles:void 0,classes:void 0,replaceWith:void 0,transitionProperties:void 0,transitionDuration:void 0,transitionTimingFunction:void 0,transitionDelay:void 0}),r(t))return;const i={properties:this.properties,styles:this.styles,classes:this.classes,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay,...t||{}};e.resolvedValues.properties={},this.states.forEach(t=>this.processRawPropertyForState(e,"properties",i.properties,t)),"transitionProperties"in i&&(e.resolvedValues.transitionProperties={},this.states.forEach(t=>this.processRawPropertyForState(e,"transitionProperties",i.transitionProperties,t)));for(const[t,n]of Object.entries(i))"transitionProperties"!=t&&"properties"!=t&&(e.resolvedValues[t]={},this.states.forEach(i=>this.processRawPropertyForState(e,t,n,i)))}generateNewData(e,t){return{object:new WeakRef(e),enabled:{global:!0,properties:!0,classes:!0,styles:!0,replaceWith:!0,transition:!0},lastState:this.stateOf(e),onSwitch:t}}initializeOptions(e,t){return t?t instanceof HTMLCollection?t=[...t]:Array.isArray(t)||(t=[t]):t=[],(e=e||{}).attachObjects=e.attachObjects??!0,e.executeForAll=e.executeForAll??0===t.length,e.recomputeIndices=e.recomputeIndices??0!==t.length,e.recomputeProperties=e.recomputeProperties??0!==t.length,e}clone(){return new v({states:this.states,properties:this.properties,classes:this.classes,styles:this.styles,replaceWith:this.replaceWith,transitionProperties:this.transitionProperties,transitionDuration:this.transitionDuration,transitionTimingFunction:this.transitionTimingFunction,transitionDelay:this.transitionDelay})}processRawPropertyForState(e,t,i,n){let s;const a=e.object.deref();if(a){if("function"==typeof i)s=i(n,e.objectIndex,e.totalObjectCount,a);else if("object"==typeof i&&Ke(this.states,...Object.keys(i))){const t=i[n];s="function"==typeof t?t(e.objectIndex,e.totalObjectCount,a):t}else s=i;if("properties"!=t&&"transitionProperties"!=t||"string"!=typeof s){if("styles"==t){if(null==e.resolvedValues.styles[n]&&(e.resolvedValues.styles[n]={}),"number"==typeof s)return void e.resolvedValues.transitionProperties[n].forEach(t=>e.resolvedValues.styles[n][t]=s);if("string"==typeof s){const t=s.split(";").map(e=>e.split(":").map(e=>e.trim()));if(1==t.length&&1==t[0].length)return void e.resolvedValues.transitionProperties[n].forEach(i=>e.resolvedValues.styles[n][i]=t[0][0])}}}else s=s.split(" ");e.resolvedValues[t][n]=s}}parseTime(e){const t=e.match(this.timeRegex);if(!t)return NaN;const i=parseFloat(t[1]);return"ms"===(t[2]?.toLowerCase()??"s")?i/1e3:i}}})();var Ye,Ge,qe,Xe,Je,Qe,Ze,et,tt,it;e.Direction=void 0,(Ye=e.Direction||(e.Direction={})).vertical="vertical",Ye.horizontal="horizontal",e.SideH=void 0,(Ge=e.SideH||(e.SideH={})).left="left",Ge.right="right",e.SideV=void 0,(qe=e.SideV||(e.SideV={})).top="top",qe.bottom="bottom",e.Side=void 0,(Xe=e.Side||(e.Side={})).top="top",Xe.bottom="bottom",Xe.left="left",Xe.right="right",e.InOut=void 0,(Je=e.InOut||(e.InOut={})).in="in",Je.out="out",e.OnOff=void 0,(Qe=e.OnOff||(e.OnOff={})).on="on",Qe.off="off",e.Open=void 0,(Ze=e.Open||(e.Open={})).open="open",Ze.closed="closed",e.Shown=void 0,(et=e.Shown||(e.Shown={})).visible="visible",et.hidden="hidden",e.AccessLevel=void 0,(tt=e.AccessLevel||(e.AccessLevel={})).public="public",tt.protected="protected",tt.private="private",e.Range=void 0,(it=e.Range||(e.Range={})).min="min",it.max="max";class nt{attachedNode;reifects;_enabled;constructor(e){this.attachedNode=e,this.reifects=[],this._enabled={},this.enabled=!0}attach(...e){return e.forEach(e=>{this.reifects.some(t=>t.deref()==e)||(this.reifects.push(new WeakRef(e)),e.attach(this.attachedNode))}),this}detach(...e){return e.forEach(e=>{const t=this.reifects.find(t=>t.deref()==e);t&&(this.reifects.splice(this.reifects.indexOf(t),1),e.detach(this.attachedNode))}),this}initialize(e,t,i){return e.initialize(t,this.attachedNode,i),this}apply(e,t,i){return e.apply(t,this.attachedNode,i),this}toggle(e,t){return e.toggle(this.attachedNode,t),this}clear(){this.attachedNode instanceof Node&&ct(this.attachedNode).setStyle("transition","",!0)}reload(){this.clear(),this.reifects.forEach(e=>e.deref()?.reloadFor(this.attachedNode))}reloadTransitions(){this.clear(),this.reifects.forEach(e=>e.deref()?.reloadTransitionFor(this.attachedNode))}get enabled(){return this._enabled}set enabled(e){if("boolean"==typeof e)this._enabled.global=e;else{if(!e)return;for(const[t,i]of Object.entries(e))this._enabled[t]=i}}getReifectEnabledState(e){return e.getObjectEnabledState(this.attachedNode)}enableReifect(e,t){e.enableObject(this.attachedNode,t)}}const st=new class{dataMap=new WeakMap;data(e){return e instanceof h&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}},at=new $e({states:[e.Shown.visible,e.Shown.hidden],styles:e=>`visibility: ${e}`});function rt(){Object.defineProperty(h.prototype,"reifects",{get:function(){if(!this.element)return;const e=st.data(this.element);return e.reifects||(e.reifects=new nt(this)),e.reifects},configurable:!1,enumerable:!0}),Object.defineProperty(h.prototype,"showTransition",{get:function(){if(!this.element)return;const e=st.data(this.element);return e.showTransition||(e.showTransition=at),e.showTransition},set:function(e){this.element&&(st.data(this.element).showTransition=e)},configurable:!0,enumerable:!0}),Object.defineProperty(h.prototype,"isShown",{get:function(){if(!this.element)return;const t=this.showTransition.stateOf(this);return t==e.Shown.visible||t!=e.Shown.hidden&&("none"!=this.element.style.display&&"hidden"!=this.element.style.visibility&&"0"!=this.element.style.opacity)},configurable:!1,enumerable:!0}),h.prototype.show=function(t,i={executeForAll:!1}){if(this.element)return this.showTransition.apply(t?e.Shown.visible:e.Shown.hidden,this.element,i),this}}const ot=new WeakMap;function lt(e){let t;if(ht(),e||(e="div"),"string"==typeof e)t=_({tag:e});else if("object"==typeof e){if(e instanceof h)return e;t=e instanceof Node?e:e.element&&"object"==typeof e.element?e.element:e}const i=ot.get(t);if(i)return i;const n=new h;return n.element=t,ot.set(t,n),n}function ct(e){return lt(e)}const ht=Re(function(e={}){e.excludeHierarchyFunctions||d(),e.excludeMiscFunctions||f(),e.excludeClassFunctions||g(),e.excludeElementFunctions||ne(),e.excludeEventFunctions||Ae(),e.excludeStyleFunctions||Be(),e.excludeToolFunctions||ze(),e.excludeSubstrateFunctions||Fe(),e.excludeReifectFunctions||rt()});function ut(e={}){return function(t,i){const{kind:s,name:a,static:r}=i,o=a,l=function(e){return Symbol(`__cache__${e}`)}(o),c=Symbol(`__cache__setup__${o}`),h=[],u=function(e=!0){if(!e)return;const t=this[l];if(t){t instanceof Map?t.clear():delete this[l];for(const e of h)clearTimeout(e);h.length=0}},d=function(){this[c]||(this[c]=!0,function(e,t,i,s,a,r,o){if(r.onEvent){const t="function"==typeof e?.addEventListener?e:document,i=Array.isArray(r.onEvent)?r.onEvent:String(r.onEvent).split(/\s+/).filter(Boolean);for(const e of i)ct(t).on(e,()=>o())}if(r.onFieldChange){const t=Array.isArray(r.onFieldChange)?r.onFieldChange:[r.onFieldChange];for(const i of t){const t="string"==typeof i?i:i.name;if(!t)continue;const s=n(e,t),a=e[t];if("function"==typeof a){const i=a;Object.defineProperty(e,t,{configurable:!0,enumerable:s?.enumerable??!0,writable:!0,value:function(...e){return o(),i.apply(this,e)}})}else{const i=()=>s?.get?s.get.call(e):a,n=i=>{s?.set?s.set.call(e,i):Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:i})};Object.defineProperty(e,t,{configurable:!0,enumerable:s?.enumerable??!0,get:()=>i(),set(e){o(),n(e)}})}}}if(r.onCallback){const t=setInterval(()=>{const t=r.onCallback.call(e);t instanceof Promise?t.then(e=>o(Boolean(e))):o(Boolean(t))},r.onCallbackFrequency??50);"function"==typeof e?.addEventListener&&e.addEventListener("destroy",()=>clearInterval(t),{once:!0})}}(this,0,0,0,0,e,u.bind(this)))};if("method"===s){const n=t;return i.addInitializer(function(){this[l]||(this[l]=new Map)}),function(...t){d.call(this);const i=this[l]??(this[l]=new Map),s=function(e){return e&&0!==e.length?JSON.stringify(e.map(e=>{if("function"==typeof e)return`function:${e.name}`;if(e&&"object"==typeof e)try{return JSON.stringify(Object.entries(e).sort())}catch{return"[[unserializable-object]]"}return void 0===e?"undefined":e})):"__no_args__"}(t);if(i.has(s))return i.get(s);const a=n.apply(this,t);if(i.set(s,a),e.timeout){const t=setTimeout(()=>i.delete(s),e.timeout);h.push(t)}if(e.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:e=>setTimeout(e,0))(()=>u.call(this))}return a}}if("getter"===s){const i=t;return function(){if(d.call(this),void 0===this[l]){if(this[l]=i.call(this),e.timeout){const t=setTimeout(()=>u.call(this),e.timeout);h.push(t)}if(e.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:e=>setTimeout(e,0))(()=>u.call(this))}}return this[l]}}if("accessor"===s){const i=t;return{get(){if(d.call(this),void 0===this[l]){const t=i.get?i.get.call(this):void 0;if(this[l]=t,e.timeout){const t=setTimeout(()=>u.call(this),e.timeout);h.push(t)}if(e.clearOnNextFrame){("function"==typeof requestAnimationFrame?requestAnimationFrame:e=>setTimeout(e,0))(()=>u.call(this))}}return this[l]},set(e){u.call(this),i.set&&i.set.call(this,e)},init:e=>e}}}}function dt(e){for(const t of Object.getOwnPropertySymbols(e))String(t).startsWith("Symbol(__cache__")&&delete e[t]}const pt=new class{prototypeMap=new WeakMap;dataMap=new WeakMap;data(e){return e instanceof h&&(e=e.element),e?(this.dataMap.has(e)||this.dataMap.set(e,{}),this.dataMap.get(e)):{}}prototype(e){return e?(this.prototypeMap.has(e)||this.prototypeMap.set(e,{}),this.prototypeMap.get(e)):{}}fieldSetInPrototype(e,t){for(;e&&e!==HTMLElement.prototype;){if(this.prototype(e)[t])return!0;e=Object.getPrototypeOf(e)}return!1}skipAttributeChangedCallback(e){return this.fieldSetInPrototype(e,"setupAttributeChangedCallback")}skipConnectedCallback(e){return this.fieldSetInPrototype(e,"setupConnectedCallback")}getNamesOfPrototypeChain(e){const t=[];for(;e&&e!==HTMLElement.prototype;){const i=this.prototype(e).name;i&&t.push(i),e=Object.getPrototypeOf(e)}return t}};function ft(e,t={injectAttributeBridge:!0}){return function(i,n){const s=e??te(n.name),r=i.prototype;if(s&&(pt.prototype(r).name=s),Object.defineProperty(i,"observedAttributes",{configurable:!0,enumerable:!1,get:function(){const e=new Set;let t=this;for(;t&&t!==Function.prototype;){const i=t[Symbol.metadata]?.observedAttributes;if(i)for(const t of i)e.add(t);t=Object.getPrototypeOf(t)}return Array.from(e)}}),!1!==t.injectAttributeBridge&&!pt.skipAttributeChangedCallback(r)){pt.prototype(r).setupAttributeChangedCallback=!0;const e=function(t,i,n){if(a(this,"attributeChangedCallback",e)?.call(this,t,i,n),n===i)return;if(pt.data(this).attributeBridgePass)return;const s=ie(t);if(s in this)try{pt.data(this).attributeBridgePass=!0,this[s]=null===n?void 0:Z(n)}finally{pt.data(this).attributeBridgePass=!1}};Object.defineProperty(r,"attributeChangedCallback",{configurable:!0,enumerable:!1,writable:!0,value:e})}if(!pt.skipConnectedCallback(r)){pt.prototype(r).setupConnectedCallback=!0;const e=function(){if(a(this,"connectedCallback",e)?.call(this),this instanceof HTMLElement){for(const e of this.constructor.observedAttributes??[]){const t=this[ie(e)];if(void 0===t)continue;const i=Q(t);this.getAttribute(e)!==i&&this.setAttribute(e,i)}pt.getNamesOfPrototypeChain(Object.getPrototypeOf(this)).forEach(e=>this.classList?.add(e))}};Object.defineProperty(r,"connectedCallback",{configurable:!0,enumerable:!1,writable:!0,value:e})}return n.addInitializer(function(){s&&!customElements.get(s)&&customElements.define(s,i)}),i}}function mt(e,t=!0){return function(i,s){if(!e)return i;const{kind:a,name:r}=s,o=String(r),l=e.split(".").filter(Boolean),c=function(e){if(!e)return;let t=e;for(const e of l)if(t=t[e],!t)return;return t};if("method"===a)return function(...e){const t=c(this),i=t?.[o];if("function"==typeof i)return i.apply(t,e)};s.addInitializer(function(){const e=function(){return c(this)?.[o]},i=function(e){const t=c(this);t&&(t[o]=e)};if("field"===a||"accessor"===a){const s=n(this,o);Object.defineProperty(this,o,{configurable:!0,enumerable:s?.enumerable??!0,get:()=>e.call(this),set:e=>{t&&i.call(this,e)}})}})}}"metadata"in Symbol||Object.defineProperty(Symbol,"metadata",{value:Symbol.for("Symbol.metadata"),writable:!1,enumerable:!1,configurable:!0});const gt=new class{constructorMap=new WeakMap;constructorData(e){let t=this.constructorMap.get(e);return t||(t={installed:new Map},this.constructorMap.set(e,t)),t}};function bt(e,t){const{kind:i,name:a,static:r}=t,o=String(a),l=te(o),c=Symbol(`__observed_${o}`);if(t.metadata){const e=t.metadata.observedAttributes;Object.prototype.hasOwnProperty.call(t.metadata,"observedAttributes")?e||(t.metadata.observedAttributes=new Set):t.metadata.observedAttributes=new Set(e),t.metadata.observedAttributes.add(l)}t.addInitializer(function(){const t=r?this:s(this,o);let h,u;if("field"===i||"accessor"===i)try{this[c]=this[a]}catch{}const d=function(){return h?h.call(this):this[c]},p=function(e){this[o]!==e&&(u?u.call(this,e):this[c]=e,this.setAttribute?.(l,Q(this[o])))};if("field"===i||"accessor"===i){const t=e;t?.get&&(h=t.get),t?.set&&(u=t.set);const i=n(this,o);i?.get&&(h=i.get),i?.set&&(u=i.set),Object.defineProperty(this,o,{configurable:!0,enumerable:i?.enumerable??!0,get:()=>d.call(this),set:e=>p.call(this,e)})}else if("getter"===i||"setter"===i){const e=gt.constructorData(t).installed;if(e.get(o))return;e.set(o,!0);const i=n(t,o)??{};"function"==typeof i.get&&(h=i.get),"function"==typeof i.set&&(u=i.set),Object.defineProperty(t,o,{configurable:!0,enumerable:!!i?.enumerable,get:function(){return d.call(this)},set:function(e){p.call(this,e)}})}})}function yt(e){const t=_(e);return ct(t).setStyles({display:"flex",flexDirection:"column"},!0),t}function vt(e){const t=_(e);return ct(t).setStyles({display:"flex",flexDirection:"row"},!0),t}class kt extends be{#i;get target(){return this.#i}set target(e){this.#i=e}toolName;manager;options;constructor(e){super(e),this.manager=e.manager??this.manager??Ie.instance,this.toolName=e.toolName??this.toolName??void 0,this.options=e.listenerOptions??{};const t=this.element;this.target=e.target??this.target??t instanceof Node?t:t?.element instanceof Node?t.element:void 0}initialize(){super.initialize();const e=this.target??this;for(const[t,i]of Object.entries(J)){const n=this[t];if("function"!=typeof n)continue;const s=this.options?.[t];this.toolName?ct(e).onTool(i,this.toolName,e=>n.call(this,e),s,this.manager):ct(e).on(i,e=>n.call(this,e),s,this.manager)}}}function Et(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}function St(e){let t=document.createElement("div");return t.innerHTML=e,t.children[0]}function _t(e,t=!0){return new Promise((i,n)=>{e&&0!==e.length?fetch(e).then(e=>{if(!e.ok)throw new Error("Network response was not ok while loading your SVG");return e.text()}).then(e=>{const t=St(e);if(!t)throw new Error("Error parsing SVG text");i(t)}).catch(e=>{t||n(e),console.error("Error fetching SVG:",e),n(e)}):n(new Error("Invalid path"))})}function wt(e){const t=e.prototype,i=Symbol("__unset_default_classes__");Object.defineProperty(t,"unsetDefaultClasses",{get:function(){return this[i]??!1},set:function(e){this[i]=e;const t=this.constructor?.config?.defaultClasses;t&&ct(this).toggleClass(t,e)},enumerable:!0,configurable:!0})}Et("turbo-button{align-items:center;background-color:#dadada;border:1px solid #000;border-radius:.4em;color:#000;display:inline-flex;flex-direction:row;gap:.4em;padding:.5em .7em;text-decoration:none}turbo-button>h4{flex-grow:1}");class Ct extends HTMLElement{static config={shadowDOM:!1,defaultSelectedClass:"selected"};mvc=new I({element:this});onAttach=new A;onDetach=new A;onAdopt=new A;static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}connectedCallback(){this.onAttach.fire()}disconnectedCallback(){this.onDetach.fire()}adoptedCallback(){this.onAdopt.fire()}}Pe(Ct),Oe(Ct),wt(Ct);let Dt=(()=>{let e,i,n,s,a,r,l,h=[ft("turbo-icon")],u=[],d=Ct,p=[],f=[],m=[],g=[],b=[];return class extends d{static{i=this}static{const y="function"==typeof Symbol&&Symbol.metadata?Object.create(d[Symbol.metadata]??null):void 0;n=[bt,c({initialValueCallback:function(){return this.getPropertiesValue(this.type,"defaultType","svg")},preprocessValue:function(e){return e&&0!=e.length?("."==e[0]&&(e=e.substring(1)),e):this.type},callAfter:function(){this.generateIcon()}})],s=[bt,c({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultDirectory","")},preprocessValue:function(e){return o(e)?this.directory:(e.length>0&&!e.endsWith("/")&&(e+="/"),e)},callAfter:function(){this.generateIcon()}})],a=[bt,c()],r=[bt,c()],l=[ut()],t.__esDecorate(this,null,a,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:e=>"icon"in e,set:(e,t)=>{e.icon=t}},metadata:y},null,p),t.__esDecorate(this,null,r,{kind:"setter",name:"iconColor",static:!1,private:!1,access:{has:e=>"iconColor"in e,set:(e,t)=>{e.iconColor=t}},metadata:y},null,p),t.__esDecorate(this,null,l,{kind:"method",name:"loadSvg",static:!1,private:!1,access:{has:e=>"loadSvg"in e,get:e=>e.loadSvg},metadata:y},null,p),t.__esDecorate(null,null,n,{kind:"field",name:"type",static:!1,private:!1,access:{has:e=>"type"in e,get:e=>e.type,set:(e,t)=>{e.type=t}},metadata:y},f,m),t.__esDecorate(null,null,s,{kind:"field",name:"directory",static:!1,private:!1,access:{has:e=>"directory"in e,get:e=>e.directory,set:(e,t)=>{e.directory=t}},metadata:y},g,b),t.__esDecorate(null,e={value:i},h,{kind:"class",name:i.name,metadata:y},null,u),i=e.value,y&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:y})}static config={...Ct.config,defaultType:"svg",customLoaders:{}};static imageTypes=["png","jpg","jpeg","gif","webp","PNG","JPG","JPEG","GIF","WEBP"];_element=t.__runInitializers(this,p);_loadToken=0;onLoaded;type=t.__runInitializers(this,f,void 0);directory=(t.__runInitializers(this,m),t.__runInitializers(this,g,void 0));get path(){let e=ee(this.icon);const t=this.icon?.replace(e,"");return 0===e.length&&this.type?.length>0&&(e="."+this.type),this.directory+t+e}set icon(e){const t=ee(e).substring(1);t&&(this.type=t),this.generateIcon()}set iconColor(e){this.updateColor(e)}set element(e){this._element=e}get element(){return this._element}loadSvg(e){return _t(e)}loadImg(e){return D({src:e,alt:this.icon})}updateColor(e=this.iconColor){e&&this.element instanceof SVGElement&&(this.element.style.fill=e)}generateIcon(){const e=this.path,t=ee(e)?.substring(1);if(this.element instanceof HTMLImageElement&&We(t,...this.constructor.imageTypes))return this.element.src=this.path,void(this.element.alt=this.icon);if(this.clear(),!this.icon)return;const i=++this._loadToken,n=this.getLoader(t)(e);n instanceof Element?this.setupLoadedElement(n):n.then(e=>{i===this._loadToken&&this.setupLoadedElement(e)}).catch(e=>console.error(`Failed to load icon: ${e}`))}getLoader(e){if(!e)return;const t=this.constructor.config.customLoaders[e];if(t)return t;if(We(e,"svg","SVG"))return this.loadSvg.bind(this);if(We(e,...this.constructor.imageTypes))return this.loadImg.bind(this);throw new Error(`Unsupported icon type: ${e}`)}setupLoadedElement(e){!this.element&&e&&(e.parentElement&&(e=e.cloneNode(!0)),ct(this).addChild(e),this.updateColor(),this.onLoaded?.(e),this.element=e)}clear(){ct(this.element).destroy(),this.element=null}constructor(){super(...arguments),t.__runInitializers(this,b)}static{t.__runInitializers(i,u)}},i})();function Tt(e){return e.tag||(e.tag="turbo-icon"),_({...e})}let Ot=(()=>{let e,i,n,s,a,r,o,l,h,u,d=[ft("turbo-rich-element")],p=[],f=Ct,m=[],g=[],b=[];return class extends f{static{i=this}static{const y="function"==typeof Symbol&&Symbol.metadata?Object.create(f[Symbol.metadata]??null):void 0;n=[c({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultElementTag","h4")}})],s=[c({executeSetterBeforeStoring:!0})],a=[c({preprocessValue:function(e){if("string"==typeof e){if(this.leftIcon)return this.leftIcon.icon=e,this.leftIcon;e=Tt({icon:e})}return ct(this).remChild(this.leftIcon),this.addAtPosition(e,"leftIcon"),e}})],r=[c({preprocessValue:function(e){if("string"==typeof e){if(this.prefixEntry)return this.prefixEntry.textContent=e,this.prefixEntry;e=_({text:e})}return ct(this).remChild(this.prefixEntry),this.addAtPosition(e,"prefixEntry"),e}})],o=[c({preprocessValue:function(e){if("string"==typeof e){if(this.element&&"textContent"in this.element)return this.element.textContent=e,this.element;e=_({tag:this.elementTag,text:e})}else"object"!=typeof e||e instanceof Element||(e.tag||(e.tag=this.elementTag),e=_(e));return ct(this).remChild(this.element),this.addAtPosition(e,"element"),e}})],l=[c({preprocessValue:function(e){if("string"==typeof e){if(this.suffixEntry)return this.suffixEntry.textContent=e,this.suffixEntry;e=_({text:e})}return ct(this).remChild(this.suffixEntry),this.addAtPosition(e,"suffixEntry"),e}})],h=[c({preprocessValue:function(e){if("string"==typeof e){if(this.rightIcon)return this.rightIcon.icon=e,this.rightIcon;e=Tt({icon:e})}return ct(this).remChild(this.rightIcon),this.addAtPosition(e,"rightIcon"),e}})],u=[c({executeSetterBeforeStoring:!0})],t.__esDecorate(this,null,s,{kind:"setter",name:"leftCustomElements",static:!1,private:!1,access:{has:e=>"leftCustomElements"in e,set:(e,t)=>{e.leftCustomElements=t}},metadata:y},null,m),t.__esDecorate(this,null,a,{kind:"setter",name:"leftIcon",static:!1,private:!1,access:{has:e=>"leftIcon"in e,set:(e,t)=>{e.leftIcon=t}},metadata:y},null,m),t.__esDecorate(this,null,r,{kind:"setter",name:"prefixEntry",static:!1,private:!1,access:{has:e=>"prefixEntry"in e,set:(e,t)=>{e.prefixEntry=t}},metadata:y},null,m),t.__esDecorate(this,null,o,{kind:"setter",name:"element",static:!1,private:!1,access:{has:e=>"element"in e,set:(e,t)=>{e.element=t}},metadata:y},null,m),t.__esDecorate(this,null,l,{kind:"setter",name:"suffixEntry",static:!1,private:!1,access:{has:e=>"suffixEntry"in e,set:(e,t)=>{e.suffixEntry=t}},metadata:y},null,m),t.__esDecorate(this,null,h,{kind:"setter",name:"rightIcon",static:!1,private:!1,access:{has:e=>"rightIcon"in e,set:(e,t)=>{e.rightIcon=t}},metadata:y},null,m),t.__esDecorate(this,null,u,{kind:"setter",name:"rightCustomElements",static:!1,private:!1,access:{has:e=>"rightCustomElements"in e,set:(e,t)=>{e.rightCustomElements=t}},metadata:y},null,m),t.__esDecorate(null,null,n,{kind:"field",name:"elementTag",static:!1,private:!1,access:{has:e=>"elementTag"in e,get:e=>e.elementTag,set:(e,t)=>{e.elementTag=t}},metadata:y},g,b),t.__esDecorate(null,e={value:i},d,{kind:"class",name:i.name,metadata:y},null,p),i=e.value,y&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:y})}static config={...Ct.config,defaultElementTag:"h4"};childrenOrder=(t.__runInitializers(this,m),["leftCustomElements","leftIcon","prefixEntry","element","suffixEntry","rightIcon","rightCustomElements"]);addAtPosition(e,t){if(!e||!t)return;let i=0;for(let e=0;e<this.childrenOrder.length;e++){const n=this.childrenOrder[e];if(n===t)break;const s=this[n];s&&s instanceof Element?i++:s&&Array.isArray(s)&&(i+=s.length)}ct(this).addChild(e,i)}elementTag=t.__runInitializers(this,g,void 0);set leftCustomElements(e){ct(this).remChild(this.leftCustomElements),this.addAtPosition(e,"leftCustomElements")}set leftIcon(e){}get leftIcon(){}set prefixEntry(e){}get prefixEntry(){}set element(e){}get element(){}get text(){const e=this.element;return e?e.textContent:""}set text(e){e||(e=""),this.element=e}set suffixEntry(e){}get suffixEntry(){}set rightIcon(e){}get rightIcon(){}set rightCustomElements(e){ct(this).remChild(this.rightCustomElements),this.addAtPosition(e,"rightCustomElements")}constructor(){super(...arguments),t.__runInitializers(this,b)}static{t.__runInitializers(i,p)}},i})();function Pt(e){return e.text&&!e.element&&(e.element=e.text),!e.elementTag||"object"!=typeof e.element||e.element instanceof Element||(e.element.tag=e.elementTag),e.tag||(e.tag="turbo-rich-element"),_({...e,text:void 0})}let Mt=(()=>{let e,i,n=[ft("turbo-button")],s=[],a=Ot;return class extends a{static{i=this}static{const r="function"==typeof Symbol&&Symbol.metadata?Object.create(a[Symbol.metadata]??null):void 0;t.__esDecorate(null,e={value:i},n,{kind:"class",name:i.name,metadata:r},null,s),i=e.value,r&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})}static config={...Ot.config,defaultElementTag:"h4"};static{t.__runInitializers(i,s)}},i})();function It(e){return e.tag||(e.tag="turbo-button"),Pt({...e})}let xt=(()=>{let e,i,n,s,a,r=[ft("turbo-icon-switch")],o=[],l=Dt,h=[];return class extends l{static{i=this}static{const u="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;n=[c({preprocessValue:function(e){return e instanceof $e?e:new $e(e||{})}})],s=[c()],a=[c()],t.__esDecorate(this,null,n,{kind:"setter",name:"switchReifect",static:!1,private:!1,access:{has:e=>"switchReifect"in e,set:(e,t)=>{e.switchReifect=t}},metadata:u},null,h),t.__esDecorate(this,null,s,{kind:"setter",name:"defaultState",static:!1,private:!1,access:{has:e=>"defaultState"in e,set:(e,t)=>{e.defaultState=t}},metadata:u},null,h),t.__esDecorate(this,null,a,{kind:"setter",name:"appendStateToIconName",static:!1,private:!1,access:{has:e=>"appendStateToIconName"in e,set:(e,t)=>{e.appendStateToIconName=t}},metadata:u},null,h),t.__esDecorate(null,e={value:i},r,{kind:"class",name:i.name,metadata:u},null,o),i=e.value,u&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),t.__runInitializers(i,o)}config=(t.__runInitializers(this,h),{...Dt.config});get switchReifect(){}set switchReifect(e){this.switchReifect.attach(this),this.defaultState&&this.switchReifect.apply(this.defaultState,this)}set defaultState(e){this.switchReifect?.apply(e,this)}set appendStateToIconName(e){if(e){const e=this.switchReifect?.properties;this.switchReifect.states.forEach(t=>{e[t]||(e[t]={}),e[t].icon=this.icon+"-"+t.toString()})}}initialize(){super.initialize(),this.defaultState&&this.switchReifect&&this.switchReifect.apply(this.defaultState,this)}},i})();function At(e){return e.tag||(e.tag="turbo-icon-switch"),Tt({...e})}let jt=(()=>{let e,i,n,s,a=[ft("turbo-icon-toggle")],r=[],o=Dt,l=[];return class extends o{static{i=this}static{const h="function"==typeof Symbol&&Symbol.metadata?Object.create(o[Symbol.metadata]??null):void 0;n=[c({initialValue:!1})],s=[c({initialValue:!1})],t.__esDecorate(this,null,n,{kind:"setter",name:"toggled",static:!1,private:!1,access:{has:e=>"toggled"in e,set:(e,t)=>{e.toggled=t}},metadata:h},null,l),t.__esDecorate(this,null,s,{kind:"setter",name:"toggleOnClick",static:!1,private:!1,access:{has:e=>"toggleOnClick"in e,set:(e,t)=>{e.toggleOnClick=t}},metadata:h},null,l),t.__esDecorate(null,e={value:i},a,{kind:"class",name:i.name,metadata:h},null,r),i=e.value,h&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),t.__runInitializers(i,r)}config=(t.__runInitializers(this,l),{...Dt.config});stopPropagationOnClick=!0;onToggle;clickListener=()=>(this.toggle(),this.stopPropagationOnClick);set toggled(e){this.onToggle&&this.onToggle(e,this)}set toggleOnClick(e){e?ct(this).on(J.click,this.clickListener):ct(this).removeListener(J.click,this.clickListener)}toggle(){this.toggled=!this.toggled}},i})();function Bt(e=8){const t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map(e=>e.toString(36).padStart(2,"0")).join("").slice(0,e)}function Nt(e,t){if("number"!=typeof e||"number"!=typeof t)return 0;const i=Math.min(e,t),n=Math.max(e,t);return Math.random()*(n-i)+i}class zt extends kt{keyName="__input__interactor__";_composing=!1;_resizeQueued=!1;options={compositionStart:{capture:!0},compositionEnd:{capture:!0},input:{capture:!0}};get inputElement(){return this.element.element}initialize(){super.initialize(),ct(this.target).bypassManagerOn=()=>!0}setupChangedCallbacks(){super.setupChangedCallbacks(),this.emitter.add("valueSet",()=>this.handleInput())}click(){return this.element.locked||this.inputElement?.focus(),!1}focusIn(e){if(e.target===this.inputElement){if(!this.element.locked)return this.element.selectTextOnFocus&&requestAnimationFrame(()=>{try{this.inputElement.select?.()}catch{}}),this.element.onFocus.fire(),!0;this.inputElement.blur()}}focusOut(e){e.target===this.inputElement&&(this.element.value=this.element.element?.value,this.element.onBlur.fire())}compositionStart(e){e.target===this.inputElement&&(this._composing=!0)}compositionEnd(e){if(e.target===this.inputElement)return this._composing=!1,this.handleInput(),!0}input(e){if(e.target===this.inputElement)return this.handleInput(),!0}handleInput(){this._composing||this.inputElement&&(this.element.dynamicVerticalResize&&this.inputElement instanceof HTMLTextAreaElement&&(this._resizeQueued||(this._resizeQueued=!0,queueMicrotask(()=>{this._resizeQueued=!1,ct(this.inputElement).setStyle("height","auto",!0).setStyle("height",this.inputElement.scrollHeight+"px",!0)}))),this.emitter.fire("processValue"))}}let Vt=(()=>{let e,i,n,s=[ft("turbo-input")],a=[],r=Ot,o=[];return class extends r{static{i=this}static{const l="function"==typeof Symbol&&Symbol.metadata?Object.create(r[Symbol.metadata]??null):void 0;n=[c()],t.__esDecorate(this,null,n,{kind:"setter",name:"label",static:!1,private:!1,access:{has:e=>"label"in e,set:(e,t)=>{e.label=t}},metadata:l},null,o),t.__esDecorate(null,e={value:i},s,{kind:"class",name:i.name,metadata:l},null,a),i=e.value,l&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})}static config={...Ot.config,defaultElementTag:"input"};labelElement=t.__runInitializers(this,o);_content;get content(){return this._content}set content(e){this._content=e}defaultId="turbo-input-"+Bt();locked=!1;selectTextOnFocus=!1;dynamicVerticalResize=!1;inputRegexCheck;blurRegexCheck;lastValidForInput="";lastValidForBlur="";onFocus=new A;onBlur=new A;onInput=new A;set label(e){e&&0!==e.length?(this.labelElement||(this.labelElement=_({tag:"label",htmlFor:this.element?.id??this.defaultId}),ct(this).childHandler=this,ct(this).addChild(this.labelElement,0),this.content&&(ct(this).childHandler=this.content)),this.labelElement.textContent=e):this.labelElement&&this.labelElement.remove()}set element(e){e instanceof Node||"object"!=typeof e||(e.name||(e.name=Bt()),"input"!==this.elementTag||e.type||(e.type="text")),super.element=e,this.element&&(this.element.id?this.labelElement&&(this.labelElement.htmlFor=this.element.id):this.element.id=this.defaultId)}get element(){return super.element}initialize(){super.initialize(),this.mvc.generate({interactors:[zt]}),this.mvc.getInteractor("__input__interactor__").target=this.content}setupUIElements(){super.setupUIElements(),this.content=C()}setupUILayout(){super.setupUILayout(),ct(this.content).addChild(ct(this).childrenArray),ct(this).addChild([this.labelElement,this.content]),ct(this).childHandler=this.content}setupChangedCallbacks(){super.setupChangedCallbacks(),this.mvc.emitter.add("processValue",()=>this.processInputValue())}get value(){const e=this.element?.value;try{const t=parseFloat(e);if(!isNaN(t))return t}catch{}return e}set value(e){if(!(this.element instanceof HTMLInputElement||this.element instanceof HTMLTextAreaElement))return;let t=e.toString();if(this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(t)||(t=this.lastValidForBlur)}this.element.value=t,this.mvc.emitter.fire("valueSet")}processInputValue(e=this.element.value){if(this.inputRegexCheck){const t=new RegExp(this.inputRegexCheck);if(!t.test(e)){const i=this.sanitizeByRegex(e,this.inputRegexCheck);e=t.test(i)?i:this.lastValidForInput}}if(this.lastValidForInput=e.toString(),this.blurRegexCheck){new RegExp(this.blurRegexCheck).test(e.toString())&&(this.lastValidForBlur=e)}else this.lastValidForBlur=e;this.element.value=e,this.onInput.fire()}sanitizeByRegex(e,t){const i="string"==typeof t?t:t.source,n="string"==typeof t?"":t.flags.replace("g",""),s=new RegExp(i,n);let a="";for(const t of e){const e=a+t;s.lastIndex=0,s.test(e)&&(a=e)}return a}static{t.__runInitializers(i,a)}},i})();function Ft(e){return e.element=e.input,e.elementTag=e.inputTag,e.elementTag||(e.elementTag="input"),e.element||(e.element={}),e.tag||(e.tag="turbo-input"),Pt({...e,input:void 0,inputTag:void 0})}let Lt=(()=>{let e,i,n=[ft("turbo-numerical-input")],s=[],a=Vt;return class extends a{static{i=this}static{const r="function"==typeof Symbol&&Symbol.metadata?Object.create(a[Symbol.metadata]??null):void 0;t.__esDecorate(null,e={value:i},n,{kind:"class",name:i.name,metadata:r},null,s),i=e.value,r&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r}),t.__runInitializers(i,s)}multiplier=1;decimalPlaces;min;max;get value(){return Number.parseFloat(this.element.value)/this.multiplier}set value(e){e&&""!=e||(e=0),"string"==typeof e&&(e=Number.parseFloat(e)),e*=this.multiplier,null!=this.min&&e<this.min&&(e=this.min),null!=this.max&&e>this.max&&(e=this.max),null!=this.decimalPlaces&&(e=Math.round(e*Math.pow(10,this.decimalPlaces))/Math.pow(10,this.decimalPlaces)),super.value=e}},i})();class Rt extends me{toggledEntry;values;constructor(e){super(e),this.toggledEntry=e.toggledEntry,this.values=e.values}}class Wt{static config={};static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}}Pe(Wt);let Kt=(()=>{let e,i,n,s,a,l,h,u,d,p=Wt,f=[],m=[],g=[],b=[],y=[],v=[],k=[],E=[],S=[],_=[],w=[],C=[],D=[],O=[],P=[];return class extends p{static{const r="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;e=[c()],i=[c({defaultValue:e=>e instanceof Ot?e.text:e instanceof HTMLElement?e.textContent:e instanceof Element?e.innerHTML:void 0})],n=[c({defaultValue:()=>""})],s=[c({defaultValue:e=>Pt({text:Q(e)})})],a=[c({defaultValue:function(e){this.initializeSelection(),ct(e).on(J.click,()=>(this.select(e,!this.isSelected(e)),!0))}})],l=[c({defaultValue:function(e){}})],h=[c({defaultValue:!1})],u=[c({defaultValueCallback:function(){return!this.multiSelection}})],d=[c({callBefore:function(){this.selectedEntries?.forEach(e=>lt(e).removeClass(this.selectedEntryClasses))},callAfter:function(){this.selectedEntries?.forEach(e=>lt(e).addClass(this.selectedEntryClasses))},initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectedEntryClasses")}})],t.__esDecorate(this,null,e,{kind:"setter",name:"parent",static:!1,private:!1,access:{has:e=>"parent"in e,set:(e,t)=>{e.parent=t}},metadata:r},null,f),t.__esDecorate(this,null,h,{kind:"setter",name:"multiSelection",static:!1,private:!1,access:{has:e=>"multiSelection"in e,set:(e,t)=>{e.multiSelection=t}},metadata:r},null,f),t.__esDecorate(null,null,i,{kind:"field",name:"getValue",static:!1,private:!1,access:{has:e=>"getValue"in e,get:e=>e.getValue,set:(e,t)=>{e.getValue=t}},metadata:r},m,g),t.__esDecorate(null,null,n,{kind:"field",name:"getSecondaryValue",static:!1,private:!1,access:{has:e=>"getSecondaryValue"in e,get:e=>e.getSecondaryValue,set:(e,t)=>{e.getSecondaryValue=t}},metadata:r},b,y),t.__esDecorate(null,null,s,{kind:"field",name:"createEntry",static:!1,private:!1,access:{has:e=>"createEntry"in e,get:e=>e.createEntry,set:(e,t)=>{e.createEntry=t}},metadata:r},v,k),t.__esDecorate(null,null,a,{kind:"field",name:"onEntryAdded",static:!1,private:!1,access:{has:e=>"onEntryAdded"in e,get:e=>e.onEntryAdded,set:(e,t)=>{e.onEntryAdded=t}},metadata:r},E,S),t.__esDecorate(null,null,l,{kind:"field",name:"onEntryRemoved",static:!1,private:!1,access:{has:e=>"onEntryRemoved"in e,get:e=>e.onEntryRemoved,set:(e,t)=>{e.onEntryRemoved=t}},metadata:r},_,w),t.__esDecorate(null,null,u,{kind:"field",name:"forceSelection",static:!1,private:!1,access:{has:e=>"forceSelection"in e,get:e=>e.forceSelection,set:(e,t)=>{e.forceSelection=t}},metadata:r},C,D),t.__esDecorate(null,null,d,{kind:"field",name:"selectedEntryClasses",static:!1,private:!1,access:{has:e=>"selectedEntryClasses"in e,get:e=>e.selectedEntryClasses,set:(e,t)=>{e.selectedEntryClasses=t}},metadata:r},O,P),r&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})}static config={defaultSelectedEntryClasses:"selected"};_inputField=t.__runInitializers(this,f);_entries=[];_entriesData=new WeakMap;parentObserver;onSelectDelegate=new A;onEnabledDelegate=new A;get entries(){return this._entries}set entries(e){this.enableObserver(!1);const t=this.selectedValues;this.clear(),this._entries=(Array.isArray(e)?e:Array.from(e)).filter(e=>e!==this.inputField),console.log(this.entries),e instanceof HTMLCollection&&e.item(0)&&(this.parent=e.item(0).parentElement);const i=this.entries;for(let e=0;e<i.length;e++)this.onEntryAdded?.call(this,i[e],e);this.deselectAll();for(let e=0;e<i.length;e++)t.includes(this.getValue(i[e]))&&this.select(i[e]);0===this.selectedEntries.length&&this.initializeSelection(),this.refreshInputField(),this.enableObserver(!0)}get values(){return this.entries.map(e=>this.getValue(e))}set values(e){const t=[];e.forEach(e=>{const i=this.createEntry(e);i instanceof Node&&this.parent&&ct(this.parent).addChild(i),t.push(i)}),console.log(t),this.entries=t}get selectedEntries(){return this.entries.filter(e=>this.getEntryData(e).selected)}set selectedEntries(e){this.deselectAll(),e&&e.forEach(e=>this.select(e))}set parent(e){e instanceof Element&&(ct(e).addChild(this.entries.filter(e=>e instanceof Node)),this.inputField&&e.appendChild(this.inputField),this.setupParentObserver())}getValue=t.__runInitializers(this,m,void 0);getSecondaryValue=(t.__runInitializers(this,g),t.__runInitializers(this,b,void 0));createEntry=(t.__runInitializers(this,y),t.__runInitializers(this,v,void 0));onEntryAdded=(t.__runInitializers(this,k),t.__runInitializers(this,E,void 0));onEntryRemoved=(t.__runInitializers(this,S),t.__runInitializers(this,_,void 0));get inputName(){return this.inputField?.name}set inputName(e){this._inputField||(this._inputField=T({value:this.stringSelectedValue,type:"hidden",parent:this.parent??document.body})),this.inputField.name=e}get inputField(){return this._inputField}set multiSelection(e){this.forceSelection=!e}forceSelection=(t.__runInitializers(this,w),t.__runInitializers(this,C,void 0));set onSelect(e){e&&this.onSelectDelegate.add(e)}set onEnabled(e){e&&this.onEnabledDelegate.add(e)}selectedEntryClasses=(t.__runInitializers(this,D),t.__runInitializers(this,O,void 0));constructor(e={}){super(),t.__runInitializers(this,P);const i=e.selectedValues||[];e.selectedValues=void 0,e.onEnabled||(e.onEnabled=(e,t)=>{t instanceof HTMLElement&&ct(t).setStyle("visibility",e?"":"hidden")});for(const t of Object.keys(e))try{this[t]=e[t]}catch{}this.forceSelection||this.deselectAll(),this.entries.forEach(e=>{i.includes(this.getValue(e))&&this.select(e)})}getEntryData(e){if(!e)return{};let t=this._entriesData.get(e);return t||(t={selected:!1,enabled:!0},this._entriesData.set(e,t)),t}clearEntryData(e){this._entriesData.delete(e);const t=this.entries.indexOf(e);t>=0&&this.entries.splice(t,1)}addEntry(e,t=this.entries.length){(void 0===t||"number"!=typeof t||t>this.entries.length)&&(t=this.entries.length),t<0&&(t=0),this.enableObserver(!1),this.onEntryAdded?.call(this,e,t),Array.isArray(this.entries)&&!this.entries.includes(e)&&this.entries.splice(t,0,e),e instanceof Node&&!e.parentElement&&this.parent&&ct(this.parent).addChild(e,t),this.enableObserver(!0),requestAnimationFrame(()=>this.select(this.selectedEntry))}getEntryFromSecondaryValue(e){return this.entries.find(t=>this.getSecondaryValue(t)===e)}isSelected(e){return this.selectedEntries.includes(e)}getEntry(e){let t;try{const i=this.find(e);if(i)t=i;else{const i=this.entries.find(t=>t===e);i&&(t=i)}}catch{}return t}select(e,t=!0){if(r(e)||o(e))return this;let i;try{const t=this.getEntry(e);if(t)i=t;else{const t=this.entries.find(t=>t===e);t&&(i=t)}}catch{}if(!i)return this;const n=this.isSelected(i);return t===n||!t&&n&&this.selectedEntries.length<=1&&this.forceSelection||(this.multiSelection||this.deselectAll(),this.getEntryData(i).selected=t,i instanceof HTMLElement&&ct(i).toggleClass(this.selectedEntryClasses,t),this.initializeSelection(),this.refreshInputField(),this.onSelectDelegate.fire(t,i,this.getIndex(i)),(this.parent??document).dispatchEvent(new Rt({toggledEntry:i,values:this.selectedValues}))),this}selectByIndex(e,t=He){return e=t(e,this.entries.length-1,0),this.select(this.entries[e])}getIndex(e){return this.entries.indexOf(e)}deselectAll(){this.selectedEntries.forEach(e=>{e instanceof HTMLElement&&ct(e).toggleClass(this.selectedEntryClasses,!1),this.getEntryData(e).selected=!1}),this.refreshInputField()}reset(){this.deselectAll()}get enabledEntries(){return this.entries.filter(e=>this.getEntryData(e).enabled)}get enabledValues(){return this.enabledEntries.map(e=>this.getValue(e))}get enabledSecondaryValues(){return this.enabledEntries.map(e=>this.getSecondaryValue(e))}find(e){return this.entries.find(t=>this.getValue(t)===e)}findBySecondaryValue(e){return this.entries.find(t=>this.getSecondaryValue(t)===e)}findAll(...e){return this.entries.filter(t=>e.includes(this.getValue(t)))}findAllBySecondaryValue(...e){return this.entries.filter(t=>e.includes(this.getSecondaryValue(t)))}enable(e,...t){t&&0!==t.length||(t=this.entries),t.forEach(t=>{const i=this.getEntry(t);i&&(this.getEntryData(i).enabled=e,this.onEnabledDelegate.fire(e,i,this.getIndex(i)))})}get selectedEntry(){return this.selectedEntries[0]}get selectedValues(){return this.selectedEntries.map(e=>this.getValue(e))}get selectedValue(){const e=this.selectedEntry;if(e)return this.getValue(e)}get selectedSecondaryValues(){return this.selectedEntries.map(e=>this.getSecondaryValue(e))}get selectedSecondaryValue(){const e=this.selectedEntry;if(e)return this.getSecondaryValue(e)}get stringSelectedValue(){return this.selectedEntries.map(e=>Q(this.getValue(e))).join(", ")}clear(){this.enableObserver(!1);for(const e of this.entries)this.clearEntryData(e),this.onEntryRemoved(e),this.parent&&e instanceof HTMLElement&&e.remove();this._entries=[],this.refreshInputField(),this.enableObserver(!0)}refreshInputField(){this.inputField&&(this.inputField.value=this.stringSelectedValue)}destroy(){return this.enableObserver(!1),this.parentObserver=null,this}enableObserver(e){if(!e)return this.parentObserver?.disconnect();this.parent instanceof Element&&this.parentObserver&&this.parentObserver.observe(this.parent,{childList:!0})}initializeSelection(){if(this.forceSelection&&this.enabledEntries.length&&0===this.selectedEntries.length){const e=this.enabledEntries[0];e&&this.select(e)}}setupParentObserver(){this.enableObserver(!1),this.parentObserver=new MutationObserver(e=>{for(const t of e){for(const e of t.addedNodes){if(!(e instanceof Element)||e.parentElement!==this.parent)continue;if(e===this.inputField)continue;const t=e,i=Array.from(this.parent.children).filter(e=>e!==this.inputField).filter(e=>this.entries.includes(e)||e===t),n=i.indexOf(t);if(!(n<0)){if(0===n)this.entries.splice(n,0,t);else{const e=this.entries.indexOf(i[n-1]);this.entries.splice(e+1,0,t)}this.getEntryData(t),this.onEntryAdded?.call(this,t,this.getIndex(t))}}for(const e of t.removedNodes)e instanceof Element&&e!==this.inputField&&queueMicrotask(()=>{if(e.isConnected)return;const t=this.getEntryData(e);if(t.selected&&this.forceSelection&&this.enabledEntries.length){const e=this.enabledEntries[0];e&&this.select(e)}t.selected=!1,this.onEntryRemoved?.call(this,e),this.clearEntryData(e)})}}),this.enableObserver(!0)}}})();Et(".turbo-drawer{align-items:center;direction:ltr;display:inline-flex}.turbo-drawer-panel-container{align-items:center;display:flex;overflow:hidden;position:relative}.turbo-drawer-thumb{display:inline-block;position:relative}.top-drawer .turbo-drawer-panel-container,.turbo-drawer.top-drawer{flex-direction:column}.bottom-drawer .turbo-drawer-panel-container,.turbo-drawer.bottom-drawer{flex-direction:column-reverse}.left-drawer .turbo-drawer-panel-container,.turbo-drawer.left-drawer{flex-direction:row}.right-drawer .turbo-drawer-panel-container,.turbo-drawer.right-drawer{flex-direction:row-reverse}");class Ht extends $e{constructor(e){e.states=[""],super(e)}get properties(){const e=super.properties;return"object"==typeof e&&""in e?e[""]:e}set properties(e){super.properties=e}get styles(){const e=super.styles;return"object"==typeof e&&""in e?e[""]:e}set styles(e){super.styles=e}get classes(){const e=super.classes;return"object"==typeof e&&""in e?e[""]:e}set classes(e){super.classes=e}get replaceWith(){const e=super.replaceWith;return"object"==typeof e&&""in e?e[""]:e}set replaceWith(e){super.replaceWith=e}set transition(e){super.transition=e}get transitionProperties(){const e=super.transitionProperties;return"object"==typeof e&&""in e?e[""]:e}set transitionProperties(e){super.transitionProperties=e}get transitionDuration(){const e=super.transitionDuration;return"object"==typeof e&&""in e?e[""]:e}set transitionDuration(e){super.transitionDuration=e}get transitionTimingFunction(){const e=super.transitionTimingFunction;return"object"==typeof e&&""in e?e[""]:e}set transitionTimingFunction(e){super.transitionTimingFunction=e}get transitionDelay(){const e=super.transitionDelay;return"object"==typeof e&&""in e?e[""]:e}set transitionDelay(e){super.transitionDelay=e}initialize(e,t){super.initialize("",e,t)}apply(e,t){super.apply("",e,t)}}let Ut=(()=>{let i,n,s,a,r,o,l,h,u,d,p,f,m,g=[ft("turbo-drawer")],b=[],y=Ct,v=[],k=[],E=[];return class extends y{static{n=this}static{const S="function"==typeof Symbol&&Symbol.metadata?Object.create(y[Symbol.metadata]??null):void 0;s=[c({setIfUndefined:!0,callBefore:function(){this.thumb&&ct(this).remChild(this.thumb)},preprocessValue:e=>e instanceof HTMLElement?e:C(e)})],a=[c({setIfUndefined:!0,callBefore:function(){this.panel&&ct(this).remChild(this.panel)},preprocessValue:e=>e instanceof HTMLElement?e:C(e)})],r=[c({callBefore:function(){this.icon?.parentElement===this.thumb&&this.thumb.removeChild(this.icon)},preprocessValue:function(t){return t instanceof Element?t:("string"!=typeof t||this.attachSideToIconName||this.rotateIconBasedOnSide||(this.attachSideToIconName=!0),At("object"==typeof t?t:{icon:t,switchReifect:{states:Object.values(e.Side)},defaultState:this.open?this.getOppositeSide():this.side,appendStateToIconName:this.attachSideToIconName}))}})],o=[c({defaultValue:!1})],l=[c({defaultValue:!1})],h=[c({defaultValue:!1})],u=[c({defaultValue:e.Side.bottom,cancelIfUnchanged:!1})],d=[c({defaultValue:{open:0,closed:0},preprocessValue:e=>"number"==typeof e?{open:e,closed:e}:{open:e?.open||0,closed:e?.closed||0}})],p=[c({defaultValue:!1})],f=[c()],m=[c({defaultValueCallback:function(){return new Ht({transitionProperties:["transform",this.isVertical?"height":"width"],transitionDuration:.2,transitionTimingFunction:"ease-out"})},callAfter:function(){this.transition.attachAll(this,this.panelContainer)}})],t.__esDecorate(this,null,s,{kind:"setter",name:"thumb",static:!1,private:!1,access:{has:e=>"thumb"in e,set:(e,t)=>{e.thumb=t}},metadata:S},null,v),t.__esDecorate(this,null,a,{kind:"setter",name:"panel",static:!1,private:!1,access:{has:e=>"panel"in e,set:(e,t)=>{e.panel=t}},metadata:S},null,v),t.__esDecorate(this,null,r,{kind:"setter",name:"icon",static:!1,private:!1,access:{has:e=>"icon"in e,set:(e,t)=>{e.icon=t}},metadata:S},null,v),t.__esDecorate(this,null,o,{kind:"setter",name:"hideOverflow",static:!1,private:!1,access:{has:e=>"hideOverflow"in e,set:(e,t)=>{e.hideOverflow=t}},metadata:S},null,v),t.__esDecorate(this,null,l,{kind:"setter",name:"attachSideToIconName",static:!1,private:!1,access:{has:e=>"attachSideToIconName"in e,set:(e,t)=>{e.attachSideToIconName=t}},metadata:S},null,v),t.__esDecorate(this,null,h,{kind:"setter",name:"rotateIconBasedOnSide",static:!1,private:!1,access:{has:e=>"rotateIconBasedOnSide"in e,set:(e,t)=>{e.rotateIconBasedOnSide=t}},metadata:S},null,v),t.__esDecorate(this,null,u,{kind:"setter",name:"side",static:!1,private:!1,access:{has:e=>"side"in e,set:(e,t)=>{e.side=t}},metadata:S},null,v),t.__esDecorate(this,null,d,{kind:"setter",name:"offset",static:!1,private:!1,access:{has:e=>"offset"in e,set:(e,t)=>{e.offset=t}},metadata:S},null,v),t.__esDecorate(this,null,p,{kind:"setter",name:"open",static:!1,private:!1,access:{has:e=>"open"in e,set:(e,t)=>{e.open=t}},metadata:S},null,v),t.__esDecorate(this,null,f,{kind:"setter",name:"translation",static:!1,private:!1,access:{has:e=>"translation"in e,set:(e,t)=>{e.translation=t}},metadata:S},null,v),t.__esDecorate(null,null,m,{kind:"field",name:"transition",static:!1,private:!1,access:{has:e=>"transition"in e,get:e=>e.transition,set:(e,t)=>{e.transition=t}},metadata:S},k,E),t.__esDecorate(null,i={value:n},g,{kind:"class",name:n.name,metadata:S},null,b),n=i.value,S&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:S}),t.__runInitializers(n,b)}_panelContainer=t.__runInitializers(this,v);get panelContainer(){return this._panelContainer}dragging=!1;animationOn=!1;resizeObserver;set thumb(e){ct(e).addClass("turbo-drawer-thumb"),this.initialized&&this.setupUILayout()}get thumb(){}set panel(e){ct(e).addClass("turbo-drawer-panel"),this.initialized&&this.setupUILayout()}get panel(){}set icon(e){this.initialized&&this.setupUILayout()}get icon(){}set hideOverflow(e){ct(this.panelContainer).setStyle("overflow",e?"hidden":"")}set attachSideToIconName(e){this.icon instanceof xt&&(this.icon.appendStateToIconName=e),e&&(this.rotateIconBasedOnSide=!1)}set rotateIconBasedOnSide(e){e&&(this.attachSideToIconName=!1),this.icon instanceof xt&&(this.icon.switchReifect.styles={top:"transform: rotate(180deg)",bottom:"transform: rotate(0deg)",left:"transform: rotate(90deg)",right:"transform: rotate(270deg)"})}set side(t){ct(this).toggleClass("top-drawer",t==e.Side.top),ct(this).toggleClass("bottom-drawer",t==e.Side.bottom),ct(this).toggleClass("left-drawer",t==e.Side.left),ct(this).toggleClass("right-drawer",t==e.Side.right),this.refresh()}set offset(e){}get offset(){}get isVertical(){return this.side==e.Side.top||this.side==e.Side.bottom}set open(e){e?this.resizeObserver.observe(this.panel,{box:"border-box"}):this.resizeObserver.unobserve(this.panel),this.refresh()}set translation(t){switch(this.side){case e.Side.top:case e.Side.bottom:this.hideOverflow?ct(this.panelContainer).setStyle("height",t+"px"):ct(this).setStyle("transform",`translateY(${-t}px)`);break;case e.Side.left:case e.Side.right:this.hideOverflow?ct(this.panelContainer).setStyle("width",t+"px"):ct(this).setStyle("transform",`translateX(${-t}px)`)}}transition=t.__runInitializers(this,k,void 0);get translation(){}initialize(){super.initialize(),this.transition.attachAll(this,this.panelContainer);let e=!1;this.resizeObserver=new ResizeObserver(t=>{this.open&&!this.dragging&&(e||(e=!0,requestAnimationFrame(()=>{const i=Array.isArray(t[0].borderBoxSize)?t[0].borderBoxSize[0]:t[0].borderBoxSize;this.translation=(this.open?this.offset.open:this.offset.closed)+(this.isVertical?i.blockSize:i.inlineSize),e=!1})))}),this.animationOn=!0}setupUIElements(){super.setupUIElements(),this._panelContainer=C({classes:"turbo-drawer-panel-container"})}setupUILayout(){super.setupUILayout(),ct(this).childHandler=this,ct(this.panel).addChild(ct(this).childrenArray.filter(e=>e!==this.panelContainer)),ct(this).addChild([this.thumb,this.panelContainer]),ct(this.panelContainer).addChild(this.panel),ct(this.thumb).addChild(this.icon),ct(this).childHandler=this.panel}setupUIListeners(){this.thumb.addEventListener(J.click,e=>{e.stopImmediatePropagation(),this.open=!this.open}),this.thumb.addEventListener(X.dragStart,e=>{e.stopImmediatePropagation(),this.dragging=!0,this.animationOn&&(this.transition.enabled=!1)}),this.thumb.addEventListener(X.drag,e=>{this.dragging&&(e.stopImmediatePropagation(),this.translation+=this.isVertical?e.scaledDeltaPosition.y:e.scaledDeltaPosition.x)}),this.thumb.addEventListener(X.dragEnd,t=>{if(!this.dragging)return;t.stopImmediatePropagation(),this.dragging=!1;const i=t.positions.first.sub(t.origins.first);switch(this.side){case e.Side.top:this.open&&i.y>100?this.open=!1:!this.open&&i.y<-100&&(this.open=!0);break;case e.Side.bottom:this.open&&i.y<-100?this.open=!1:!this.open&&i.y>100&&(this.open=!0);break;case e.Side.left:this.open&&i.x>100?this.open=!1:!this.open&&i.x<-100&&(this.open=!0);break;case e.Side.right:this.open&&i.x<-100?this.open=!1:!this.open&&i.x>100&&(this.open=!0)}this.refresh()})}getOppositeSide(t=this.side){switch(t){case e.Side.top:return e.Side.bottom;case e.Side.bottom:return e.Side.top;case e.Side.left:return e.Side.right;case e.Side.right:return e.Side.left}}getAdjacentSide(t=this.side){switch(t){case e.Side.top:return e.Side.right;case e.Side.bottom:return e.Side.left;case e.Side.left:return e.Side.top;case e.Side.right:return e.Side.bottom}}refresh(){this.animationOn&&(this.transition.enabled=!0,this.transition.apply()),this.hideOverflow&&ct(this.panel).setStyle("position","absolute",!0),this.icon instanceof xt&&this.icon.switchReifect.apply(this.open?this.getOppositeSide():this.side),requestAnimationFrame(()=>{this.translation=(this.open?this.offset.open:this.offset.closed)+(this.open?this.isVertical?this.panel.offsetHeight:this.panel.offsetWidth:0),this.hideOverflow&&ct(this.panel).setStyle("position","relative",!0)})}constructor(){super(...arguments),t.__runInitializers(this,E)}},n})();var $t;e.PopupFallbackMode=void 0,($t=e.PopupFallbackMode||(e.PopupFallbackMode={})).invert="invert",$t.offset="offset",$t.none="none";Et("#turbo-popup-parent-element{display:block;left:0;position:fixed;top:0;z-index:1000}.turbo-popup{display:block;inset:auto;overflow:auto;position:fixed}");let Yt=(()=>{let i,n,s,a,r,o,l,h,u,d,p,f,m,g,b=[ft("turbo-popup")],y=[],v=Ct,k=[],E=[],S=[],_=[],w=[];var D=class extends v{static{n=this}static{const T="function"==typeof Symbol&&Symbol.metadata?Object.create(v[Symbol.metadata]??null):void 0;s=[c({defaultValue:C({parent:document.body,id:"turbo-popup-parent-element"})})],a=[c({defaultValue:document.body})],r=[c({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupAnchor",{x:50,y:0})},preprocessValue:e=>new ke(e).bound(0,100)})],o=[c({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultAnchorPosition",{x:50,y:100})},preprocessValue:e=>new ke(e).bound(0,100)})],l=[c({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultViewportMargin",0)},preprocessValue:e=>new ke(e)})],h=[c({initialValueCallback:function(){return this.getPropertiesValue(void 0,"defaultOffsetFromAnchor",0)},preprocessValue:e=>new ke(e)})],u=[c({preprocessValue:e=>"object"!=typeof e?{x:e,y:e}:e,initialValueCallback:function(){return{x:Math.abs(this.anchorPosition.x-50)>25?e.PopupFallbackMode.invert:e.PopupFallbackMode.offset,y:Math.abs(this.anchorPosition.y-50)>25?e.PopupFallbackMode.invert:e.PopupFallbackMode.offset}}})],d=[ut({clearOnNextFrame:!0})],p=[ut({clearOnNextFrame:!0})],f=[ut({clearOnNextFrame:!0})],m=[ut({clearOnNextFrame:!0})],g=[ut({clearOnNextFrame:!0})],t.__esDecorate(this,null,r,{kind:"setter",name:"popupPosition",static:!1,private:!1,access:{has:e=>"popupPosition"in e,set:(e,t)=>{e.popupPosition=t}},metadata:T},null,k),t.__esDecorate(this,null,o,{kind:"setter",name:"anchorPosition",static:!1,private:!1,access:{has:e=>"anchorPosition"in e,set:(e,t)=>{e.anchorPosition=t}},metadata:T},null,k),t.__esDecorate(this,null,l,{kind:"setter",name:"viewportMargin",static:!1,private:!1,access:{has:e=>"viewportMargin"in e,set:(e,t)=>{e.viewportMargin=t}},metadata:T},null,k),t.__esDecorate(this,null,h,{kind:"setter",name:"offsetFromAnchor",static:!1,private:!1,access:{has:e=>"offsetFromAnchor"in e,set:(e,t)=>{e.offsetFromAnchor=t}},metadata:T},null,k),t.__esDecorate(this,null,u,{kind:"setter",name:"fallbackModes",static:!1,private:!1,access:{has:e=>"fallbackModes"in e,set:(e,t)=>{e.fallbackModes=t}},metadata:T},null,k),t.__esDecorate(this,null,d,{kind:"getter",name:"rect",static:!1,private:!1,access:{has:e=>"rect"in e,get:e=>e.rect},metadata:T},null,k),t.__esDecorate(this,null,p,{kind:"getter",name:"anchorRect",static:!1,private:!1,access:{has:e=>"anchorRect"in e,get:e=>e.anchorRect},metadata:T},null,k),t.__esDecorate(this,null,f,{kind:"getter",name:"computedStyle",static:!1,private:!1,access:{has:e=>"computedStyle"in e,get:e=>e.computedStyle},metadata:T},null,k),t.__esDecorate(this,null,m,{kind:"getter",name:"anchorComputedStyle",static:!1,private:!1,access:{has:e=>"anchorComputedStyle"in e,get:e=>e.anchorComputedStyle},metadata:T},null,k),t.__esDecorate(this,null,g,{kind:"getter",name:"computedMargins",static:!1,private:!1,access:{has:e=>"computedMargins"in e,get:e=>e.computedMargins},metadata:T},null,k),t.__esDecorate(null,null,s,{kind:"field",name:"parentElement",static:!0,private:!1,access:{has:e=>"parentElement"in e,get:e=>e.parentElement,set:(e,t)=>{e.parentElement=t}},metadata:T},E,S),t.__esDecorate(null,null,a,{kind:"field",name:"anchor",static:!1,private:!1,access:{has:e=>"anchor"in e,get:e=>e.anchor,set:(e,t)=>{e.anchor=t}},metadata:T},_,w),t.__esDecorate(null,i={value:n},b,{kind:"class",name:n.name,metadata:T},null,y),D=n=i.value,T&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:T})}static config={...Ct.config,defaultPopupPosition:{x:0,y:-100},defaultAnchorPosition:{x:0,y:100},defaultViewportMargin:4,defaultOffsetFromAnchor:{x:0,y:4}};static parentElement=t.__runInitializers(n,E,void 0);anchor=(t.__runInitializers(this,k),t.__runInitializers(this,_,void 0));set popupPosition(e){}get popupPosition(){}set anchorPosition(e){}get anchorPosition(){}set viewportMargin(e){}get viewportMargin(){}set offsetFromAnchor(e){}get offsetFromAnchor(){}set fallbackModes(e){}get fallbackModes(){}get rect(){return this.getBoundingClientRect()}get anchorRect(){return this.anchor.getBoundingClientRect()}get computedStyle(){return window.getComputedStyle(this)}get anchorComputedStyle(){return window.getComputedStyle(this.anchor)}get computedMargins(){return{x:parseFloat(this.computedStyle.marginLeft)+parseFloat(this.computedStyle.marginRight),y:parseFloat(this.computedStyle.marginTop)+parseFloat(this.computedStyle.marginBottom)}}initialize(){super.initialize(),this.show(!1),this.parentElement||lt(this).addToParent(D.parentElement)}setupUIListeners(){super.setupUIListeners(),document.addEventListener(J.scroll,()=>this.show(!1),{capture:!0,passive:!0}),window.addEventListener(J.resize,()=>{lt(this).isShown&&this.recomputePosition()},{passive:!0}),lt(document.body).on(J.click,e=>{if(!lt(this).isShown)return;const t=e.target;this.contains(t)||this.anchor instanceof Node&&this.anchor.contains(t)||this.show(!1)},{capture:!0})}recomputePosition(){if(!this.anchor)return;lt(this).setStyles({maxHeight:"",maxWidth:""},!0);const t=this.computeAxis(e.Direction.horizontal),i=this.computeAxis(e.Direction.vertical);lt(this).setStyles({left:`${t}px`,top:`${i}px`});const n=Math.max(0,Math.min(window.innerWidth-2*this.viewportMargin.x,window.innerWidth-2*this.viewportMargin.x-this.computedMargins.x)),s=Math.max(0,Math.min(window.innerHeight-2*this.viewportMargin.y,window.innerHeight-2*this.viewportMargin.y-this.computedMargins.y));lt(this).setStyle("maxWidth",`${n}px`),lt(this).setStyle("maxHeight",`${s}px`)}computeAxis(t){const i=t===e.Direction.horizontal?"x":"y",n=t===e.Direction.horizontal?"width":"height",s=t===e.Direction.horizontal?window.innerWidth:window.innerHeight,a=this.anchorRect[t===e.Direction.horizontal?"left":"top"],r=this.rect[n]+this.computedMargins[i],o=this.viewportMargin[i],l=s-this.viewportMargin[i]-r,c=a+this.anchorRect[n]*this.anchorPosition[i]/100-r*this.popupPosition[i]/100+this.offsetFromAnchor[i],h=c>=o&&c<=l;if(h||this.fallbackModes[i]===e.PopupFallbackMode.offset)return Math.min(Math.max(c,o),l);const u=a+this.anchorRect[n]*(1-this.anchorPosition[i]/100)-r*(1-this.popupPosition[i]/100)-this.offsetFromAnchor[i];let d;if(u>=o&&u<=l)d=u;else if(h)d=c;else{const e=Math.abs(c-Math.min(Math.max(c,o),l))<=Math.abs(u-Math.min(Math.max(u,o),l))?c:u;d=Math.min(Math.max(e,o),l)}return d}show(e){return e?(this.style.visibility="hidden",this.style.display="",this.recomputePosition(),this.style.visibility="",lt(this).show(!0)):lt(this).setStyles({maxHeight:"",maxWidth:""},!0).show(!1),this}constructor(){super(...arguments),t.__runInitializers(this,w)}static{t.__runInitializers(n,S),t.__runInitializers(n,y)}};return D=n})();function Gt(e={}){return _({...e,text:void 0,tag:"turbo-popup"})}Et("turbo-dropdown{display:inline-block;position:relative}turbo-dropdown>.turbo-popup{background-color:#fff;border:.1em solid #5e5e5e;border-radius:.4em;display:flex;flex-direction:column;overflow:hidden}turbo-dropdown>.turbo-popup>turbo-select-entry{padding:.5em}turbo-dropdown>.turbo-popup>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}turbo-dropdown>turbo-select-entry{padding:.5em .7em;width:100%}turbo-dropdown>turbo-select-entry:hover{background-color:#d7d7d7}turbo-dropdown>turbo-select-entry:not(:last-child){border-bottom:.1em solid #bdbdbd}");let qt=(()=>{let e,i,n,s,a,r,o,l,h,u=[ft("turbo-dropdown")],d=[],p=Ct,f=[],m=[],g=[],b=[],y=[],v=[],k=[],E=[],S=[],_=[],w=[];return class extends p{static{i=this}static{const C="function"==typeof Symbol&&Symbol.metadata?Object.create(p[Symbol.metadata]??null):void 0;n=[c({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorTag")}})],s=[c({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultSelectorClasses")},callBefore:function(){lt(this.selector).removeClass(this.selectorClasses)},callAfter:function(){lt(this.selector).addClass(this.selectorClasses)}})],a=[c({defaultValueCallback:function(){return this.getPropertiesValue(void 0,"defaultPopupClasses")},callBefore:function(){lt(this.popup).removeClass(this.popupClasses)},callAfter:function(){lt(this.popup).addClass(this.popupClasses)}})],r=[mt("select")],o=[mt("select")],l=[c({setIfUndefined:!0,preprocessValue:function(e){if(e instanceof HTMLElement)return e;const t="string"==typeof e?e:Q(this.select.getValue(this.entries[0]));if(!(this.selector instanceof Mt))return It({text:t,elementTag:this.selectorTag});this.selector.text=t}})],h=[c({defaultValueCallback:()=>Gt()})],t.__esDecorate(this,null,l,{kind:"setter",name:"selector",static:!1,private:!1,access:{has:e=>"selector"in e,set:(e,t)=>{e.selector=t}},metadata:C},null,f),t.__esDecorate(this,null,h,{kind:"setter",name:"popup",static:!1,private:!1,access:{has:e=>"popup"in e,set:(e,t)=>{e.popup=t}},metadata:C},null,f),t.__esDecorate(null,null,n,{kind:"field",name:"selectorTag",static:!1,private:!1,access:{has:e=>"selectorTag"in e,get:e=>e.selectorTag,set:(e,t)=>{e.selectorTag=t}},metadata:C},m,g),t.__esDecorate(null,null,s,{kind:"field",name:"selectorClasses",static:!1,private:!1,access:{has:e=>"selectorClasses"in e,get:e=>e.selectorClasses,set:(e,t)=>{e.selectorClasses=t}},metadata:C},b,y),t.__esDecorate(null,null,a,{kind:"field",name:"popupClasses",static:!1,private:!1,access:{has:e=>"popupClasses"in e,get:e=>e.popupClasses,set:(e,t)=>{e.popupClasses=t}},metadata:C},v,k),t.__esDecorate(null,null,r,{kind:"field",name:"entries",static:!1,private:!1,access:{has:e=>"entries"in e,get:e=>e.entries,set:(e,t)=>{e.entries=t}},metadata:C},E,S),t.__esDecorate(null,null,o,{kind:"field",name:"values",static:!1,private:!1,access:{has:e=>"values"in e,get:e=>e.values,set:(e,t)=>{e.values=t}},metadata:C},_,w),t.__esDecorate(null,e={value:i},u,{kind:"class",name:i.name,metadata:C},null,d),i=e.value,C&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:C})}static config={...Ct.config,defaultSelectorTag:"h4"};select=(t.__runInitializers(this,f),new Kt({onEntryAdded:e=>this.onEntryAdded(e)}));popupOpen=!1;selectorTag=t.__runInitializers(this,m,void 0);selectorClasses=(t.__runInitializers(this,g),t.__runInitializers(this,b,void 0));popupClasses=(t.__runInitializers(this,y),t.__runInitializers(this,v,void 0));entries=(t.__runInitializers(this,k),t.__runInitializers(this,E,void 0));values=(t.__runInitializers(this,S),t.__runInitializers(this,_,void 0));onEntryAdded(e){this.select.initializeSelection(),lt(e).on(J.click,()=>(this.select.select(e,!this.select.isSelected(e)),this.openPopup(!1),!0))}set selector(e){e instanceof HTMLElement&&(lt(e).addClass(this.selectorClasses).on(J.click,e=>(this.openPopup(!this.popupOpen),!0)),this.popup instanceof Yt&&(this.popup.anchor=e),lt(this).addChild(e),e instanceof Mt&&(this.select.onSelect=()=>e.text=this.stringSelectedValue))}get selector(){}set popup(e){e instanceof Yt&&(e.anchor=this.selector),lt(e).addClass(this.popupClasses),this.select.parent=e}initialize(){super.initialize(),this.selector,lt(document.body).on(J.click,()=>e=>{this.popupOpen&&!this.contains(e.target)&&this.openPopup(!1)},{capture:!0})}openPopup(e){this.popupOpen!=e&&(this.popupOpen=e,"show"in this.popup&&"function"==typeof this.popup.show?this.popup.show(e):lt(this.popup).show(e))}get selectedValues(){return this.select.selectedValues}get selectedValue(){return this.select.selectedValue}get selectedSecondaryValues(){return this.select.selectedSecondaryValues}get selectedSecondaryValue(){return this.select.selectedSecondaryValue}get stringSelectedValue(){return this.select.stringSelectedValue}constructor(){super(...arguments),t.__runInitializers(this,w)}static{t.__runInitializers(i,d)}},i})();let Xt=(()=>{let e,i,n,s,a=[ft("turbo-marking-menu")],r=[],o=Ct,l=[],h=[],u=[],d=[];return class extends o{static{i=this}static{const p="function"==typeof Symbol&&Symbol.metadata?Object.create(o[Symbol.metadata]??null):void 0;n=[c({initialValue:0,preprocessValue:e=>e-Math.PI/2})],s=[c({initialValue:2*Math.PI,preprocessValue:e=>e-Math.PI/2})],t.__esDecorate(null,null,n,{kind:"field",name:"startAngle",static:!1,private:!1,access:{has:e=>"startAngle"in e,get:e=>e.startAngle,set:(e,t)=>{e.startAngle=t}},metadata:p},l,h),t.__esDecorate(null,null,s,{kind:"field",name:"endAngle",static:!1,private:!1,access:{has:e=>"endAngle"in e,get:e=>e.endAngle,set:(e,t)=>{e.endAngle=t}},metadata:p},u,d),t.__esDecorate(null,e={value:i},a,{kind:"class",name:i.name,metadata:p},null,r),i=e.value,p&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p}),t.__runInitializers(i,r)}transition;currentOrigin;minDragDistance=20;semiMajor=50;semiMinor=45;startAngle=t.__runInitializers(this,l,void 0);endAngle=(t.__runInitializers(this,h),t.__runInitializers(this,u,void 0));constructor(){super(...arguments),t.__runInitializers(this,d)}},i})(),Jt=(()=>{let i,n,s,a,r=[ft("turbo-select-wheel")],o=[],l=Ct,h=[];return class extends l{static{n=this}static{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;s=[c()],a=[c()],t.__esDecorate(this,null,s,{kind:"setter",name:"alwaysOpen",static:!1,private:!1,access:{has:e=>"alwaysOpen"in e,set:(e,t)=>{e.alwaysOpen=t}},metadata:e},null,h),t.__esDecorate(this,null,a,{kind:"setter",name:"open",static:!1,private:!1,access:{has:e=>"open"in e,set:(e,t)=>{e.open=t}},metadata:e},null,h),t.__esDecorate(null,i={value:n},r,{kind:"class",name:n.name,metadata:e},null,o),n=i.value,e&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e}),t.__runInitializers(n,o)}_currentPosition=(t.__runInitializers(this,h),0);_reifect;_size={max:100,min:-100};sizePerEntry=[];positionPerEntry=[];totalSize=0;dragLimitOffset=30;openTimeout=3e3;direction=e.Direction.horizontal;scale={max:1,min:.5};generateCustomStyling;dragging;openTimer;set alwaysOpen(e){e?ct(document).removeListener(J.click,this.closeOnClick):ct(document).on(J.click,this.closeOnClick),this.open=e}closeOnClick=()=>this.open=!1;get isVertical(){return this.direction==e.Direction.vertical}set open(e){ct(this).setStyle("overflow",e?"visible":"hidden")}get currentPosition(){return this._currentPosition}computeDragValue(e){return-e[this.isVertical?"y":"x"]}clearOpenTimer(){this.openTimer&&clearTimeout(this.openTimer)}setOpenTimer(){this.clearOpenTimer(),"number"!=typeof this.openTimeout||this.openTimeout<0||(this.openTimer=setTimeout(()=>this.open=!1,this.openTimeout))}},n})();class Qt{static config={shadowDOM:!1,defaultSelectedClass:"selected"};static configure(e){Object.entries(e).forEach(([e,t])=>{void 0!==t&&(this.config[e]=t)})}element;mvc=new I({element:this});constructor(e={}){this.element=w(e)}setupChangedCallbacks(){}setupUIElements(){}setupUILayout(){}setupUIListeners(){}}async function Zt(e,t=12){const i=Math.ceil(6*t/8),n=new TextEncoder,s=await crypto.subtle.digest("SHA-256",n.encode(e)),a=new Uint8Array(s).slice(0,i);return("function"==typeof btoa?btoa(String.fromCharCode(...a)):Buffer.from(a).toString("base64")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"").slice(0,t)}function ei(e){if(!e)return NaN;const t=parseInt(e.substring(1),16);return.2126*((t>>16&255)/255)+.7152*((t>>8&255)/255)+.0722*((255&t)/255)}function ti(e,t){if(!e||!t)return NaN;const i=ei(e),n=ei(t);return(Math.max(i,n)+.1)/(Math.min(i,n)+.1)}function ii(e,...t){let i="";return e.forEach((e,n)=>{i+=e+(t[n]||"")}),i}Pe(Qt),Oe(Qt),wt(Qt);const ni={900:{Black:"normal",BlackItalic:"italic"},800:{ExtraBold:"normal",ExtraBoldItalic:"italic"},700:{Bold:"normal",BoldItalic:"italic"},600:{SemiBold:"normal",SemiBoldItalic:"italic"},500:{Medium:"normal",MediumItalic:"italic"},400:{Regular:"normal",Italic:"italic"},300:{Light:"normal",LightItalic:"italic"},200:{ExtraLight:"normal",ExtraLightItalic:"italic"},100:{Thin:"normal",ThinItalic:"italic"}};function si(e,t,i,n,s){return ii`
        @font-face {
            font-family: "${e}";
            src: url("${t}") format("${i}"), 
            url("${t}") format("woff"),
            url("${t}") format("truetype");
            font-weight: ${"string"==typeof n?'"'+n+'"':n};
            font-style: "${s}";
        }`}let ai=(()=>{let e,n=F,s=[];return class extends n{static{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;e=[c()],t.__esDecorate(this,null,e,{kind:"setter",name:"enabledCallbacks",static:!1,private:!1,access:{has:e=>"enabledCallbacks"in e,set:(e,t)=>{e.enabledCallbacks=t}},metadata:i},null,s),i&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})}constructor(e,i){super(e,i),t.__runInitializers(this,s)}get data(){return super.data}set data(e){e instanceof i.AbstractType&&(super.data=e)}set enabledCallbacks(e){this.getAllBlocks().forEach(t=>{t.observer&&t.data&&(e?t.data.observe(t.observer):t.data.unobserve(t.observer))})}getData(e,t=this.defaultBlockKey){const n=this.getBlockData(t);if(n instanceof i.Map)return n.get(e.toString());if(n instanceof i.Array){const t=Number(e);if(t>=0&&t<n.length)return n.get(t)}return null}setData(e,t,n=this.defaultBlockKey){const s=this.getBlockData(n);if(s instanceof i.Map)s.set(e.toString(),t);else if(s instanceof i.Array){const i=Number(e);if(i<0)return;i<s.length&&s.delete(i,1),s.insert(i,[t])}}getSize(e=this.defaultBlockKey){const t=this.getBlockData(e);return t instanceof i.Map||t instanceof i.Array?t instanceof i.Array?t.length:t.size:0}createBlock(e,t,i=this.defaultBlockKey){return{...super.createBlock(e,t),observer:(e,t)=>this.observeChanges(e,t,i)}}setBlock(e,t,i=this.defaultBlockKey,n=!0){if(this.enabledCallbacks){const e=this.getBlock(i);e&&e.data&&e.observer&&e.data.unobserve(e.observer)}this.clear(i),super.setBlock(e,t,i,n)}initialize(e=this.defaultBlockKey){super.initialize(e);const t=this.getBlock(e);t?.data?.observe(t?.observer)}getAllKeys(e=this.defaultComputationBlockKey){const t=[];for(const n of this.getAllBlocks(e)){const e=n.data;if(e instanceof i.Map)t.push(...Array.from(e.keys()));else if(e instanceof i.Array)for(let i=0;i<e.length;i++)t.push(i)}return t}getAllObservers(e=this.defaultComputationBlockKey){return this.getAllBlocks(e).map(e=>e.observer)}}})();return Object.defineProperty(e,"YAbstractType",{enumerable:!0,get:function(){return i.AbstractType}}),Object.defineProperty(e,"YArray",{enumerable:!0,get:function(){return i.Array}}),Object.defineProperty(e,"YArrayEvent",{enumerable:!0,get:function(){return i.YArrayEvent}}),Object.defineProperty(e,"YDoc",{enumerable:!0,get:function(){return i.Doc}}),Object.defineProperty(e,"YEvent",{enumerable:!0,get:function(){return i.YEvent}}),Object.defineProperty(e,"YMap",{enumerable:!0,get:function(){return i.Map}}),Object.defineProperty(e,"YMapEvent",{enumerable:!0,get:function(){return i.YMapEvent}}),Object.defineProperty(e,"YText",{enumerable:!0,get:function(){return i.Text}}),e.$=ct,e.ApplyDefaultsMergeProperties=p,e.BasicInputEvents=se,e.DefaultClickEventName=K,e.DefaultDragEventName=Y,e.DefaultEventName=J,e.DefaultKeyEventName=R,e.DefaultMoveEventName=U,e.DefaultWheelEventName=q,e.Delegate=A,e.MathMLNamespace=y,e.MathMLTags=k,e.Mvc=I,e.NonPassiveEvents=ae,e.Point=ke,e.Reifect=Ht,e.ReifectHandler=nt,e.StatefulReifect=$e,e.SvgNamespace=b,e.SvgTags=v,e.TurboBaseElement=Wt,e.TurboButton=Mt,e.TurboClickEventName=W,e.TurboController=be,e.TurboDragEvent=Se,e.TurboDragEventName=$,e.TurboDrawer=Ut,e.TurboDropdown=qt,e.TurboElement=Ct,e.TurboEmitter=M,e.TurboEvent=me,e.TurboEventManager=Ie,e.TurboEventName=X,e.TurboHandler=De,e.TurboHeadlessElement=Me,e.TurboIcon=Dt,e.TurboIconSwitch=xt,e.TurboIconToggle=jt,e.TurboInput=Vt,e.TurboInteractor=kt,e.TurboKeyEvent=ge,e.TurboKeyEventName=L,e.TurboMap=ce,e.TurboMarkingMenu=Xt,e.TurboModel=F,e.TurboMoveEventName=H,e.TurboNumericalInput=Lt,e.TurboPopup=Yt,e.TurboProxiedElement=Qt,e.TurboRichElement=Ot,e.TurboSelect=Kt,e.TurboSelectInputEvent=Rt,e.TurboSelectWheel=Jt,e.TurboSelector=h,e.TurboSubstrate=class extends be{substrateName;solverKeys=[];get objectList(){return ct(this).getSubstrateObjectList(this.substrateName)}set objectList(e){ct(this).setSubstrateObjectList(e,this.substrateName)}constructor(e){super(e),this.substrateName=e.substrateName??this.substrateName??void 0,e.onActivate&&(this.onActivate=e.onActivate),e.onDeactivate&&(this.onDeactivate=e.onDeactivate)}initialize(){super.initialize(),this.substrateName&&(ct(this).makeSubstrate(this.substrateName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0}),this.solverKeys.forEach(e=>{ct(this).addSolver(t=>this[e]?.(t))}))}addObject(e){ct(this).addObjectToSubstrate(e,this.substrateName)}removeObject(e){ct(this).removeObjectFromSubstrate(e,this.substrateName)}hasObject(e){return ct(this).hasObjectInSubstrate(e,this.substrateName)}isProcessed(e){return ct(this).wasObjectProcessedBySubstrate(e,this.substrateName)}addSolver(e){ct(this).addSolver(e,this.substrateName)}removeSolver(e){ct(this).removeSolver(e,this.substrateName)}clearSolvers(){ct(this).clearSolvers(this.substrateName)}resolve(e={}){ct(this).resolveSubstrate({...e,substrate:this.substrateName})}},e.TurboTool=class extends be{toolName;embeddedTarget;manager;activationEvent=J.click;clickMode=e.ClickMode.left;key;constructor(e){super(e),this.toolName=e.toolName??this.toolName??void 0,e.embeddedTarget&&(this.embeddedTarget=e.embeddedTarget),e.onActivate&&(this.onActivate=e.onActivate),e.onDeactivate&&(this.onDeactivate=e.onDeactivate),e.activationEvent&&(this.activationEvent=e.activationEvent),e.clickMode&&(this.clickMode=e.clickMode),e.customActivation&&(this.customActivation=e.customActivation),e.key&&(this.key=e.key),this.manager=e.manager??this.manager??Ie.instance}initialize(){if(super.initialize(),this.toolName){ct(this).makeTool(this.toolName,{onActivate:"function"==typeof this.onActivate?this.onActivate.bind(this):void 0,onDeactivate:"function"==typeof this.onDeactivate?this.onDeactivate.bind(this):void 0,activationEvent:this.activationEvent,clickMode:this.clickMode,customActivation:"function"==typeof this.customActivation?this.customActivation.bind(this):void 0,key:this.key,manager:this.manager}),this.embeddedTarget&&ct(this).embedTool(this.embeddedTarget,this.manager);for(const[e,t]of Object.entries(J)){const i=this[e];"function"==typeof i&&ct(this).addToolBehavior(t,(e,t)=>i.call(this,e,t),this.toolName,this.manager)}}}},e.TurboView=class{element;model;emitter;constructor(e){this.element=e.element,e.model&&(this.model=e.model),e.emitter&&(this.emitter=e.emitter)}initialize(){this.setupUIElements(),this.setupUILayout(),this.setupUIListeners(),this.setupChangedCallbacks()}setupChangedCallbacks(){V(this)}setupUIElements(){}setupUILayout(){}setupUIListeners(){}},e.TurboWeakSet=we,e.TurboWheelEvent=ve,e.TurboWheelEventName=G,e.YComponentModel=class extends ai{observeChanges(e,t,i){e.keysChanged.forEach(t=>{const n=e.changes.keys.get(t);n?this.fireKeyChangedCallback(t,i,"delete"===n?.action):console.warn(`No change info for key "${t}". Event:`,e)})}},e.YManagerModel=class extends ai{onAdded=new A;onUpdated=new A;onDeleted=new A;constructor(e,t){super(e,t),this.onUpdated.add((e,t,i)=>{(t instanceof Ct||t instanceof Qt)&&(t.data=e,t.dataId=i.toString())}),this.onDeleted.add((e,t,i,n)=>{this.removeInstance(t),this.getBlock(n).instances?.delete(i)})}createBlock(e,t,i=this.defaultBlockKey){return{...super.createBlock(e,t,i),instances:new Map}}getInstance(e,t=this.defaultComputationBlockKey){for(const i of this.getAllBlocks(t))if(i.instances&&i.instances.has(e))return i.instances.get(e);return null}getAllComponents(e=this.defaultComputationBlockKey){const t=this.getBlock(e);if(t&&t.data instanceof i.Array){const t=this.getBlock(e)?.instances;if(!t)return[];const i=[];for(const[e,n]of t.entries())i.push([e,n]);return i.sort((e,t)=>"string"==typeof e[0]&&"string"==typeof t[0]?e[0].localeCompare(t[0]):"number"==typeof e[0]&&"number"==typeof t[0]?e[0]-t[0]:0),i.map(([,e])=>e)}return this.getAllBlocks(e).flatMap(e=>Array.from(e.instances?.values())||[])}clear(e=this.defaultComputationBlockKey){super.clear(e),this.getAllBlocks(e).forEach(e=>{e?.instances?.forEach(e=>this.removeInstance(e)),e?.instances?.clear()})}getAllData(e=this.defaultComputationBlockKey){return super.getAllData(e)}fireKeyChangedCallback(e,t=this.defaultBlockKey,i=!1){if(!this.getAllKeys(t).includes(e))return super.fireKeyChangedCallback(e,t,i);const n=this.getData(e,t),s=this.onAdded.fire(n,e,t);s&&(this.getBlock(t).instances?.set(e,s),"object"==typeof s&&("data"in s&&(s.data=n),"dataId"in s&&(s.dataId=e.toString())),this.onUpdated.fire(n,s,e,t))}removeInstance(e){e&&"object"==typeof e&&"remove"in e&&"function"==typeof e.remove&&e?.remove()}observeChanges(e,t,n=this.defaultBlockKey){if(e instanceof i.YMapEvent)e.keysChanged.forEach(t=>{const i=e.changes.keys.get(t);switch(i.action){case"add":this.fireKeyChangedCallback(t,n);break;case"delete":this.onDeleted.fire(i.oldValue,this.getInstance(t,n),t,n);break;case"update":this.onUpdated.fire(this.getData(t,n),this.getInstance(t,n),t,n)}});else if(e instanceof i.YArrayEvent){let t=0;for(const i of e.delta)if(void 0!==i.retain)t+=i.retain;else if(i.insert){const e=(Array.isArray(i.insert)?i.insert:[i.insert]).length;this.shiftIndices(t,e,n);for(let i=0;i<e;i++)this.fireKeyChangedCallback(t+i,n);t+=e}else if(i.delete){const e=i.delete;for(let i=0;i<e;i++)this.onDeleted.fire(void 0,this.getInstance(t+i,n),t+i,n);this.shiftIndices(t+e,-e,n)}}}shiftIndices(e,t,i=this.defaultBlockKey){const n=this.getBlock(i)?.instances;if(!n)return;const s=[];for(const[t,i]of n.entries()){const n=Number(t);n>=e&&s.push([n,i])}s.sort((e,t)=>e[0]-t[0]);for(const[e]of s)n.delete(e);for(const[e,i]of s){const s=e+t;"object"==typeof i&&"dataId"in i&&(i.dataId=s),n.set(e+t,i)}}},e.YModel=ai,e.a=function(e={}){return _({...e,tag:"a"})},e.addInYArray=function(e,t,i){return null==i||i>t.length?(i=t.length,t.push([e])):(i<0&&(i=0),t.insert(i,[e])),i},e.addInYMap=async function(e,t,i){const n=async()=>await Zt(t?.doc?.clientID?.toString(32)+Bt());if(!i)for(i=await n();void 0!==t?.get(i);)i=await n();return t.set(i,e),i},e.areEqual=function(...e){if(e.length<2)return!0;for(let t=0;t<e.length-1;t++)if(e[t]!=e[t+1])return!1;return!0},e.auto=c,e.bestOverlayColor=function(e,t="#000000",i="#FFFFFF"){return ti(e,i)>ti(t,e)?i:t},e.blindElement=w,e.button=It,e.cache=ut,e.callOnce=Re,e.callOncePerInstance=function(e,t){if("method"!==t.kind)throw new Error(`@callOnce can only be used on methods (got: ${t.kind}).`);const i=String(t.name),n=Symbol(`__callOnce__${i}`);return function(...t){if(!this[n])return this[n]=!0,e.apply(this,t);console.warn(`Function ${i} has already been called once on this instance and will not be called again.`)}},e.camelToKebabCase=te,e.canvas=function(e={}){return _({...e,tag:"canvas"})},e.clearCache=dt,e.clearCacheEntry=function(e,t){const i="function"==typeof t?t.name:t,n=Object.getOwnPropertySymbols(e).find(e=>String(e)===`Symbol(__cache__${i})`);n&&delete e[n]},e.contrast=ti,e.controller=ue,e.createProxy=function(e,t){return new Proxy(e,{get:(e,i,n)=>i in e?Reflect.get(e,i,n):i in t?Reflect.get(t,i,n):void 0,set:(e,i,n,s)=>i in e?Reflect.set(e,i,n,s):Reflect.set(t,i,n,s)})},e.createYArray=function(e){const t=new i.Array;return t.push(e),t},e.createYMap=function(e){const t=new i.Map;for(const[i,n]of Object.entries(e))t.set(i,n);return t},e.css=ii,e.deepObserveAll=function(e,t,...n){if(!e)return;const s=new Set(n);e.observeDeep(e=>{const n=new Set;for(const a of e){const e=a.target,r=e._item?.parent,o=e._item?.parentSub;for(const e of s)(a instanceof i.YMapEvent&&a.changes.keys.has(e)||a instanceof i.YArrayEvent&&r instanceof i.Map&&o===e||a.path?.some(t=>t===e))&&n.add(e);if(n.size===s.size)return void t(a,e)}})},e.deepObserveAny=function(e,t,...n){if(!e)return;const s=new Set(n);e.observeDeep(e=>{for(const n of e){const e=n.target,a=e._item?.parent,r=e._item?.parentSub;for(const o of s)if(n instanceof i.YMapEvent&&n.changes.keys.has(o)||n instanceof i.YArrayEvent&&a instanceof i.Map&&r===o||n.path?.some(e=>e===o))return void t(o,n,e)}})},e.define=ft,e.disposeEffect=function(e,t){const i=j.getReactivityData(e,t);i.effect?.dispose(),i.effect=void 0},e.disposeEffects=function(e){for(const[,t]of j.data(e))t.effect?.dispose(),t.effect=void 0},e.div=C,e.drawer=function(e){return e.tag||(e.tag="turbo-drawer"),_({...e,text:void 0})},e.dropdown=function(e={}){return e.tag||(e.tag="turbo-dropdown"),_({...e,text:void 0})},e.eachEqualToAny=Ke,e.effect=function(...e){const t=e[0],i=e[1];if(i&&"object"==typeof i&&"kind"in i&&"name"in i&&"static"in i&&"private"in i){const{kind:e,name:n,static:s}=i,a=String(n);if("method"!==e&&"getter"!==e&&("field"!==e||"function"!=typeof t))throw new Error("@effect can only decorate zero-arg instance methods or getters.");if(s)throw new Error("@effect does not support static methods/getters.");i.addInitializer?.(function(){const e=this,i=function(){t?.call(this)},n=N.makeEffect(()=>i.call(e));j.setEffect(e,a,n)})}else if("function"==typeof t){const e=N.makeEffect(t);return e.run(),()=>e.dispose()}},e.element=_,e.equalToAny=We,e.expose=mt,e.fetchSvg=_t,e.flexCol=yt,e.flexColCenter=function(e){const t=yt(e);return ct(t).setStyles({justifyContent:"center",alignItems:"center"},!0),t},e.flexRow=vt,e.flexRowCenter=function(e){const t=vt(e);return ct(t).setStyles({justifyContent:"center",alignItems:"center"},!0),t},e.form=function(e={}){return _({...e,tag:"form"})},e.generateTagFunction=function(e){return(t={})=>(t.tag=e,_({...t,tag:e}))},e.getEventPosition=function(e){return e instanceof me?e.scaledPosition:e instanceof PointerEvent?new ke(e.clientX,e.clientY):void 0},e.getFileExtension=ee,e.getFirstDescriptorInChain=n,e.getFirstPrototypeInChainWith=s,e.getSignal=function(e,t){return j.getSignal(e,t)},e.getSuperMethod=a,e.h1=function(e={}){return _({...e,tag:"h1"})},e.h2=function(e={}){return _({...e,tag:"h2"})},e.h3=function(e={}){return _({...e,tag:"h3"})},e.h4=function(e={}){return _({...e,tag:"h4"})},e.h5=function(e={}){return _({...e,tag:"h5"})},e.h6=function(e={}){return _({...e,tag:"h6"})},e.handler=de,e.hasPropertyInChain=function(e,t){let i=e;for(;i&&i!==HTMLElement.prototype;){if(Object.prototype.hasOwnProperty.call(i,t))return!0;i=Object.getPrototypeOf(i)}return!1},e.hashBySize=Zt,e.hashString=async function(e){const t=(new TextEncoder).encode(e),i=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(i)).map(e=>e.toString(16).padStart(2,"0")).join("")},e.icon=Tt,e.iconSwitch=At,e.iconToggle=function(e){return e.tag||(e.tag="turbo-icon-toggle"),Tt({...e})},e.img=D,e.initializeEffects=V,e.input=T,e.interactor=function(e){return function(t,i){he(i,"Interactor",e)}},e.isMathMLTag=S,e.isNull=r,e.isSvgTag=E,e.isUndefined=o,e.kebabToCamelCase=ie,e.linearInterpolation=function(e,t,i,n,s,a=!0){if(a){const n=Math.max(t,i),s=Math.min(t,i);e>n&&(e=n),e<s&&(e=s)}return n+(e-t)*(s-n)/(i-t)},e.link=function(e={}){return _({...e,tag:"link"})},e.loadLocalFont=function(e){e.name&&e.pathOrDirectory||console.error("Please specify font name and path/directory");const t=0==ee(e.pathOrDirectory).length;e.stylesPerWeights||(e.stylesPerWeights=t?ni:{normal:"normal"}),e.format||(e.format="woff2"),e.extension||(e.extension=".ttf"),"."!=e.extension[0]&&(e.extension="."+e.extension),P(Object.entries(e.stylesPerWeights).map(([t,i])=>{const n=Number.parseInt(t),s=n||t;return"string"==typeof i?si(e.name,e.pathOrDirectory,e.format,s,i):Object.entries(i).map(([t,i])=>si(e.name,`${e.pathOrDirectory}/${e.name}-${t}${e.extension}`,e.format,s,i)).join("\n")}).join("\n"))},e.luminance=ei,e.markDirty=z,e.mod=Ue,e.modelSignal=function(e,t){return function(i,n){const s=e??String(n.name);return B.signalDecorator(i,n,function(){return this.getData?.(s,t)},function(e){this.setData?.(s,e,t)})}},e.numericalInput=function(e){return e.inputRegexCheck||(e.inputRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?\.?$|^-$|^$/),e.blurRegexCheck||(e.blurRegexCheck=/^(?!-0?(\.0+)?$)-?(0|[1-9]\d*)?(\.\d+)?(?<=\d)$/),e.tag||(e.tag="turbo-numerical-input"),Ft({...e})},e.observe=bt,e.p=function(e={}){return _({...e,tag:"p"})},e.parse=Z,e.popup=Gt,e.randomColor=function(e=[50,70],t=[70,85]){return"number"!=typeof e&&e.length>=2&&(e=Nt(e[0],e[1])),"number"!=typeof t&&t.length>=2&&(t=Nt(t[0],t[1])),"hsl("+360*Math.random()+" "+e+" "+t+")"},e.randomFromRange=Nt,e.randomId=Bt,e.randomString=function(e=12){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let i="";for(let n=0;n<e;n++)i+=t.charAt(Math.floor(62*Math.random()));return i},e.reifect=function(e){return new Ht(e)},e.removeFromYArray=function(e,t){for(const[i,n]of t.toArray())if(e==n)return t.delete(i),!0;return!1},e.richElement=Pt,e.setSignal=function(e,t,i){return j.setSignal(e,t,i)},e.setupClassFunctions=g,e.setupElementFunctions=ne,e.setupEventFunctions=Ae,e.setupHierarchyFunctions=d,e.setupMiscFunctions=f,e.setupReifectFunctions=rt,e.setupStyleFunctions=Be,e.setupSubstrateFunctions=Fe,e.setupToolFunctions=ze,e.signal=function(...e){if(e[1]&&"object"==typeof e[1]&&"kind"in e[1]&&"name"in e[1]&&"static"in e[1]&&"private"in e[1])return B.signalDecorator(e[0],e[1]);const t=e[0];return B.createBoxFromEntry(j.createSignalEntry(t))},e.solver=function(e,t){const{name:i}=t;return t.addInitializer(function(){this.solverKeys?.push(i)}),e},e.spacer=function(e){const t=_(e);return ct(t).setStyle("flexGrow",1,!0),t},e.span=function(e={}){return _({...e,tag:"span"})},e.statefulReifier=function(e){return new $e(e)},e.stringify=Q,e.style=O,e.stylesheet=P,e.substrate=function(e){return function(t,i){he(i,"Substrate",e)}},e.t=function(e){return lt(e)},e.textToElement=St,e.textarea=function(e={}){return _({...e,tag:"textarea"})},e.tool=function(e){return function(t,i){he(i,"Tool",e)}},e.trim=He,e.tu=function(e){return lt(e)},e.turbo=lt,e.turboInput=Ft,e.turbofy=ht,e.video=function(e={}){return _({...e,tag:"video"})},e}({},tslib,yjs);
